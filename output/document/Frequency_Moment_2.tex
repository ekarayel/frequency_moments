%
\begin{isabellebody}%
\setisabellecontext{Frequency{\isacharunderscore}{\kern0pt}Moment{\isacharunderscore}{\kern0pt}{\isadigit{2}}}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Frequency Moment $2$%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Frequency{\isacharunderscore}{\kern0pt}Moment{\isacharunderscore}{\kern0pt}{\isadigit{2}}\isanewline
\ \ \isakeyword{imports}\ Main\ Median\ Partitions\ Primes{\isacharunderscore}{\kern0pt}Ext\ Encoding\ List{\isacharunderscore}{\kern0pt}Ext\ \isanewline
\ \ \ \ Universal{\isacharunderscore}{\kern0pt}Hash{\isacharunderscore}{\kern0pt}Families{\isacharunderscore}{\kern0pt}Nat\ Frequency{\isacharunderscore}{\kern0pt}Moments\ Landau{\isacharunderscore}{\kern0pt}Ext\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
This section contains a formalization of the algorithm for the second frequency moment.
It is based on the algorithm described in \cite[\textsection 2.2]{alon1999}.
The only difference is that the algorithm is adapted to work with prime field of odd order, which
greatly reduces the implementation complexity.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ h\ k\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ hash\ p\ k\ h\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}k\ {\isacharless}{\kern0pt}\ p{\isacharbraceright}{\kern0pt}\ then\ int\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ else\ {\isacharminus}{\kern0pt}\ int\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{type{\isacharunderscore}{\kern0pt}synonym}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ int\ set\ list{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}rat\ {\isasymRightarrow}\ rat\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ pmf{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isasymdelta}\ {\isasymepsilon}\ n\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isasymdelta}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ p\ {\isacharequal}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}max\ n\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ h\ {\isasymleftarrow}\ prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ pmf{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ x\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ sketch{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ {\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}h\ i{\isacharparenright}{\kern0pt}\ x\ {\isacharplus}{\kern0pt}\ sketch\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ rat\ pmf{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ sketch{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}median\ s\isactrlsub {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i\isactrlsub {\isadigit{2}}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymSum}i\isactrlsub {\isadigit{1}}{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}sketch\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ i\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isacharunderscore}{\kern0pt}exp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}Factorial{\isacharunderscore}{\kern0pt}Ring{\isachardot}{\kern0pt}prime\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharless}{\kern0pt}\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\isanewline
\ \ \ \ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isacharparenleft}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isasymomega}\ k{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}m{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ g{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ prime{\isacharunderscore}{\kern0pt}gt{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}nat\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}odd\ p{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ prime{\isacharunderscore}{\kern0pt}odd{\isacharunderscore}{\kern0pt}nat\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ t\ \isakeyword{where}\ t{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p{\isacharequal}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}t{\isacharplus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ oddE\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymOmega}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymOmega}\ {\isacharequal}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}set{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fin{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharbrackleft}{\kern0pt}OF\ g{\isacharbrackright}{\kern0pt}\ ne{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ p{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}t{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ Int{\isacharunderscore}{\kern0pt}absorb{\isadigit{2}}{\isacharcomma}{\kern0pt}\ rule\ subsetI{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}card{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}antisym{\isacharcomma}{\kern0pt}\ rule\ subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isacharplus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ p{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}{\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ p\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ k{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ {\isacharbraceleft}{\kern0pt}t{\isacharplus}{\kern0pt}{\isadigit{1}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}card{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}antisym{\isacharcomma}{\kern0pt}\ rule\ subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ p\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}t{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ p\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ k{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}{\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}integral\isactrlsup L\ {\isasymOmega}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ x\ k{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ integral\isactrlsup L\ {\isasymOmega}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ indicator\ {\isacharbraceleft}{\kern0pt}{\isasymomega}{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ hash\ p\ k\ {\isasymomega}\ {\isacharless}{\kern0pt}\ p{\isacharbraceright}{\kern0pt}\ {\isasymomega}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}m\ {\isacharplus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ indicator\ {\isacharbraceleft}{\kern0pt}{\isasymomega}{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ hash\ p\ k\ {\isasymomega}\ {\isasymge}\ p{\isacharbraceright}{\kern0pt}\ {\isasymomega}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ {\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ measure{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}{\isachardot}{\kern0pt}\ hash\ p\ k\ {\isasymomega}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ \ {\isacharplus}{\kern0pt}\ \isanewline
\ \ \ \ \ {\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ measure{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}{\isachardot}{\kern0pt}\ hash\ p\ k\ {\isasymomega}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ k\ {\isasymge}\ p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}add{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ b{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ b{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}{\isasymOmega}{\isacharunderscore}{\kern0pt}def\ hash{\isacharunderscore}{\kern0pt}prob{\isacharunderscore}{\kern0pt}range{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ zero{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharbrackright}{\kern0pt}\ c{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ c{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}add{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}distrib\ ac{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}integral\isactrlsup L\ {\isasymOmega}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ x\ k{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ a{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}Factorial{\isacharunderscore}{\kern0pt}Ring{\isachardot}{\kern0pt}prime\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymAnd}a{\isachardot}{\kern0pt}\ a\ {\isasymin}\ set\ as\ {\isasymLongrightarrow}\ a\ {\isacharless}{\kern0pt}\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}M\ {\isasymequiv}\ measure{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}f\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isasymomega}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ var{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ M\ f\ {\isasymle}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}A{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{and}\ exp{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ M\ f\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}B{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ h\ \isakeyword{where}\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}\ x{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isasymomega}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ c\ \isakeyword{where}\ {\isachardoublequoteopen}c\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ as\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ r\ \isakeyword{where}\ {\isachardoublequoteopen}r\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}m{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}prod\ \isakeyword{where}\ {\isachardoublequoteopen}h{\isacharunderscore}{\kern0pt}prod\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}as\ {\isasymomega}{\isachardot}{\kern0pt}\ prod{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}h\ {\isasymomega}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ list\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymProd}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ r\ {\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ as\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{interpret}\isamarkupfalse%
\ prob{\isacharunderscore}{\kern0pt}space\ M\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf\ M{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}x\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ x\ {\isacharasterisk}{\kern0pt}\ h\ {\isasymomega}\ x{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isacharunderscore}{\kern0pt}def\ c{\isacharunderscore}{\kern0pt}def\ h{\isacharunderscore}{\kern0pt}def\ sum{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}eval\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ int{\isacharunderscore}{\kern0pt}M{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}f{\isachardot}{\kern0pt}\ integrable\ M\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}f\ {\isasymomega}{\isacharparenright}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}real{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}M{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ ne{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ fin{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}one{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}r\ {\isacharparenleft}{\kern0pt}Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}r{\isacharunderscore}{\kern0pt}def\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}two{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}r\ {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}r{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ nonzero{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}four{\isacharunderscore}{\kern0pt}est{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}r\ {\isadigit{4}}\ {\isasymle}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}r{\isacharunderscore}{\kern0pt}two{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}r{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ pos{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ power{\isadigit{4}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}xxxx{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ y{\isacharequal}{\kern0pt}{\isachardoublequoteopen}real\ p\ {\isacharasterisk}{\kern0pt}\ {\isadigit{1}}{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ real\ p\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharasterisk}{\kern0pt}\ {\isadigit{1}}{\isadigit{6}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}less\ num{\isacharunderscore}{\kern0pt}double\ numeral{\isacharunderscore}{\kern0pt}mult\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}power\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}le\ prime{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}nat\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp{\isacharplus}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}sym{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymnoteq}\ y\ {\isasymand}\ y\ {\isasymnoteq}\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymnoteq}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}elim{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}as{\isachardot}{\kern0pt}\ prod{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}r\ {\isasymcirc}\ count{\isacharunderscore}{\kern0pt}list\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}remdups\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ prod{\isachardot}{\kern0pt}set{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}list{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ set\ x\ {\isasymsubseteq}\ set\ as\ {\isasymLongrightarrow}\ length\ x\ {\isasymle}\ {\isadigit{4}}\ {\isasymLongrightarrow}\ expectation\ {\isacharparenleft}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ x\ {\isasymsubseteq}\ set\ as{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}sub{\isacharunderscore}{\kern0pt}p{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set\ x\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ atLeastLessThan{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}p{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}k{\isachardot}{\kern0pt}\ k\ {\isasymin}\ set\ x\ {\isasymLongrightarrow}\ k\ {\isacharless}{\kern0pt}\ p{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ x\ {\isasymle}\ {\isadigit{4}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}x{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{4}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}length\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}trans\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}expectation\ {\isacharparenleft}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ expectation\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ {\isasymProd}\ i\ {\isasymin}\ set\ x{\isachardot}{\kern0pt}\ h\ {\isasymomega}\ i{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ x\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}expectation{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ prod{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}eval{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymProd}i\ {\isasymin}\ set\ x{\isachardot}{\kern0pt}\ expectation\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ h\ {\isasymomega}\ i{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ x\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}lebesgue{\isacharunderscore}{\kern0pt}integral{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}h{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}compose{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X{\isacharequal}{\kern0pt}{\isachardoublequoteopen}hash\ p{\isachardoublequoteclose}\ \isakeyword{and}\ M{\isacharprime}{\kern0pt}{\isacharequal}{\kern0pt}{\isachardoublequoteopen}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ hash{\isacharunderscore}{\kern0pt}k{\isacharunderscore}{\kern0pt}wise{\isacharunderscore}{\kern0pt}indep{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ n{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{4}}{\isachardoublequoteclose}\ \isakeyword{and}\ p{\isacharequal}{\kern0pt}{\isachardoublequoteopen}p{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ card{\isacharunderscore}{\kern0pt}x\ x{\isacharunderscore}{\kern0pt}sub{\isacharunderscore}{\kern0pt}p\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}k{\isacharunderscore}{\kern0pt}wise{\isacharunderscore}{\kern0pt}indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}def\ M{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ int{\isacharunderscore}{\kern0pt}M{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymProd}i\ {\isasymin}\ set\ x{\isachardot}{\kern0pt}\ r\ {\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ x\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isacharunderscore}{\kern0pt}exp{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ x{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}p\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}h{\isacharunderscore}{\kern0pt}def\ r{\isacharunderscore}{\kern0pt}def\ M{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}expectation\ {\isacharparenleft}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}cong{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ x\ y\ {\isasymLongrightarrow}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ y{\isachardoublequoteclose}\ \isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ y\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ list{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ x\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ f\ \isakeyword{where}\ b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bij{\isacharunderscore}{\kern0pt}betw\ f\ {\isacharparenleft}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ c{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymAnd}z{\isachardot}{\kern0pt}\ z\ {\isasymin}\ set\ x\ {\isasymLongrightarrow}\ count{\isacharunderscore}{\kern0pt}list\ x\ z\ {\isacharequal}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ y\ {\isacharparenleft}{\kern0pt}f\ z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ eq{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}obtain{\isacharunderscore}{\kern0pt}bij{\isacharbrackleft}{\kern0pt}OF\ a{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x\ {\isacharequal}{\kern0pt}\ prod\ {\isacharparenleft}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ r{\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\ f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ c{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymProd}i\ {\isasymin}\ f\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ r{\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isachardot}{\kern0pt}reindex{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ b\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isachardot}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ b\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ y{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}cong{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}p\ x{\isachardot}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ p\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ p\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ p\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}expectation\ f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isasymin}set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j{\isasymin}set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharasterisk}{\kern0pt}\ c\ j\ {\isacharasterisk}{\kern0pt}\ expectation\ {\isacharparenleft}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}i{\isacharcomma}{\kern0pt}j{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isacharunderscore}{\kern0pt}eq\ h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right\ Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}sum{\isacharbrackleft}{\kern0pt}OF\ int{\isacharunderscore}{\kern0pt}M{\isacharbrackright}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isasymin}set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j{\isasymin}set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharasterisk}{\kern0pt}\ c\ j\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}i{\isacharcomma}{\kern0pt}j{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ \ \isanewline
\ \ \ \ c\ i\ {\isacharasterisk}{\kern0pt}\ c\ j\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}p{\isachardot}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ p\ {\isacharbrackleft}{\kern0pt}i{\isacharcomma}{\kern0pt}j{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}enum{\isacharunderscore}{\kern0pt}partitions\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isacharunderscore}{\kern0pt}partitions{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isasymin}set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharasterisk}{\kern0pt}\ c\ i\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Suc\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}elim\ r{\isacharunderscore}{\kern0pt}one{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation{\isacharunderscore}{\kern0pt}elim\ distrib{\isacharunderscore}{\kern0pt}left\ sum{\isachardot}{\kern0pt}distrib\ sum{\isacharunderscore}{\kern0pt}collapse\ fold{\isacharunderscore}{\kern0pt}sym{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}c{\isacharunderscore}{\kern0pt}def\ F{\isacharunderscore}{\kern0pt}def\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult\ r{\isacharunderscore}{\kern0pt}two{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}{\isacharquery}{\kern0pt}B\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}expectation\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{1}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{2}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{3}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{4}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\isanewline
\ \ \ \ c\ i{\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ expectation\ {\isacharparenleft}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}i{\isadigit{1}}{\isacharcomma}{\kern0pt}\ i{\isadigit{2}}{\isacharcomma}{\kern0pt}\ i{\isadigit{3}}{\isacharcomma}{\kern0pt}\ i{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isacharunderscore}{\kern0pt}eq\ h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ power{\isadigit{4}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}xxxx\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right\ Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}sum{\isacharbrackleft}{\kern0pt}OF\ int{\isacharunderscore}{\kern0pt}M{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{1}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{2}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{3}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{4}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ c\ i{\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}i{\isadigit{1}}{\isacharcomma}{\kern0pt}i{\isadigit{2}}{\isacharcomma}{\kern0pt}i{\isadigit{3}}{\isacharcomma}{\kern0pt}i{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{1}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{2}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{3}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{4}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ c\ i{\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}p{\isachardot}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ p\ {\isacharbrackleft}{\kern0pt}i{\isadigit{1}}{\isacharcomma}{\kern0pt}i{\isadigit{2}}{\isacharcomma}{\kern0pt}i{\isadigit{3}}{\isacharcomma}{\kern0pt}i{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}enum{\isacharunderscore}{\kern0pt}partitions\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isacharunderscore}{\kern0pt}partitions{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ c\ j{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymSum}\ i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i{\isacharcircum}{\kern0pt}{\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{4}}{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}{\isasymSum}\ i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharcircum}{\kern0pt}\ {\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Suc\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}elim\ r{\isacharunderscore}{\kern0pt}one{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation{\isacharunderscore}{\kern0pt}elim\ distrib{\isacharunderscore}{\kern0pt}left\ sum{\isachardot}{\kern0pt}distrib\ sum{\isacharunderscore}{\kern0pt}collapse\ fold{\isacharunderscore}{\kern0pt}sym{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps\ sum{\isacharunderscore}{\kern0pt}subtractf\ sum{\isacharunderscore}{\kern0pt}collapse{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}\ i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharcircum}{\kern0pt}\ {\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}r\ {\isadigit{4}}\ {\isacharminus}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left\ sum{\isacharunderscore}{\kern0pt}subtractf{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharcircum}{\kern0pt}\ {\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}power{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}distrib\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}four{\isacharunderscore}{\kern0pt}est\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharplus}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}c{\isacharunderscore}{\kern0pt}def\ r{\isacharunderscore}{\kern0pt}two\ F{\isacharunderscore}{\kern0pt}def\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ v{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}expectation\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}variance\ f\ {\isasymle}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ variance{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}OF\ int{\isacharunderscore}{\kern0pt}M\ int{\isacharunderscore}{\kern0pt}M{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ subst\ b{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}power{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}distrib{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ v{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}A\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}sketch{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ n\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\ \ \isakeyword{fixes}\ as\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ list{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}{\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymdelta}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isasymequiv}\ nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isasymdelta}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isasymequiv}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}{\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}p\ {\isasymequiv}\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}max\ n\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}sketch\ {\isasymequiv}\ fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ a{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}{\isasymOmega}\ {\isasymequiv}\ prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sketch\ {\isacharequal}{\kern0pt}\ {\isasymOmega}\ {\isasymbind}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}h{\isachardot}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}h\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ ys\ \isakeyword{where}\ {\isachardoublequoteopen}ys\ {\isacharequal}{\kern0pt}\ rev\ as{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}sketch\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ x{\isacharparenright}{\kern0pt}\ ys\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ foldr{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}fold\ ys{\isacharunderscore}{\kern0pt}def\ sketch{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymOmega}\ {\isasymbind}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}h{\isachardot}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}h\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ys{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ ys{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def\ restrict{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ a\ as{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ a\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ a\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharcomma}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ snd\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isachardot}{\kern0pt}simps\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ a{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}assoc{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}return{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}def\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isachardot}{\kern0pt}simps\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init{\isachardot}{\kern0pt}simps\ cong{\isacharcolon}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymOmega}\ {\isasymbind}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}h{\isachardot}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}h\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ ys{\isacharunderscore}{\kern0pt}def\ rev{\isacharunderscore}{\kern0pt}map{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}correct{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}{\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymdelta}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ as\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}M\ {\isasymequiv}\ fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ a{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}\ {\isasymbind}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ measure{\isacharunderscore}{\kern0pt}pmf\ M{\isachardot}{\kern0pt}\ {\isasymbar}{\isasymomega}\ {\isacharminus}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isasymbar}\ {\isasymle}\ {\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isadigit{1}}{\isacharminus}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{1}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isasymdelta}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{2}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}{\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ p\ \isakeyword{where}\ {\isachardoublequoteopen}p\ {\isacharequal}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}max\ n\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from\ {\isacharequal}{\kern0pt}\ fst{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from\ {\isacharequal}{\kern0pt}\ fst\ {\isasymcirc}\ snd{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}from\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}p{\isacharunderscore}{\kern0pt}from\ {\isacharequal}{\kern0pt}\ fst\ {\isasymcirc}\ snd\ {\isasymcirc}\ snd{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}from\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ int\ set\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}h{\isacharunderscore}{\kern0pt}from\ {\isacharequal}{\kern0pt}\ fst\ {\isasymcirc}\ snd\ {\isasymcirc}\ snd\ {\isasymcirc}\ snd{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ sketch{\isacharunderscore}{\kern0pt}from\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}sketch{\isacharunderscore}{\kern0pt}from\ {\isacharequal}{\kern0pt}\ snd\ {\isasymcirc}\ snd\ {\isasymcirc}\ snd\ {\isasymcirc}\ snd{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}prime{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Factorial{\isacharunderscore}{\kern0pt}Ring{\isachardot}{\kern0pt}prime\ p{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}p{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}prime\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isasymge}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}p{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}lower{\isacharunderscore}{\kern0pt}bound\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}trans\ max{\isachardot}{\kern0pt}cobounded{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}sq{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isasymnoteq}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Num{\isachardot}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ nat{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ nat{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}as{\isacharunderscore}{\kern0pt}int\ nat{\isacharunderscore}{\kern0pt}power{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff\ not{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}one\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}power\ zero{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}numeral{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}set{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fin{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharbrackleft}{\kern0pt}OF\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}\ ne{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}set{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def\ set{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ finite{\isacharunderscore}{\kern0pt}PiE{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ as{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}p{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ set\ as\ {\isasymLongrightarrow}\ x\ {\isacharless}{\kern0pt}\ p{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ y{\isacharequal}{\kern0pt}{\isachardoublequoteopen}n{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ atLeastLessThan{\isacharunderscore}{\kern0pt}iff\ \isacommand{apply}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}p{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}lower{\isacharunderscore}{\kern0pt}bound\ max{\isachardot}{\kern0pt}boundedE{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fin{\isacharunderscore}{\kern0pt}poly{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ fin{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ s{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ h{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ sketch{\isacharunderscore}{\kern0pt}from\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ p{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ h{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ sketch{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}conv{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ h{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ sketch{\isacharunderscore}{\kern0pt}from\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}split{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f\ \isakeyword{where}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ median\ s\isactrlsub {\isadigit{2}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymSum}i\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}x\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f{\isadigit{3}}\ \isakeyword{where}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}f{\isadigit{3}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{2}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}x\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ i\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f{\isadigit{2}}\ \isakeyword{where}\ {\isachardoublequoteopen}f{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isasymlambda}i{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ f{\isadigit{3}}\ x\ i\isactrlsub {\isadigit{1}}\ i{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}var{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isasymLongrightarrow}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharslash}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}indep{\isacharunderscore}{\kern0pt}vars\ {\isacharparenleft}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ borel{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i\isactrlsub {\isadigit{1}}\ x{\isachardot}{\kern0pt}\ f{\isadigit{3}}\ x\ i\isactrlsub {\isadigit{1}}\ i{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ rule\ indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}intro\ {\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}j{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}j{\isacharcomma}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a\ f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def\ disjoint{\isacharunderscore}{\kern0pt}family{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def\ s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero\ s{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{3}}\ {\isasymomega}\ j\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ a\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ del{\isacharcolon}{\kern0pt}Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}zero{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance{\isacharunderscore}{\kern0pt}divide{\isacharbrackleft}{\kern0pt}OF\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}var{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}indep{\isacharbrackleft}{\kern0pt}OF\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ b{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ divide{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ variance{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}slice{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}a{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ var{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharbrackleft}{\kern0pt}OF\ p{\isacharunderscore}{\kern0pt}prime\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ as{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}p{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ frac{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero{\isacharcomma}{\kern0pt}\ metis\ p{\isacharunderscore}{\kern0pt}sq{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ divide{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ opaque{\isacharunderscore}{\kern0pt}lifting{\isacharparenright}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}ceiling\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}divide\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}eq\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power\ real{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}ceiling{\isacharunderscore}{\kern0pt}ge{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}pos{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharslash}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharslash}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}exp{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isasymLongrightarrow}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{3}}\ {\isasymomega}\ j\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ a\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}sum{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharslash}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ integral{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}slice{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}a{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ exp{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharbrackleft}{\kern0pt}OF\ p{\isacharunderscore}{\kern0pt}prime\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ as{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}p{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero\ p{\isacharunderscore}{\kern0pt}sq{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f{\isacharprime}{\kern0pt}\ \isakeyword{where}\ {\isachardoublequoteopen}f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ median\ s\isactrlsub {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ real{\isacharunderscore}{\kern0pt}f{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isacharprime}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ s{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}def\ median{\isacharunderscore}{\kern0pt}rat\ median{\isacharunderscore}{\kern0pt}restrict\ cong{\isacharcolon}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}divide\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}diff{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ distr{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}M\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}pmf\ f\ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ \ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}sketch{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ as{\isacharequal}{\kern0pt}{\isachardoublequoteopen}as{\isachardoublequoteclose}\ \isakeyword{and}\ n{\isacharequal}{\kern0pt}{\isachardoublequoteopen}n{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}M{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}assoc{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}return{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}conv{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ p{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ h{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ sketch{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ cong{\isacharcolon}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}map{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ f{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ g\ \isakeyword{where}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isasymbar}{\isasymomega}\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ e{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isasymomega}{\isachardot}{\kern0pt}\ {\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as\ {\isasymge}\ {\isasymbar}{\isasymomega}\ {\isacharminus}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isasymbar}{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isasymomega}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}\ {\isasymomega}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}g{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}antisym{\isacharcomma}{\kern0pt}\ rule\ subsetI{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ abs{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}diff\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ subsetI{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ abs{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}diff\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}indep{\isacharunderscore}{\kern0pt}vars\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ borel{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i\ {\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}intro\ {\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}j{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}j{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}disjoint{\isacharunderscore}{\kern0pt}family{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ fastforce{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}mem{\isacharunderscore}{\kern0pt}Times{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ real\ s\isactrlsub {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}ceiling\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ {\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymbar}f{\isadigit{2}}\ {\isasymomega}\ i\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymbar}f{\isadigit{2}}\ {\isasymomega}\ i\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}as\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ a\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ F{\isacharunderscore}{\kern0pt}def\ f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ F{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}F\ {\isadigit{2}}\ as\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ F{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackleft}{\kern0pt}OF\ False{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \ \ \ \ \isacommand{define}\isamarkupfalse%
\ var\ \isakeyword{where}\ \ {\isachardoublequoteopen}var\ {\isacharequal}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}exp{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ a\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ F{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}integrable\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isasymin}\ borel{\isacharunderscore}{\kern0pt}measurable\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymbar}f{\isadigit{2}}\ {\isasymomega}\ i\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}\ {\isasymle}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isasymbar}f{\isadigit{2}}\ {\isasymomega}\ i\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ pmf{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\ \isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ var\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}Chebyshev{\isacharunderscore}{\kern0pt}inequality{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ M{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isakeyword{and}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}simplified{\isacharbrackright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ p{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ F{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\isanewline
\ \ \ \ \ \ \ \ \ \ b{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ b{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ b{\isacharunderscore}{\kern0pt}{\isadigit{3}}\ b{\isacharunderscore}{\kern0pt}{\isadigit{4}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}var{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{3}}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isacharquery}{\kern0pt}ths{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ pos{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ F{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}var{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}var{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ a\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ distr{\isacharprime}{\kern0pt}\ e\ real{\isacharunderscore}{\kern0pt}f\ f{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}def\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ M{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isasymepsilon}{\isacharequal}{\kern0pt}{\isachardoublequoteopen}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isachardoublequoteclose}\ \isakeyword{and}\ X{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}i\ {\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{apply}\isamarkupfalse%
\ simp\ \isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{4}}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{fun}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ let\ s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isasymdelta}\isactrlsup {\isadigit{2}}\ {\isasymrceil}\ in\isanewline
\ \ \ \ let\ s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}\ in\ \isanewline
\ \ \ \ {\isadigit{5}}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{2}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ s\isactrlsub {\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ encode{\isacharunderscore}{\kern0pt}state\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ bool\ list\ option{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}encode{\isacharunderscore}{\kern0pt}state\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ N\isactrlsub S\ {\isasymtimes}\isactrlsub D\ {\isacharparenleft}{\kern0pt}{\isasymlambda}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ N\isactrlsub S\ {\isasymtimes}\isactrlsub D\ {\isacharparenleft}{\kern0pt}{\isasymlambda}s\isactrlsub {\isadigit{2}}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ N\isactrlsub S\ {\isasymtimes}\isactrlsub D\ {\isacharparenleft}{\kern0pt}{\isasymlambda}p{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}List{\isachardot}{\kern0pt}product\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbrackright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub S\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ {\isacharparenleft}{\kern0pt}zfact\isactrlsub S\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub S\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}List{\isachardot}{\kern0pt}product\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbrackright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub S\ I\isactrlsub S{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ encode{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}dom\ encode{\isacharunderscore}{\kern0pt}state{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ encoding{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}inj{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ dependent{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ dependent{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ dependent{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ encode{\isacharunderscore}{\kern0pt}extensional\ list{\isacharunderscore}{\kern0pt}encoding\ zfact{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ encode{\isacharunderscore}{\kern0pt}extensional\ int{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}exact{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}{\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymdelta}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ as\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}M\ {\isasymequiv}\ fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ a{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}AE\ {\isasymomega}\ in\ M{\isachardot}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state\ {\isasymomega}{\isacharparenright}{\kern0pt}\ {\isasymle}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{1}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isasymdelta}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{2}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ p\ \isakeyword{where}\ {\isachardoublequoteopen}p\ {\isacharequal}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}max\ n\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above\ {\isadigit{3}}\ {\isacharequal}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}min\ p{\isacharunderscore}{\kern0pt}def\ gr{\isadigit{0}}I\ not{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}zero{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}n{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}n\ {\isasymle}\ {\isadigit{3}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ One{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}def\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}upper{\isacharunderscore}{\kern0pt}bound\ Suc{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ add{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}right\ linear\ not{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq\ numeral{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}y{\isachardot}{\kern0pt}\ y{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub E\ bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ y{\isacharcomma}{\kern0pt}\ {\isasymlambda}i{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ \ \ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ y\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}y\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub E\ bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\ extensional\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ \ PiE{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ y\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ {\isacharparenleft}{\kern0pt}zfact\isactrlsub S\ p{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{9}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{5}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ y\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ {\isacharparenleft}{\kern0pt}zfact\isactrlsub S\ p{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}\ real\ {\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomial{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharbrackleft}{\kern0pt}OF\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ a{\isacharunderscore}{\kern0pt}{\isadigit{5}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}real\ {\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ log{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}cancel{\isacharunderscore}{\kern0pt}iff{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}n\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{9}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ {\isacharparenleft}{\kern0pt}zfact\isactrlsub S\ p{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{9}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ \ \ x\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ {\isasymbar}x{\isasymbar}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ int\ n{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ int\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ i\ \isakeyword{where}\ {\isachardoublequoteopen}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ x{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}abs\ x\ {\isasymle}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ abs\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ x{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ rule\ sum{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}abs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}int\ p{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ \isacommand{by}\isamarkupfalse%
\ simp\ \isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ int\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}int\ p{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}triv{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ int\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharplus}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}int\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}n\ \isacommand{apply}\isamarkupfalse%
\ linarith\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}abs\ x\ {\isasymle}\ \ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ int\ n{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ int\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mult{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ y{\isacharcomma}{\kern0pt}\ {\isasymlambda}i{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{2}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}n{\isacharplus}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{2}}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ encode{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ dependent{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ prod{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ fun\isactrlsub S{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ del{\isacharcolon}{\kern0pt}encode{\isacharunderscore}{\kern0pt}dependent{\isacharunderscore}{\kern0pt}sum{\isachardot}{\kern0pt}simps\ encode{\isacharunderscore}{\kern0pt}prod{\isachardot}{\kern0pt}simps\ N\isactrlsub S{\isachardot}{\kern0pt}simps\ plus{\isacharunderscore}{\kern0pt}ereal{\isachardot}{\kern0pt}simps\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}add{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharcomma}{\kern0pt}\ metis\ p{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}n{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}estI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{9}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ rule\ a{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}estI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharplus}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}n{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ length\ as{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ int{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}a{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ y{\isacharcomma}{\kern0pt}\ {\isasymlambda}i{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ AE{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ M{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}sketch{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ n{\isacharequal}{\kern0pt}{\isachardoublequoteopen}n{\isachardoublequoteclose}\ \isakeyword{and}\ as{\isacharequal}{\kern0pt}{\isachardoublequoteopen}as{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ set{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ PiE{\isacharunderscore}{\kern0pt}iff\ \ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharcomma}{\kern0pt}\ metis\ ne{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharcomma}{\kern0pt}\ metis\ fin{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharbrackleft}{\kern0pt}OF\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ a{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}asympotic{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}complexity{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}at{\isacharunderscore}{\kern0pt}top\ {\isasymtimes}\isactrlsub F\ at{\isacharunderscore}{\kern0pt}top\ {\isasymtimes}\isactrlsub F\ at{\isacharunderscore}{\kern0pt}right\ {\isadigit{0}}\ {\isasymtimes}\isactrlsub F\ at{\isacharunderscore}{\kern0pt}right\ {\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ \isanewline
\ \ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ m{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}rhs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ n{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}n{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ m{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}m{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ g\ \isakeyword{where}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ n{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}n{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}top{\isacharunderscore}{\kern0pt}linorder\ nat{\isacharunderscore}{\kern0pt}ceiling{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ m{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}m{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}top{\isacharunderscore}{\kern0pt}linorder\ nat{\isacharunderscore}{\kern0pt}ceiling{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ eps{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inv{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ delta{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inv{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}rightI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ b{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}delta{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}rightI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ b{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}delta\ delta{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ one{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}power\ power{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}over{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps\ eps{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}exp\ {\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ abs{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}self\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}trans\ exp{\isacharunderscore}{\kern0pt}gt{\isacharunderscore}{\kern0pt}zero\ ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff\ order{\isacharunderscore}{\kern0pt}trans{\isacharunderscore}{\kern0pt}rules{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ n{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ m{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{5}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono\ {\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}exp\ {\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ abs{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}self\ linorder{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le\ ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff\ not{\isacharunderscore}{\kern0pt}exp{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}zero\ order{\isachardot}{\kern0pt}trans{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono\ {\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps\ eps{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{8}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{9}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}\ unit{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}rightI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ b{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}nat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isachardot}{\kern0pt}in{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ always{\isacharunderscore}{\kern0pt}eventually{\isacharcomma}{\kern0pt}\ rule\ allI{\isacharcomma}{\kern0pt}\ rule\ arg{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ opaque{\isacharunderscore}{\kern0pt}lifting{\isacharparenright}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}ceiling\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}divide\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}eq\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ceil{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}const{\isacharunderscore}{\kern0pt}inv{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}nat{\isacharcomma}{\kern0pt}\ rule\ landau{\isacharunderscore}{\kern0pt}ceil{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ minus{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ cmult{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}iff{\isacharcomma}{\kern0pt}\ rule\ disjI{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ ln{\isacharunderscore}{\kern0pt}div{\isacharcomma}{\kern0pt}\ simp{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}trans\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono\ mult{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}commute\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}iff\ verit{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}simplify{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ mult{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}mult{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{9}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isachardot}{\kern0pt}in{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ ln{\isacharunderscore}{\kern0pt}mult{\isacharcomma}{\kern0pt}\ simp{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ n{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{5}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharcomma}{\kern0pt}\ rule\ l{\isadigit{1}}{\isacharcomma}{\kern0pt}\ rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{6}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ l{\isadigit{4}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{7}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}eps{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}ceil{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ minus{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ cmult{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}iff{\isacharcomma}{\kern0pt}\ rule\ disjI{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isachardot}{\kern0pt}in{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln{\isacharparenleft}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ ln{\isacharunderscore}{\kern0pt}div{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharbrackleft}{\kern0pt}OF\ eps{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ \ unit{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharcomma}{\kern0pt}\ m{\isacharunderscore}{\kern0pt}of\ x{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}\ n{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ m{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}g{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharcomma}{\kern0pt}\ subst\ mult{\isachardot}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}mult{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}mult{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{4}}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def\ l{\isadigit{6}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def\ l{\isadigit{7}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def\ l{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{8}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}rhs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}bigo{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}\ g{\isacharunderscore}{\kern0pt}def\ n{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ m{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=Frequency_Moment_2.tex%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%31=6%:%
%:%40=8%:%
%:%41=9%:%
%:%42=10%:%
%:%43=11%:%
%:%45=13%:%
%:%46=13%:%
%:%47=14%:%
%:%48=15%:%
%:%49=16%:%
%:%50=16%:%
%:%51=17%:%
%:%52=18%:%
%:%53=18%:%
%:%54=19%:%
%:%61=26%:%
%:%62=27%:%
%:%63=28%:%
%:%64=28%:%
%:%65=29%:%
%:%66=30%:%
%:%67=31%:%
%:%68=32%:%
%:%69=32%:%
%:%70=33%:%
%:%72=35%:%
%:%73=36%:%
%:%74=37%:%
%:%75=37%:%
%:%76=38%:%
%:%77=39%:%
%:%78=40%:%
%:%79=41%:%
%:%80=42%:%
%:%82=44%:%
%:%89=45%:%
%:%90=45%:%
%:%91=46%:%
%:%92=46%:%
%:%93=46%:%
%:%94=46%:%
%:%95=47%:%
%:%96=48%:%
%:%97=48%:%
%:%98=48%:%
%:%99=48%:%
%:%100=49%:%
%:%101=49%:%
%:%102=49%:%
%:%103=50%:%
%:%104=50%:%
%:%105=50%:%
%:%106=51%:%
%:%107=52%:%
%:%108=52%:%
%:%109=53%:%
%:%110=54%:%
%:%111=54%:%
%:%112=55%:%
%:%113=55%:%
%:%114=56%:%
%:%115=56%:%
%:%116=57%:%
%:%117=58%:%
%:%118=58%:%
%:%119=58%:%
%:%120=59%:%
%:%121=60%:%
%:%122=60%:%
%:%123=61%:%
%:%124=61%:%
%:%125=62%:%
%:%126=62%:%
%:%127=63%:%
%:%128=63%:%
%:%129=64%:%
%:%130=64%:%
%:%131=65%:%
%:%132=65%:%
%:%133=65%:%
%:%134=66%:%
%:%135=66%:%
%:%136=67%:%
%:%137=67%:%
%:%138=67%:%
%:%139=68%:%
%:%140=68%:%
%:%141=69%:%
%:%142=69%:%
%:%143=69%:%
%:%144=69%:%
%:%145=70%:%
%:%146=71%:%
%:%147=71%:%
%:%148=72%:%
%:%149=72%:%
%:%150=73%:%
%:%151=73%:%
%:%152=74%:%
%:%153=74%:%
%:%154=75%:%
%:%155=75%:%
%:%156=75%:%
%:%157=75%:%
%:%158=76%:%
%:%159=76%:%
%:%160=76%:%
%:%161=77%:%
%:%162=77%:%
%:%163=78%:%
%:%164=78%:%
%:%165=78%:%
%:%166=78%:%
%:%167=79%:%
%:%168=80%:%
%:%169=80%:%
%:%171=82%:%
%:%172=83%:%
%:%173=83%:%
%:%174=84%:%
%:%175=84%:%
%:%176=84%:%
%:%178=86%:%
%:%179=87%:%
%:%180=87%:%
%:%181=88%:%
%:%182=88%:%
%:%183=89%:%
%:%184=89%:%
%:%185=90%:%
%:%186=90%:%
%:%187=91%:%
%:%188=91%:%
%:%189=91%:%
%:%190=92%:%
%:%191=92%:%
%:%192=93%:%
%:%193=93%:%
%:%194=94%:%
%:%195=94%:%
%:%196=94%:%
%:%197=95%:%
%:%198=96%:%
%:%199=96%:%
%:%200=97%:%
%:%201=97%:%
%:%202=97%:%
%:%203=98%:%
%:%204=98%:%
%:%205=99%:%
%:%206=100%:%
%:%207=100%:%
%:%208=101%:%
%:%209=101%:%
%:%210=102%:%
%:%211=102%:%
%:%212=103%:%
%:%218=103%:%
%:%221=104%:%
%:%222=105%:%
%:%223=105%:%
%:%224=106%:%
%:%225=107%:%
%:%226=108%:%
%:%227=109%:%
%:%228=110%:%
%:%229=111%:%
%:%230=112%:%
%:%237=113%:%
%:%238=113%:%
%:%239=114%:%
%:%240=114%:%
%:%241=115%:%
%:%242=115%:%
%:%243=116%:%
%:%244=116%:%
%:%245=117%:%
%:%246=117%:%
%:%247=118%:%
%:%248=119%:%
%:%249=119%:%
%:%250=120%:%
%:%251=121%:%
%:%252=121%:%
%:%253=122%:%
%:%254=122%:%
%:%255=122%:%
%:%256=123%:%
%:%257=124%:%
%:%258=124%:%
%:%259=125%:%
%:%260=125%:%
%:%261=126%:%
%:%262=127%:%
%:%263=127%:%
%:%264=127%:%
%:%265=127%:%
%:%266=128%:%
%:%267=129%:%
%:%268=129%:%
%:%269=130%:%
%:%270=130%:%
%:%271=131%:%
%:%272=131%:%
%:%273=132%:%
%:%274=132%:%
%:%275=133%:%
%:%276=134%:%
%:%277=134%:%
%:%278=134%:%
%:%279=135%:%
%:%280=136%:%
%:%281=136%:%
%:%282=137%:%
%:%283=137%:%
%:%284=138%:%
%:%285=138%:%
%:%286=138%:%
%:%287=138%:%
%:%288=139%:%
%:%289=139%:%
%:%290=140%:%
%:%291=141%:%
%:%292=142%:%
%:%293=142%:%
%:%294=143%:%
%:%295=143%:%
%:%296=144%:%
%:%297=144%:%
%:%298=145%:%
%:%299=145%:%
%:%300=145%:%
%:%301=145%:%
%:%302=146%:%
%:%303=146%:%
%:%304=147%:%
%:%305=147%:%
%:%306=148%:%
%:%307=148%:%
%:%308=149%:%
%:%309=149%:%
%:%310=150%:%
%:%311=150%:%
%:%312=151%:%
%:%313=151%:%
%:%314=152%:%
%:%315=152%:%
%:%316=153%:%
%:%317=153%:%
%:%318=154%:%
%:%319=154%:%
%:%320=155%:%
%:%321=155%:%
%:%322=156%:%
%:%323=156%:%
%:%324=157%:%
%:%325=158%:%
%:%326=158%:%
%:%327=158%:%
%:%328=159%:%
%:%329=160%:%
%:%330=160%:%
%:%331=161%:%
%:%332=161%:%
%:%333=162%:%
%:%334=162%:%
%:%335=163%:%
%:%336=163%:%
%:%337=164%:%
%:%338=164%:%
%:%339=165%:%
%:%340=166%:%
%:%341=166%:%
%:%342=167%:%
%:%343=167%:%
%:%344=168%:%
%:%345=168%:%
%:%346=169%:%
%:%347=169%:%
%:%348=170%:%
%:%349=170%:%
%:%350=170%:%
%:%351=170%:%
%:%352=171%:%
%:%353=171%:%
%:%354=171%:%
%:%355=172%:%
%:%356=172%:%
%:%357=173%:%
%:%358=173%:%
%:%359=173%:%
%:%360=173%:%
%:%361=174%:%
%:%362=175%:%
%:%363=175%:%
%:%364=176%:%
%:%365=176%:%
%:%366=177%:%
%:%367=177%:%
%:%368=178%:%
%:%369=178%:%
%:%370=178%:%
%:%371=179%:%
%:%372=179%:%
%:%373=180%:%
%:%374=180%:%
%:%375=181%:%
%:%376=181%:%
%:%377=182%:%
%:%378=182%:%
%:%379=183%:%
%:%380=183%:%
%:%381=184%:%
%:%382=184%:%
%:%383=185%:%
%:%384=185%:%
%:%385=186%:%
%:%386=186%:%
%:%387=187%:%
%:%388=187%:%
%:%389=187%:%
%:%390=188%:%
%:%391=188%:%
%:%392=189%:%
%:%393=189%:%
%:%394=190%:%
%:%395=190%:%
%:%396=191%:%
%:%397=191%:%
%:%398=191%:%
%:%399=192%:%
%:%400=192%:%
%:%401=193%:%
%:%402=193%:%
%:%403=193%:%
%:%404=193%:%
%:%405=194%:%
%:%406=194%:%
%:%407=195%:%
%:%408=196%:%
%:%409=196%:%
%:%410=197%:%
%:%411=197%:%
%:%412=198%:%
%:%413=198%:%
%:%414=199%:%
%:%415=199%:%
%:%416=200%:%
%:%417=200%:%
%:%418=200%:%
%:%419=201%:%
%:%420=201%:%
%:%421=201%:%
%:%422=202%:%
%:%423=202%:%
%:%424=203%:%
%:%425=203%:%
%:%426=204%:%
%:%427=204%:%
%:%428=204%:%
%:%429=205%:%
%:%430=205%:%
%:%431=206%:%
%:%432=206%:%
%:%433=206%:%
%:%434=207%:%
%:%435=207%:%
%:%436=207%:%
%:%437=208%:%
%:%438=208%:%
%:%439=209%:%
%:%440=209%:%
%:%441=210%:%
%:%442=210%:%
%:%443=211%:%
%:%444=211%:%
%:%445=212%:%
%:%446=213%:%
%:%447=213%:%
%:%448=213%:%
%:%449=213%:%
%:%450=214%:%
%:%451=214%:%
%:%452=215%:%
%:%453=216%:%
%:%454=216%:%
%:%455=217%:%
%:%456=217%:%
%:%457=218%:%
%:%458=219%:%
%:%459=219%:%
%:%460=220%:%
%:%461=220%:%
%:%462=221%:%
%:%463=221%:%
%:%464=221%:%
%:%465=222%:%
%:%466=222%:%
%:%467=223%:%
%:%468=223%:%
%:%469=224%:%
%:%470=224%:%
%:%471=225%:%
%:%472=225%:%
%:%473=226%:%
%:%474=226%:%
%:%475=226%:%
%:%476=227%:%
%:%477=228%:%
%:%478=228%:%
%:%479=229%:%
%:%480=229%:%
%:%481=230%:%
%:%482=230%:%
%:%483=231%:%
%:%484=231%:%
%:%485=231%:%
%:%486=232%:%
%:%487=232%:%
%:%488=233%:%
%:%489=233%:%
%:%490=234%:%
%:%491=234%:%
%:%492=234%:%
%:%493=235%:%
%:%494=235%:%
%:%495=236%:%
%:%496=236%:%
%:%497=237%:%
%:%498=237%:%
%:%499=237%:%
%:%500=237%:%
%:%501=238%:%
%:%502=239%:%
%:%503=239%:%
%:%504=240%:%
%:%505=241%:%
%:%506=241%:%
%:%507=242%:%
%:%508=242%:%
%:%509=243%:%
%:%510=243%:%
%:%511=243%:%
%:%512=244%:%
%:%513=245%:%
%:%514=245%:%
%:%515=246%:%
%:%516=246%:%
%:%517=247%:%
%:%518=247%:%
%:%519=248%:%
%:%520=248%:%
%:%521=249%:%
%:%522=249%:%
%:%523=250%:%
%:%524=250%:%
%:%525=251%:%
%:%526=251%:%
%:%527=251%:%
%:%529=253%:%
%:%530=254%:%
%:%531=254%:%
%:%532=255%:%
%:%533=255%:%
%:%534=256%:%
%:%535=256%:%
%:%536=257%:%
%:%537=257%:%
%:%538=257%:%
%:%539=258%:%
%:%540=259%:%
%:%541=259%:%
%:%542=260%:%
%:%543=260%:%
%:%544=261%:%
%:%545=261%:%
%:%546=262%:%
%:%547=262%:%
%:%548=262%:%
%:%549=263%:%
%:%550=263%:%
%:%551=264%:%
%:%552=264%:%
%:%553=265%:%
%:%554=265%:%
%:%555=266%:%
%:%556=266%:%
%:%557=267%:%
%:%558=267%:%
%:%559=268%:%
%:%560=268%:%
%:%561=268%:%
%:%562=269%:%
%:%563=269%:%
%:%564=270%:%
%:%565=270%:%
%:%566=271%:%
%:%567=271%:%
%:%568=272%:%
%:%569=272%:%
%:%570=272%:%
%:%571=273%:%
%:%572=273%:%
%:%573=273%:%
%:%574=274%:%
%:%575=274%:%
%:%576=275%:%
%:%577=276%:%
%:%578=276%:%
%:%579=276%:%
%:%580=277%:%
%:%581=277%:%
%:%582=278%:%
%:%583=279%:%
%:%584=279%:%
%:%585=280%:%
%:%586=280%:%
%:%587=281%:%
%:%588=281%:%
%:%589=282%:%
%:%590=282%:%
%:%591=282%:%
%:%592=283%:%
%:%593=284%:%
%:%594=284%:%
%:%595=284%:%
%:%596=285%:%
%:%602=285%:%
%:%605=286%:%
%:%606=287%:%
%:%607=287%:%
%:%608=288%:%
%:%609=289%:%
%:%610=290%:%
%:%611=291%:%
%:%612=292%:%
%:%613=293%:%
%:%614=294%:%
%:%615=295%:%
%:%616=296%:%
%:%617=297%:%
%:%618=298%:%
%:%625=299%:%
%:%626=299%:%
%:%627=300%:%
%:%628=300%:%
%:%629=301%:%
%:%630=301%:%
%:%631=302%:%
%:%632=302%:%
%:%633=303%:%
%:%634=303%:%
%:%635=303%:%
%:%636=304%:%
%:%637=305%:%
%:%638=305%:%
%:%639=306%:%
%:%640=306%:%
%:%641=307%:%
%:%642=307%:%
%:%643=307%:%
%:%644=308%:%
%:%645=308%:%
%:%646=309%:%
%:%647=309%:%
%:%648=310%:%
%:%649=310%:%
%:%650=311%:%
%:%651=311%:%
%:%652=312%:%
%:%653=312%:%
%:%654=313%:%
%:%655=313%:%
%:%656=314%:%
%:%657=314%:%
%:%658=314%:%
%:%659=315%:%
%:%660=315%:%
%:%661=316%:%
%:%662=316%:%
%:%663=317%:%
%:%664=317%:%
%:%665=318%:%
%:%666=318%:%
%:%667=319%:%
%:%668=319%:%
%:%669=320%:%
%:%670=320%:%
%:%671=320%:%
%:%672=321%:%
%:%673=322%:%
%:%674=322%:%
%:%675=323%:%
%:%676=323%:%
%:%677=323%:%
%:%678=323%:%
%:%679=324%:%
%:%685=324%:%
%:%688=325%:%
%:%689=326%:%
%:%690=326%:%
%:%691=327%:%
%:%692=328%:%
%:%693=329%:%
%:%694=330%:%
%:%695=331%:%
%:%702=332%:%
%:%703=332%:%
%:%704=333%:%
%:%705=333%:%
%:%706=334%:%
%:%707=334%:%
%:%708=335%:%
%:%709=335%:%
%:%710=336%:%
%:%711=336%:%
%:%712=337%:%
%:%713=338%:%
%:%714=339%:%
%:%715=339%:%
%:%716=340%:%
%:%717=340%:%
%:%718=341%:%
%:%719=341%:%
%:%720=342%:%
%:%721=342%:%
%:%722=343%:%
%:%723=343%:%
%:%724=344%:%
%:%725=345%:%
%:%726=345%:%
%:%727=346%:%
%:%728=346%:%
%:%729=347%:%
%:%730=347%:%
%:%731=347%:%
%:%732=348%:%
%:%733=349%:%
%:%734=349%:%
%:%735=350%:%
%:%736=350%:%
%:%737=351%:%
%:%738=351%:%
%:%739=352%:%
%:%740=353%:%
%:%741=353%:%
%:%742=353%:%
%:%743=354%:%
%:%744=355%:%
%:%745=355%:%
%:%746=356%:%
%:%747=356%:%
%:%748=357%:%
%:%749=358%:%
%:%750=358%:%
%:%751=358%:%
%:%752=358%:%
%:%753=359%:%
%:%754=360%:%
%:%755=360%:%
%:%756=361%:%
%:%757=361%:%
%:%758=362%:%
%:%759=363%:%
%:%760=363%:%
%:%761=364%:%
%:%762=364%:%
%:%763=365%:%
%:%764=365%:%
%:%765=366%:%
%:%766=366%:%
%:%767=367%:%
%:%768=368%:%
%:%769=368%:%
%:%770=369%:%
%:%771=369%:%
%:%772=370%:%
%:%773=370%:%
%:%774=370%:%
%:%775=371%:%
%:%776=371%:%
%:%777=372%:%
%:%778=372%:%
%:%779=373%:%
%:%780=374%:%
%:%781=374%:%
%:%782=375%:%
%:%783=375%:%
%:%784=376%:%
%:%785=376%:%
%:%786=376%:%
%:%787=377%:%
%:%788=378%:%
%:%789=378%:%
%:%790=379%:%
%:%791=379%:%
%:%792=379%:%
%:%793=380%:%
%:%794=381%:%
%:%795=381%:%
%:%796=382%:%
%:%797=382%:%
%:%798=382%:%
%:%799=383%:%
%:%800=384%:%
%:%801=384%:%
%:%802=385%:%
%:%803=385%:%
%:%804=386%:%
%:%805=387%:%
%:%806=387%:%
%:%807=388%:%
%:%808=388%:%
%:%809=389%:%
%:%810=390%:%
%:%811=390%:%
%:%814=393%:%
%:%815=394%:%
%:%816=395%:%
%:%817=395%:%
%:%818=396%:%
%:%819=397%:%
%:%820=398%:%
%:%821=398%:%
%:%822=399%:%
%:%823=400%:%
%:%824=400%:%
%:%825=401%:%
%:%826=401%:%
%:%827=402%:%
%:%828=402%:%
%:%829=403%:%
%:%830=403%:%
%:%831=404%:%
%:%832=404%:%
%:%833=405%:%
%:%834=405%:%
%:%835=406%:%
%:%836=406%:%
%:%837=406%:%
%:%838=407%:%
%:%839=408%:%
%:%840=408%:%
%:%841=409%:%
%:%842=409%:%
%:%843=410%:%
%:%844=410%:%
%:%845=411%:%
%:%846=411%:%
%:%847=412%:%
%:%848=412%:%
%:%849=413%:%
%:%850=413%:%
%:%851=414%:%
%:%852=414%:%
%:%853=415%:%
%:%854=415%:%
%:%855=416%:%
%:%856=416%:%
%:%857=417%:%
%:%858=417%:%
%:%859=418%:%
%:%860=418%:%
%:%861=418%:%
%:%862=419%:%
%:%863=419%:%
%:%864=420%:%
%:%865=420%:%
%:%866=421%:%
%:%867=421%:%
%:%868=422%:%
%:%869=422%:%
%:%870=423%:%
%:%871=423%:%
%:%872=424%:%
%:%873=424%:%
%:%874=425%:%
%:%875=425%:%
%:%876=426%:%
%:%877=426%:%
%:%878=426%:%
%:%879=427%:%
%:%880=427%:%
%:%881=428%:%
%:%882=428%:%
%:%883=429%:%
%:%884=429%:%
%:%885=430%:%
%:%886=430%:%
%:%887=430%:%
%:%888=431%:%
%:%889=431%:%
%:%890=432%:%
%:%891=432%:%
%:%892=433%:%
%:%893=433%:%
%:%894=434%:%
%:%895=434%:%
%:%896=435%:%
%:%897=435%:%
%:%898=436%:%
%:%899=436%:%
%:%900=436%:%
%:%901=437%:%
%:%902=437%:%
%:%903=437%:%
%:%904=438%:%
%:%905=438%:%
%:%906=438%:%
%:%907=439%:%
%:%908=439%:%
%:%909=440%:%
%:%910=440%:%
%:%911=440%:%
%:%912=441%:%
%:%913=441%:%
%:%914=442%:%
%:%915=442%:%
%:%916=443%:%
%:%917=444%:%
%:%918=444%:%
%:%919=445%:%
%:%920=445%:%
%:%921=446%:%
%:%922=446%:%
%:%923=447%:%
%:%924=447%:%
%:%925=448%:%
%:%926=448%:%
%:%927=449%:%
%:%928=449%:%
%:%929=450%:%
%:%930=450%:%
%:%931=451%:%
%:%932=451%:%
%:%933=452%:%
%:%934=452%:%
%:%935=453%:%
%:%936=453%:%
%:%937=453%:%
%:%938=454%:%
%:%939=454%:%
%:%940=455%:%
%:%941=455%:%
%:%942=456%:%
%:%943=456%:%
%:%944=457%:%
%:%945=457%:%
%:%946=458%:%
%:%947=458%:%
%:%948=459%:%
%:%949=459%:%
%:%950=460%:%
%:%951=460%:%
%:%952=461%:%
%:%953=461%:%
%:%954=461%:%
%:%955=462%:%
%:%956=462%:%
%:%957=463%:%
%:%958=463%:%
%:%959=463%:%
%:%960=464%:%
%:%961=464%:%
%:%962=465%:%
%:%963=465%:%
%:%964=466%:%
%:%965=467%:%
%:%966=467%:%
%:%967=468%:%
%:%968=468%:%
%:%969=469%:%
%:%970=469%:%
%:%971=469%:%
%:%972=470%:%
%:%973=470%:%
%:%974=471%:%
%:%975=472%:%
%:%976=472%:%
%:%977=473%:%
%:%978=473%:%
%:%979=474%:%
%:%980=474%:%
%:%981=475%:%
%:%982=475%:%
%:%983=476%:%
%:%984=476%:%
%:%985=477%:%
%:%986=477%:%
%:%987=478%:%
%:%988=478%:%
%:%989=479%:%
%:%990=479%:%
%:%991=480%:%
%:%992=481%:%
%:%993=481%:%
%:%994=482%:%
%:%995=482%:%
%:%996=483%:%
%:%997=483%:%
%:%998=484%:%
%:%999=484%:%
%:%1000=485%:%
%:%1001=485%:%
%:%1002=486%:%
%:%1003=486%:%
%:%1004=487%:%
%:%1005=487%:%
%:%1006=488%:%
%:%1007=489%:%
%:%1008=489%:%
%:%1009=490%:%
%:%1010=490%:%
%:%1011=491%:%
%:%1012=491%:%
%:%1013=492%:%
%:%1014=492%:%
%:%1015=493%:%
%:%1016=493%:%
%:%1017=494%:%
%:%1018=494%:%
%:%1019=495%:%
%:%1020=495%:%
%:%1021=496%:%
%:%1022=496%:%
%:%1023=497%:%
%:%1024=497%:%
%:%1025=498%:%
%:%1026=499%:%
%:%1027=499%:%
%:%1028=500%:%
%:%1029=500%:%
%:%1030=501%:%
%:%1031=501%:%
%:%1032=501%:%
%:%1033=502%:%
%:%1034=503%:%
%:%1035=503%:%
%:%1036=504%:%
%:%1037=505%:%
%:%1038=505%:%
%:%1039=506%:%
%:%1040=506%:%
%:%1041=507%:%
%:%1042=507%:%
%:%1043=508%:%
%:%1044=508%:%
%:%1045=509%:%
%:%1046=509%:%
%:%1047=510%:%
%:%1048=510%:%
%:%1049=511%:%
%:%1050=511%:%
%:%1051=511%:%
%:%1052=511%:%
%:%1053=511%:%
%:%1054=512%:%
%:%1055=512%:%
%:%1056=513%:%
%:%1057=513%:%
%:%1058=514%:%
%:%1059=514%:%
%:%1060=514%:%
%:%1061=514%:%
%:%1062=515%:%
%:%1063=516%:%
%:%1064=516%:%
%:%1065=517%:%
%:%1066=517%:%
%:%1067=518%:%
%:%1068=518%:%
%:%1069=518%:%
%:%1070=519%:%
%:%1071=519%:%
%:%1072=520%:%
%:%1073=520%:%
%:%1074=520%:%
%:%1075=521%:%
%:%1076=521%:%
%:%1077=522%:%
%:%1078=522%:%
%:%1079=523%:%
%:%1080=523%:%
%:%1081=524%:%
%:%1082=524%:%
%:%1083=525%:%
%:%1084=525%:%
%:%1085=526%:%
%:%1086=527%:%
%:%1087=527%:%
%:%1088=528%:%
%:%1089=528%:%
%:%1090=529%:%
%:%1091=529%:%
%:%1092=530%:%
%:%1093=530%:%
%:%1094=530%:%
%:%1095=531%:%
%:%1096=531%:%
%:%1097=532%:%
%:%1098=533%:%
%:%1099=533%:%
%:%1100=534%:%
%:%1101=534%:%
%:%1102=534%:%
%:%1103=535%:%
%:%1104=535%:%
%:%1105=536%:%
%:%1106=536%:%
%:%1107=536%:%
%:%1108=537%:%
%:%1109=537%:%
%:%1110=538%:%
%:%1111=538%:%
%:%1112=538%:%
%:%1113=539%:%
%:%1114=539%:%
%:%1115=539%:%
%:%1116=540%:%
%:%1117=540%:%
%:%1118=541%:%
%:%1119=541%:%
%:%1120=542%:%
%:%1121=542%:%
%:%1122=543%:%
%:%1123=544%:%
%:%1124=544%:%
%:%1125=545%:%
%:%1126=545%:%
%:%1127=546%:%
%:%1128=546%:%
%:%1129=547%:%
%:%1130=547%:%
%:%1131=548%:%
%:%1132=548%:%
%:%1133=548%:%
%:%1134=549%:%
%:%1135=549%:%
%:%1136=550%:%
%:%1137=550%:%
%:%1138=551%:%
%:%1139=551%:%
%:%1140=551%:%
%:%1141=552%:%
%:%1147=552%:%
%:%1150=553%:%
%:%1151=554%:%
%:%1152=554%:%
%:%1153=555%:%
%:%1160=562%:%
%:%1161=563%:%
%:%1162=564%:%
%:%1163=564%:%
%:%1164=565%:%
%:%1169=570%:%
%:%1170=571%:%
%:%1171=572%:%
%:%1172=572%:%
%:%1175=573%:%
%:%1179=573%:%
%:%1180=573%:%
%:%1181=574%:%
%:%1182=574%:%
%:%1183=575%:%
%:%1184=575%:%
%:%1185=576%:%
%:%1186=576%:%
%:%1187=577%:%
%:%1188=577%:%
%:%1189=578%:%
%:%1190=578%:%
%:%1191=579%:%
%:%1192=579%:%
%:%1197=579%:%
%:%1200=580%:%
%:%1201=581%:%
%:%1202=581%:%
%:%1203=582%:%
%:%1204=583%:%
%:%1205=584%:%
%:%1206=585%:%
%:%1207=586%:%
%:%1214=587%:%
%:%1215=587%:%
%:%1216=588%:%
%:%1217=588%:%
%:%1218=589%:%
%:%1219=589%:%
%:%1220=590%:%
%:%1221=590%:%
%:%1222=591%:%
%:%1223=592%:%
%:%1224=592%:%
%:%1225=593%:%
%:%1226=593%:%
%:%1227=594%:%
%:%1228=595%:%
%:%1229=595%:%
%:%1230=596%:%
%:%1231=596%:%
%:%1232=597%:%
%:%1233=597%:%
%:%1234=598%:%
%:%1235=598%:%
%:%1236=599%:%
%:%1237=599%:%
%:%1238=600%:%
%:%1239=600%:%
%:%1240=601%:%
%:%1241=601%:%
%:%1242=602%:%
%:%1243=603%:%
%:%1244=603%:%
%:%1247=606%:%
%:%1248=607%:%
%:%1249=607%:%
%:%1250=608%:%
%:%1251=608%:%
%:%1252=609%:%
%:%1253=609%:%
%:%1254=610%:%
%:%1255=611%:%
%:%1256=611%:%
%:%1257=611%:%
%:%1258=611%:%
%:%1259=612%:%
%:%1260=613%:%
%:%1261=613%:%
%:%1262=614%:%
%:%1263=615%:%
%:%1264=615%:%
%:%1265=616%:%
%:%1266=616%:%
%:%1267=617%:%
%:%1268=617%:%
%:%1269=618%:%
%:%1270=618%:%
%:%1271=619%:%
%:%1272=619%:%
%:%1273=620%:%
%:%1274=620%:%
%:%1275=620%:%
%:%1276=621%:%
%:%1277=621%:%
%:%1278=621%:%
%:%1279=622%:%
%:%1280=622%:%
%:%1281=623%:%
%:%1282=623%:%
%:%1283=624%:%
%:%1284=624%:%
%:%1285=624%:%
%:%1286=625%:%
%:%1287=625%:%
%:%1288=625%:%
%:%1289=626%:%
%:%1290=626%:%
%:%1291=627%:%
%:%1292=627%:%
%:%1293=627%:%
%:%1294=628%:%
%:%1295=628%:%
%:%1296=629%:%
%:%1297=629%:%
%:%1298=630%:%
%:%1299=631%:%
%:%1300=631%:%
%:%1302=633%:%
%:%1303=634%:%
%:%1304=634%:%
%:%1305=635%:%
%:%1306=635%:%
%:%1307=636%:%
%:%1308=636%:%
%:%1309=637%:%
%:%1310=637%:%
%:%1311=637%:%
%:%1312=638%:%
%:%1313=638%:%
%:%1314=639%:%
%:%1315=639%:%
%:%1316=640%:%
%:%1317=640%:%
%:%1318=641%:%
%:%1319=641%:%
%:%1320=641%:%
%:%1321=642%:%
%:%1322=642%:%
%:%1323=643%:%
%:%1324=643%:%
%:%1325=644%:%
%:%1326=644%:%
%:%1327=644%:%
%:%1328=645%:%
%:%1329=645%:%
%:%1330=645%:%
%:%1331=646%:%
%:%1332=646%:%
%:%1333=647%:%
%:%1334=647%:%
%:%1335=647%:%
%:%1336=648%:%
%:%1337=648%:%
%:%1338=649%:%
%:%1339=649%:%
%:%1340=649%:%
%:%1341=650%:%
%:%1342=650%:%
%:%1343=651%:%
%:%1344=651%:%
%:%1345=651%:%
%:%1346=652%:%
%:%1347=652%:%
%:%1348=653%:%
%:%1349=653%:%
%:%1350=654%:%
%:%1351=655%:%
%:%1352=655%:%
%:%1358=661%:%
%:%1359=662%:%
%:%1360=662%:%
%:%1361=663%:%
%:%1362=663%:%
%:%1363=664%:%
%:%1364=665%:%
%:%1365=666%:%
%:%1366=666%:%
%:%1367=667%:%
%:%1368=667%:%
%:%1369=668%:%
%:%1370=668%:%
%:%1371=669%:%
%:%1372=669%:%
%:%1373=670%:%
%:%1374=670%:%
%:%1375=671%:%
%:%1376=671%:%
%:%1377=672%:%
%:%1378=672%:%
%:%1379=673%:%
%:%1380=673%:%
%:%1381=674%:%
%:%1382=674%:%
%:%1383=675%:%
%:%1384=675%:%
%:%1385=675%:%
%:%1386=676%:%
%:%1387=676%:%
%:%1388=677%:%
%:%1389=677%:%
%:%1390=677%:%
%:%1392=679%:%
%:%1393=679%:%
%:%1394=680%:%
%:%1395=680%:%
%:%1396=681%:%
%:%1397=682%:%
%:%1398=682%:%
%:%1399=683%:%
%:%1400=683%:%
%:%1401=684%:%
%:%1402=684%:%
%:%1403=685%:%
%:%1404=685%:%
%:%1405=686%:%
%:%1406=686%:%
%:%1407=687%:%
%:%1408=687%:%
%:%1409=688%:%
%:%1410=688%:%
%:%1411=689%:%
%:%1412=689%:%
%:%1413=690%:%
%:%1414=690%:%
%:%1415=691%:%
%:%1421=691%:%
%:%1424=692%:%
%:%1425=693%:%
%:%1426=693%:%
%:%1427=694%:%
%:%1428=695%:%
%:%1429=696%:%
%:%1436=697%:%
%:%1437=697%:%
%:%1438=698%:%
%:%1439=698%:%
%:%1440=699%:%
%:%1441=699%:%
%:%1442=700%:%
%:%1443=700%:%
%:%1444=701%:%
%:%1445=701%:%
%:%1446=702%:%
%:%1447=703%:%
%:%1448=703%:%
%:%1449=704%:%
%:%1450=705%:%
%:%1451=705%:%
%:%1452=706%:%
%:%1453=706%:%
%:%1454=707%:%
%:%1455=707%:%
%:%1456=708%:%
%:%1457=708%:%
%:%1458=709%:%
%:%1459=710%:%
%:%1460=710%:%
%:%1461=711%:%
%:%1462=711%:%
%:%1463=712%:%
%:%1464=712%:%
%:%1465=713%:%
%:%1466=713%:%
%:%1467=714%:%
%:%1468=714%:%
%:%1469=715%:%
%:%1470=716%:%
%:%1471=716%:%
%:%1472=717%:%
%:%1473=717%:%
%:%1474=718%:%
%:%1475=718%:%
%:%1476=719%:%
%:%1477=719%:%
%:%1478=720%:%
%:%1479=720%:%
%:%1480=721%:%
%:%1481=721%:%
%:%1482=722%:%
%:%1483=723%:%
%:%1484=723%:%
%:%1485=724%:%
%:%1486=724%:%
%:%1487=725%:%
%:%1488=725%:%
%:%1489=726%:%
%:%1490=726%:%
%:%1491=727%:%
%:%1492=727%:%
%:%1493=728%:%
%:%1494=728%:%
%:%1495=729%:%
%:%1496=730%:%
%:%1497=730%:%
%:%1498=731%:%
%:%1499=731%:%
%:%1500=732%:%
%:%1501=732%:%
%:%1502=733%:%
%:%1503=733%:%
%:%1504=734%:%
%:%1505=734%:%
%:%1506=735%:%
%:%1507=735%:%
%:%1508=736%:%
%:%1509=737%:%
%:%1510=737%:%
%:%1511=738%:%
%:%1512=738%:%
%:%1513=739%:%
%:%1514=739%:%
%:%1515=740%:%
%:%1516=740%:%
%:%1517=741%:%
%:%1518=741%:%
%:%1519=742%:%
%:%1520=742%:%
%:%1521=743%:%
%:%1522=744%:%
%:%1523=744%:%
%:%1524=745%:%
%:%1525=745%:%
%:%1526=746%:%
%:%1527=746%:%
%:%1528=747%:%
%:%1529=747%:%
%:%1530=748%:%
%:%1531=749%:%
%:%1532=749%:%
%:%1533=750%:%
%:%1534=750%:%
%:%1535=751%:%
%:%1536=751%:%
%:%1537=752%:%
%:%1538=752%:%
%:%1539=753%:%
%:%1540=754%:%
%:%1541=754%:%
%:%1542=755%:%
%:%1543=755%:%
%:%1544=756%:%
%:%1545=757%:%
%:%1546=757%:%
%:%1547=758%:%
%:%1548=758%:%
%:%1549=759%:%
%:%1550=760%:%
%:%1551=760%:%
%:%1552=761%:%
%:%1553=761%:%
%:%1554=762%:%
%:%1555=762%:%
%:%1556=763%:%
%:%1557=763%:%
%:%1558=764%:%
%:%1559=765%:%
%:%1560=765%:%
%:%1561=766%:%
%:%1562=766%:%
%:%1563=767%:%
%:%1564=767%:%
%:%1565=768%:%
%:%1566=768%:%
%:%1567=769%:%
%:%1568=769%:%
%:%1569=770%:%
%:%1570=771%:%
%:%1571=771%:%
%:%1572=772%:%
%:%1573=772%:%
%:%1574=773%:%
%:%1575=773%:%
%:%1576=774%:%
%:%1577=774%:%
%:%1578=775%:%
%:%1579=776%:%
%:%1580=776%:%
%:%1581=777%:%
%:%1582=778%:%
%:%1583=778%:%
%:%1584=779%:%
%:%1585=779%:%
%:%1586=780%:%
%:%1587=780%:%
%:%1588=781%:%
%:%1589=782%:%
%:%1590=782%:%
%:%1591=783%:%
%:%1592=783%:%
%:%1593=784%:%
%:%1594=785%:%
%:%1595=785%:%
%:%1596=786%:%
%:%1597=786%:%
%:%1598=787%:%
%:%1599=787%:%
%:%1600=788%:%
%:%1601=788%:%
%:%1602=789%:%
%:%1603=789%:%
%:%1604=790%:%
%:%1605=790%:%
%:%1606=791%:%
%:%1607=792%:%
%:%1608=792%:%
%:%1609=793%:%
%:%1610=793%:%
%:%1611=794%:%
%:%1612=794%:%
%:%1613=795%:%
%:%1614=795%:%
%:%1615=796%:%
%:%1616=796%:%
%:%1617=797%:%
%:%1618=797%:%
%:%1619=798%:%
%:%1620=798%:%
%:%1621=799%:%
%:%1622=800%:%
%:%1623=800%:%
%:%1624=801%:%
%:%1625=801%:%
%:%1626=802%:%
%:%1627=802%:%
%:%1628=803%:%
%:%1629=803%:%
%:%1630=804%:%
%:%1631=804%:%
%:%1632=805%:%
%:%1633=805%:%
%:%1634=806%:%
%:%1635=806%:%
%:%1636=807%:%
%:%1637=808%:%
%:%1638=808%:%
%:%1639=809%:%
%:%1640=809%:%
%:%1641=810%:%
%:%1642=810%:%
%:%1643=811%:%
%:%1644=811%:%
%:%1645=812%:%
%:%1646=812%:%
%:%1647=813%:%
%:%1648=813%:%
%:%1649=814%:%
%:%1650=814%:%
%:%1651=815%:%
%:%1652=815%:%
%:%1653=816%:%
%:%1654=816%:%
%:%1655=817%:%
%:%1656=817%:%
%:%1657=818%:%
%:%1658=818%:%
%:%1659=819%:%
%:%1660=819%:%
%:%1661=820%:%
%:%1662=820%:%
%:%1663=821%:%
%:%1664=821%:%
%:%1665=822%:%
%:%1666=822%:%
%:%1667=823%:%
%:%1668=824%:%
%:%1669=824%:%
%:%1670=825%:%
%:%1671=825%:%
%:%1672=826%:%
%:%1673=826%:%
%:%1674=827%:%
%:%1675=827%:%
%:%1676=828%:%
%:%1677=828%:%
%:%1678=829%:%
%:%1679=829%:%
%:%1680=830%:%
%:%1681=830%:%
%:%1682=831%:%
%:%1683=831%:%
%:%1684=832%:%
%:%1685=833%:%
%:%1686=833%:%
%:%1687=834%:%
%:%1688=835%:%
%:%1689=835%:%
%:%1690=836%:%
%:%1691=836%:%
%:%1692=837%:%
%:%1693=837%:%
%:%1694=838%:%
%:%1695=838%:%
%:%1696=839%:%
%:%1697=839%:%
%:%1698=840%:%
%:%1699=841%:%
%:%1700=841%:%
%:%1701=842%:%
%:%1702=843%:%
%:%1703=843%:%
%:%1704=844%:%
%:%1705=844%:%
%:%1706=845%:%
%:%1707=845%:%
%:%1708=846%:%
%:%1709=846%:%
%:%1710=846%:%
%:%1711=847%:%
%:%1712=848%:%
%:%1713=848%:%
%:%1714=849%:%
%:%1715=850%:%
%:%1716=850%:%
%:%1717=851%:%
%:%1718=851%:%
%:%1719=852%:%
%:%1720=852%:%
%:%1721=853%:%
%:%1722=853%:%
%:%1723=854%:%
%:%1724=854%:%
%:%1725=855%:%
%:%1726=855%:%
%:%1727=856%:%
%:%1728=856%:%
%:%1729=857%:%
%:%1730=857%:%
%:%1731=858%:%
%:%1732=858%:%
%:%1733=859%:%
%:%1734=859%:%
%:%1735=860%:%
%:%1736=860%:%
%:%1737=861%:%
%:%1738=861%:%
%:%1739=862%:%
%:%1740=862%:%
%:%1741=863%:%
%:%1742=863%:%
%:%1743=864%:%
%:%1744=865%:%
%:%1745=865%:%
%:%1746=866%:%
%:%1747=866%:%
%:%1748=867%:%
%:%1749=867%:%
%:%1750=868%:%
%:%1751=868%:%
%:%1752=868%:%
%:%1753=869%:%
%:%1754=869%:%
%:%1755=870%:%
%:%1756=870%:%
%:%1757=871%:%
%:%1758=871%:%
%:%1759=872%:%
%:%1760=872%:%
%:%1761=873%:%
%:%1762=873%:%
%:%1763=874%:%
%:%1764=874%:%
%:%1765=875%:%
%:%1766=875%:%
%:%1767=876%:%
%:%1768=876%:%
%:%1769=877%:%
%:%1770=877%:%
%:%1771=878%:%
%:%1772=878%:%
%:%1773=879%:%
%:%1774=879%:%
%:%1775=880%:%
%:%1776=880%:%
%:%1777=880%:%
%:%1778=881%:%
%:%1779=881%:%
%:%1780=882%:%
%:%1781=882%:%
%:%1782=883%:%
%:%1783=883%:%
%:%1784=884%:%
%:%1785=884%:%
%:%1786=884%:%
%:%1787=884%:%
%:%1788=885%:%
%:%1794=885%:%
%:%1799=886%:%
%:%1804=887%:%
