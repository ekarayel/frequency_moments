%
\begin{isabellebody}%
\setisabellecontext{Frequency{\isacharunderscore}{\kern0pt}Moment{\isacharunderscore}{\kern0pt}{\isadigit{2}}}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Frequency Moment $2$%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Frequency{\isacharunderscore}{\kern0pt}Moment{\isacharunderscore}{\kern0pt}{\isadigit{2}}\isanewline
\ \ \isakeyword{imports}\ Main\ Median\ Partitions\ Primes{\isacharunderscore}{\kern0pt}Ext\ Encoding\ List{\isacharunderscore}{\kern0pt}Ext\ \isanewline
\ \ \ \ Universal{\isacharunderscore}{\kern0pt}Hash{\isacharunderscore}{\kern0pt}Families{\isacharunderscore}{\kern0pt}Nat\ Frequency{\isacharunderscore}{\kern0pt}Moments\ Landau{\isacharunderscore}{\kern0pt}Ext\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
This section contains a formalization of the algorithm for the second frequency moment.
It is based on the algorithm described in \cite[\textsection 2.2]{alon1999}.
The only difference is that the algorithm is adapted to work with prime field of odd order, which
greatly reduces the implementation complexity.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ h\ k\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ even\ {\isacharparenleft}{\kern0pt}hash\ p\ k\ h{\isacharparenright}{\kern0pt}\ then\ int\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ else\ {\isacharminus}{\kern0pt}\ int\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{type{\isacharunderscore}{\kern0pt}synonym}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ int\ set\ list{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}rat\ {\isasymRightarrow}\ rat\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ pmf{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isasymdelta}\ {\isasymepsilon}\ n\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isasymdelta}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ p\ {\isacharequal}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}max\ n\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ h\ {\isasymleftarrow}\ prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ pmf{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ x\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ sketch{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ {\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}h\ i{\isacharparenright}{\kern0pt}\ x\ {\isacharplus}{\kern0pt}\ sketch\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ rat\ pmf{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ sketch{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}median\ s\isactrlsub {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i\isactrlsub {\isadigit{2}}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymSum}i\isactrlsub {\isadigit{1}}{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}sketch\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ i\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isacharunderscore}{\kern0pt}exp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}Factorial{\isacharunderscore}{\kern0pt}Ring{\isachardot}{\kern0pt}prime\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharless}{\kern0pt}\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\isanewline
\ \ \ \ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isacharparenleft}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isasymomega}\ k{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}m{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ g{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ prime{\isacharunderscore}{\kern0pt}gt{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}nat\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}odd\ p{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ prime{\isacharunderscore}{\kern0pt}odd{\isacharunderscore}{\kern0pt}nat\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ t\ \isakeyword{where}\ t{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p{\isacharequal}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}t{\isacharplus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ oddE\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymOmega}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymOmega}\ {\isacharequal}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}set{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fin{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharbrackleft}{\kern0pt}OF\ g{\isacharbrackright}{\kern0pt}\ ne{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ even\ k{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}x{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}t{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}card{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}antisym{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ subsetI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ evenE\ Suc{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ atLeastAtMost{\isacharunderscore}{\kern0pt}iff\ image{\isacharunderscore}{\kern0pt}eqI\ less{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}le\ mult{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}cancel{\isadigit{1}}\ not{\isacharunderscore}{\kern0pt}less\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}Suc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ image{\isacharunderscore}{\kern0pt}subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}t{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ card{\isacharunderscore}{\kern0pt}image{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}mult{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ t{\isacharplus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ even\ k{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isacharplus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ even\ k{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p\ {\isacharequal}{\kern0pt}\ card\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ odd\ k{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ even\ k{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}card{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}antisym{\isacharcomma}{\kern0pt}\ rule\ subsetI{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ subsetI{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ odd\ k{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ \ card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ even\ k{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ card{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}disjoint{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ odd\ k{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ t{\isacharplus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}c{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p\ {\isacharequal}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ odd\ k{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ t{\isacharplus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ odd\ k{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ d{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ {\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ measure{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}{\isachardot}{\kern0pt}\ hash\ p\ k\ {\isasymomega}\ {\isasymin}\ Collect\ even{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ subst\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ hash{\isacharunderscore}{\kern0pt}prob{\isacharunderscore}{\kern0pt}range{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ zero{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ frac{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}g{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}g{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ linarith\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ d{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ {\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ measure{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}{\isachardot}{\kern0pt}\ hash\ p\ k\ {\isasymomega}\ {\isasymin}\ Collect\ odd{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ subst\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ hash{\isacharunderscore}{\kern0pt}prob{\isacharunderscore}{\kern0pt}range{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ zero{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ frac{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}g{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}g{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ linarith\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}integral\isactrlsup L\ {\isasymOmega}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ x\ k{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ integral\isactrlsup L\ {\isasymOmega}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ indicator\ {\isacharbraceleft}{\kern0pt}{\isasymomega}{\isachardot}{\kern0pt}\ even\ {\isacharparenleft}{\kern0pt}hash\ p\ k\ {\isasymomega}{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymomega}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}m\ {\isacharplus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ indicator\ {\isacharbraceleft}{\kern0pt}{\isasymomega}{\isachardot}{\kern0pt}\ odd\ {\isacharparenleft}{\kern0pt}hash\ p\ k\ {\isasymomega}{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymomega}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ {\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ measure{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}{\isachardot}{\kern0pt}\ hash\ p\ k\ {\isasymomega}\ {\isasymin}\ Collect\ even{\isacharparenright}{\kern0pt}\ \ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ \ {\isacharplus}{\kern0pt}\ \isanewline
\ \ \ \ \ {\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ measure{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}{\isachardot}{\kern0pt}\ hash\ p\ k\ {\isasymomega}\ {\isasymin}\ Collect\ odd{\isacharparenright}{\kern0pt}\ \ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}add{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ b{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ b{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ d{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ subst\ d{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}add{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}distrib\ ac{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}integral\isactrlsup L\ {\isasymOmega}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ x\ k{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ a{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}Factorial{\isacharunderscore}{\kern0pt}Ring{\isachardot}{\kern0pt}prime\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymAnd}a{\isachardot}{\kern0pt}\ a\ {\isasymin}\ set\ as\ {\isasymLongrightarrow}\ a\ {\isacharless}{\kern0pt}\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}M\ {\isasymequiv}\ measure{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}f\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isasymomega}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ var{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ M\ f\ {\isasymle}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}A{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{and}\ exp{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ M\ f\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}B{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ h\ \isakeyword{where}\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}\ x{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isasymomega}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ c\ \isakeyword{where}\ {\isachardoublequoteopen}c\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ as\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ r\ \isakeyword{where}\ {\isachardoublequoteopen}r\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}m{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}prod\ \isakeyword{where}\ {\isachardoublequoteopen}h{\isacharunderscore}{\kern0pt}prod\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}as\ {\isasymomega}{\isachardot}{\kern0pt}\ prod{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}h\ {\isasymomega}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ list\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymProd}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ r\ {\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ as\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{interpret}\isamarkupfalse%
\ prob{\isacharunderscore}{\kern0pt}space\ M\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf\ M{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}x\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ x\ {\isacharasterisk}{\kern0pt}\ h\ {\isasymomega}\ x{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isacharunderscore}{\kern0pt}def\ c{\isacharunderscore}{\kern0pt}def\ h{\isacharunderscore}{\kern0pt}def\ sum{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}eval\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ int{\isacharunderscore}{\kern0pt}M{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}f{\isachardot}{\kern0pt}\ integrable\ M\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}f\ {\isasymomega}{\isacharparenright}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}real{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}M{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ ne{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ fin{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}one{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}r\ {\isacharparenleft}{\kern0pt}Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}r{\isacharunderscore}{\kern0pt}def\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}two{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}r\ {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}r{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ nonzero{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}four{\isacharunderscore}{\kern0pt}est{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}r\ {\isadigit{4}}\ {\isasymle}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}r{\isacharunderscore}{\kern0pt}two{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}r{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ pos{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ power{\isadigit{4}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}xxxx{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ y{\isacharequal}{\kern0pt}{\isachardoublequoteopen}real\ p\ {\isacharasterisk}{\kern0pt}\ {\isadigit{1}}{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ real\ p\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharasterisk}{\kern0pt}\ {\isadigit{1}}{\isadigit{6}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}less\ num{\isacharunderscore}{\kern0pt}double\ numeral{\isacharunderscore}{\kern0pt}mult\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}power\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}le\ prime{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}nat\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp{\isacharplus}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}sym{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymnoteq}\ y\ {\isasymand}\ y\ {\isasymnoteq}\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymnoteq}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}elim{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}as{\isachardot}{\kern0pt}\ prod{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}r\ {\isasymcirc}\ count{\isacharunderscore}{\kern0pt}list\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}remdups\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ prod{\isachardot}{\kern0pt}set{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}list{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ set\ x\ {\isasymsubseteq}\ set\ as\ {\isasymLongrightarrow}\ length\ x\ {\isasymle}\ {\isadigit{4}}\ {\isasymLongrightarrow}\ expectation\ {\isacharparenleft}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ x\ {\isasymsubseteq}\ set\ as{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}sub{\isacharunderscore}{\kern0pt}p{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set\ x\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ atLeastLessThan{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}p{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}k{\isachardot}{\kern0pt}\ k\ {\isasymin}\ set\ x\ {\isasymLongrightarrow}\ k\ {\isacharless}{\kern0pt}\ p{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ x\ {\isasymle}\ {\isadigit{4}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}x{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{4}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}length\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}trans\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}expectation\ {\isacharparenleft}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ expectation\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ {\isasymProd}\ i\ {\isasymin}\ set\ x{\isachardot}{\kern0pt}\ h\ {\isasymomega}\ i{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ x\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}expectation{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ prod{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}eval{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymProd}i\ {\isasymin}\ set\ x{\isachardot}{\kern0pt}\ expectation\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ h\ {\isasymomega}\ i{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ x\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}lebesgue{\isacharunderscore}{\kern0pt}integral{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}h{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}compose{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X{\isacharequal}{\kern0pt}{\isachardoublequoteopen}hash\ p{\isachardoublequoteclose}\ \isakeyword{and}\ M{\isacharprime}{\kern0pt}{\isacharequal}{\kern0pt}{\isachardoublequoteopen}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ hash{\isacharunderscore}{\kern0pt}k{\isacharunderscore}{\kern0pt}wise{\isacharunderscore}{\kern0pt}indep{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ n{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{4}}{\isachardoublequoteclose}\ \isakeyword{and}\ p{\isacharequal}{\kern0pt}{\isachardoublequoteopen}p{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ card{\isacharunderscore}{\kern0pt}x\ x{\isacharunderscore}{\kern0pt}sub{\isacharunderscore}{\kern0pt}p\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}k{\isacharunderscore}{\kern0pt}wise{\isacharunderscore}{\kern0pt}indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}def\ M{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ int{\isacharunderscore}{\kern0pt}M{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymProd}i\ {\isasymin}\ set\ x{\isachardot}{\kern0pt}\ r\ {\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ x\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isacharunderscore}{\kern0pt}exp{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ x{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}p\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}h{\isacharunderscore}{\kern0pt}def\ r{\isacharunderscore}{\kern0pt}def\ M{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}expectation\ {\isacharparenleft}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}cong{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ x\ y\ {\isasymLongrightarrow}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ y{\isachardoublequoteclose}\ \isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ y\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ list{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ x\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ f\ \isakeyword{where}\ b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bij{\isacharunderscore}{\kern0pt}betw\ f\ {\isacharparenleft}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ c{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymAnd}z{\isachardot}{\kern0pt}\ z\ {\isasymin}\ set\ x\ {\isasymLongrightarrow}\ count{\isacharunderscore}{\kern0pt}list\ x\ z\ {\isacharequal}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ y\ {\isacharparenleft}{\kern0pt}f\ z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ eq{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}obtain{\isacharunderscore}{\kern0pt}bij{\isacharbrackleft}{\kern0pt}OF\ a{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x\ {\isacharequal}{\kern0pt}\ prod\ {\isacharparenleft}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ r{\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\ f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ c{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymProd}i\ {\isasymin}\ f\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ r{\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isachardot}{\kern0pt}reindex{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ b\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isachardot}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ b\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ y{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}cong{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}p\ x{\isachardot}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ p\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ p\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ p\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}expectation\ f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isasymin}set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j{\isasymin}set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharasterisk}{\kern0pt}\ c\ j\ {\isacharasterisk}{\kern0pt}\ expectation\ {\isacharparenleft}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}i{\isacharcomma}{\kern0pt}j{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isacharunderscore}{\kern0pt}eq\ h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right\ Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}sum{\isacharbrackleft}{\kern0pt}OF\ int{\isacharunderscore}{\kern0pt}M{\isacharbrackright}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isasymin}set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j{\isasymin}set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharasterisk}{\kern0pt}\ c\ j\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}i{\isacharcomma}{\kern0pt}j{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ \ \isanewline
\ \ \ \ c\ i\ {\isacharasterisk}{\kern0pt}\ c\ j\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}p{\isachardot}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ p\ {\isacharbrackleft}{\kern0pt}i{\isacharcomma}{\kern0pt}j{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}enum{\isacharunderscore}{\kern0pt}partitions\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isacharunderscore}{\kern0pt}partitions{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isasymin}set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharasterisk}{\kern0pt}\ c\ i\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Suc\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}elim\ r{\isacharunderscore}{\kern0pt}one{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation{\isacharunderscore}{\kern0pt}elim\ distrib{\isacharunderscore}{\kern0pt}left\ sum{\isachardot}{\kern0pt}distrib\ sum{\isacharunderscore}{\kern0pt}collapse\ fold{\isacharunderscore}{\kern0pt}sym{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}c{\isacharunderscore}{\kern0pt}def\ F{\isacharunderscore}{\kern0pt}def\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult\ r{\isacharunderscore}{\kern0pt}two{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}{\isacharquery}{\kern0pt}B\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}expectation\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{1}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{2}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{3}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{4}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\isanewline
\ \ \ \ c\ i{\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ expectation\ {\isacharparenleft}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}i{\isadigit{1}}{\isacharcomma}{\kern0pt}\ i{\isadigit{2}}{\isacharcomma}{\kern0pt}\ i{\isadigit{3}}{\isacharcomma}{\kern0pt}\ i{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isacharunderscore}{\kern0pt}eq\ h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ power{\isadigit{4}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}xxxx\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right\ Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}sum{\isacharbrackleft}{\kern0pt}OF\ int{\isacharunderscore}{\kern0pt}M{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{1}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{2}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{3}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{4}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ c\ i{\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}i{\isadigit{1}}{\isacharcomma}{\kern0pt}i{\isadigit{2}}{\isacharcomma}{\kern0pt}i{\isadigit{3}}{\isacharcomma}{\kern0pt}i{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{1}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{2}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{3}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{4}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ c\ i{\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}p{\isachardot}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ p\ {\isacharbrackleft}{\kern0pt}i{\isadigit{1}}{\isacharcomma}{\kern0pt}i{\isadigit{2}}{\isacharcomma}{\kern0pt}i{\isadigit{3}}{\isacharcomma}{\kern0pt}i{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}enum{\isacharunderscore}{\kern0pt}partitions\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isacharunderscore}{\kern0pt}partitions{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ c\ j{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymSum}\ i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i{\isacharcircum}{\kern0pt}{\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{4}}{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}{\isasymSum}\ i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharcircum}{\kern0pt}\ {\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Suc\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}elim\ r{\isacharunderscore}{\kern0pt}one{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation{\isacharunderscore}{\kern0pt}elim\ distrib{\isacharunderscore}{\kern0pt}left\ sum{\isachardot}{\kern0pt}distrib\ sum{\isacharunderscore}{\kern0pt}collapse\ fold{\isacharunderscore}{\kern0pt}sym{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps\ sum{\isacharunderscore}{\kern0pt}subtractf\ sum{\isacharunderscore}{\kern0pt}collapse{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}\ i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharcircum}{\kern0pt}\ {\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}r\ {\isadigit{4}}\ {\isacharminus}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left\ sum{\isacharunderscore}{\kern0pt}subtractf{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharcircum}{\kern0pt}\ {\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}power{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}distrib\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}four{\isacharunderscore}{\kern0pt}est\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharplus}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}c{\isacharunderscore}{\kern0pt}def\ r{\isacharunderscore}{\kern0pt}two\ F{\isacharunderscore}{\kern0pt}def\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ v{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}expectation\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}variance\ f\ {\isasymle}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ variance{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}OF\ int{\isacharunderscore}{\kern0pt}M\ int{\isacharunderscore}{\kern0pt}M{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ subst\ b{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}power{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}distrib{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ v{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}A\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}sketch{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ n\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\ \ \isakeyword{fixes}\ as\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ list{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}{\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymdelta}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isasymequiv}\ nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isasymdelta}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isasymequiv}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}{\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}p\ {\isasymequiv}\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}max\ n\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}sketch\ {\isasymequiv}\ fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ a{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}{\isasymOmega}\ {\isasymequiv}\ prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sketch\ {\isacharequal}{\kern0pt}\ {\isasymOmega}\ {\isasymbind}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}h{\isachardot}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}h\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ ys\ \isakeyword{where}\ {\isachardoublequoteopen}ys\ {\isacharequal}{\kern0pt}\ rev\ as{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}sketch\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ x{\isacharparenright}{\kern0pt}\ ys\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ foldr{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}fold\ ys{\isacharunderscore}{\kern0pt}def\ sketch{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymOmega}\ {\isasymbind}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}h{\isachardot}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}h\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ys{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ ys{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def\ restrict{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ a\ as{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ a\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ a\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharcomma}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ snd\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isachardot}{\kern0pt}simps\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ a{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}assoc{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}return{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}def\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isachardot}{\kern0pt}simps\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init{\isachardot}{\kern0pt}simps\ cong{\isacharcolon}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymOmega}\ {\isasymbind}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}h{\isachardot}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}h\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ ys{\isacharunderscore}{\kern0pt}def\ rev{\isacharunderscore}{\kern0pt}map{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}correct{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}{\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymdelta}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ as\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}M\ {\isasymequiv}\ fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ a{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}\ {\isasymbind}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ measure{\isacharunderscore}{\kern0pt}pmf\ M{\isachardot}{\kern0pt}\ {\isasymbar}{\isasymomega}\ {\isacharminus}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isasymbar}\ {\isasymle}\ {\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isadigit{1}}{\isacharminus}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{1}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isasymdelta}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{2}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}{\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ p\ \isakeyword{where}\ {\isachardoublequoteopen}p\ {\isacharequal}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}max\ n\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from\ {\isacharequal}{\kern0pt}\ fst{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from\ {\isacharequal}{\kern0pt}\ fst\ {\isasymcirc}\ snd{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}from\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}p{\isacharunderscore}{\kern0pt}from\ {\isacharequal}{\kern0pt}\ fst\ {\isasymcirc}\ snd\ {\isasymcirc}\ snd{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}from\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ int\ set\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}h{\isacharunderscore}{\kern0pt}from\ {\isacharequal}{\kern0pt}\ fst\ {\isasymcirc}\ snd\ {\isasymcirc}\ snd\ {\isasymcirc}\ snd{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ sketch{\isacharunderscore}{\kern0pt}from\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}sketch{\isacharunderscore}{\kern0pt}from\ {\isacharequal}{\kern0pt}\ snd\ {\isasymcirc}\ snd\ {\isasymcirc}\ snd\ {\isasymcirc}\ snd{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}prime{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Factorial{\isacharunderscore}{\kern0pt}Ring{\isachardot}{\kern0pt}prime\ p{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}p{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}prime\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isasymge}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}p{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}lower{\isacharunderscore}{\kern0pt}bound\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}trans\ max{\isachardot}{\kern0pt}cobounded{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}sq{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isasymnoteq}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Num{\isachardot}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ nat{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ nat{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}as{\isacharunderscore}{\kern0pt}int\ nat{\isacharunderscore}{\kern0pt}power{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff\ not{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}one\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}power\ zero{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}numeral{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}set{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fin{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharbrackleft}{\kern0pt}OF\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}\ ne{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}set{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def\ set{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ finite{\isacharunderscore}{\kern0pt}PiE{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ as{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}p{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ set\ as\ {\isasymLongrightarrow}\ x\ {\isacharless}{\kern0pt}\ p{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ y{\isacharequal}{\kern0pt}{\isachardoublequoteopen}n{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ atLeastLessThan{\isacharunderscore}{\kern0pt}iff\ \isacommand{apply}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}p{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}lower{\isacharunderscore}{\kern0pt}bound\ max{\isachardot}{\kern0pt}boundedE{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fin{\isacharunderscore}{\kern0pt}poly{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ fin{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ s{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ h{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ sketch{\isacharunderscore}{\kern0pt}from\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ p{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ h{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ sketch{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}conv{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ h{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ sketch{\isacharunderscore}{\kern0pt}from\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}split{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f\ \isakeyword{where}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ median\ s\isactrlsub {\isadigit{2}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymSum}i\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}x\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f{\isadigit{3}}\ \isakeyword{where}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}f{\isadigit{3}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{2}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}x\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ i\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f{\isadigit{2}}\ \isakeyword{where}\ {\isachardoublequoteopen}f{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isasymlambda}i{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ f{\isadigit{3}}\ x\ i\isactrlsub {\isadigit{1}}\ i{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}var{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isasymLongrightarrow}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharslash}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}indep{\isacharunderscore}{\kern0pt}vars\ {\isacharparenleft}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ borel{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i\isactrlsub {\isadigit{1}}\ x{\isachardot}{\kern0pt}\ f{\isadigit{3}}\ x\ i\isactrlsub {\isadigit{1}}\ i{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ rule\ indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}intro\ {\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}j{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}j{\isacharcomma}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a\ f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def\ disjoint{\isacharunderscore}{\kern0pt}family{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def\ s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero\ s{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{3}}\ {\isasymomega}\ j\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ a\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ del{\isacharcolon}{\kern0pt}Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}zero{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance{\isacharunderscore}{\kern0pt}divide{\isacharbrackleft}{\kern0pt}OF\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}var{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}indep{\isacharbrackleft}{\kern0pt}OF\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ b{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ divide{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ variance{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}slice{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}a{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ var{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharbrackleft}{\kern0pt}OF\ p{\isacharunderscore}{\kern0pt}prime\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ as{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}p{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ frac{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero{\isacharcomma}{\kern0pt}\ metis\ p{\isacharunderscore}{\kern0pt}sq{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ divide{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ opaque{\isacharunderscore}{\kern0pt}lifting{\isacharparenright}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}ceiling\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}divide\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}eq\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power\ real{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}ceiling{\isacharunderscore}{\kern0pt}ge{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}pos{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharslash}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharslash}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}exp{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isasymLongrightarrow}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{3}}\ {\isasymomega}\ j\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ a\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}sum{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharslash}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ integral{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}slice{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}a{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ exp{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharbrackleft}{\kern0pt}OF\ p{\isacharunderscore}{\kern0pt}prime\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ as{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}p{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero\ p{\isacharunderscore}{\kern0pt}sq{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f{\isacharprime}{\kern0pt}\ \isakeyword{where}\ {\isachardoublequoteopen}f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ median\ s\isactrlsub {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ real{\isacharunderscore}{\kern0pt}f{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isacharprime}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ s{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}def\ median{\isacharunderscore}{\kern0pt}rat\ median{\isacharunderscore}{\kern0pt}restrict\ cong{\isacharcolon}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}divide\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}diff{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ distr{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}M\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}pmf\ f\ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ \ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}sketch{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ as{\isacharequal}{\kern0pt}{\isachardoublequoteopen}as{\isachardoublequoteclose}\ \isakeyword{and}\ n{\isacharequal}{\kern0pt}{\isachardoublequoteopen}n{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}M{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}assoc{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}return{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}conv{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ p{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ h{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ sketch{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ cong{\isacharcolon}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}map{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ f{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ g\ \isakeyword{where}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isasymbar}{\isasymomega}\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ e{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isasymomega}{\isachardot}{\kern0pt}\ {\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as\ {\isasymge}\ {\isasymbar}{\isasymomega}\ {\isacharminus}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isasymbar}{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isasymomega}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}\ {\isasymomega}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}g{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}antisym{\isacharcomma}{\kern0pt}\ rule\ subsetI{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ abs{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}diff\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ subsetI{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ abs{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}diff\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}indep{\isacharunderscore}{\kern0pt}vars\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ borel{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i\ {\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}intro\ {\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}j{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}j{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}disjoint{\isacharunderscore}{\kern0pt}family{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ fastforce{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}mem{\isacharunderscore}{\kern0pt}Times{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ real\ s\isactrlsub {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}ceiling\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ {\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymbar}f{\isadigit{2}}\ {\isasymomega}\ i\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymbar}f{\isadigit{2}}\ {\isasymomega}\ i\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}as\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ a\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ F{\isacharunderscore}{\kern0pt}def\ f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ F{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}F\ {\isadigit{2}}\ as\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ F{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackleft}{\kern0pt}OF\ False{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \ \ \ \ \isacommand{define}\isamarkupfalse%
\ var\ \isakeyword{where}\ \ {\isachardoublequoteopen}var\ {\isacharequal}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}exp{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ a\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ F{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}integrable\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isasymin}\ borel{\isacharunderscore}{\kern0pt}measurable\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymbar}f{\isadigit{2}}\ {\isasymomega}\ i\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}\ {\isasymle}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isasymbar}f{\isadigit{2}}\ {\isasymomega}\ i\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ pmf{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\ \isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ var\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}Chebyshev{\isacharunderscore}{\kern0pt}inequality{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ M{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isakeyword{and}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}simplified{\isacharbrackright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ p{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ F{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\isanewline
\ \ \ \ \ \ \ \ \ \ b{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ b{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ b{\isacharunderscore}{\kern0pt}{\isadigit{3}}\ b{\isacharunderscore}{\kern0pt}{\isadigit{4}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}var{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{3}}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isacharquery}{\kern0pt}ths{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ pos{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ F{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}var{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}var{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ a\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ distr{\isacharprime}{\kern0pt}\ e\ real{\isacharunderscore}{\kern0pt}f\ f{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}def\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ M{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isasymepsilon}{\isacharequal}{\kern0pt}{\isachardoublequoteopen}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isachardoublequoteclose}\ \isakeyword{and}\ X{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}i\ {\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{apply}\isamarkupfalse%
\ simp\ \isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{4}}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{fun}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ let\ s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isasymdelta}\isactrlsup {\isadigit{2}}\ {\isasymrceil}\ in\isanewline
\ \ \ \ let\ s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}\ in\ \isanewline
\ \ \ \ {\isadigit{5}}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{2}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ s\isactrlsub {\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ encode{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ bool\ list\ option{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}encode{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ N\isactrlsub S\ {\isasymtimes}\isactrlsub D\ {\isacharparenleft}{\kern0pt}{\isasymlambda}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ N\isactrlsub S\ {\isasymtimes}\isactrlsub D\ {\isacharparenleft}{\kern0pt}{\isasymlambda}s\isactrlsub {\isadigit{2}}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ N\isactrlsub S\ {\isasymtimes}\isactrlsub D\ {\isacharparenleft}{\kern0pt}{\isasymlambda}p{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}List{\isachardot}{\kern0pt}product\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbrackright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub S\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ {\isacharparenleft}{\kern0pt}zfact\isactrlsub S\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub S\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}List{\isachardot}{\kern0pt}product\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbrackright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub S\ I\isactrlsub S{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ encode{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}dom\ encode{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ encoding{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}inj{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}encode{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ dependent{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ dependent{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ dependent{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ encode{\isacharunderscore}{\kern0pt}extensional\ list{\isacharunderscore}{\kern0pt}encoding\ zfact{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ encode{\isacharunderscore}{\kern0pt}extensional\ int{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}exact{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}{\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymdelta}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ as\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}M\ {\isasymequiv}\ fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ a{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}AE\ {\isasymomega}\ in\ M{\isachardot}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymomega}{\isacharparenright}{\kern0pt}\ {\isasymle}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{1}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isasymdelta}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{2}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ p\ \isakeyword{where}\ {\isachardoublequoteopen}p\ {\isacharequal}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}max\ n\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above\ {\isadigit{3}}\ {\isacharequal}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}min\ p{\isacharunderscore}{\kern0pt}def\ gr{\isadigit{0}}I\ not{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}zero{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}n{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}n\ {\isasymle}\ {\isadigit{3}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ One{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}def\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}upper{\isacharunderscore}{\kern0pt}bound\ Suc{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ add{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}right\ linear\ not{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq\ numeral{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}y{\isachardot}{\kern0pt}\ y{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub E\ bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ y{\isacharcomma}{\kern0pt}\ {\isasymlambda}i{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ \ \ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ y\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}y\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub E\ bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\ extensional\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ \ PiE{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ y\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ {\isacharparenleft}{\kern0pt}zfact\isactrlsub S\ p{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{9}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{5}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ y\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ {\isacharparenleft}{\kern0pt}zfact\isactrlsub S\ p{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}\ real\ {\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomial{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharbrackleft}{\kern0pt}OF\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ a{\isacharunderscore}{\kern0pt}{\isadigit{5}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}real\ {\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ log{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}cancel{\isacharunderscore}{\kern0pt}iff{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}n\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{9}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ {\isacharparenleft}{\kern0pt}zfact\isactrlsub S\ p{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{9}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ \ \ x\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ {\isasymbar}x{\isasymbar}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ int\ n{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ int\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ i\ \isakeyword{where}\ {\isachardoublequoteopen}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ x{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}abs\ x\ {\isasymle}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ abs\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ x{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ rule\ sum{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}abs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}int\ p{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ \isacommand{by}\isamarkupfalse%
\ simp\ \isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ int\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}int\ p{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}triv{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ int\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharplus}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}int\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}n\ \isacommand{apply}\isamarkupfalse%
\ linarith\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}abs\ x\ {\isasymle}\ \ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ int\ n{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ int\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mult{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ y{\isacharcomma}{\kern0pt}\ {\isasymlambda}i{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{2}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}n{\isacharplus}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{2}}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ encode{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ dependent{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ prod{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ fun\isactrlsub S{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ del{\isacharcolon}{\kern0pt}encode{\isacharunderscore}{\kern0pt}dependent{\isacharunderscore}{\kern0pt}sum{\isachardot}{\kern0pt}simps\ encode{\isacharunderscore}{\kern0pt}prod{\isachardot}{\kern0pt}simps\ N\isactrlsub S{\isachardot}{\kern0pt}simps\ plus{\isacharunderscore}{\kern0pt}ereal{\isachardot}{\kern0pt}simps\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}add{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharcomma}{\kern0pt}\ metis\ p{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}n{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}estI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{9}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ rule\ a{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}estI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharplus}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}n{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ length\ as{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ int{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}a{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ y{\isacharcomma}{\kern0pt}\ {\isasymlambda}i{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ AE{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ M{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}sketch{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ n{\isacharequal}{\kern0pt}{\isachardoublequoteopen}n{\isachardoublequoteclose}\ \isakeyword{and}\ as{\isacharequal}{\kern0pt}{\isachardoublequoteopen}as{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ set{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ PiE{\isacharunderscore}{\kern0pt}iff\ \ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharcomma}{\kern0pt}\ metis\ ne{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharcomma}{\kern0pt}\ metis\ fin{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharbrackleft}{\kern0pt}OF\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ a{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}asympotic{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}complexity{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}at{\isacharunderscore}{\kern0pt}top\ {\isasymtimes}\isactrlsub F\ at{\isacharunderscore}{\kern0pt}top\ {\isasymtimes}\isactrlsub F\ at{\isacharunderscore}{\kern0pt}right\ {\isadigit{0}}\ {\isasymtimes}\isactrlsub F\ at{\isacharunderscore}{\kern0pt}right\ {\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ \isanewline
\ \ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ m{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}rhs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ n{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}n{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ m{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}m{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ g\ \isakeyword{where}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ n{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}n{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}top{\isacharunderscore}{\kern0pt}linorder\ nat{\isacharunderscore}{\kern0pt}ceiling{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ m{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}m{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}top{\isacharunderscore}{\kern0pt}linorder\ nat{\isacharunderscore}{\kern0pt}ceiling{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ eps{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inv{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ delta{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inv{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}rightI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ b{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}delta{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}rightI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ b{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}delta\ delta{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ one{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}power\ power{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}over{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps\ eps{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}exp\ {\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ abs{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}self\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}trans\ exp{\isacharunderscore}{\kern0pt}gt{\isacharunderscore}{\kern0pt}zero\ ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff\ order{\isacharunderscore}{\kern0pt}trans{\isacharunderscore}{\kern0pt}rules{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ n{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ m{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{5}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono\ {\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}exp\ {\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ abs{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}self\ linorder{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le\ ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff\ not{\isacharunderscore}{\kern0pt}exp{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}zero\ order{\isachardot}{\kern0pt}trans{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono\ {\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps\ eps{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{8}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{9}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}\ unit{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}rightI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ b{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}nat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isachardot}{\kern0pt}in{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ always{\isacharunderscore}{\kern0pt}eventually{\isacharcomma}{\kern0pt}\ rule\ allI{\isacharcomma}{\kern0pt}\ rule\ arg{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ opaque{\isacharunderscore}{\kern0pt}lifting{\isacharparenright}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}ceiling\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}divide\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}eq\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ceil{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}const{\isacharunderscore}{\kern0pt}inv{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}nat{\isacharcomma}{\kern0pt}\ rule\ landau{\isacharunderscore}{\kern0pt}ceil{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ minus{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ cmult{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}iff{\isacharcomma}{\kern0pt}\ rule\ disjI{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ ln{\isacharunderscore}{\kern0pt}div{\isacharcomma}{\kern0pt}\ simp{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}trans\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono\ mult{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}commute\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}iff\ verit{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}simplify{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ mult{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}mult{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{9}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isachardot}{\kern0pt}in{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ ln{\isacharunderscore}{\kern0pt}mult{\isacharcomma}{\kern0pt}\ simp{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ n{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{5}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharcomma}{\kern0pt}\ rule\ l{\isadigit{1}}{\isacharcomma}{\kern0pt}\ rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{6}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ l{\isadigit{4}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{7}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}eps{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}ceil{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ minus{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ cmult{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}iff{\isacharcomma}{\kern0pt}\ rule\ disjI{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isachardot}{\kern0pt}in{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln{\isacharparenleft}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ ln{\isacharunderscore}{\kern0pt}div{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharbrackleft}{\kern0pt}OF\ eps{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ \ unit{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharcomma}{\kern0pt}\ m{\isacharunderscore}{\kern0pt}of\ x{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}\ n{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ m{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}g{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharcomma}{\kern0pt}\ subst\ mult{\isachardot}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}mult{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}mult{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{4}}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def\ l{\isadigit{6}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def\ l{\isadigit{7}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def\ l{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{8}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}rhs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}bigo{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}\ g{\isacharunderscore}{\kern0pt}def\ n{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ m{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=Frequency_Moment_2.tex%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%31=6%:%
%:%40=8%:%
%:%41=9%:%
%:%42=10%:%
%:%43=11%:%
%:%45=13%:%
%:%46=13%:%
%:%47=14%:%
%:%48=15%:%
%:%49=16%:%
%:%50=16%:%
%:%51=17%:%
%:%52=18%:%
%:%53=18%:%
%:%54=19%:%
%:%61=26%:%
%:%62=27%:%
%:%63=28%:%
%:%64=28%:%
%:%65=29%:%
%:%66=30%:%
%:%67=31%:%
%:%68=32%:%
%:%69=32%:%
%:%70=33%:%
%:%72=35%:%
%:%73=36%:%
%:%74=37%:%
%:%75=37%:%
%:%76=38%:%
%:%77=39%:%
%:%78=40%:%
%:%79=41%:%
%:%80=42%:%
%:%82=44%:%
%:%89=45%:%
%:%90=45%:%
%:%91=46%:%
%:%92=46%:%
%:%93=46%:%
%:%94=46%:%
%:%95=47%:%
%:%96=48%:%
%:%97=48%:%
%:%98=48%:%
%:%99=48%:%
%:%100=49%:%
%:%101=49%:%
%:%102=49%:%
%:%103=50%:%
%:%104=50%:%
%:%105=50%:%
%:%106=51%:%
%:%107=52%:%
%:%108=52%:%
%:%109=53%:%
%:%110=54%:%
%:%111=54%:%
%:%112=55%:%
%:%113=55%:%
%:%114=56%:%
%:%115=56%:%
%:%116=57%:%
%:%117=58%:%
%:%118=58%:%
%:%119=58%:%
%:%120=59%:%
%:%121=60%:%
%:%122=60%:%
%:%123=61%:%
%:%124=61%:%
%:%125=62%:%
%:%126=62%:%
%:%127=63%:%
%:%128=63%:%
%:%129=64%:%
%:%130=64%:%
%:%131=65%:%
%:%132=65%:%
%:%133=66%:%
%:%134=66%:%
%:%135=67%:%
%:%136=67%:%
%:%137=67%:%
%:%138=68%:%
%:%139=68%:%
%:%140=69%:%
%:%141=69%:%
%:%142=70%:%
%:%143=70%:%
%:%144=70%:%
%:%145=70%:%
%:%146=71%:%
%:%147=71%:%
%:%148=71%:%
%:%149=71%:%
%:%150=72%:%
%:%151=72%:%
%:%152=72%:%
%:%153=73%:%
%:%154=74%:%
%:%155=74%:%
%:%156=74%:%
%:%157=75%:%
%:%158=75%:%
%:%159=75%:%
%:%160=76%:%
%:%161=76%:%
%:%162=77%:%
%:%163=77%:%
%:%164=78%:%
%:%165=78%:%
%:%166=78%:%
%:%167=79%:%
%:%168=79%:%
%:%169=80%:%
%:%170=80%:%
%:%171=80%:%
%:%172=81%:%
%:%173=81%:%
%:%174=82%:%
%:%175=82%:%
%:%176=82%:%
%:%177=83%:%
%:%178=83%:%
%:%179=84%:%
%:%180=84%:%
%:%181=85%:%
%:%182=85%:%
%:%183=86%:%
%:%184=87%:%
%:%185=87%:%
%:%186=88%:%
%:%187=88%:%
%:%188=89%:%
%:%189=89%:%
%:%190=90%:%
%:%191=90%:%
%:%192=91%:%
%:%193=91%:%
%:%194=92%:%
%:%195=92%:%
%:%196=92%:%
%:%197=93%:%
%:%198=93%:%
%:%199=94%:%
%:%200=94%:%
%:%201=95%:%
%:%202=95%:%
%:%203=96%:%
%:%204=96%:%
%:%205=97%:%
%:%206=97%:%
%:%207=98%:%
%:%208=98%:%
%:%209=98%:%
%:%210=99%:%
%:%211=100%:%
%:%212=100%:%
%:%214=102%:%
%:%215=103%:%
%:%216=103%:%
%:%217=104%:%
%:%218=104%:%
%:%219=104%:%
%:%221=106%:%
%:%222=107%:%
%:%223=107%:%
%:%224=108%:%
%:%225=108%:%
%:%226=109%:%
%:%227=109%:%
%:%228=110%:%
%:%229=110%:%
%:%230=111%:%
%:%231=111%:%
%:%232=111%:%
%:%233=112%:%
%:%234=112%:%
%:%235=113%:%
%:%236=113%:%
%:%237=113%:%
%:%238=114%:%
%:%239=115%:%
%:%240=115%:%
%:%241=116%:%
%:%242=116%:%
%:%243=116%:%
%:%244=117%:%
%:%245=117%:%
%:%246=118%:%
%:%247=119%:%
%:%248=119%:%
%:%249=120%:%
%:%250=120%:%
%:%251=121%:%
%:%252=121%:%
%:%253=122%:%
%:%259=122%:%
%:%262=123%:%
%:%263=124%:%
%:%264=124%:%
%:%265=125%:%
%:%266=126%:%
%:%267=127%:%
%:%268=128%:%
%:%269=129%:%
%:%270=130%:%
%:%271=131%:%
%:%278=132%:%
%:%279=132%:%
%:%280=133%:%
%:%281=133%:%
%:%282=134%:%
%:%283=134%:%
%:%284=135%:%
%:%285=135%:%
%:%286=136%:%
%:%287=136%:%
%:%288=137%:%
%:%289=138%:%
%:%290=138%:%
%:%291=139%:%
%:%292=140%:%
%:%293=140%:%
%:%294=141%:%
%:%295=141%:%
%:%296=141%:%
%:%297=142%:%
%:%298=143%:%
%:%299=143%:%
%:%300=144%:%
%:%301=144%:%
%:%302=145%:%
%:%303=146%:%
%:%304=146%:%
%:%305=146%:%
%:%306=146%:%
%:%307=147%:%
%:%308=148%:%
%:%309=148%:%
%:%310=149%:%
%:%311=149%:%
%:%312=150%:%
%:%313=150%:%
%:%314=151%:%
%:%315=151%:%
%:%316=152%:%
%:%317=153%:%
%:%318=153%:%
%:%319=153%:%
%:%320=154%:%
%:%321=155%:%
%:%322=155%:%
%:%323=156%:%
%:%324=156%:%
%:%325=157%:%
%:%326=157%:%
%:%327=157%:%
%:%328=157%:%
%:%329=158%:%
%:%330=158%:%
%:%331=159%:%
%:%332=160%:%
%:%333=161%:%
%:%334=161%:%
%:%335=162%:%
%:%336=162%:%
%:%337=163%:%
%:%338=163%:%
%:%339=164%:%
%:%340=164%:%
%:%341=164%:%
%:%342=164%:%
%:%343=165%:%
%:%344=165%:%
%:%345=166%:%
%:%346=166%:%
%:%347=167%:%
%:%348=167%:%
%:%349=168%:%
%:%350=168%:%
%:%351=169%:%
%:%352=169%:%
%:%353=170%:%
%:%354=170%:%
%:%355=171%:%
%:%356=171%:%
%:%357=172%:%
%:%358=172%:%
%:%359=173%:%
%:%360=173%:%
%:%361=174%:%
%:%362=174%:%
%:%363=175%:%
%:%364=175%:%
%:%365=176%:%
%:%366=177%:%
%:%367=177%:%
%:%368=177%:%
%:%369=178%:%
%:%370=179%:%
%:%371=179%:%
%:%372=180%:%
%:%373=180%:%
%:%374=181%:%
%:%375=181%:%
%:%376=182%:%
%:%377=182%:%
%:%378=183%:%
%:%379=183%:%
%:%380=184%:%
%:%381=185%:%
%:%382=185%:%
%:%383=186%:%
%:%384=186%:%
%:%385=187%:%
%:%386=187%:%
%:%387=188%:%
%:%388=188%:%
%:%389=189%:%
%:%390=189%:%
%:%391=189%:%
%:%392=189%:%
%:%393=190%:%
%:%394=190%:%
%:%395=190%:%
%:%396=191%:%
%:%397=191%:%
%:%398=192%:%
%:%399=192%:%
%:%400=192%:%
%:%401=192%:%
%:%402=193%:%
%:%403=194%:%
%:%404=194%:%
%:%405=195%:%
%:%406=195%:%
%:%407=196%:%
%:%408=196%:%
%:%409=197%:%
%:%410=197%:%
%:%411=197%:%
%:%412=198%:%
%:%413=198%:%
%:%414=199%:%
%:%415=199%:%
%:%416=200%:%
%:%417=200%:%
%:%418=201%:%
%:%419=201%:%
%:%420=202%:%
%:%421=202%:%
%:%422=203%:%
%:%423=203%:%
%:%424=204%:%
%:%425=204%:%
%:%426=205%:%
%:%427=205%:%
%:%428=206%:%
%:%429=206%:%
%:%430=206%:%
%:%431=207%:%
%:%432=207%:%
%:%433=208%:%
%:%434=208%:%
%:%435=209%:%
%:%436=209%:%
%:%437=210%:%
%:%438=210%:%
%:%439=210%:%
%:%440=211%:%
%:%441=211%:%
%:%442=212%:%
%:%443=212%:%
%:%444=212%:%
%:%445=212%:%
%:%446=213%:%
%:%447=213%:%
%:%448=214%:%
%:%449=215%:%
%:%450=215%:%
%:%451=216%:%
%:%452=216%:%
%:%453=217%:%
%:%454=217%:%
%:%455=218%:%
%:%456=218%:%
%:%457=219%:%
%:%458=219%:%
%:%459=219%:%
%:%460=220%:%
%:%461=220%:%
%:%462=220%:%
%:%463=221%:%
%:%464=221%:%
%:%465=222%:%
%:%466=222%:%
%:%467=223%:%
%:%468=223%:%
%:%469=223%:%
%:%470=224%:%
%:%471=224%:%
%:%472=225%:%
%:%473=225%:%
%:%474=225%:%
%:%475=226%:%
%:%476=226%:%
%:%477=226%:%
%:%478=227%:%
%:%479=227%:%
%:%480=228%:%
%:%481=228%:%
%:%482=229%:%
%:%483=229%:%
%:%484=230%:%
%:%485=230%:%
%:%486=231%:%
%:%487=232%:%
%:%488=232%:%
%:%489=232%:%
%:%490=232%:%
%:%491=233%:%
%:%492=233%:%
%:%493=234%:%
%:%494=235%:%
%:%495=235%:%
%:%496=236%:%
%:%497=236%:%
%:%498=237%:%
%:%499=238%:%
%:%500=238%:%
%:%501=239%:%
%:%502=239%:%
%:%503=240%:%
%:%504=240%:%
%:%505=240%:%
%:%506=241%:%
%:%507=241%:%
%:%508=242%:%
%:%509=242%:%
%:%510=243%:%
%:%511=243%:%
%:%512=244%:%
%:%513=244%:%
%:%514=245%:%
%:%515=245%:%
%:%516=245%:%
%:%517=246%:%
%:%518=247%:%
%:%519=247%:%
%:%520=248%:%
%:%521=248%:%
%:%522=249%:%
%:%523=249%:%
%:%524=250%:%
%:%525=250%:%
%:%526=250%:%
%:%527=251%:%
%:%528=251%:%
%:%529=252%:%
%:%530=252%:%
%:%531=253%:%
%:%532=253%:%
%:%533=253%:%
%:%534=254%:%
%:%535=254%:%
%:%536=255%:%
%:%537=255%:%
%:%538=256%:%
%:%539=256%:%
%:%540=256%:%
%:%541=256%:%
%:%542=257%:%
%:%543=258%:%
%:%544=258%:%
%:%545=259%:%
%:%546=260%:%
%:%547=260%:%
%:%548=261%:%
%:%549=261%:%
%:%550=262%:%
%:%551=262%:%
%:%552=262%:%
%:%553=263%:%
%:%554=264%:%
%:%555=264%:%
%:%556=265%:%
%:%557=265%:%
%:%558=266%:%
%:%559=266%:%
%:%560=267%:%
%:%561=267%:%
%:%562=268%:%
%:%563=268%:%
%:%564=269%:%
%:%565=269%:%
%:%566=270%:%
%:%567=270%:%
%:%568=270%:%
%:%570=272%:%
%:%571=273%:%
%:%572=273%:%
%:%573=274%:%
%:%574=274%:%
%:%575=275%:%
%:%576=275%:%
%:%577=276%:%
%:%578=276%:%
%:%579=276%:%
%:%580=277%:%
%:%581=278%:%
%:%582=278%:%
%:%583=279%:%
%:%584=279%:%
%:%585=280%:%
%:%586=280%:%
%:%587=281%:%
%:%588=281%:%
%:%589=281%:%
%:%590=282%:%
%:%591=282%:%
%:%592=283%:%
%:%593=283%:%
%:%594=284%:%
%:%595=284%:%
%:%596=285%:%
%:%597=285%:%
%:%598=286%:%
%:%599=286%:%
%:%600=287%:%
%:%601=287%:%
%:%602=287%:%
%:%603=288%:%
%:%604=288%:%
%:%605=289%:%
%:%606=289%:%
%:%607=290%:%
%:%608=290%:%
%:%609=291%:%
%:%610=291%:%
%:%611=291%:%
%:%612=292%:%
%:%613=292%:%
%:%614=292%:%
%:%615=293%:%
%:%616=293%:%
%:%617=294%:%
%:%618=295%:%
%:%619=295%:%
%:%620=295%:%
%:%621=296%:%
%:%622=296%:%
%:%623=297%:%
%:%624=298%:%
%:%625=298%:%
%:%626=299%:%
%:%627=299%:%
%:%628=300%:%
%:%629=300%:%
%:%630=301%:%
%:%631=301%:%
%:%632=301%:%
%:%633=302%:%
%:%634=303%:%
%:%635=303%:%
%:%636=303%:%
%:%637=304%:%
%:%643=304%:%
%:%646=305%:%
%:%647=306%:%
%:%648=306%:%
%:%649=307%:%
%:%650=308%:%
%:%651=309%:%
%:%652=310%:%
%:%653=311%:%
%:%654=312%:%
%:%655=313%:%
%:%656=314%:%
%:%657=315%:%
%:%658=316%:%
%:%659=317%:%
%:%666=318%:%
%:%667=318%:%
%:%668=319%:%
%:%669=319%:%
%:%670=320%:%
%:%671=320%:%
%:%672=321%:%
%:%673=321%:%
%:%674=322%:%
%:%675=322%:%
%:%676=322%:%
%:%677=323%:%
%:%678=324%:%
%:%679=324%:%
%:%680=325%:%
%:%681=325%:%
%:%682=326%:%
%:%683=326%:%
%:%684=326%:%
%:%685=327%:%
%:%686=327%:%
%:%687=328%:%
%:%688=328%:%
%:%689=329%:%
%:%690=329%:%
%:%691=330%:%
%:%692=330%:%
%:%693=331%:%
%:%694=331%:%
%:%695=332%:%
%:%696=332%:%
%:%697=333%:%
%:%698=333%:%
%:%699=333%:%
%:%700=334%:%
%:%701=334%:%
%:%702=335%:%
%:%703=335%:%
%:%704=336%:%
%:%705=336%:%
%:%706=337%:%
%:%707=337%:%
%:%708=338%:%
%:%709=338%:%
%:%710=339%:%
%:%711=339%:%
%:%712=339%:%
%:%713=340%:%
%:%714=341%:%
%:%715=341%:%
%:%716=342%:%
%:%717=342%:%
%:%718=342%:%
%:%719=342%:%
%:%720=343%:%
%:%726=343%:%
%:%729=344%:%
%:%730=345%:%
%:%731=345%:%
%:%732=346%:%
%:%733=347%:%
%:%734=348%:%
%:%735=349%:%
%:%736=350%:%
%:%743=351%:%
%:%744=351%:%
%:%745=352%:%
%:%746=352%:%
%:%747=353%:%
%:%748=353%:%
%:%749=354%:%
%:%750=354%:%
%:%751=355%:%
%:%752=355%:%
%:%753=356%:%
%:%754=357%:%
%:%755=358%:%
%:%756=358%:%
%:%757=359%:%
%:%758=359%:%
%:%759=360%:%
%:%760=360%:%
%:%761=361%:%
%:%762=361%:%
%:%763=362%:%
%:%764=362%:%
%:%765=363%:%
%:%766=364%:%
%:%767=364%:%
%:%768=365%:%
%:%769=365%:%
%:%770=366%:%
%:%771=366%:%
%:%772=366%:%
%:%773=367%:%
%:%774=368%:%
%:%775=368%:%
%:%776=369%:%
%:%777=369%:%
%:%778=370%:%
%:%779=370%:%
%:%780=371%:%
%:%781=372%:%
%:%782=372%:%
%:%783=372%:%
%:%784=373%:%
%:%785=374%:%
%:%786=374%:%
%:%787=375%:%
%:%788=375%:%
%:%789=376%:%
%:%790=377%:%
%:%791=377%:%
%:%792=377%:%
%:%793=377%:%
%:%794=378%:%
%:%795=379%:%
%:%796=379%:%
%:%797=380%:%
%:%798=380%:%
%:%799=381%:%
%:%800=382%:%
%:%801=382%:%
%:%802=383%:%
%:%803=383%:%
%:%804=384%:%
%:%805=384%:%
%:%806=385%:%
%:%807=385%:%
%:%808=386%:%
%:%809=387%:%
%:%810=387%:%
%:%811=388%:%
%:%812=388%:%
%:%813=389%:%
%:%814=389%:%
%:%815=389%:%
%:%816=390%:%
%:%817=390%:%
%:%818=391%:%
%:%819=391%:%
%:%820=392%:%
%:%821=393%:%
%:%822=393%:%
%:%823=394%:%
%:%824=394%:%
%:%825=395%:%
%:%826=395%:%
%:%827=395%:%
%:%828=396%:%
%:%829=397%:%
%:%830=397%:%
%:%831=398%:%
%:%832=398%:%
%:%833=398%:%
%:%834=399%:%
%:%835=400%:%
%:%836=400%:%
%:%837=401%:%
%:%838=401%:%
%:%839=401%:%
%:%840=402%:%
%:%841=403%:%
%:%842=403%:%
%:%843=404%:%
%:%844=404%:%
%:%845=405%:%
%:%846=406%:%
%:%847=406%:%
%:%848=407%:%
%:%849=407%:%
%:%850=408%:%
%:%851=409%:%
%:%852=409%:%
%:%855=412%:%
%:%856=413%:%
%:%857=414%:%
%:%858=414%:%
%:%859=415%:%
%:%860=416%:%
%:%861=417%:%
%:%862=417%:%
%:%863=418%:%
%:%864=419%:%
%:%865=419%:%
%:%866=420%:%
%:%867=420%:%
%:%868=421%:%
%:%869=421%:%
%:%870=422%:%
%:%871=422%:%
%:%872=423%:%
%:%873=423%:%
%:%874=424%:%
%:%875=424%:%
%:%876=425%:%
%:%877=425%:%
%:%878=425%:%
%:%879=426%:%
%:%880=427%:%
%:%881=427%:%
%:%882=428%:%
%:%883=428%:%
%:%884=429%:%
%:%885=429%:%
%:%886=430%:%
%:%887=430%:%
%:%888=431%:%
%:%889=431%:%
%:%890=432%:%
%:%891=432%:%
%:%892=433%:%
%:%893=433%:%
%:%894=434%:%
%:%895=434%:%
%:%896=435%:%
%:%897=435%:%
%:%898=436%:%
%:%899=436%:%
%:%900=437%:%
%:%901=437%:%
%:%902=437%:%
%:%903=438%:%
%:%904=438%:%
%:%905=439%:%
%:%906=439%:%
%:%907=440%:%
%:%908=440%:%
%:%909=441%:%
%:%910=441%:%
%:%911=442%:%
%:%912=442%:%
%:%913=443%:%
%:%914=443%:%
%:%915=444%:%
%:%916=444%:%
%:%917=445%:%
%:%918=445%:%
%:%919=445%:%
%:%920=446%:%
%:%921=446%:%
%:%922=447%:%
%:%923=447%:%
%:%924=448%:%
%:%925=448%:%
%:%926=449%:%
%:%927=449%:%
%:%928=449%:%
%:%929=450%:%
%:%930=450%:%
%:%931=451%:%
%:%932=451%:%
%:%933=452%:%
%:%934=452%:%
%:%935=453%:%
%:%936=453%:%
%:%937=454%:%
%:%938=454%:%
%:%939=455%:%
%:%940=455%:%
%:%941=455%:%
%:%942=456%:%
%:%943=456%:%
%:%944=456%:%
%:%945=457%:%
%:%946=457%:%
%:%947=457%:%
%:%948=458%:%
%:%949=458%:%
%:%950=459%:%
%:%951=459%:%
%:%952=459%:%
%:%953=460%:%
%:%954=460%:%
%:%955=461%:%
%:%956=461%:%
%:%957=462%:%
%:%958=463%:%
%:%959=463%:%
%:%960=464%:%
%:%961=464%:%
%:%962=465%:%
%:%963=465%:%
%:%964=466%:%
%:%965=466%:%
%:%966=467%:%
%:%967=467%:%
%:%968=468%:%
%:%969=468%:%
%:%970=469%:%
%:%971=469%:%
%:%972=470%:%
%:%973=470%:%
%:%974=471%:%
%:%975=471%:%
%:%976=472%:%
%:%977=472%:%
%:%978=472%:%
%:%979=473%:%
%:%980=473%:%
%:%981=474%:%
%:%982=474%:%
%:%983=475%:%
%:%984=475%:%
%:%985=476%:%
%:%986=476%:%
%:%987=477%:%
%:%988=477%:%
%:%989=478%:%
%:%990=478%:%
%:%991=479%:%
%:%992=479%:%
%:%993=480%:%
%:%994=480%:%
%:%995=480%:%
%:%996=481%:%
%:%997=481%:%
%:%998=482%:%
%:%999=482%:%
%:%1000=482%:%
%:%1001=483%:%
%:%1002=483%:%
%:%1003=484%:%
%:%1004=484%:%
%:%1005=485%:%
%:%1006=486%:%
%:%1007=486%:%
%:%1008=487%:%
%:%1009=487%:%
%:%1010=488%:%
%:%1011=488%:%
%:%1012=488%:%
%:%1013=489%:%
%:%1014=489%:%
%:%1015=490%:%
%:%1016=491%:%
%:%1017=491%:%
%:%1018=492%:%
%:%1019=492%:%
%:%1020=493%:%
%:%1021=493%:%
%:%1022=494%:%
%:%1023=494%:%
%:%1024=495%:%
%:%1025=495%:%
%:%1026=496%:%
%:%1027=496%:%
%:%1028=497%:%
%:%1029=497%:%
%:%1030=498%:%
%:%1031=498%:%
%:%1032=499%:%
%:%1033=500%:%
%:%1034=500%:%
%:%1035=501%:%
%:%1036=501%:%
%:%1037=502%:%
%:%1038=502%:%
%:%1039=503%:%
%:%1040=503%:%
%:%1041=504%:%
%:%1042=504%:%
%:%1043=505%:%
%:%1044=505%:%
%:%1045=506%:%
%:%1046=506%:%
%:%1047=507%:%
%:%1048=508%:%
%:%1049=508%:%
%:%1050=509%:%
%:%1051=509%:%
%:%1052=510%:%
%:%1053=510%:%
%:%1054=511%:%
%:%1055=511%:%
%:%1056=512%:%
%:%1057=512%:%
%:%1058=513%:%
%:%1059=513%:%
%:%1060=514%:%
%:%1061=514%:%
%:%1062=515%:%
%:%1063=515%:%
%:%1064=516%:%
%:%1065=516%:%
%:%1066=517%:%
%:%1067=518%:%
%:%1068=518%:%
%:%1069=519%:%
%:%1070=519%:%
%:%1071=520%:%
%:%1072=520%:%
%:%1073=520%:%
%:%1074=521%:%
%:%1075=522%:%
%:%1076=522%:%
%:%1077=523%:%
%:%1078=524%:%
%:%1079=524%:%
%:%1080=525%:%
%:%1081=525%:%
%:%1082=526%:%
%:%1083=526%:%
%:%1084=527%:%
%:%1085=527%:%
%:%1086=528%:%
%:%1087=528%:%
%:%1088=529%:%
%:%1089=529%:%
%:%1090=530%:%
%:%1091=530%:%
%:%1092=530%:%
%:%1093=530%:%
%:%1094=530%:%
%:%1095=531%:%
%:%1096=531%:%
%:%1097=532%:%
%:%1098=532%:%
%:%1099=533%:%
%:%1100=533%:%
%:%1101=533%:%
%:%1102=533%:%
%:%1103=534%:%
%:%1104=535%:%
%:%1105=535%:%
%:%1106=536%:%
%:%1107=536%:%
%:%1108=537%:%
%:%1109=537%:%
%:%1110=537%:%
%:%1111=538%:%
%:%1112=538%:%
%:%1113=539%:%
%:%1114=539%:%
%:%1115=539%:%
%:%1116=540%:%
%:%1117=540%:%
%:%1118=541%:%
%:%1119=541%:%
%:%1120=542%:%
%:%1121=542%:%
%:%1122=543%:%
%:%1123=543%:%
%:%1124=544%:%
%:%1125=544%:%
%:%1126=545%:%
%:%1127=546%:%
%:%1128=546%:%
%:%1129=547%:%
%:%1130=547%:%
%:%1131=548%:%
%:%1132=548%:%
%:%1133=549%:%
%:%1134=549%:%
%:%1135=549%:%
%:%1136=550%:%
%:%1137=550%:%
%:%1138=551%:%
%:%1139=552%:%
%:%1140=552%:%
%:%1141=553%:%
%:%1142=553%:%
%:%1143=553%:%
%:%1144=554%:%
%:%1145=554%:%
%:%1146=555%:%
%:%1147=555%:%
%:%1148=555%:%
%:%1149=556%:%
%:%1150=556%:%
%:%1151=557%:%
%:%1152=557%:%
%:%1153=557%:%
%:%1154=558%:%
%:%1155=558%:%
%:%1156=558%:%
%:%1157=559%:%
%:%1158=559%:%
%:%1159=560%:%
%:%1160=560%:%
%:%1161=561%:%
%:%1162=561%:%
%:%1163=562%:%
%:%1164=563%:%
%:%1165=563%:%
%:%1166=564%:%
%:%1167=564%:%
%:%1168=565%:%
%:%1169=565%:%
%:%1170=566%:%
%:%1171=566%:%
%:%1172=567%:%
%:%1173=567%:%
%:%1174=567%:%
%:%1175=568%:%
%:%1176=568%:%
%:%1177=569%:%
%:%1178=569%:%
%:%1179=570%:%
%:%1180=570%:%
%:%1181=570%:%
%:%1182=571%:%
%:%1188=571%:%
%:%1191=572%:%
%:%1192=573%:%
%:%1193=573%:%
%:%1194=574%:%
%:%1201=581%:%
%:%1202=582%:%
%:%1203=583%:%
%:%1204=583%:%
%:%1205=584%:%
%:%1210=589%:%
%:%1211=590%:%
%:%1212=591%:%
%:%1213=591%:%
%:%1216=592%:%
%:%1220=592%:%
%:%1221=592%:%
%:%1222=593%:%
%:%1223=593%:%
%:%1224=594%:%
%:%1225=594%:%
%:%1226=595%:%
%:%1227=595%:%
%:%1228=596%:%
%:%1229=596%:%
%:%1230=597%:%
%:%1231=597%:%
%:%1232=598%:%
%:%1233=598%:%
%:%1238=598%:%
%:%1241=599%:%
%:%1242=600%:%
%:%1243=600%:%
%:%1244=601%:%
%:%1245=602%:%
%:%1246=603%:%
%:%1247=604%:%
%:%1248=605%:%
%:%1255=606%:%
%:%1256=606%:%
%:%1257=607%:%
%:%1258=607%:%
%:%1259=608%:%
%:%1260=608%:%
%:%1261=609%:%
%:%1262=609%:%
%:%1263=610%:%
%:%1264=611%:%
%:%1265=611%:%
%:%1266=612%:%
%:%1267=612%:%
%:%1268=613%:%
%:%1269=614%:%
%:%1270=614%:%
%:%1271=615%:%
%:%1272=615%:%
%:%1273=616%:%
%:%1274=616%:%
%:%1275=617%:%
%:%1276=617%:%
%:%1277=618%:%
%:%1278=618%:%
%:%1279=619%:%
%:%1280=619%:%
%:%1281=620%:%
%:%1282=620%:%
%:%1283=621%:%
%:%1284=622%:%
%:%1285=622%:%
%:%1288=625%:%
%:%1289=626%:%
%:%1290=626%:%
%:%1291=627%:%
%:%1292=627%:%
%:%1293=628%:%
%:%1294=628%:%
%:%1295=629%:%
%:%1296=630%:%
%:%1297=630%:%
%:%1298=630%:%
%:%1299=630%:%
%:%1300=631%:%
%:%1301=632%:%
%:%1302=632%:%
%:%1303=633%:%
%:%1304=634%:%
%:%1305=634%:%
%:%1306=635%:%
%:%1307=635%:%
%:%1308=636%:%
%:%1309=636%:%
%:%1310=637%:%
%:%1311=637%:%
%:%1312=638%:%
%:%1313=638%:%
%:%1314=639%:%
%:%1315=639%:%
%:%1316=639%:%
%:%1317=640%:%
%:%1318=640%:%
%:%1319=640%:%
%:%1320=641%:%
%:%1321=641%:%
%:%1322=642%:%
%:%1323=642%:%
%:%1324=643%:%
%:%1325=643%:%
%:%1326=643%:%
%:%1327=644%:%
%:%1328=644%:%
%:%1329=644%:%
%:%1330=645%:%
%:%1331=645%:%
%:%1332=646%:%
%:%1333=646%:%
%:%1334=646%:%
%:%1335=647%:%
%:%1336=647%:%
%:%1337=648%:%
%:%1338=648%:%
%:%1339=649%:%
%:%1340=650%:%
%:%1341=650%:%
%:%1343=652%:%
%:%1344=653%:%
%:%1345=653%:%
%:%1346=654%:%
%:%1347=654%:%
%:%1348=655%:%
%:%1349=655%:%
%:%1350=656%:%
%:%1351=656%:%
%:%1352=656%:%
%:%1353=657%:%
%:%1354=657%:%
%:%1355=658%:%
%:%1356=658%:%
%:%1357=659%:%
%:%1358=659%:%
%:%1359=660%:%
%:%1360=660%:%
%:%1361=660%:%
%:%1362=661%:%
%:%1363=661%:%
%:%1364=662%:%
%:%1365=662%:%
%:%1366=663%:%
%:%1367=663%:%
%:%1368=663%:%
%:%1369=664%:%
%:%1370=664%:%
%:%1371=664%:%
%:%1372=665%:%
%:%1373=665%:%
%:%1374=666%:%
%:%1375=666%:%
%:%1376=666%:%
%:%1377=667%:%
%:%1378=667%:%
%:%1379=668%:%
%:%1380=668%:%
%:%1381=668%:%
%:%1382=669%:%
%:%1383=669%:%
%:%1384=670%:%
%:%1385=670%:%
%:%1386=670%:%
%:%1387=671%:%
%:%1388=671%:%
%:%1389=672%:%
%:%1390=672%:%
%:%1391=673%:%
%:%1392=674%:%
%:%1393=674%:%
%:%1399=680%:%
%:%1400=681%:%
%:%1401=681%:%
%:%1402=682%:%
%:%1403=682%:%
%:%1404=683%:%
%:%1405=684%:%
%:%1406=685%:%
%:%1407=685%:%
%:%1408=686%:%
%:%1409=686%:%
%:%1410=687%:%
%:%1411=687%:%
%:%1412=688%:%
%:%1413=688%:%
%:%1414=689%:%
%:%1415=689%:%
%:%1416=690%:%
%:%1417=690%:%
%:%1418=691%:%
%:%1419=691%:%
%:%1420=692%:%
%:%1421=692%:%
%:%1422=693%:%
%:%1423=693%:%
%:%1424=694%:%
%:%1425=694%:%
%:%1426=694%:%
%:%1427=695%:%
%:%1428=695%:%
%:%1429=696%:%
%:%1430=696%:%
%:%1431=696%:%
%:%1433=698%:%
%:%1434=698%:%
%:%1435=699%:%
%:%1436=699%:%
%:%1437=700%:%
%:%1438=701%:%
%:%1439=701%:%
%:%1440=702%:%
%:%1441=702%:%
%:%1442=703%:%
%:%1443=703%:%
%:%1444=704%:%
%:%1445=704%:%
%:%1446=705%:%
%:%1447=705%:%
%:%1448=706%:%
%:%1449=706%:%
%:%1450=707%:%
%:%1451=707%:%
%:%1452=708%:%
%:%1453=708%:%
%:%1454=709%:%
%:%1455=709%:%
%:%1456=710%:%
%:%1462=710%:%
%:%1465=711%:%
%:%1466=712%:%
%:%1467=712%:%
%:%1468=713%:%
%:%1469=714%:%
%:%1470=715%:%
%:%1477=716%:%
%:%1478=716%:%
%:%1479=717%:%
%:%1480=717%:%
%:%1481=718%:%
%:%1482=718%:%
%:%1483=719%:%
%:%1484=719%:%
%:%1485=720%:%
%:%1486=720%:%
%:%1487=721%:%
%:%1488=722%:%
%:%1489=722%:%
%:%1490=723%:%
%:%1491=724%:%
%:%1492=724%:%
%:%1493=725%:%
%:%1494=725%:%
%:%1495=726%:%
%:%1496=726%:%
%:%1497=727%:%
%:%1498=727%:%
%:%1499=728%:%
%:%1500=729%:%
%:%1501=729%:%
%:%1502=730%:%
%:%1503=730%:%
%:%1504=731%:%
%:%1505=731%:%
%:%1506=732%:%
%:%1507=732%:%
%:%1508=733%:%
%:%1509=733%:%
%:%1510=734%:%
%:%1511=735%:%
%:%1512=735%:%
%:%1513=736%:%
%:%1514=736%:%
%:%1515=737%:%
%:%1516=737%:%
%:%1517=738%:%
%:%1518=738%:%
%:%1519=739%:%
%:%1520=739%:%
%:%1521=740%:%
%:%1522=740%:%
%:%1523=741%:%
%:%1524=742%:%
%:%1525=742%:%
%:%1526=743%:%
%:%1527=743%:%
%:%1528=744%:%
%:%1529=744%:%
%:%1530=745%:%
%:%1531=745%:%
%:%1532=746%:%
%:%1533=746%:%
%:%1534=747%:%
%:%1535=747%:%
%:%1536=748%:%
%:%1537=749%:%
%:%1538=749%:%
%:%1539=750%:%
%:%1540=750%:%
%:%1541=751%:%
%:%1542=751%:%
%:%1543=752%:%
%:%1544=752%:%
%:%1545=753%:%
%:%1546=753%:%
%:%1547=754%:%
%:%1548=754%:%
%:%1549=755%:%
%:%1550=756%:%
%:%1551=756%:%
%:%1552=757%:%
%:%1553=757%:%
%:%1554=758%:%
%:%1555=758%:%
%:%1556=759%:%
%:%1557=759%:%
%:%1558=760%:%
%:%1559=760%:%
%:%1560=761%:%
%:%1561=761%:%
%:%1562=762%:%
%:%1563=763%:%
%:%1564=763%:%
%:%1565=764%:%
%:%1566=764%:%
%:%1567=765%:%
%:%1568=765%:%
%:%1569=766%:%
%:%1570=766%:%
%:%1571=767%:%
%:%1572=768%:%
%:%1573=768%:%
%:%1574=769%:%
%:%1575=769%:%
%:%1576=770%:%
%:%1577=770%:%
%:%1578=771%:%
%:%1579=771%:%
%:%1580=772%:%
%:%1581=773%:%
%:%1582=773%:%
%:%1583=774%:%
%:%1584=774%:%
%:%1585=775%:%
%:%1586=776%:%
%:%1587=776%:%
%:%1588=777%:%
%:%1589=777%:%
%:%1590=778%:%
%:%1591=779%:%
%:%1592=779%:%
%:%1593=780%:%
%:%1594=780%:%
%:%1595=781%:%
%:%1596=781%:%
%:%1597=782%:%
%:%1598=782%:%
%:%1599=783%:%
%:%1600=784%:%
%:%1601=784%:%
%:%1602=785%:%
%:%1603=785%:%
%:%1604=786%:%
%:%1605=786%:%
%:%1606=787%:%
%:%1607=787%:%
%:%1608=788%:%
%:%1609=788%:%
%:%1610=789%:%
%:%1611=790%:%
%:%1612=790%:%
%:%1613=791%:%
%:%1614=791%:%
%:%1615=792%:%
%:%1616=792%:%
%:%1617=793%:%
%:%1618=793%:%
%:%1619=794%:%
%:%1620=795%:%
%:%1621=795%:%
%:%1622=796%:%
%:%1623=797%:%
%:%1624=797%:%
%:%1625=798%:%
%:%1626=798%:%
%:%1627=799%:%
%:%1628=799%:%
%:%1629=800%:%
%:%1630=801%:%
%:%1631=801%:%
%:%1632=802%:%
%:%1633=802%:%
%:%1634=803%:%
%:%1635=804%:%
%:%1636=804%:%
%:%1637=805%:%
%:%1638=805%:%
%:%1639=806%:%
%:%1640=806%:%
%:%1641=807%:%
%:%1642=807%:%
%:%1643=808%:%
%:%1644=808%:%
%:%1645=809%:%
%:%1646=809%:%
%:%1647=810%:%
%:%1648=811%:%
%:%1649=811%:%
%:%1650=812%:%
%:%1651=812%:%
%:%1652=813%:%
%:%1653=813%:%
%:%1654=814%:%
%:%1655=814%:%
%:%1656=815%:%
%:%1657=815%:%
%:%1658=816%:%
%:%1659=816%:%
%:%1660=817%:%
%:%1661=817%:%
%:%1662=818%:%
%:%1663=819%:%
%:%1664=819%:%
%:%1665=820%:%
%:%1666=820%:%
%:%1667=821%:%
%:%1668=821%:%
%:%1669=822%:%
%:%1670=822%:%
%:%1671=823%:%
%:%1672=823%:%
%:%1673=824%:%
%:%1674=824%:%
%:%1675=825%:%
%:%1676=825%:%
%:%1677=826%:%
%:%1678=827%:%
%:%1679=827%:%
%:%1680=828%:%
%:%1681=828%:%
%:%1682=829%:%
%:%1683=829%:%
%:%1684=830%:%
%:%1685=830%:%
%:%1686=831%:%
%:%1687=831%:%
%:%1688=832%:%
%:%1689=832%:%
%:%1690=833%:%
%:%1691=833%:%
%:%1692=834%:%
%:%1693=834%:%
%:%1694=835%:%
%:%1695=835%:%
%:%1696=836%:%
%:%1697=836%:%
%:%1698=837%:%
%:%1699=837%:%
%:%1700=838%:%
%:%1701=838%:%
%:%1702=839%:%
%:%1703=839%:%
%:%1704=840%:%
%:%1705=840%:%
%:%1706=841%:%
%:%1707=841%:%
%:%1708=842%:%
%:%1709=843%:%
%:%1710=843%:%
%:%1711=844%:%
%:%1712=844%:%
%:%1713=845%:%
%:%1714=845%:%
%:%1715=846%:%
%:%1716=846%:%
%:%1717=847%:%
%:%1718=847%:%
%:%1719=848%:%
%:%1720=848%:%
%:%1721=849%:%
%:%1722=849%:%
%:%1723=850%:%
%:%1724=850%:%
%:%1725=851%:%
%:%1726=852%:%
%:%1727=852%:%
%:%1728=853%:%
%:%1729=854%:%
%:%1730=854%:%
%:%1731=855%:%
%:%1732=855%:%
%:%1733=856%:%
%:%1734=856%:%
%:%1735=857%:%
%:%1736=857%:%
%:%1737=858%:%
%:%1738=858%:%
%:%1739=859%:%
%:%1740=860%:%
%:%1741=860%:%
%:%1742=861%:%
%:%1743=862%:%
%:%1744=862%:%
%:%1745=863%:%
%:%1746=863%:%
%:%1747=864%:%
%:%1748=864%:%
%:%1749=865%:%
%:%1750=865%:%
%:%1751=865%:%
%:%1752=866%:%
%:%1753=867%:%
%:%1754=867%:%
%:%1755=868%:%
%:%1756=869%:%
%:%1757=869%:%
%:%1758=870%:%
%:%1759=870%:%
%:%1760=871%:%
%:%1761=871%:%
%:%1762=872%:%
%:%1763=872%:%
%:%1764=873%:%
%:%1765=873%:%
%:%1766=874%:%
%:%1767=874%:%
%:%1768=875%:%
%:%1769=875%:%
%:%1770=876%:%
%:%1771=876%:%
%:%1772=877%:%
%:%1773=877%:%
%:%1774=878%:%
%:%1775=878%:%
%:%1776=879%:%
%:%1777=879%:%
%:%1778=880%:%
%:%1779=880%:%
%:%1780=881%:%
%:%1781=881%:%
%:%1782=882%:%
%:%1783=882%:%
%:%1784=883%:%
%:%1785=884%:%
%:%1786=884%:%
%:%1787=885%:%
%:%1788=885%:%
%:%1789=886%:%
%:%1790=886%:%
%:%1791=887%:%
%:%1792=887%:%
%:%1793=887%:%
%:%1794=888%:%
%:%1795=888%:%
%:%1796=889%:%
%:%1797=889%:%
%:%1798=890%:%
%:%1799=890%:%
%:%1800=891%:%
%:%1801=891%:%
%:%1802=892%:%
%:%1803=892%:%
%:%1804=893%:%
%:%1805=893%:%
%:%1806=894%:%
%:%1807=894%:%
%:%1808=895%:%
%:%1809=895%:%
%:%1810=896%:%
%:%1811=896%:%
%:%1812=897%:%
%:%1813=897%:%
%:%1814=898%:%
%:%1815=898%:%
%:%1816=899%:%
%:%1817=899%:%
%:%1818=899%:%
%:%1819=900%:%
%:%1820=900%:%
%:%1821=901%:%
%:%1822=901%:%
%:%1823=902%:%
%:%1824=902%:%
%:%1825=903%:%
%:%1826=903%:%
%:%1827=903%:%
%:%1828=903%:%
%:%1829=904%:%
%:%1835=904%:%
%:%1840=905%:%
%:%1845=906%:%
