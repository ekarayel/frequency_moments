%
\begin{isabellebody}%
\setisabellecontext{Divides}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{More on quotient and remainder%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Divides\isanewline
\isakeyword{imports}\ Parity\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{More on division%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{inductive}\isamarkupfalse%
\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}int\ {\isasymRightarrow}\ int\ {\isasymRightarrow}\ int\ {\isasymtimes}\ int\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}by{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ k\ {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}dividesI{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}l\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ k\ {\isacharequal}{\kern0pt}\ q\ {\isacharasterisk}{\kern0pt}\ l\ {\isasymLongrightarrow}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ k\ l\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}remainderI{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}sgn\ r\ {\isacharequal}{\kern0pt}\ sgn\ l\ {\isasymLongrightarrow}\ {\isasymbar}r{\isasymbar}\ {\isacharless}{\kern0pt}\ {\isasymbar}l{\isasymbar}\isanewline
\ \ \ \ \ \ {\isasymLongrightarrow}\ k\ {\isacharequal}{\kern0pt}\ q\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharplus}{\kern0pt}\ r\ {\isasymLongrightarrow}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ k\ l\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ \ \ \ \isanewline
\ \ {\isachardoublequoteopen}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ k\ l\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ \isanewline
\ \ \ \ k\ {\isacharequal}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ q\ {\isacharplus}{\kern0pt}\ r\ {\isasymand}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}if\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ l\ then\ {\isadigit{0}}\ {\isasymle}\ r\ {\isasymand}\ r\ {\isacharless}{\kern0pt}\ l\ else\ if\ l\ {\isacharless}{\kern0pt}\ {\isadigit{0}}\ then\ l\ {\isacharless}{\kern0pt}\ r\ {\isasymand}\ r\ {\isasymle}\ {\isadigit{0}}\ else\ q\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}r\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}auto\ elim{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isachardot}{\kern0pt}cases\ intro{\isacharcolon}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}by{\isadigit{0}}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}dividesI\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}remainderI\isanewline
\ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ ac{\isacharunderscore}{\kern0pt}simps\ sgn{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharunderscore}{\kern0pt}pos\ sgn{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharunderscore}{\kern0pt}neg{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ unique{\isacharunderscore}{\kern0pt}quotient{\isacharunderscore}{\kern0pt}lemma{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}b\ {\isacharasterisk}{\kern0pt}\ q{\isacharprime}{\kern0pt}\ {\isacharplus}{\kern0pt}\ r{\isacharprime}{\kern0pt}\ {\isasymle}\ b\ {\isacharasterisk}{\kern0pt}\ q\ {\isacharplus}{\kern0pt}\ r{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ r{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}r{\isacharprime}{\kern0pt}\ {\isacharless}{\kern0pt}\ b{\isachardoublequoteclose}\ {\isachardoublequoteopen}r\ {\isacharless}{\kern0pt}\ b{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}q{\isacharprime}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}q{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}r{\isacharprime}{\kern0pt}\ {\isacharplus}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}q{\isacharprime}{\kern0pt}{\isacharminus}{\kern0pt}q{\isacharparenright}{\kern0pt}\ {\isasymle}\ r{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}distrib{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ q\ {\isacharminus}{\kern0pt}\ q{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}distrib\ distrib{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isacharasterisk}{\kern0pt}\ q{\isacharprime}{\kern0pt}\ {\isacharless}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ q{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ right{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}distrib\ distrib{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}cancel{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ unique{\isacharunderscore}{\kern0pt}quotient{\isacharunderscore}{\kern0pt}lemma{\isacharunderscore}{\kern0pt}neg{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}b\ {\isacharasterisk}{\kern0pt}\ q{\isacharprime}{\kern0pt}\ {\isacharplus}{\kern0pt}\ r{\isacharprime}{\kern0pt}\ {\isasymle}\ b{\isacharasterisk}{\kern0pt}q\ {\isacharplus}{\kern0pt}\ r\ {\isasymLongrightarrow}\ r\ {\isasymle}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ b\ {\isacharless}{\kern0pt}\ r\ {\isasymLongrightarrow}\ b\ {\isacharless}{\kern0pt}\ r{\isacharprime}{\kern0pt}\ {\isasymLongrightarrow}\ q\ {\isasymle}\ {\isacharparenleft}{\kern0pt}q{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule{\isacharunderscore}{\kern0pt}tac\ b\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}b{\isachardoublequoteclose}\ \isakeyword{and}\ r\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}r{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ r{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}r{\isachardoublequoteclose}\ \isakeyword{in}\ unique{\isacharunderscore}{\kern0pt}quotient{\isacharunderscore}{\kern0pt}lemma{\isacharparenright}{\kern0pt}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ unique{\isacharunderscore}{\kern0pt}quotient{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ a\ b\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ a\ b\ {\isacharparenleft}{\kern0pt}q{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ r{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ q\ {\isacharequal}{\kern0pt}\ q{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}antisym{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}iff\ linorder{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}iff\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split{\isacharunderscore}{\kern0pt}asm{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}blast\ intro{\isacharcolon}{\kern0pt}\ order{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}refl\ {\isacharbrackleft}{\kern0pt}THEN\ unique{\isacharunderscore}{\kern0pt}quotient{\isacharunderscore}{\kern0pt}lemma{\isacharbrackright}{\kern0pt}\ order{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}refl\ {\isacharbrackleft}{\kern0pt}THEN\ unique{\isacharunderscore}{\kern0pt}quotient{\isacharunderscore}{\kern0pt}lemma{\isacharunderscore}{\kern0pt}neg{\isacharbrackright}{\kern0pt}\ sym{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ unique{\isacharunderscore}{\kern0pt}remainder{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ a\ b\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ a\ b\ {\isacharparenleft}{\kern0pt}q{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ r{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ r\ {\isacharequal}{\kern0pt}\ r{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subgoal{\isacharunderscore}{\kern0pt}tac\ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ q{\isacharprime}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}blast\ intro{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}quotient{\isacharparenright}{\kern0pt}\isanewline
\isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ k\ l\ {\isacharparenleft}{\kern0pt}k\ div\ l{\isacharcomma}{\kern0pt}\ k\ mod\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ k\ rule{\isacharcolon}{\kern0pt}\ int{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ zero\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}iff\ divide{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def\ modulo{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}pos\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}of\ n{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ l\ rule{\isacharcolon}{\kern0pt}\ int{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ del{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}mult\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}add\isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}greater{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}dvd\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}mult\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}add\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps\isanewline
\ \ \ \ \ \ \ \ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}iff\ divide{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def\ modulo{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}neg\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}of\ n{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ l\ rule{\isacharcolon}{\kern0pt}\ int{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp\ del{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}mult\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}add\isanewline
\ \ \ \ \ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}greater{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}dvd\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}mult\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}add\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps\isanewline
\ \ \ \ \ \ \ \ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}iff\ divide{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def\ modulo{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}unique{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ k\ l\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ div{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}unique{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}k\ div\ l\ {\isacharequal}{\kern0pt}\ q{\isachardoublequoteclose}\ \isakeyword{and}\ mod{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}unique{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}k\ mod\ l\ {\isacharequal}{\kern0pt}\ r{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ {\isacharbrackleft}{\kern0pt}of\ k\ l{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ unique{\isacharunderscore}{\kern0pt}quotient\ {\isacharbrackleft}{\kern0pt}of\ k\ l{\isacharbrackright}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}remainder\ {\isacharbrackleft}{\kern0pt}of\ k\ l{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}nat{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymbar}k{\isasymbar}\ div\ {\isasymbar}l{\isasymbar}\ {\isacharequal}{\kern0pt}\ int\ {\isacharparenleft}{\kern0pt}nat\ {\isasymbar}k{\isasymbar}\ div\ nat\ {\isasymbar}l{\isasymbar}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divide{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}nat{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymbar}k{\isasymbar}\ mod\ {\isasymbar}l{\isasymbar}\ {\isacharequal}{\kern0pt}\ int\ {\isacharparenleft}{\kern0pt}nat\ {\isasymbar}k{\isasymbar}\ mod\ nat\ {\isasymbar}l{\isasymbar}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ modulo{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zdiv{\isacharunderscore}{\kern0pt}int{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}int\ {\isacharparenleft}{\kern0pt}a\ div\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ int\ a\ div\ int\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divide{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zmod{\isacharunderscore}{\kern0pt}int{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}int\ {\isacharparenleft}{\kern0pt}a\ mod\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ int\ a\ mod\ int\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ modulo{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}sgn{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}cancel{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ k\ l\ v\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}v\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}sgn\ v\ {\isacharasterisk}{\kern0pt}\ {\isasymbar}k{\isasymbar}{\isacharparenright}{\kern0pt}\ div\ {\isacharparenleft}{\kern0pt}sgn\ v\ {\isacharasterisk}{\kern0pt}\ {\isasymbar}l{\isasymbar}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymbar}k{\isasymbar}\ div\ {\isasymbar}l{\isasymbar}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sgn\ v\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isasymor}\ sgn\ v\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}v\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ divide{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}sgn\ v\ {\isacharasterisk}{\kern0pt}\ {\isasymbar}k{\isasymbar}{\isachardoublequoteclose}\ {\isachardoublequoteopen}sgn\ v\ {\isacharasterisk}{\kern0pt}\ {\isasymbar}l{\isasymbar}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp\ add{\isacharcolon}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}less\ div{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}nat{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}sgn{\isacharunderscore}{\kern0pt}abs{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ k\ l\ v\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}sgn\ k\ {\isacharequal}{\kern0pt}\ sgn\ l{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\ div\ l\ {\isacharequal}{\kern0pt}\ {\isasymbar}k{\isasymbar}\ div\ {\isasymbar}l{\isasymbar}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}l\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ assms\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}sgn\ k\ {\isacharasterisk}{\kern0pt}\ {\isasymbar}k{\isasymbar}{\isacharparenright}{\kern0pt}\ div\ {\isacharparenleft}{\kern0pt}sgn\ l\ {\isacharasterisk}{\kern0pt}\ {\isasymbar}l{\isasymbar}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymbar}k{\isasymbar}\ div\ {\isasymbar}l{\isasymbar}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}sgn{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}cancel\ {\isacharbrackleft}{\kern0pt}of\ l\ k\ l{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ sgn{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}abs{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}dvd{\isacharunderscore}{\kern0pt}sgn{\isacharunderscore}{\kern0pt}abs{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ k\ l\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}l\ dvd\ k{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\ div\ l\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sgn\ k\ {\isacharasterisk}{\kern0pt}\ sgn\ l{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymbar}k{\isasymbar}\ div\ {\isasymbar}l{\isasymbar}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}k\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymor}\ l\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}l\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}sgn\ l\ {\isacharequal}{\kern0pt}\ sgn\ k{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}sgn{\isacharunderscore}{\kern0pt}abs{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}k\ {\isasymnoteq}\ {\isadigit{0}}{\isacartoucheclose}\ {\isacartoucheopen}l\ {\isasymnoteq}\ {\isadigit{0}}{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sgn\ l\ {\isacharasterisk}{\kern0pt}\ sgn\ k\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ sgn{\isacharunderscore}{\kern0pt}if\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}splits{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ assms\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ divide{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}of\ k\ l{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ zdiv{\isacharunderscore}{\kern0pt}int\ ac{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}noneq{\isacharunderscore}{\kern0pt}sgn{\isacharunderscore}{\kern0pt}abs{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ k\ l\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}l\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}sgn\ k\ {\isasymnoteq}\ sgn\ l{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\ div\ l\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymbar}k{\isasymbar}\ div\ {\isasymbar}l{\isasymbar}{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}{\isasymnot}\ l\ dvd\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ divide{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}of\ k\ l{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ auto\ simp\ add{\isacharcolon}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}less\ zdiv{\isacharunderscore}{\kern0pt}int{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Laws for div and mod with Unary Minus%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ zminus{\isadigit{1}}{\isacharunderscore}{\kern0pt}lemma{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ a\ b\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ b\ {\isasymnoteq}\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}a{\isacharparenright}{\kern0pt}\ b\ {\isacharparenleft}{\kern0pt}if\ r{\isacharequal}{\kern0pt}{\isadigit{0}}\ then\ {\isacharminus}{\kern0pt}q\ else\ {\isacharminus}{\kern0pt}q\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ r{\isacharequal}{\kern0pt}{\isadigit{0}}\ then\ {\isadigit{0}}\ else\ b{\isacharminus}{\kern0pt}r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}force\ simp\ add{\isacharcolon}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}iff\ right{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}distrib{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zdiv{\isacharunderscore}{\kern0pt}zminus{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}b\ {\isasymnoteq}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}a{\isacharparenright}{\kern0pt}\ div\ b\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ a\ mod\ b\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ b{\isacharparenright}{\kern0pt}\ else\ \ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ b{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}blast\ intro{\isacharcolon}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ {\isacharbrackleft}{\kern0pt}THEN\ zminus{\isadigit{1}}{\isacharunderscore}{\kern0pt}lemma{\isacharcomma}{\kern0pt}\ THEN\ div{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}unique{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zmod{\isacharunderscore}{\kern0pt}zminus{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ mod\ b\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ a\ mod\ b\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ {\isadigit{0}}\ else\ \ b\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ mod\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}b\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}blast\ intro{\isacharcolon}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ {\isacharbrackleft}{\kern0pt}THEN\ zminus{\isadigit{1}}{\isacharunderscore}{\kern0pt}lemma{\isacharcomma}{\kern0pt}\ THEN\ mod{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}unique{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zmod{\isacharunderscore}{\kern0pt}zminus{\isadigit{1}}{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}zero{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ k\ l\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ k\ mod\ l\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ k\ mod\ l\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}dvd{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zmod{\isacharunderscore}{\kern0pt}zminus{\isadigit{2}}{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}zero{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ k\ l\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\ mod\ {\isacharminus}{\kern0pt}\ l\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ k\ mod\ l\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}dvd{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zdiv{\isacharunderscore}{\kern0pt}zminus{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}b\ {\isasymnoteq}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ a\ div\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}if\ a\ mod\ b\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ b{\isacharparenright}{\kern0pt}\ else\ \ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ b{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ zdiv{\isacharunderscore}{\kern0pt}zminus{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if\ div{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zmod{\isacharunderscore}{\kern0pt}zminus{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}a\ mod\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}b{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ a\ mod\ b\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ {\isadigit{0}}\ else\ \ {\isacharparenleft}{\kern0pt}a\ mod\ b{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ zmod{\isacharunderscore}{\kern0pt}zminus{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if\ mod{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Monotonicity in the First Argument (Dividend)%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ zdiv{\isacharunderscore}{\kern0pt}mono{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ b{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isasymle}\ a{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}a\ div\ b\ {\isasymle}\ a{\isacharprime}{\kern0pt}\ div\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ unique{\isacharunderscore}{\kern0pt}quotient{\isacharunderscore}{\kern0pt}lemma{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ b{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ a\ mod\ b\ {\isasymle}\ b\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharprime}{\kern0pt}\ div\ b{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ a{\isacharprime}{\kern0pt}\ mod\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}use\ assms\ \isakeyword{in}\ auto{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zdiv{\isacharunderscore}{\kern0pt}mono{\isadigit{1}}{\isacharunderscore}{\kern0pt}neg{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ b{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isasymle}\ a{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}a{\isacharprime}{\kern0pt}\ div\ b\ {\isasymle}\ a\ div\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ unique{\isacharunderscore}{\kern0pt}quotient{\isacharunderscore}{\kern0pt}lemma{\isacharunderscore}{\kern0pt}neg{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ b{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ a\ mod\ b\ {\isasymle}\ b\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharprime}{\kern0pt}\ div\ b{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ a{\isacharprime}{\kern0pt}\ mod\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}use\ assms\ \isakeyword{in}\ auto{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Monotonicity in the Second Argument (Divisor)%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ q{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}lemma{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ q{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ b{\isacharprime}{\kern0pt}{\isacharasterisk}{\kern0pt}q{\isacharprime}{\kern0pt}\ {\isacharplus}{\kern0pt}\ r{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}r{\isacharprime}{\kern0pt}\ {\isacharless}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ q{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}q{\isacharprime}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ distrib{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ assms\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zdiv{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}{\isacharunderscore}{\kern0pt}lemma{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ q{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int\isanewline
\ \ \isakeyword{assumes}\ eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b{\isacharasterisk}{\kern0pt}q\ {\isacharplus}{\kern0pt}\ r\ {\isacharequal}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharasterisk}{\kern0pt}q{\isacharprime}{\kern0pt}\ {\isacharplus}{\kern0pt}\ r{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ le{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ b{\isacharprime}{\kern0pt}{\isacharasterisk}{\kern0pt}q{\isacharprime}{\kern0pt}\ {\isacharplus}{\kern0pt}\ r{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}r{\isacharprime}{\kern0pt}\ {\isacharless}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ r{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}b{\isacharprime}{\kern0pt}\ {\isasymle}\ b{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}q\ {\isasymle}\ q{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ q{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ q{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}lemma\ le\ {\isacartoucheopen}r{\isacharprime}{\kern0pt}\ {\isacharless}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacartoucheclose}\ {\isacartoucheopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b{\isacharasterisk}{\kern0pt}q\ {\isacharequal}{\kern0pt}\ r{\isacharprime}{\kern0pt}\ {\isacharminus}{\kern0pt}\ r\ {\isacharplus}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharasterisk}{\kern0pt}q{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ eq\ \isacommand{by}\isamarkupfalse%
\ linarith\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b{\isacharasterisk}{\kern0pt}q\ {\isacharless}{\kern0pt}\ b{\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}q{\isacharprime}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ mult{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ distrib{\isacharunderscore}{\kern0pt}left\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ assms\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}cancel{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}pos{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zdiv{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ a{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}b{\isacharprime}{\kern0pt}\ {\isasymle}\ b{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}a\ div\ b\ {\isasymle}\ a\ div\ b{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ zdiv{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}{\isacharunderscore}{\kern0pt}lemma{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ linarith\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ b{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ a\ mod\ b\ {\isacharequal}{\kern0pt}\ b{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ b{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ a\ mod\ b{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}use\ assms\ \isakeyword{in}\ auto{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zdiv{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}lemma{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ \isakeyword{fixes}\ q{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int\isanewline
\ \ \ \ \isakeyword{assumes}\ {\isachardoublequoteopen}b{\isacharasterisk}{\kern0pt}q\ {\isacharplus}{\kern0pt}\ r\ {\isacharequal}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharasterisk}{\kern0pt}q{\isacharprime}{\kern0pt}\ {\isacharplus}{\kern0pt}\ r{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}b{\isacharprime}{\kern0pt}{\isacharasterisk}{\kern0pt}q{\isacharprime}{\kern0pt}\ {\isacharplus}{\kern0pt}\ r{\isacharprime}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}r\ {\isacharless}{\kern0pt}\ b{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ r{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}b{\isacharprime}{\kern0pt}\ {\isasymle}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{shows}\ {\isachardoublequoteopen}q{\isacharprime}{\kern0pt}\ {\isasymle}\ q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b{\isacharprime}{\kern0pt}{\isacharasterisk}{\kern0pt}q{\isacharprime}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ linarith\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ assms\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}q{\isacharprime}{\kern0pt}\ {\isasymle}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b{\isacharasterisk}{\kern0pt}q{\isacharprime}{\kern0pt}\ {\isasymle}\ b{\isacharprime}{\kern0pt}{\isacharasterisk}{\kern0pt}q{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isacartoucheopen}q{\isacharprime}{\kern0pt}\ {\isasymle}\ {\isadigit{0}}{\isacartoucheclose}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}neg{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b{\isacharasterisk}{\kern0pt}q{\isacharprime}{\kern0pt}\ {\isacharless}{\kern0pt}\ b{\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}q\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ distrib{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}cancel{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zdiv{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}{\isacharunderscore}{\kern0pt}neg{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}b{\isacharprime}{\kern0pt}\ {\isasymle}\ b{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}a\ div\ b{\isacharprime}{\kern0pt}\ {\isasymle}\ a\ div\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ zdiv{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}lemma{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ linarith\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ b{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ a\ mod\ b\ {\isacharequal}{\kern0pt}\ b{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ b{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ a\ mod\ b{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}use\ assms\ \isakeyword{in}\ auto{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}geq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ k\ l\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ l{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}l\ {\isasymle}\ k{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\ div\ l\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}\ div\ l\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ l{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ j\ \isakeyword{where}\ k{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}k\ {\isacharequal}{\kern0pt}\ j\ {\isacharplus}{\kern0pt}\ l{\isachardoublequoteclose}\ \isacommand{{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ assms\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}self{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}geq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ k\ l\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ l{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}l\ {\isasymle}\ k{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\ mod\ l\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}\ mod\ l{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ l{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ j\ \isakeyword{where}\ k{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}k\ {\isacharequal}{\kern0pt}\ j\ {\isacharplus}{\kern0pt}\ l{\isachardoublequoteclose}\ \isacommand{{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ assms\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Splitting Rules for div and mod%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The proofs of the two lemmas below are essentially identical%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}lemma{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}{\isadigit{0}}{\isacharless}{\kern0pt}k\ {\isasymLongrightarrow}\isanewline
\ \ \ \ P{\isacharparenleft}{\kern0pt}n\ div\ k\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}n\ mod\ k{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i\ j{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isasymle}j\ {\isasymand}\ j{\isacharless}{\kern0pt}k\ {\isasymand}\ n\ {\isacharequal}{\kern0pt}\ k{\isacharasterisk}{\kern0pt}i\ {\isacharplus}{\kern0pt}\ j\ {\isasymlongrightarrow}\ P\ i\ j{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}lemma{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}k{\isacharless}{\kern0pt}{\isadigit{0}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ P{\isacharparenleft}{\kern0pt}n\ div\ k\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isacharparenleft}{\kern0pt}n\ mod\ k{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i\ j{\isachardot}{\kern0pt}\ k{\isacharless}{\kern0pt}j\ {\isasymand}\ j{\isasymle}{\isadigit{0}}\ {\isasymand}\ n\ {\isacharequal}{\kern0pt}\ k{\isacharasterisk}{\kern0pt}i\ {\isacharplus}{\kern0pt}\ j\ {\isasymlongrightarrow}\ P\ i\ j{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}zdiv{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}P{\isacharparenleft}{\kern0pt}n\ div\ k\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}k\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymlongrightarrow}\ P\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}k\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i\ j{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isasymle}j\ {\isasymand}\ j{\isacharless}{\kern0pt}k\ {\isasymand}\ n\ {\isacharequal}{\kern0pt}\ k{\isacharasterisk}{\kern0pt}i\ {\isacharplus}{\kern0pt}\ j\ {\isasymlongrightarrow}\ P\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ {\isacharparenleft}{\kern0pt}k{\isacharless}{\kern0pt}{\isadigit{0}}\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i\ j{\isachardot}{\kern0pt}\ k{\isacharless}{\kern0pt}j\ {\isasymand}\ j{\isasymle}{\isadigit{0}}\ {\isasymand}\ n\ {\isacharequal}{\kern0pt}\ k{\isacharasterisk}{\kern0pt}i\ {\isacharplus}{\kern0pt}\ j\ {\isasymlongrightarrow}\ P\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}k\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ linorder{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}iff\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}lemma\ {\isacharbrackleft}{\kern0pt}of\ concl{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}x\ y{\isachardot}{\kern0pt}\ P\ x{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}lemma\ {\isacharbrackleft}{\kern0pt}of\ concl{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}x\ y{\isachardot}{\kern0pt}\ P\ x{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}zmod{\isacharcolon}{\kern0pt}\isanewline
\ {\isachardoublequoteopen}P{\isacharparenleft}{\kern0pt}n\ mod\ k\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}k\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymlongrightarrow}\ P\ n{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}k\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i\ j{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isasymle}j\ {\isasymand}\ j{\isacharless}{\kern0pt}k\ {\isasymand}\ n\ {\isacharequal}{\kern0pt}\ k{\isacharasterisk}{\kern0pt}i\ {\isacharplus}{\kern0pt}\ j\ {\isasymlongrightarrow}\ P\ j{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ {\isacharparenleft}{\kern0pt}k{\isacharless}{\kern0pt}{\isadigit{0}}\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i\ j{\isachardot}{\kern0pt}\ k{\isacharless}{\kern0pt}j\ {\isasymand}\ j{\isasymle}{\isadigit{0}}\ {\isasymand}\ n\ {\isacharequal}{\kern0pt}\ k{\isacharasterisk}{\kern0pt}i\ {\isacharplus}{\kern0pt}\ j\ {\isasymlongrightarrow}\ P\ j{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}k\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ linorder{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}iff\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}lemma\ {\isacharbrackleft}{\kern0pt}of\ concl{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}x\ y{\isachardot}{\kern0pt}\ P\ y{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}lemma\ {\isacharbrackleft}{\kern0pt}of\ concl{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}x\ y{\isachardot}{\kern0pt}\ P\ y{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Enable (lin)arith to deal with \isa{{\isacharparenleft}{\kern0pt}div{\isacharparenright}{\kern0pt}} and \isa{{\isacharparenleft}{\kern0pt}mod{\isacharparenright}{\kern0pt}}
  when these are applied to some constant that is of the form
  \isa{numeral\ k}:%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{declare}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}zdiv\ {\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}numeral\ k{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ arith{\isacharunderscore}{\kern0pt}split{\isacharbrackright}{\kern0pt}\ \isakeyword{for}\ k\isanewline
\isacommand{declare}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}zmod\ {\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}numeral\ k{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ arith{\isacharunderscore}{\kern0pt}split{\isacharbrackright}{\kern0pt}\ \isakeyword{for}\ k%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Computing \isa{div} and \isa{mod} with shifting%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ pos{\isacharunderscore}{\kern0pt}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ b{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ a\ b\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}b{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ neg{\isacharunderscore}{\kern0pt}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}b\ {\isasymle}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ b\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}b{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}r\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
computing div by shifting%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ pos{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ {\isasymle}\ a\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}b{\isacharparenright}{\kern0pt}\ div\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ b\ div\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ pos{\isacharunderscore}{\kern0pt}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ {\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ div{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ neg{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ A{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}b{\isacharparenright}{\kern0pt}\ div\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ div\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ neg{\isacharunderscore}{\kern0pt}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ {\isacharbrackleft}{\kern0pt}OF\ A\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ div{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zdiv{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}Bit{\isadigit{0}}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ v{\isacharparenright}{\kern0pt}\ div\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ w{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ numeral\ v\ div\ {\isacharparenleft}{\kern0pt}numeral\ w\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ numeral{\isachardot}{\kern0pt}simps\ \isacommand{unfolding}\isamarkupfalse%
\ mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ div{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}mult{\isadigit{1}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zdiv{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}Bit{\isadigit{1}}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ v{\isacharparenright}{\kern0pt}\ div\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ w{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}numeral\ v\ div\ {\isacharparenleft}{\kern0pt}numeral\ w\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ numeral{\isachardot}{\kern0pt}simps\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ add{\isachardot}{\kern0pt}commute\ {\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isadigit{1}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ pos{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ pos{\isacharunderscore}{\kern0pt}zmod{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ a\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ a{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b\ mod\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ pos{\isacharunderscore}{\kern0pt}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ {\isacharbrackleft}{\kern0pt}OF\ assms\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mod{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ neg{\isacharunderscore}{\kern0pt}zmod{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ a\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isasymle}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}b\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ mod\ a{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ neg{\isacharunderscore}{\kern0pt}eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ {\isacharbrackleft}{\kern0pt}OF\ assms\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mod{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}unique{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zmod{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}Bit{\isadigit{0}}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ v{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ w{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ v\ mod\ numeral\ w{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ numeral{\isacharunderscore}{\kern0pt}Bit{\isadigit{0}}\ {\isacharbrackleft}{\kern0pt}of\ v{\isacharbrackright}{\kern0pt}\ numeral{\isacharunderscore}{\kern0pt}Bit{\isadigit{0}}\ {\isacharbrackleft}{\kern0pt}of\ w{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mod{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}mult{\isadigit{1}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zmod{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}Bit{\isadigit{1}}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ v{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ w{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ v\ mod\ numeral\ w{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ numeral{\isacharunderscore}{\kern0pt}Bit{\isadigit{1}}\ {\isacharbrackleft}{\kern0pt}of\ v{\isacharbrackright}{\kern0pt}\ numeral{\isacharunderscore}{\kern0pt}Bit{\isadigit{0}}\ {\isacharbrackleft}{\kern0pt}of\ w{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ add{\isachardot}{\kern0pt}commute\ {\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isadigit{1}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ pos{\isacharunderscore}{\kern0pt}zmod{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zdiv{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}i\ div\ k\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ k\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymor}\ {\isadigit{0}}\ {\isasymle}\ i\ {\isasymand}\ i\ {\isacharless}{\kern0pt}\ k\ {\isasymor}\ i\ {\isasymle}\ {\isadigit{0}}\ {\isasymand}\ k\ {\isacharless}{\kern0pt}\ i{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}L\ {\isacharequal}{\kern0pt}\ {\isacharquery}{\kern0pt}R{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{for}\ i\ k\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}L\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}L\ {\isasymlongrightarrow}\ {\isacharquery}{\kern0pt}R{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ split{\isacharunderscore}{\kern0pt}zdiv\ {\isacharbrackleft}{\kern0pt}THEN\ iffD{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ simp\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}R\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}R\ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}L\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zmod{\isacharunderscore}{\kern0pt}trivial{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ i\ k\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}i\ mod\ k\ {\isacharequal}{\kern0pt}\ i\ {\isasymlongleftrightarrow}\ k\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymor}\ {\isadigit{0}}\ {\isasymle}\ i\ {\isasymand}\ i\ {\isacharless}{\kern0pt}\ k\ {\isasymor}\ i\ {\isasymle}\ {\isadigit{0}}\ {\isasymand}\ k\ {\isacharless}{\kern0pt}\ i{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}i\ mod\ k\ {\isacharequal}{\kern0pt}\ i\ {\isasymlongleftrightarrow}\ i\ div\ k\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ safe\ {\isacharparenleft}{\kern0pt}insert\ div{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}of\ i\ k{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ zdiv{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Quotients of Signs%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}minus{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ div\ b\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isakeyword{for}\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divide{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zmod{\isacharunderscore}{\kern0pt}minus{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ mod\ b\ {\isacharequal}{\kern0pt}\ b\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isakeyword{for}\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ modulo{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ minus{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isacartoucheopen}{\isacharminus}{\kern0pt}\ k\ mod\ l\ {\isacharequal}{\kern0pt}\ l\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ mod\ l{\isacartoucheclose}\ \isakeyword{if}\ {\isacartoucheopen}l\ {\isasymge}\ {\isadigit{0}}{\isacartoucheclose}\ \isakeyword{for}\ k\ l\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isacartoucheopen}l\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isacartoucheclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ that\ \isacommand{have}\isamarkupfalse%
\ {\isacartoucheopen}l\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isacartoucheopen}l\ dvd\ k{\isacartoucheclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ j\ \isakeyword{where}\ {\isacartoucheopen}k\ {\isacharequal}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ j{\isacartoucheclose}\ \isacommand{{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isacartoucheopen}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\ j\ mod\ l\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ mod\ l\ {\isacharequal}{\kern0pt}\ l\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}l\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ zmod{\isacharunderscore}{\kern0pt}minus{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isacartoucheopen}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\ j\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ mod\ l\ {\isacharequal}{\kern0pt}\ l\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isacartoucheopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ k\ mod\ l{\isacartoucheclose}\ {\isacartoucheopen}k\ mod\ l\ {\isacharless}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ l{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ l{\isacartoucheclose}\ le{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}less\ False\ \isacommand{apply}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ le{\isacharunderscore}{\kern0pt}less\ \isacommand{apply}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ pos{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}bound\ {\isacharbrackleft}{\kern0pt}of\ l\ k{\isacharbrackright}{\kern0pt}\ \isacommand{apply}\isamarkupfalse%
\ linarith\ \isanewline
\ \ \ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}l\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ {\isacartoucheopen}{\isacharparenleft}{\kern0pt}k\ mod\ l\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ mod\ l\ {\isacharequal}{\kern0pt}\ k\ mod\ l\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ zmod{\isacharunderscore}{\kern0pt}trivial{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ zmod{\isacharunderscore}{\kern0pt}zminus{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}dvd\ algebra{\isacharunderscore}{\kern0pt}simps\ mod{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}less{\isadigit{0}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}a\ div\ b\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ div\ b\ {\isasymle}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ div\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ zdiv{\isacharunderscore}{\kern0pt}mono{\isadigit{1}}\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isacharminus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}minus{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}le{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbrackleft}{\kern0pt}{\isacharbar}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ {\isasymle}\ a{\isacharsemicolon}{\kern0pt}\ b\ {\isacharless}{\kern0pt}\ {\isadigit{0}}\ {\isacharbar}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ a\ div\ b\ {\isasymle}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}drule\ zdiv{\isacharunderscore}{\kern0pt}mono{\isadigit{1}}{\isacharunderscore}{\kern0pt}neg{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}nonpos{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}le{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbrackleft}{\kern0pt}{\isacharbar}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{0}}{\isacharsemicolon}{\kern0pt}\ b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isacharbar}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ a\ div\ b\ {\isasymle}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}drule\ zdiv{\isacharunderscore}{\kern0pt}mono{\isadigit{1}}{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Now for some equivalences of the form \isa{a\ div\ b\ {\isachargreater}{\kern0pt}{\isacharequal}{\kern0pt}{\isacharless}{\kern0pt}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ {\isasymdots}}
conditional upon the sign of \isa{a} or \isa{b}. There are many more.
They should all be simp rules unless that causes too much search.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ pos{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeyword{fixes}\ a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int\isanewline
\ \ \ \ \ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{0}}\ {\isasymle}\ a\ div\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}\ {\isasymle}\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ a\ div\ b\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isasymle}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}less\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}blast\ intro{\isacharcolon}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}less{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ a{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ div\ b\ {\isasymle}\ a\ div\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ zdiv{\isacharunderscore}{\kern0pt}mono{\isadigit{1}}\ assms\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ a\ div\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ pos{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isadigit{0}}{\isacharless}{\kern0pt}k\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}i{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ div\ k\ {\isasymlongleftrightarrow}\ k\ {\isasymle}\ i{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ pos{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}of\ k\ i{\isacharbrackright}{\kern0pt}\ zdiv{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}of\ i\ k{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ arith%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ neg{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}b\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{0}}\ {\isasymle}\ a\ div\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ {\isasymle}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}minus\ {\isacharbrackleft}{\kern0pt}of\ a{\isacharcomma}{\kern0pt}\ symmetric{\isacharbrackright}{\kern0pt}\ pos{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}iff\ del{\isacharcolon}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}minus{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ pos{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ b\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ b\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ pos{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ neg{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ b\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ neg{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nonneg{\isadigit{1}}{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ a{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}a\ div\ b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ a\ {\isasymge}\ b\ {\isasymand}\ b{\isachargreater}{\kern0pt}{\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ a\ div\ b\ {\isasymLongrightarrow}\ b\ {\isasymle}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}trivial{\isacharbrackleft}{\kern0pt}of\ a\ b{\isacharbrackright}{\kern0pt}\ assms\ \isacommand{by}\isamarkupfalse%
\ arith\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ a\ div\ b\ {\isasymLongrightarrow}\ b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ div{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}le{\isadigit{0}}{\isacharbrackleft}{\kern0pt}of\ a\ b{\isacharbrackright}{\kern0pt}\ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}b{\isacharequal}{\kern0pt}{\isadigit{0}}{\isachardoublequoteclose}{\isacharsemicolon}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isasymle}\ a\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ a\ div\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ int{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}less{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}a\ div\ b{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ zdiv{\isacharunderscore}{\kern0pt}mono{\isadigit{1}}{\isacharbrackleft}{\kern0pt}of\ b\ a\ b{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zmod{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}dividend{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}m{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ m\ mod\ k\ {\isasymle}\ m{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ split{\isacharunderscore}{\kern0pt}zmod{\isacharbrackleft}{\kern0pt}THEN\ iffD{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fastforce\ dest{\isacharcolon}{\kern0pt}\ q{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}lemma\ intro{\isacharcolon}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Further properties%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}k\ div\ l\ {\isasymge}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ k\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymor}\ l\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymor}\ k\ {\isasymge}\ {\isadigit{0}}\ {\isasymand}\ l\ {\isasymge}\ {\isadigit{0}}\isanewline
\ \ \ \ {\isasymor}\ k\ {\isacharless}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ l\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{for}\ k\ l\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}k\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymor}\ l\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ pos{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}iff\ neg{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ neg{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}iff\ not{\isacharunderscore}{\kern0pt}le\ not{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}or{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}k\ mod\ l\ {\isasymge}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ l\ dvd\ k\ {\isasymor}\ l\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ k\ {\isasymge}\ {\isadigit{0}}\ {\isasymor}\ l\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{for}\ k\ l\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}l\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ dvd{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}use\ neg{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}sign\ {\isacharbrackleft}{\kern0pt}of\ l\ k{\isacharbrackright}{\kern0pt}\ \isakeyword{in}\ {\isacartoucheopen}auto\ simp\ add{\isacharcolon}{\kern0pt}\ le{\isacharunderscore}{\kern0pt}less\ not{\isacharunderscore}{\kern0pt}less{\isacartoucheclose}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Simplify expressions in which div and mod combine numerical constants%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ int{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}{\isacharparenleft}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ q\ {\isacharplus}{\kern0pt}\ r{\isacharsemicolon}{\kern0pt}\ {\isadigit{0}}\ {\isasymle}\ r{\isacharsemicolon}{\kern0pt}\ r\ {\isacharless}{\kern0pt}\ b{\isasymrbrakk}\ {\isasymLongrightarrow}\ a\ div\ b\ {\isacharequal}{\kern0pt}\ q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ div{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}unique\ {\isacharbrackleft}{\kern0pt}of\ a\ b\ q\ r{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ int{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}{\isacharparenleft}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ q\ {\isacharplus}{\kern0pt}\ r{\isacharsemicolon}{\kern0pt}\ r\ {\isasymle}\ {\isadigit{0}}{\isacharsemicolon}{\kern0pt}\ b\ {\isacharless}{\kern0pt}\ r{\isasymrbrakk}\ {\isasymLongrightarrow}\ a\ div\ b\ {\isacharequal}{\kern0pt}\ q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ div{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}unique\ {\isacharbrackleft}{\kern0pt}of\ a\ b\ q\ r{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ int{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}{\isacharparenleft}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ q\ {\isacharplus}{\kern0pt}\ r{\isacharsemicolon}{\kern0pt}\ {\isadigit{0}}\ {\isasymle}\ r{\isacharsemicolon}{\kern0pt}\ r\ {\isacharless}{\kern0pt}\ b{\isasymrbrakk}\ {\isasymLongrightarrow}\ a\ mod\ b\ {\isacharequal}{\kern0pt}\ r{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mod{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}unique\ {\isacharbrackleft}{\kern0pt}of\ a\ b\ q\ r{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ int{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}{\isacharparenleft}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ q\ {\isacharplus}{\kern0pt}\ r{\isacharsemicolon}{\kern0pt}\ r\ {\isasymle}\ {\isadigit{0}}{\isacharsemicolon}{\kern0pt}\ b\ {\isacharless}{\kern0pt}\ r{\isasymrbrakk}\ {\isasymLongrightarrow}\ a\ mod\ b\ {\isacharequal}{\kern0pt}\ r{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mod{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}unique\ {\isacharbrackleft}{\kern0pt}of\ a\ b\ q\ r{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ simp\ add{\isacharcolon}{\kern0pt}\ eucl{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ abs{\isacharunderscore}{\kern0pt}div{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}y{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ dvd\ x\ {\isasymLongrightarrow}\ {\isasymbar}x\ div\ y{\isasymbar}\ {\isacharequal}{\kern0pt}\ {\isasymbar}x{\isasymbar}\ div\ {\isasymbar}y{\isasymbar}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ dvd{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}y{\isacharequal}{\kern0pt}{\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ abs{\isacharunderscore}{\kern0pt}mult{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Suggested by Matthias Daum%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ int{\isacharunderscore}{\kern0pt}power{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}base{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ k\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ m{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ k{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}k\ {\isacharcircum}{\kern0pt}\ m\ div\ k\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}m\ {\isacharminus}{\kern0pt}\ Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}k\ {\isacharcircum}{\kern0pt}\ m\ {\isacharequal}{\kern0pt}\ k\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}m\ {\isacharminus}{\kern0pt}\ Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ power{\isacharunderscore}{\kern0pt}add\ eq{\isacharparenright}{\kern0pt}\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Suggested by Matthias Daum%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ int{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}self{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ x{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ x{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{1}}\ {\isacharless}{\kern0pt}\ k{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}x\ div\ k\ {\isacharless}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}nat\ x\ div\ nat\ k\ {\isacharless}{\kern0pt}\ nat\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ assms\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ nat{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}distrib\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}dvd{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}nat{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}m\ mod\ q\ {\isacharequal}{\kern0pt}\ n\ mod\ q\ {\isasymlongleftrightarrow}\ q\ dvd\ m\ {\isacharminus}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeyword{if}\ {\isachardoublequoteopen}m\ {\isasymge}\ n{\isachardoublequoteclose}\ \isakeyword{for}\ m\ n\ q\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}int\ m\ mod\ int\ q\ {\isacharequal}{\kern0pt}\ int\ n\ mod\ int\ q\ {\isasymlongleftrightarrow}\ int\ q\ dvd\ int\ m\ {\isacharminus}{\kern0pt}\ int\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}dvd{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ that\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}int\ {\isacharparenleft}{\kern0pt}m\ mod\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ int\ {\isacharparenleft}{\kern0pt}n\ mod\ q{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ int\ q\ dvd\ int\ {\isacharparenleft}{\kern0pt}m\ {\isacharminus}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}mod\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}diff{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}nat{\isadigit{1}}E{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ m\ n\ q\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}m\ mod\ q\ {\isacharequal}{\kern0pt}\ n\ mod\ q{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}m\ {\isasymge}\ n{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{obtains}\ s\ \isakeyword{where}\ {\isachardoublequoteopen}m\ {\isacharequal}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ q\ {\isacharasterisk}{\kern0pt}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}q\ dvd\ m\ {\isacharminus}{\kern0pt}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}dvd{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}nat{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ s\ \isakeyword{where}\ {\isachardoublequoteopen}m\ {\isacharminus}{\kern0pt}\ n\ {\isacharequal}{\kern0pt}\ q\ {\isacharasterisk}{\kern0pt}\ s{\isachardoublequoteclose}\ \isacommand{{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}m\ {\isasymge}\ n{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}m\ {\isacharequal}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ q\ {\isacharasterisk}{\kern0pt}\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ that\ \isacommand{show}\isamarkupfalse%
\ thesis\ \isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}nat{\isadigit{2}}E{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ m\ n\ q\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}m\ mod\ q\ {\isacharequal}{\kern0pt}\ n\ mod\ q{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}n\ {\isasymge}\ m{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{obtains}\ s\ \isakeyword{where}\ {\isachardoublequoteopen}n\ {\isacharequal}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ q\ {\isacharasterisk}{\kern0pt}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}nat{\isadigit{1}}E\ {\isacharbrackleft}{\kern0pt}of\ n\ q\ m{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ ac{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}lemma{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ mod\ n\ {\isacharequal}{\kern0pt}\ y\ mod\ n{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}y\ {\isasymle}\ x{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}q{\isachardot}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ y\ {\isacharplus}{\kern0pt}\ n\ {\isacharasterisk}{\kern0pt}\ q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}nat{\isadigit{1}}E{\isacharparenright}{\kern0pt}\ rule%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ mod\ n\ {\isacharequal}{\kern0pt}\ y\ mod\ n\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymexists}q{\isadigit{1}}\ q{\isadigit{2}}{\isachardot}{\kern0pt}\ x\ {\isacharplus}{\kern0pt}\ n\ {\isacharasterisk}{\kern0pt}\ q{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ y\ {\isacharplus}{\kern0pt}\ n\ {\isacharasterisk}{\kern0pt}\ q{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}lhs\ {\isacharequal}{\kern0pt}\ {\isacharquery}{\kern0pt}rhs{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ H{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ mod\ n\ {\isacharequal}{\kern0pt}\ y\ mod\ n{\isachardoublequoteclose}\isanewline
\ \ \isacommand{{\isacharbraceleft}{\kern0pt}}\isamarkupfalse%
\isacommand{assume}\isamarkupfalse%
\ xy{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymle}\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ H\ \isacommand{have}\isamarkupfalse%
\ th{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ mod\ n\ {\isacharequal}{\kern0pt}\ x\ mod\ n{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}lemma{\isacharbrackleft}{\kern0pt}OF\ th\ xy{\isacharbrackright}{\kern0pt}\ \isacommand{have}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}rhs\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ clarify\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule{\isacharunderscore}{\kern0pt}tac\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}q{\isachardoublequoteclose}\ \isakeyword{in}\ exI{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ exI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{0}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isacommand{{\isacharbraceright}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \isacommand{{\isacharbraceleft}{\kern0pt}}\isamarkupfalse%
\isacommand{assume}\isamarkupfalse%
\ xy{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymle}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}lemma{\isacharbrackleft}{\kern0pt}OF\ H\ xy{\isacharbrackright}{\kern0pt}\ \isacommand{have}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}rhs\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ clarify\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule{\isacharunderscore}{\kern0pt}tac\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{in}\ exI{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule{\isacharunderscore}{\kern0pt}tac\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}q{\isachardoublequoteclose}\ \isakeyword{in}\ exI{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isacommand{{\isacharbraceright}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}rhs\ \isacommand{using}\isamarkupfalse%
\ linear{\isacharbrackleft}{\kern0pt}of\ x\ y{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}rhs\ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ q{\isadigit{1}}\ q{\isadigit{2}}\ \isakeyword{where}\ q{\isadigit{1}}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharplus}{\kern0pt}\ n\ {\isacharasterisk}{\kern0pt}\ q{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ y\ {\isacharplus}{\kern0pt}\ n\ {\isacharasterisk}{\kern0pt}\ q{\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x\ {\isacharplus}{\kern0pt}\ n\ {\isacharasterisk}{\kern0pt}\ q{\isadigit{1}}{\isacharparenright}{\kern0pt}\ mod\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}y\ {\isacharplus}{\kern0pt}\ n\ {\isacharasterisk}{\kern0pt}\ q{\isadigit{2}}{\isacharparenright}{\kern0pt}\ mod\ n{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ \ {\isacharquery}{\kern0pt}lhs\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Numeral division with a pragmatic type class%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The following type class contains everything necessary to formulate
  a division algorithm in ring structures with numerals, restricted
  to its positive segments.  This is its primary motivation, and it
  could surely be formulated using a more fine-grained, more algebraic
  and less technical class hierarchy.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{class}\isamarkupfalse%
\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral\ {\isacharequal}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}with{\isacharunderscore}{\kern0pt}nat\ {\isacharplus}{\kern0pt}\ linordered{\isacharunderscore}{\kern0pt}semidom\ {\isacharplus}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ div{\isacharunderscore}{\kern0pt}less{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ a\ {\isasymLongrightarrow}\ a\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ a\ div\ b\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ mod{\isacharunderscore}{\kern0pt}less{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ {\isadigit{0}}\ {\isasymle}\ a\ {\isasymLongrightarrow}\ a\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ a\ mod\ b\ {\isacharequal}{\kern0pt}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ div{\isacharunderscore}{\kern0pt}positive{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ b\ {\isasymle}\ a\ {\isasymLongrightarrow}\ a\ div\ b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ mod{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}dividend{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ a\ {\isasymLongrightarrow}\ a\ mod\ b\ {\isasymle}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ pos{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}bound{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ a\ mod\ b\ {\isacharless}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ pos{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}sign{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isasymle}\ a\ mod\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ mod{\isacharunderscore}{\kern0pt}mult{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ c\ {\isasymLongrightarrow}\ a\ mod\ {\isacharparenleft}{\kern0pt}b\ {\isacharasterisk}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ b\ mod\ c{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ a\ mod\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ div{\isacharunderscore}{\kern0pt}mult{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ c\ {\isasymLongrightarrow}\ a\ div\ {\isacharparenleft}{\kern0pt}b\ {\isacharasterisk}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a\ div\ b\ div\ c{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ discrete{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isacharless}{\kern0pt}\ b\ {\isasymlongleftrightarrow}\ a\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isasymle}\ b{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{fixes}\ divmod\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}num\ {\isasymRightarrow}\ num\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ divmod{\isacharunderscore}{\kern0pt}step\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}num\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ divmod{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}divmod\ m\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ m\ div\ numeral\ n{\isacharcomma}{\kern0pt}\ numeral\ m\ mod\ numeral\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ divmod{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}divmod{\isacharunderscore}{\kern0pt}step\ l\ qr\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ qr\isanewline
\ \ \ \ in\ if\ r\ {\isasymge}\ numeral\ l\ then\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ q\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharcomma}{\kern0pt}\ r\ {\isacharminus}{\kern0pt}\ numeral\ l{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ else\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ %
\isamarkupcmt{These are conceptually definitions but force generated code
    to be monomorphic wrt. particular instances of this class which
    yields a significant speedup.%
}\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}digit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ a{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}b\ {\isasymle}\ a\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ a\ div\ b{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}P{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}a\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ b\ {\isacharequal}{\kern0pt}\ a\ mod\ b{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}Q{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ mod{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}dividend\ {\isacharbrackleft}{\kern0pt}of\ a\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isasymle}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ trans{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ a\ div\ b{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}positive{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}\ {\isasymle}\ a\ div\ b{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ discrete{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}less{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ mod\ b\ {\isacharless}{\kern0pt}\ b{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ pos{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}bound{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ w\ \isakeyword{where}\ {\isachardoublequoteopen}w\ {\isacharequal}{\kern0pt}\ a\ div\ b\ mod\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}exhaust{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymor}\ w\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}w{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a\ mod\ b\ {\isacharplus}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ w{\isacharunderscore}{\kern0pt}def\ mod{\isacharunderscore}{\kern0pt}mult{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq\ ac{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ w{\isacharunderscore}{\kern0pt}exhaust\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}w{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}insert\ mod{\isacharunderscore}{\kern0pt}less{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}w\ \isacommand{have}\isamarkupfalse%
\ mod{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a\ mod\ b\ {\isacharplus}{\kern0pt}\ b{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a\ div\ b\ {\isacharminus}{\kern0pt}\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ w{\isacharunderscore}{\kern0pt}def\ div{\isacharunderscore}{\kern0pt}mult{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq\ minus{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}div\ ac{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}w\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ div{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a\ div\ b\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}P\ \isakeyword{and}\ {\isacharquery}{\kern0pt}Q\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ div\ mod\ add{\isacharunderscore}{\kern0pt}implies{\isacharunderscore}{\kern0pt}diff\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}digit{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}a\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a\ div\ b{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}P{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}a\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a\ mod\ b{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}Q{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ w\ \isakeyword{where}\ {\isachardoublequoteopen}w\ {\isacharequal}{\kern0pt}\ a\ div\ b\ mod\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}exhaust{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymor}\ w\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}w{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a\ mod\ b\ {\isacharplus}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ w{\isacharunderscore}{\kern0pt}def\ mod{\isacharunderscore}{\kern0pt}mult{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq\ ac{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isasymle}\ a\ mod\ b\ {\isacharplus}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ {\isacartoucheopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b{\isacartoucheclose}\ pos{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}sign\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ a\ mod\ b{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharplus}{\kern0pt}\ b\ {\isasymle}\ a\ mod\ b\ {\isacharplus}{\kern0pt}\ b{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ assms\ w{\isacharunderscore}{\kern0pt}exhaust\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}w\ \isacommand{have}\isamarkupfalse%
\ mod{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a\ mod\ b{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a\ div\ b\ {\isacharminus}{\kern0pt}\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ w{\isacharunderscore}{\kern0pt}def\ div{\isacharunderscore}{\kern0pt}mult{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq\ minus{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}div\ ac{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}w\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ div{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ div\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a\ div\ b{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}P\ \isakeyword{and}\ {\isacharquery}{\kern0pt}Q\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ div\ mod{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}double{\isacharunderscore}{\kern0pt}modulus{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}m\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ \ \ {\isachardoublequoteopen}x\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x\ mod\ m\ {\isasymor}\ x\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x\ mod\ m\ {\isacharplus}{\kern0pt}\ m{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}x\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ m{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{using}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}digit{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ m\ x{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ m\ {\isacharequal}{\kern0pt}\ x\ mod\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ divmod{\isacharunderscore}{\kern0pt}digit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x\ mod\ m\ {\isacharplus}{\kern0pt}\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharasterisk}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ subst\ le{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}inverse{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}use\ False\ \isakeyword{in}\ auto{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fst{\isacharunderscore}{\kern0pt}divmod{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}fst\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ numeral\ m\ div\ numeral\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divmod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}divmod{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ numeral\ m\ mod\ numeral\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divmod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
This is a formulation of one step (referring to one digit position)
  in school-method division: compare the dividend at the current
  digit position with the remainder from previous division steps
  and evaluate accordingly.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}divmod{\isacharunderscore}{\kern0pt}step\ l\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ numeral\ l\ {\isasymle}\ r\isanewline
\ \ \ \ then\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ q\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharcomma}{\kern0pt}\ r\ {\isacharminus}{\kern0pt}\ numeral\ l{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divmod{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
This is a formulation of school-method division.
  If the divisor is smaller than the dividend, terminate.
  If not, shift the dividend to the right until termination
  occurs and then reiterate single division steps in the
  opposite direction.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}divmod{\isacharunderscore}{\kern0pt}step{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}divmod\ m\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ m\ {\isacharless}{\kern0pt}\ n\ then\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ numeral\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ else\ divmod{\isacharunderscore}{\kern0pt}step\ n\ {\isacharparenleft}{\kern0pt}divmod\ m\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}m\ {\isacharless}{\kern0pt}\ n{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}numeral\ m\ {\isacharless}{\kern0pt}\ numeral\ n{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ prod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ div{\isacharunderscore}{\kern0pt}less\ mod{\isacharunderscore}{\kern0pt}less\ fst{\isacharunderscore}{\kern0pt}divmod\ snd{\isacharunderscore}{\kern0pt}divmod{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}divmod\ m\ n\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ divmod{\isacharunderscore}{\kern0pt}step\ n\ {\isacharparenleft}{\kern0pt}numeral\ m\ div\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ numeral\ m\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}numeral\ n\ {\isasymle}\ numeral\ m\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}eq\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}divmod{\isacharunderscore}{\kern0pt}step\ n\ {\isacharparenleft}{\kern0pt}numeral\ m\ div\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ numeral\ m\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ m\ div\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharcomma}{\kern0pt}\ numeral\ m\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ True\ divmod{\isacharunderscore}{\kern0pt}digit{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}numeral\ m{\isachardoublequoteclose}\ {\isachardoublequoteopen}numeral\ n{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ m\ div\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ numeral\ m\ div\ numeral\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}numeral\ m\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ numeral\ n\ {\isacharequal}{\kern0pt}\ numeral\ m\ mod\ numeral\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}{\kern0pt}all\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ divmod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}numeral\ m\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ numeral\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}eq\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}divmod{\isacharunderscore}{\kern0pt}step\ n\ {\isacharparenleft}{\kern0pt}numeral\ m\ div\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ numeral\ m\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ m\ div\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ numeral\ m\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\ divmod{\isacharunderscore}{\kern0pt}digit{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ {\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}numeral\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}numeral\ m{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ m\ div\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ numeral\ m\ div\ numeral\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}numeral\ m\ mod\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ numeral\ m\ mod\ numeral\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ only{\isacharcolon}{\kern0pt}\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}numeral{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ divmod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}divmod\ m\ n\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ divmod{\isacharunderscore}{\kern0pt}step\ n\ {\isacharparenleft}{\kern0pt}numeral\ m\ div\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ n{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ numeral\ m\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ numeral{\isachardot}{\kern0pt}simps\ distrib\ mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}divmod\ m\ n\ {\isacharequal}{\kern0pt}\ divmod{\isacharunderscore}{\kern0pt}step\ n\ {\isacharparenleft}{\kern0pt}divmod\ m\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divmod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ False\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The division rewrite proper -- first, trivial results involving \isa{{\isadigit{1}}}%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}trivial\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}divmod\ m\ Num{\isachardot}{\kern0pt}One\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ m{\isacharcomma}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}divmod\ num{\isachardot}{\kern0pt}One\ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ Numeral{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}divmod\ num{\isachardot}{\kern0pt}One\ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ Numeral{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}divmod{\isacharunderscore}{\kern0pt}step\ {\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}Num{\isachardot}{\kern0pt}One{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ divmod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Division by an even number is a right-shift%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}cancel\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}divmod\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case\ divmod\ m\ n\ of\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isacharquery}{\kern0pt}P{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}divmod\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case\ divmod\ m\ n\ of\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isacharquery}{\kern0pt}Q{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}q{\isachardot}{\kern0pt}\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ q{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymAnd}q{\isachardot}{\kern0pt}\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ numeral\ q\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ only{\isacharcolon}{\kern0pt}\ numeral{\isacharunderscore}{\kern0pt}mult\ numeral{\isachardot}{\kern0pt}simps\ distrib{\isacharparenright}{\kern0pt}\ simp{\isacharunderscore}{\kern0pt}all\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}\ div\ {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{1}}\ mod\ {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}less\ mod{\isacharunderscore}{\kern0pt}less{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}P\ \isakeyword{and}\ {\isacharquery}{\kern0pt}Q\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ fst{\isacharunderscore}{\kern0pt}divmod\ snd{\isacharunderscore}{\kern0pt}divmod\ prod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ split{\isacharunderscore}{\kern0pt}def\ {\isacharasterisk}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}of\ m{\isacharbrackright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}of\ n{\isacharbrackright}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}mult{\isadigit{1}}\isanewline
\ \ \ \ \ \ div{\isacharunderscore}{\kern0pt}mult{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isadigit{2}}{\isacharbrackright}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}mult{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isadigit{2}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ add{\isachardot}{\kern0pt}commute\ del{\isacharcolon}{\kern0pt}\ numeral{\isacharunderscore}{\kern0pt}times{\isacharunderscore}{\kern0pt}numeral{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The really hard work%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}steps\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}divmod\ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}if\ m\ {\isasymle}\ n\ then\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ numeral\ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ m{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ else\ divmod{\isacharunderscore}{\kern0pt}step\ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}divmod\ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}divmod\ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}if\ m\ {\isacharless}{\kern0pt}\ n\ then\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ numeral\ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ m{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ else\ divmod{\isacharunderscore}{\kern0pt}step\ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}divmod\ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ {\isacharparenleft}{\kern0pt}num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ divmod{\isacharunderscore}{\kern0pt}divmod{\isacharunderscore}{\kern0pt}step{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}algorithm{\isacharunderscore}{\kern0pt}code\ {\isacharequal}{\kern0pt}\ divmod{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}eq\ divmod{\isacharunderscore}{\kern0pt}trivial\ divmod{\isacharunderscore}{\kern0pt}cancel\ divmod{\isacharunderscore}{\kern0pt}steps%
\begin{isamarkuptext}%
Special case: divisibility%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ divides{\isacharunderscore}{\kern0pt}aux\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}divides{\isacharunderscore}{\kern0pt}aux\ qr\ {\isasymlongleftrightarrow}\ snd\ qr\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ divides{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}divides{\isacharunderscore}{\kern0pt}aux\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ r\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divides{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ dvd{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}simp\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}numeral\ m\ dvd\ numeral\ n\ {\isasymlongleftrightarrow}\ divides{\isacharunderscore}{\kern0pt}aux\ {\isacharparenleft}{\kern0pt}divmod\ n\ m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divmod{\isacharunderscore}{\kern0pt}def\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}dvd{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Generic computation of quotient and remainder%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ numeral{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}numeral\ k\ div\ numeral\ l\ {\isacharequal}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}divmod\ k\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fst{\isacharunderscore}{\kern0pt}divmod{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ numeral{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}numeral\ k\ mod\ numeral\ l\ {\isacharequal}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}divmod\ k\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ snd{\isacharunderscore}{\kern0pt}divmod{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isadigit{1}}\ div\ numeral\ n\ {\isacharequal}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}divmod\ num{\isachardot}{\kern0pt}One\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fst{\isacharunderscore}{\kern0pt}divmod{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isadigit{1}}\ mod\ numeral\ n\ {\isacharequal}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}divmod\ num{\isachardot}{\kern0pt}One\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ snd{\isacharunderscore}{\kern0pt}divmod{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Computing congruences modulo \isa{{\isadigit{2}}\ {\isacharcircum}{\kern0pt}\ q}%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ cong{\isacharunderscore}{\kern0pt}exp{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}simps{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}numeral\ n\ mod\ numeral\ Num{\isachardot}{\kern0pt}One\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\isanewline
\ \ \ \ {\isasymlongleftrightarrow}\ True{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ n{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\isanewline
\ \ \ \ {\isasymlongleftrightarrow}\ numeral\ n\ mod\ numeral\ q\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ n{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\isanewline
\ \ \ \ {\isasymlongleftrightarrow}\ False{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}numeral\ m\ mod\ numeral\ Num{\isachardot}{\kern0pt}One\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ n\ mod\ numeral\ Num{\isachardot}{\kern0pt}One{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymlongleftrightarrow}\ True{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}numeral\ Num{\isachardot}{\kern0pt}One\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ Num{\isachardot}{\kern0pt}One\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymlongleftrightarrow}\ True{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}numeral\ Num{\isachardot}{\kern0pt}One\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ n{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymlongleftrightarrow}\ False{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}numeral\ Num{\isachardot}{\kern0pt}One\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ n{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}numeral\ n\ mod\ numeral\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ m{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ Num{\isachardot}{\kern0pt}One\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymlongleftrightarrow}\ False{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ m{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ n{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymlongleftrightarrow}\ numeral\ m\ mod\ numeral\ q\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ n\ mod\ numeral\ q{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ m{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ n{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymlongleftrightarrow}\ False{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ m{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ Num{\isachardot}{\kern0pt}One\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}numeral\ m\ mod\ numeral\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ m{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ n{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymlongleftrightarrow}\ False{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ m{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{1}}\ n{\isacharparenright}{\kern0pt}\ mod\ numeral\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymlongleftrightarrow}\ numeral\ m\ mod\ numeral\ q\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ n\ mod\ numeral\ q{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta\ dest{\isacharcolon}{\kern0pt}\ arg{\isacharunderscore}{\kern0pt}cong\ {\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ even{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{hide{\isacharunderscore}{\kern0pt}fact}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}\isakeyword{open}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}less\ mod{\isacharunderscore}{\kern0pt}less\ mod{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}dividend\ mod{\isacharunderscore}{\kern0pt}mult{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq\ div{\isacharunderscore}{\kern0pt}mult{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq\isanewline
\isanewline
\isacommand{instantiation}\isamarkupfalse%
\ nat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}nat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}num\ {\isasymRightarrow}\ num\ {\isasymRightarrow}\ nat\ {\isasymtimes}\ nat{\isachardoublequoteclose}\isanewline
\isakeyword{where}\isanewline
\ \ divmod{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}divmod{\isacharunderscore}{\kern0pt}nat\ m\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ m\ div\ numeral\ n{\isacharcomma}{\kern0pt}\ numeral\ m\ mod\ numeral\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}nat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}num\ {\isasymRightarrow}\ nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ nat\ {\isasymtimes}\ nat{\isachardoublequoteclose}\isanewline
\isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}divmod{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}nat\ l\ qr\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ qr\isanewline
\ \ \ \ in\ if\ r\ {\isasymge}\ numeral\ l\ then\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ q\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharcomma}{\kern0pt}\ r\ {\isacharminus}{\kern0pt}\ numeral\ l{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ else\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{instance}\isamarkupfalse%
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ standard\isanewline
\ \ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ divmod{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}def\ divmod{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}def\ div{\isacharunderscore}{\kern0pt}greater{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}iff\ div{\isacharunderscore}{\kern0pt}mult{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq\ mod{\isacharunderscore}{\kern0pt}mult{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{declare}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}algorithm{\isacharunderscore}{\kern0pt}code\ {\isacharbrackleft}{\kern0pt}\isakeyword{where}\ {\isacharquery}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isacharequal}{\kern0pt}\ nat{\isacharcomma}{\kern0pt}\ code{\isacharbrackright}{\kern0pt}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Suc{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ k\ l\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ num\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}Suc\ {\isadigit{0}}\ div\ numeral\ k\ {\isacharequal}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}divmod\ Num{\isachardot}{\kern0pt}One\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ fst{\isacharunderscore}{\kern0pt}divmod{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Suc{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ k\ l\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ num\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}Suc\ {\isadigit{0}}\ mod\ numeral\ k\ {\isacharequal}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}divmod\ Num{\isachardot}{\kern0pt}One\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ snd{\isacharunderscore}{\kern0pt}divmod{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{instantiation}\isamarkupfalse%
\ int\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}int\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}num\ {\isasymRightarrow}\ num\ {\isasymRightarrow}\ int\ {\isasymtimes}\ int{\isachardoublequoteclose}\isanewline
\isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}divmod{\isacharunderscore}{\kern0pt}int\ m\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ m\ div\ numeral\ n{\isacharcomma}{\kern0pt}\ numeral\ m\ mod\ numeral\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}int\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}num\ {\isasymRightarrow}\ int\ {\isasymtimes}\ int\ {\isasymRightarrow}\ int\ {\isasymtimes}\ int{\isachardoublequoteclose}\isanewline
\isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}divmod{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}int\ l\ qr\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ qr\isanewline
\ \ \ \ in\ if\ r\ {\isasymge}\ numeral\ l\ then\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ q\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharcomma}{\kern0pt}\ r\ {\isacharminus}{\kern0pt}\ numeral\ l{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ else\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{instance}\isamarkupfalse%
\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ standard\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ zmod{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}dividend\ simp\ add{\isacharcolon}{\kern0pt}\ divmod{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def\ divmod{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ pos{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}iff\ zmod{\isacharunderscore}{\kern0pt}zmult{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq\ zdiv{\isacharunderscore}{\kern0pt}zmult{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{declare}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}algorithm{\isacharunderscore}{\kern0pt}code\ {\isacharbrackleft}{\kern0pt}\isakeyword{where}\ {\isacharquery}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isacharequal}{\kern0pt}\ int{\isacharcomma}{\kern0pt}\ code{\isacharbrackright}{\kern0pt}\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\isanewline
\isakeyword{begin}\isanewline
\ \ \isanewline
\isakeyword{qualified}\ \isacommand{definition}\isamarkupfalse%
\ adjust{\isacharunderscore}{\kern0pt}div\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}int\ {\isasymtimes}\ int\ {\isasymRightarrow}\ int{\isachardoublequoteclose}\isanewline
\isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}adjust{\isacharunderscore}{\kern0pt}div\ qr\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ qr\ in\ q\ {\isacharplus}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}r\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeyword{qualified}\ \isacommand{lemma}\isamarkupfalse%
\ adjust{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}adjust{\isacharunderscore}{\kern0pt}div\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ q\ {\isacharplus}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}r\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ adjust{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\isakeyword{qualified}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\ \isacommand{definition}\isamarkupfalse%
\ adjust{\isacharunderscore}{\kern0pt}mod\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}int\ {\isasymRightarrow}\ int\ {\isasymRightarrow}\ int{\isachardoublequoteclose}\isanewline
\isakeyword{where}\isanewline
\ \ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}adjust{\isacharunderscore}{\kern0pt}mod\ l\ r\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ r\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ {\isadigit{0}}\ else\ l\ {\isacharminus}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ minus{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ m\ div\ numeral\ n\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}adjust{\isacharunderscore}{\kern0pt}div\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}int\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ fst{\isacharunderscore}{\kern0pt}divmod\ divide{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\ adjust{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}def\ divides{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def\ divide{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ minus{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ m\ mod\ numeral\ n\ {\isacharequal}{\kern0pt}\ adjust{\isacharunderscore}{\kern0pt}mod\ {\isacharparenleft}{\kern0pt}numeral\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}dvd\ divides{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}int\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{if}\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ snd{\isacharunderscore}{\kern0pt}divmod\ modulo{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divides{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def\ adjust{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divides{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def\ modulo{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ numeral{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}numeral\ m\ div\ {\isacharminus}{\kern0pt}\ numeral\ n\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}adjust{\isacharunderscore}{\kern0pt}div\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}int\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ fst{\isacharunderscore}{\kern0pt}divmod\ divide{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\ adjust{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}def\ divides{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def\ divide{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ numeral{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}numeral\ m\ mod\ {\isacharminus}{\kern0pt}\ numeral\ n\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ adjust{\isacharunderscore}{\kern0pt}mod\ {\isacharparenleft}{\kern0pt}numeral\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}dvd\ divides{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}int\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{if}\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ snd{\isacharunderscore}{\kern0pt}divmod\ modulo{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divides{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def\ adjust{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divides{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}def\ modulo{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ minus{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isadigit{1}}\ div\ numeral\ n\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}adjust{\isacharunderscore}{\kern0pt}div\ {\isacharparenleft}{\kern0pt}divmod\ Num{\isachardot}{\kern0pt}One\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ minus{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}of\ Num{\isachardot}{\kern0pt}One\ n{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ minus{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isadigit{1}}\ mod\ numeral\ n\ {\isacharequal}{\kern0pt}\ adjust{\isacharunderscore}{\kern0pt}mod\ {\isacharparenleft}{\kern0pt}numeral\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}divmod\ Num{\isachardot}{\kern0pt}One\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ minus{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}of\ Num{\isachardot}{\kern0pt}One\ n{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isadigit{1}}\ div\ {\isacharminus}{\kern0pt}\ numeral\ n\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}adjust{\isacharunderscore}{\kern0pt}div\ {\isacharparenleft}{\kern0pt}divmod\ Num{\isachardot}{\kern0pt}One\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ numeral{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}of\ Num{\isachardot}{\kern0pt}One\ n{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isadigit{1}}\ mod\ {\isacharminus}{\kern0pt}\ numeral\ n\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ adjust{\isacharunderscore}{\kern0pt}mod\ {\isacharparenleft}{\kern0pt}numeral\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}divmod\ Num{\isachardot}{\kern0pt}One\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ numeral{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}numeral\ {\isacharbrackleft}{\kern0pt}of\ Num{\isachardot}{\kern0pt}One\ n{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}BitM{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isacartoucheopen}divmod\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}BitM\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Num{\isachardot}{\kern0pt}Bit{\isadigit{0}}\ Num{\isachardot}{\kern0pt}One{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ m\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacartoucheclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ m{\isacharparenright}{\kern0pt}\ simp{\isacharunderscore}{\kern0pt}all%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}positive{\isacharunderscore}{\kern0pt}int{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}k\ div\ l\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{if}\ {\isachardoublequoteopen}k\ {\isasymge}\ l{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}l\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{for}\ k\ l\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ that\ div{\isacharunderscore}{\kern0pt}positive\ {\isacharbrackleft}{\kern0pt}of\ l\ k{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Dedicated simproc for calculation%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
There is space for improvement here: the calculation itself
  could be carried out outside the logic, and a generic simproc
  (simplifier setup) for generic calculation would be helpful.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{simproc{\isacharunderscore}{\kern0pt}setup}\isamarkupfalse%
\ numeral{\isacharunderscore}{\kern0pt}divmod\isanewline
\ \ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isadigit{0}}\ div\ {\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ mod\ {\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isadigit{0}}\ div\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ mod\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isadigit{0}}\ div\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ mod\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isadigit{0}}\ div\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ mod\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isadigit{0}}\ div\ {\isacharminus}{\kern0pt}\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ mod\ {\isacharminus}{\kern0pt}\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isadigit{1}}\ div\ {\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}\ mod\ {\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isadigit{1}}\ div\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}\ mod\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isadigit{1}}\ div\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}\ mod\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isadigit{1}}\ div\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}\ mod\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isadigit{1}}\ div\ {\isacharminus}{\kern0pt}\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}\ mod\ {\isacharminus}{\kern0pt}\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isadigit{1}}\ div\ {\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isadigit{1}}\ mod\ {\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isadigit{1}}\ div\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isadigit{1}}\ mod\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isadigit{1}}\ div\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isadigit{1}}\ mod\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isadigit{1}}\ div\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isadigit{1}}\ mod\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isadigit{1}}\ div\ {\isacharminus}{\kern0pt}\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isadigit{1}}\ mod\ {\isacharminus}{\kern0pt}\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}numeral\ a\ div\ {\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}numeral\ a\ mod\ {\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}numeral\ a\ div\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}numeral\ a\ mod\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}numeral\ a\ div\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}numeral\ a\ mod\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}numeral\ a\ div\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}numeral\ a\ mod\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unique{\isacharunderscore}{\kern0pt}euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}numeral{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}numeral\ a\ div\ {\isacharminus}{\kern0pt}\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}numeral\ a\ mod\ {\isacharminus}{\kern0pt}\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ a\ div\ {\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ a\ mod\ {\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ a\ div\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ a\ mod\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ a\ div\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ a\ mod\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ a\ div\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ a\ mod\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ a\ div\ {\isacharminus}{\kern0pt}\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ a\ mod\ {\isacharminus}{\kern0pt}\ numeral\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
{\isacartoucheopen}\ let\isanewline
\ \ \ \ val\ if{\isacharunderscore}{\kern0pt}cong\ {\isacharequal}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}Code{\isachardot}{\kern0pt}get{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}cong\ \isactrltheory \ \isactrlconstUNDERSCOREname {\isasymopen}If{\isasymclose}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ fun\ successful{\isacharunderscore}{\kern0pt}rewrite\ ctxt\ ct\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ let\isanewline
\ \ \ \ \ \ \ \ val\ thm\ {\isacharequal}{\kern0pt}\ Simplifier{\isachardot}{\kern0pt}rewrite\ ctxt\ ct\isanewline
\ \ \ \ \ \ in\ if\ Thm{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}reflexive\ thm\ then\ NONE\ else\ SOME\ thm\ end{\isacharsemicolon}{\kern0pt}\isanewline
\ \ in\ fn\ phi\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\isanewline
\ \ \ \ let\isanewline
\ \ \ \ \ \ val\ simps\ {\isacharequal}{\kern0pt}\ Morphism{\isachardot}{\kern0pt}fact\ phi\ {\isacharparenleft}{\kern0pt}{\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ div{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ mod{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ div{\isacharunderscore}{\kern0pt}by{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ mod{\isacharunderscore}{\kern0pt}by{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ div{\isacharunderscore}{\kern0pt}by{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ mod{\isacharunderscore}{\kern0pt}by{\isacharunderscore}{\kern0pt}{\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ one{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}numeral\ one{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}numeral\ minus{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}numeral\ minus{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}numeral\isanewline
\ \ \ \ \ \ \ \ one{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}numeral\ one{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}numeral\isanewline
\ \ \ \ \ \ \ \ numeral{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}numeral\ numeral{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}numeral\ minus{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}numeral\ minus{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}numeral\isanewline
\ \ \ \ \ \ \ \ numeral{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}numeral\ numeral{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}numeral\isanewline
\ \ \ \ \ \ \ \ div{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}minus\ mod{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}minus\ Divides{\isachardot}{\kern0pt}adjust{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}eq\ of{\isacharunderscore}{\kern0pt}bool{\isacharunderscore}{\kern0pt}eq\ one{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}zero\isanewline
\ \ \ \ \ \ \ \ numeral{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}zero\ neg{\isacharunderscore}{\kern0pt}equal{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}equal\ arith{\isacharunderscore}{\kern0pt}simps\ arith{\isacharunderscore}{\kern0pt}special\ divmod{\isacharunderscore}{\kern0pt}trivial\isanewline
\ \ \ \ \ \ \ \ divmod{\isacharunderscore}{\kern0pt}cancel\ divmod{\isacharunderscore}{\kern0pt}steps\ divmod{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}eq\ fst{\isacharunderscore}{\kern0pt}conv\ snd{\isacharunderscore}{\kern0pt}conv\ numeral{\isacharunderscore}{\kern0pt}One\isanewline
\ \ \ \ \ \ \ \ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta\ rel{\isacharunderscore}{\kern0pt}simps\ Divides{\isachardot}{\kern0pt}adjust{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}def\ div{\isacharunderscore}{\kern0pt}minus{\isadigit{1}}{\isacharunderscore}{\kern0pt}right\ mod{\isacharunderscore}{\kern0pt}minus{\isadigit{1}}{\isacharunderscore}{\kern0pt}right\isanewline
\ \ \ \ \ \ \ \ minus{\isacharunderscore}{\kern0pt}minus\ numeral{\isacharunderscore}{\kern0pt}times{\isacharunderscore}{\kern0pt}numeral\ mult{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}right\ mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharunderscore}{\kern0pt}right{\isacharbraceright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}lemma\ {\isachardoublequote}{\kern0pt}{\isadigit{0}}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ True{\isachardoublequote}{\kern0pt}\ by\ simp{\isacharbraceright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ fun\ prepare{\isacharunderscore}{\kern0pt}simpset\ ctxt\ {\isacharequal}{\kern0pt}\ HOL{\isacharunderscore}{\kern0pt}ss\ {\isacharbar}{\kern0pt}{\isachargreater}{\kern0pt}\ Simplifier{\isachardot}{\kern0pt}simpset{\isacharunderscore}{\kern0pt}map\ ctxt\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Simplifier{\isachardot}{\kern0pt}add{\isacharunderscore}{\kern0pt}cong\ if{\isacharunderscore}{\kern0pt}cong\ {\isacharhash}{\kern0pt}{\isachargreater}{\kern0pt}\ fold\ Simplifier{\isachardot}{\kern0pt}add{\isacharunderscore}{\kern0pt}simp\ simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ in\ fn\ ctxt\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ successful{\isacharunderscore}{\kern0pt}rewrite\ {\isacharparenleft}{\kern0pt}Simplifier{\isachardot}{\kern0pt}put{\isacharunderscore}{\kern0pt}simpset\ {\isacharparenleft}{\kern0pt}prepare{\isacharunderscore}{\kern0pt}simpset\ ctxt{\isacharparenright}{\kern0pt}\ ctxt{\isacharparenright}{\kern0pt}\ end\isanewline
\ \ end\isanewline
{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Code generation%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}nat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ nat\ {\isasymtimes}\ nat{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}divmod{\isacharunderscore}{\kern0pt}nat\ m\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}m\ div\ n{\isacharcomma}{\kern0pt}\ m\ mod\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fst{\isacharunderscore}{\kern0pt}divmod{\isacharunderscore}{\kern0pt}nat\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}fst\ {\isacharparenleft}{\kern0pt}divmod{\isacharunderscore}{\kern0pt}nat\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ m\ div\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divmod{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}divmod{\isacharunderscore}{\kern0pt}nat\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}divmod{\isacharunderscore}{\kern0pt}nat\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ m\ mod\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divmod{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ divmod{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}if\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}Divides{\isachardot}{\kern0pt}divmod{\isacharunderscore}{\kern0pt}nat\ m\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ n\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymor}\ m\ {\isacharless}{\kern0pt}\ n\ then\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ else\isanewline
\ \ \ \ let\ {\isacharparenleft}{\kern0pt}q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Divides{\isachardot}{\kern0pt}divmod{\isacharunderscore}{\kern0pt}nat\ {\isacharparenleft}{\kern0pt}m\ {\isacharminus}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ n\ in\ {\isacharparenleft}{\kern0pt}Suc\ q{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ prod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta\ not{\isacharunderscore}{\kern0pt}less\ le{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}geq\ le{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}geq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}m\ div\ n\ {\isacharequal}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}divmod{\isacharunderscore}{\kern0pt}nat\ m\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}m\ mod\ n\ {\isacharequal}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}divmod{\isacharunderscore}{\kern0pt}nat\ m\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}{\kern0pt}all%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ k\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isakeyword{shows}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}k\ div\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}k\ mod\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ k{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isadigit{0}}\ div\ k\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isadigit{0}}\ mod\ k\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}k\ div\ Int{\isachardot}{\kern0pt}Pos\ Num{\isachardot}{\kern0pt}One\ {\isacharequal}{\kern0pt}\ k{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}k\ mod\ Int{\isachardot}{\kern0pt}Pos\ Num{\isachardot}{\kern0pt}One\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}k\ div\ Int{\isachardot}{\kern0pt}Neg\ Num{\isachardot}{\kern0pt}One\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ k{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}k\ mod\ Int{\isachardot}{\kern0pt}Neg\ Num{\isachardot}{\kern0pt}One\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}Int{\isachardot}{\kern0pt}Pos\ m\ div\ Int{\isachardot}{\kern0pt}Pos\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}Int{\isachardot}{\kern0pt}Pos\ m\ mod\ Int{\isachardot}{\kern0pt}Pos\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}Int{\isachardot}{\kern0pt}Neg\ m\ div\ Int{\isachardot}{\kern0pt}Pos\ n\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Divides{\isachardot}{\kern0pt}adjust{\isacharunderscore}{\kern0pt}div\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}Int{\isachardot}{\kern0pt}Neg\ m\ mod\ Int{\isachardot}{\kern0pt}Pos\ n\ {\isacharequal}{\kern0pt}\ Divides{\isachardot}{\kern0pt}adjust{\isacharunderscore}{\kern0pt}mod\ {\isacharparenleft}{\kern0pt}Int{\isachardot}{\kern0pt}Pos\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}Int{\isachardot}{\kern0pt}Pos\ m\ div\ Int{\isachardot}{\kern0pt}Neg\ n\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Divides{\isachardot}{\kern0pt}adjust{\isacharunderscore}{\kern0pt}div\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}Int{\isachardot}{\kern0pt}Pos\ m\ mod\ Int{\isachardot}{\kern0pt}Neg\ n\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ Divides{\isachardot}{\kern0pt}adjust{\isacharunderscore}{\kern0pt}mod\ {\isacharparenleft}{\kern0pt}Int{\isachardot}{\kern0pt}Pos\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}Int{\isachardot}{\kern0pt}Neg\ m\ div\ Int{\isachardot}{\kern0pt}Neg\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}Int{\isachardot}{\kern0pt}Neg\ m\ mod\ Int{\isachardot}{\kern0pt}Neg\ n\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}divmod\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}{\kern0pt}all%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{code{\isacharunderscore}{\kern0pt}identifier}\isamarkupfalse%
\isanewline
\ \ \isakeyword{code{\isacharunderscore}{\kern0pt}module}\ Divides\ {\isasymrightharpoonup}\ {\isacharparenleft}{\kern0pt}SML{\isacharparenright}{\kern0pt}\ Arith\ \isakeyword{and}\ {\isacharparenleft}{\kern0pt}OCaml{\isacharparenright}{\kern0pt}\ Arith\ \isakeyword{and}\ {\isacharparenleft}{\kern0pt}Haskell{\isacharparenright}{\kern0pt}\ Arith%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Lemmas of doubtful value%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}geq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}m\ div\ n\ {\isacharequal}{\kern0pt}\ Suc\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}m\ {\isacharminus}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ div\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{if}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}\ {\isasymnot}\ m\ {\isacharless}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeyword{for}\ m\ n\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ le{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}geq{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}use\ that\ \isakeyword{in}\ {\isacartoucheopen}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}less{\isacartoucheclose}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}geq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}m\ mod\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}m\ {\isacharminus}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ mod\ n{\isachardoublequoteclose}\ \isakeyword{if}\ {\isachardoublequoteopen}{\isasymnot}\ m\ {\isacharless}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeyword{for}\ m\ n\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ le{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}geq{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}use\ that\ \isakeyword{in}\ {\isacartoucheopen}simp\ add{\isacharcolon}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}less{\isacartoucheclose}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}D{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymexists}q{\isachardot}{\kern0pt}\ m\ {\isacharequal}{\kern0pt}\ d\ {\isacharasterisk}{\kern0pt}\ q{\isachardoublequoteclose}\ \isakeyword{if}\ {\isachardoublequoteopen}m\ mod\ d\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{for}\ m\ d\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ that\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}dvd{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ pos{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}conj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isasymle}\ a\ mod\ b\ {\isasymand}\ a\ mod\ b\ {\isacharless}{\kern0pt}\ b{\isachardoublequoteclose}\ \isakeyword{for}\ a\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ neg{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}conj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isacharless}{\kern0pt}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ a\ mod\ b\ {\isasymle}\ {\isadigit{0}}\ {\isasymand}\ b\ {\isacharless}{\kern0pt}\ a\ mod\ b{\isachardoublequoteclose}\ \isakeyword{for}\ a\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zmod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}m\ mod\ d\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymexists}q{\isachardot}{\kern0pt}\ m\ {\isacharequal}{\kern0pt}\ d\ {\isacharasterisk}{\kern0pt}\ q{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ m\ d\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}dvd{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zmod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}D\ {\isacharbrackleft}{\kern0pt}dest{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymexists}q{\isachardot}{\kern0pt}\ m\ {\isacharequal}{\kern0pt}\ d\ {\isacharasterisk}{\kern0pt}\ q{\isachardoublequoteclose}\ \isakeyword{if}\ {\isachardoublequoteopen}m\ mod\ d\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{for}\ m\ d\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ that\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=Divides.tex%:%
%:%11=6%:%
%:%27=8%:%
%:%28=8%:%
%:%29=9%:%
%:%30=10%:%
%:%44=12%:%
%:%54=14%:%
%:%55=14%:%
%:%56=15%:%
%:%57=16%:%
%:%58=17%:%
%:%59=18%:%
%:%60=19%:%
%:%61=20%:%
%:%62=20%:%
%:%63=21%:%
%:%65=23%:%
%:%68=24%:%
%:%72=24%:%
%:%73=24%:%
%:%74=25%:%
%:%75=26%:%
%:%80=26%:%
%:%83=27%:%
%:%84=28%:%
%:%85=28%:%
%:%86=29%:%
%:%93=30%:%
%:%94=30%:%
%:%95=31%:%
%:%96=31%:%
%:%97=32%:%
%:%98=32%:%
%:%99=32%:%
%:%100=33%:%
%:%101=33%:%
%:%102=33%:%
%:%103=34%:%
%:%104=34%:%
%:%105=34%:%
%:%106=35%:%
%:%107=35%:%
%:%108=35%:%
%:%109=36%:%
%:%110=36%:%
%:%111=36%:%
%:%112=37%:%
%:%113=37%:%
%:%114=37%:%
%:%115=38%:%
%:%116=38%:%
%:%117=38%:%
%:%118=39%:%
%:%124=39%:%
%:%127=40%:%
%:%128=41%:%
%:%129=41%:%
%:%130=42%:%
%:%133=43%:%
%:%137=43%:%
%:%138=43%:%
%:%143=43%:%
%:%146=44%:%
%:%147=45%:%
%:%148=45%:%
%:%149=46%:%
%:%152=47%:%
%:%156=47%:%
%:%157=47%:%
%:%158=48%:%
%:%159=48%:%
%:%160=49%:%
%:%161=49%:%
%:%162=50%:%
%:%168=50%:%
%:%171=51%:%
%:%172=52%:%
%:%173=52%:%
%:%174=53%:%
%:%181=54%:%
%:%182=54%:%
%:%183=55%:%
%:%184=55%:%
%:%185=56%:%
%:%186=56%:%
%:%187=57%:%
%:%193=57%:%
%:%196=58%:%
%:%197=59%:%
%:%198=59%:%
%:%199=60%:%
%:%206=61%:%
%:%207=61%:%
%:%208=62%:%
%:%209=62%:%
%:%210=63%:%
%:%211=63%:%
%:%212=63%:%
%:%213=64%:%
%:%214=64%:%
%:%215=65%:%
%:%216=65%:%
%:%217=66%:%
%:%218=66%:%
%:%219=67%:%
%:%220=67%:%
%:%221=67%:%
%:%222=68%:%
%:%223=68%:%
%:%224=69%:%
%:%225=69%:%
%:%226=70%:%
%:%227=71%:%
%:%228=72%:%
%:%229=73%:%
%:%230=73%:%
%:%231=74%:%
%:%232=74%:%
%:%233=75%:%
%:%234=75%:%
%:%235=75%:%
%:%236=76%:%
%:%237=76%:%
%:%238=77%:%
%:%239=77%:%
%:%240=78%:%
%:%241=79%:%
%:%242=80%:%
%:%243=81%:%
%:%249=81%:%
%:%252=82%:%
%:%253=83%:%
%:%254=83%:%
%:%255=84%:%
%:%256=85%:%
%:%259=86%:%
%:%263=86%:%
%:%264=86%:%
%:%265=87%:%
%:%266=87%:%
%:%267=88%:%
%:%268=88%:%
%:%273=88%:%
%:%276=89%:%
%:%277=90%:%
%:%278=90%:%
%:%279=91%:%
%:%282=92%:%
%:%286=92%:%
%:%287=92%:%
%:%292=92%:%
%:%295=93%:%
%:%296=94%:%
%:%297=94%:%
%:%298=95%:%
%:%301=96%:%
%:%305=96%:%
%:%306=96%:%
%:%311=96%:%
%:%314=97%:%
%:%315=98%:%
%:%316=98%:%
%:%317=99%:%
%:%320=100%:%
%:%324=100%:%
%:%325=100%:%
%:%330=100%:%
%:%333=101%:%
%:%334=102%:%
%:%335=102%:%
%:%336=103%:%
%:%339=104%:%
%:%343=104%:%
%:%344=104%:%
%:%349=104%:%
%:%352=105%:%
%:%353=106%:%
%:%354=106%:%
%:%355=107%:%
%:%356=108%:%
%:%357=109%:%
%:%364=110%:%
%:%365=110%:%
%:%366=111%:%
%:%367=111%:%
%:%368=111%:%
%:%369=112%:%
%:%370=112%:%
%:%371=113%:%
%:%372=113%:%
%:%373=113%:%
%:%374=114%:%
%:%375=114%:%
%:%376=114%:%
%:%377=115%:%
%:%378=115%:%
%:%379=116%:%
%:%385=116%:%
%:%388=117%:%
%:%389=118%:%
%:%390=118%:%
%:%391=119%:%
%:%392=120%:%
%:%393=121%:%
%:%400=122%:%
%:%401=122%:%
%:%402=123%:%
%:%403=123%:%
%:%404=124%:%
%:%405=124%:%
%:%406=124%:%
%:%407=125%:%
%:%408=125%:%
%:%409=126%:%
%:%410=126%:%
%:%411=127%:%
%:%412=127%:%
%:%413=128%:%
%:%414=128%:%
%:%415=128%:%
%:%416=129%:%
%:%417=129%:%
%:%418=129%:%
%:%419=130%:%
%:%420=130%:%
%:%421=130%:%
%:%422=131%:%
%:%423=131%:%
%:%424=132%:%
%:%430=132%:%
%:%433=133%:%
%:%434=134%:%
%:%435=134%:%
%:%436=135%:%
%:%437=136%:%
%:%438=137%:%
%:%445=138%:%
%:%446=138%:%
%:%447=139%:%
%:%448=139%:%
%:%449=140%:%
%:%450=140%:%
%:%451=140%:%
%:%452=141%:%
%:%453=141%:%
%:%454=142%:%
%:%455=142%:%
%:%456=143%:%
%:%457=143%:%
%:%458=144%:%
%:%459=144%:%
%:%460=144%:%
%:%461=145%:%
%:%462=145%:%
%:%463=146%:%
%:%464=146%:%
%:%465=147%:%
%:%466=147%:%
%:%467=148%:%
%:%468=148%:%
%:%469=149%:%
%:%470=149%:%
%:%471=149%:%
%:%472=150%:%
%:%473=150%:%
%:%474=151%:%
%:%475=151%:%
%:%476=152%:%
%:%477=152%:%
%:%478=153%:%
%:%479=153%:%
%:%480=154%:%
%:%481=154%:%
%:%482=155%:%
%:%483=155%:%
%:%484=156%:%
%:%485=156%:%
%:%486=156%:%
%:%487=157%:%
%:%488=157%:%
%:%489=158%:%
%:%490=158%:%
%:%491=159%:%
%:%492=159%:%
%:%493=160%:%
%:%499=160%:%
%:%502=161%:%
%:%503=162%:%
%:%504=162%:%
%:%505=163%:%
%:%506=164%:%
%:%507=165%:%
%:%508=166%:%
%:%511=167%:%
%:%515=167%:%
%:%516=167%:%
%:%517=168%:%
%:%518=168%:%
%:%532=171%:%
%:%542=173%:%
%:%543=173%:%
%:%544=174%:%
%:%546=176%:%
%:%553=177%:%
%:%554=177%:%
%:%559=177%:%
%:%562=178%:%
%:%563=179%:%
%:%564=180%:%
%:%565=180%:%
%:%566=181%:%
%:%567=182%:%
%:%574=183%:%
%:%575=183%:%
%:%580=183%:%
%:%583=184%:%
%:%584=185%:%
%:%585=185%:%
%:%586=186%:%
%:%593=187%:%
%:%594=187%:%
%:%595=188%:%
%:%596=188%:%
%:%597=189%:%
%:%598=189%:%
%:%599=189%:%
%:%600=190%:%
%:%601=190%:%
%:%602=191%:%
%:%603=191%:%
%:%608=191%:%
%:%611=192%:%
%:%612=193%:%
%:%613=193%:%
%:%614=194%:%
%:%615=195%:%
%:%618=196%:%
%:%622=196%:%
%:%623=196%:%
%:%628=196%:%
%:%631=197%:%
%:%632=198%:%
%:%633=198%:%
%:%634=199%:%
%:%635=200%:%
%:%638=201%:%
%:%642=201%:%
%:%643=201%:%
%:%648=201%:%
%:%651=202%:%
%:%652=203%:%
%:%653=203%:%
%:%654=204%:%
%:%656=206%:%
%:%659=207%:%
%:%663=207%:%
%:%664=207%:%
%:%669=207%:%
%:%672=208%:%
%:%673=209%:%
%:%674=209%:%
%:%675=210%:%
%:%678=211%:%
%:%682=211%:%
%:%683=211%:%
%:%697=214%:%
%:%707=216%:%
%:%708=216%:%
%:%709=217%:%
%:%710=218%:%
%:%717=219%:%
%:%718=219%:%
%:%719=220%:%
%:%720=220%:%
%:%721=221%:%
%:%722=221%:%
%:%723=221%:%
%:%724=222%:%
%:%725=222%:%
%:%730=222%:%
%:%733=223%:%
%:%734=224%:%
%:%735=224%:%
%:%736=225%:%
%:%737=226%:%
%:%744=227%:%
%:%745=227%:%
%:%746=228%:%
%:%747=228%:%
%:%748=229%:%
%:%749=229%:%
%:%750=229%:%
%:%751=230%:%
%:%752=230%:%
%:%766=233%:%
%:%776=235%:%
%:%777=235%:%
%:%778=236%:%
%:%779=237%:%
%:%780=238%:%
%:%787=239%:%
%:%788=239%:%
%:%789=240%:%
%:%790=240%:%
%:%791=241%:%
%:%792=241%:%
%:%793=241%:%
%:%794=242%:%
%:%795=242%:%
%:%796=242%:%
%:%797=243%:%
%:%798=243%:%
%:%799=244%:%
%:%805=244%:%
%:%808=245%:%
%:%809=246%:%
%:%810=246%:%
%:%811=247%:%
%:%812=248%:%
%:%813=249%:%
%:%820=250%:%
%:%821=250%:%
%:%822=251%:%
%:%823=251%:%
%:%824=252%:%
%:%825=252%:%
%:%826=252%:%
%:%827=253%:%
%:%828=253%:%
%:%829=253%:%
%:%830=254%:%
%:%831=254%:%
%:%832=254%:%
%:%833=255%:%
%:%834=255%:%
%:%835=255%:%
%:%836=256%:%
%:%837=256%:%
%:%838=256%:%
%:%839=256%:%
%:%840=257%:%
%:%841=257%:%
%:%842=257%:%
%:%843=258%:%
%:%844=258%:%
%:%845=259%:%
%:%851=259%:%
%:%854=260%:%
%:%855=261%:%
%:%856=261%:%
%:%857=262%:%
%:%858=263%:%
%:%865=264%:%
%:%866=264%:%
%:%867=265%:%
%:%868=265%:%
%:%869=266%:%
%:%870=266%:%
%:%871=266%:%
%:%872=267%:%
%:%873=267%:%
%:%874=268%:%
%:%875=268%:%
%:%876=269%:%
%:%877=269%:%
%:%882=269%:%
%:%885=270%:%
%:%886=271%:%
%:%887=271%:%
%:%888=272%:%
%:%889=273%:%
%:%890=274%:%
%:%897=275%:%
%:%898=275%:%
%:%899=276%:%
%:%900=276%:%
%:%901=277%:%
%:%902=277%:%
%:%903=277%:%
%:%904=278%:%
%:%905=278%:%
%:%906=278%:%
%:%907=279%:%
%:%908=279%:%
%:%909=280%:%
%:%910=280%:%
%:%911=281%:%
%:%912=281%:%
%:%913=282%:%
%:%914=282%:%
%:%915=282%:%
%:%916=283%:%
%:%917=283%:%
%:%918=283%:%
%:%919=284%:%
%:%920=284%:%
%:%921=284%:%
%:%922=285%:%
%:%923=285%:%
%:%924=285%:%
%:%925=286%:%
%:%931=286%:%
%:%934=287%:%
%:%935=288%:%
%:%936=288%:%
%:%937=289%:%
%:%938=290%:%
%:%945=291%:%
%:%946=291%:%
%:%947=292%:%
%:%948=292%:%
%:%949=293%:%
%:%950=293%:%
%:%951=293%:%
%:%952=294%:%
%:%953=294%:%
%:%954=295%:%
%:%955=295%:%
%:%956=296%:%
%:%957=296%:%
%:%962=296%:%
%:%965=297%:%
%:%966=298%:%
%:%967=298%:%
%:%968=299%:%
%:%969=300%:%
%:%970=301%:%
%:%977=302%:%
%:%978=302%:%
%:%979=303%:%
%:%980=303%:%
%:%981=303%:%
%:%982=304%:%
%:%983=304%:%
%:%984=304%:%
%:%985=304%:%
%:%986=305%:%
%:%987=305%:%
%:%988=305%:%
%:%989=305%:%
%:%990=306%:%
%:%996=306%:%
%:%999=307%:%
%:%1000=308%:%
%:%1001=308%:%
%:%1002=309%:%
%:%1003=310%:%
%:%1004=311%:%
%:%1011=312%:%
%:%1012=312%:%
%:%1013=313%:%
%:%1014=313%:%
%:%1015=313%:%
%:%1016=314%:%
%:%1017=314%:%
%:%1018=314%:%
%:%1019=314%:%
%:%1020=315%:%
%:%1021=315%:%
%:%1022=315%:%
%:%1023=315%:%
%:%1024=316%:%
%:%1039=319%:%
%:%1051=321%:%
%:%1053=323%:%
%:%1054=323%:%
%:%1055=324%:%
%:%1056=325%:%
%:%1059=326%:%
%:%1063=326%:%
%:%1064=326%:%
%:%1069=326%:%
%:%1072=327%:%
%:%1073=328%:%
%:%1074=328%:%
%:%1075=329%:%
%:%1076=330%:%
%:%1079=331%:%
%:%1083=331%:%
%:%1084=331%:%
%:%1089=331%:%
%:%1092=332%:%
%:%1093=333%:%
%:%1094=333%:%
%:%1095=334%:%
%:%1098=337%:%
%:%1105=338%:%
%:%1106=338%:%
%:%1107=339%:%
%:%1108=339%:%
%:%1109=340%:%
%:%1110=340%:%
%:%1111=340%:%
%:%1112=341%:%
%:%1113=341%:%
%:%1114=342%:%
%:%1115=342%:%
%:%1116=343%:%
%:%1117=343%:%
%:%1122=343%:%
%:%1125=344%:%
%:%1126=345%:%
%:%1127=345%:%
%:%1128=346%:%
%:%1131=349%:%
%:%1138=350%:%
%:%1139=350%:%
%:%1140=351%:%
%:%1141=351%:%
%:%1142=352%:%
%:%1143=352%:%
%:%1144=352%:%
%:%1145=353%:%
%:%1146=353%:%
%:%1147=354%:%
%:%1148=354%:%
%:%1149=355%:%
%:%1150=355%:%
%:%1159=357%:%
%:%1160=358%:%
%:%1161=359%:%
%:%1163=360%:%
%:%1164=360%:%
%:%1165=361%:%
%:%1166=361%:%
%:%1173=364%:%
%:%1183=366%:%
%:%1184=366%:%
%:%1185=367%:%
%:%1186=368%:%
%:%1187=369%:%
%:%1190=370%:%
%:%1194=370%:%
%:%1195=370%:%
%:%1196=370%:%
%:%1197=370%:%
%:%1202=370%:%
%:%1205=371%:%
%:%1206=372%:%
%:%1207=372%:%
%:%1208=373%:%
%:%1209=374%:%
%:%1210=375%:%
%:%1213=376%:%
%:%1217=376%:%
%:%1218=376%:%
%:%1219=376%:%
%:%1220=376%:%
%:%1229=378%:%
%:%1231=380%:%
%:%1232=380%:%
%:%1235=381%:%
%:%1239=381%:%
%:%1240=381%:%
%:%1241=382%:%
%:%1242=382%:%
%:%1247=382%:%
%:%1250=383%:%
%:%1251=384%:%
%:%1252=384%:%
%:%1253=385%:%
%:%1256=386%:%
%:%1260=386%:%
%:%1261=386%:%
%:%1262=387%:%
%:%1263=387%:%
%:%1268=387%:%
%:%1271=388%:%
%:%1272=389%:%
%:%1273=389%:%
%:%1274=390%:%
%:%1275=391%:%
%:%1278=392%:%
%:%1282=392%:%
%:%1283=392%:%
%:%1284=392%:%
%:%1285=393%:%
%:%1286=393%:%
%:%1291=393%:%
%:%1294=394%:%
%:%1295=395%:%
%:%1296=395%:%
%:%1297=396%:%
%:%1298=397%:%
%:%1301=398%:%
%:%1305=398%:%
%:%1306=398%:%
%:%1307=399%:%
%:%1308=399%:%
%:%1309=400%:%
%:%1310=400%:%
%:%1315=400%:%
%:%1318=401%:%
%:%1319=402%:%
%:%1320=402%:%
%:%1321=403%:%
%:%1322=404%:%
%:%1323=405%:%
%:%1326=406%:%
%:%1330=406%:%
%:%1331=406%:%
%:%1332=407%:%
%:%1333=407%:%
%:%1338=407%:%
%:%1341=408%:%
%:%1342=409%:%
%:%1343=409%:%
%:%1344=410%:%
%:%1345=411%:%
%:%1346=412%:%
%:%1349=413%:%
%:%1353=413%:%
%:%1354=413%:%
%:%1355=414%:%
%:%1356=414%:%
%:%1361=414%:%
%:%1364=415%:%
%:%1365=416%:%
%:%1366=416%:%
%:%1367=417%:%
%:%1368=418%:%
%:%1371=419%:%
%:%1375=419%:%
%:%1376=419%:%
%:%1377=420%:%
%:%1378=420%:%
%:%1379=420%:%
%:%1384=420%:%
%:%1387=421%:%
%:%1388=422%:%
%:%1389=422%:%
%:%1390=423%:%
%:%1391=424%:%
%:%1394=425%:%
%:%1398=425%:%
%:%1399=425%:%
%:%1400=426%:%
%:%1401=426%:%
%:%1402=427%:%
%:%1403=427%:%
%:%1408=427%:%
%:%1411=428%:%
%:%1412=429%:%
%:%1413=429%:%
%:%1414=430%:%
%:%1415=431%:%
%:%1422=432%:%
%:%1423=432%:%
%:%1424=433%:%
%:%1425=433%:%
%:%1426=434%:%
%:%1427=434%:%
%:%1428=434%:%
%:%1429=435%:%
%:%1430=435%:%
%:%1431=436%:%
%:%1432=436%:%
%:%1433=436%:%
%:%1434=437%:%
%:%1435=437%:%
%:%1436=438%:%
%:%1437=438%:%
%:%1438=439%:%
%:%1439=439%:%
%:%1440=439%:%
%:%1441=439%:%
%:%1442=440%:%
%:%1443=440%:%
%:%1444=441%:%
%:%1450=441%:%
%:%1453=442%:%
%:%1454=443%:%
%:%1455=443%:%
%:%1456=444%:%
%:%1457=445%:%
%:%1464=446%:%
%:%1465=446%:%
%:%1466=447%:%
%:%1467=447%:%
%:%1468=448%:%
%:%1469=448%:%
%:%1470=449%:%
%:%1471=449%:%
%:%1472=450%:%
%:%1473=450%:%
%:%1474=451%:%
%:%1475=451%:%
%:%1476=452%:%
%:%1491=455%:%
%:%1501=457%:%
%:%1502=457%:%
%:%1505=458%:%
%:%1509=458%:%
%:%1510=458%:%
%:%1515=458%:%
%:%1518=459%:%
%:%1519=460%:%
%:%1520=460%:%
%:%1523=461%:%
%:%1527=461%:%
%:%1528=461%:%
%:%1533=461%:%
%:%1536=462%:%
%:%1537=463%:%
%:%1538=463%:%
%:%1539=464%:%
%:%1546=465%:%
%:%1547=465%:%
%:%1548=466%:%
%:%1549=466%:%
%:%1550=467%:%
%:%1551=467%:%
%:%1552=467%:%
%:%1553=468%:%
%:%1554=468%:%
%:%1555=469%:%
%:%1556=469%:%
%:%1557=470%:%
%:%1558=470%:%
%:%1559=471%:%
%:%1560=471%:%
%:%1561=471%:%
%:%1562=472%:%
%:%1563=472%:%
%:%1564=473%:%
%:%1565=473%:%
%:%1566=473%:%
%:%1567=474%:%
%:%1568=474%:%
%:%1569=475%:%
%:%1570=475%:%
%:%1571=476%:%
%:%1572=476%:%
%:%1573=476%:%
%:%1574=476%:%
%:%1575=477%:%
%:%1576=477%:%
%:%1577=477%:%
%:%1578=478%:%
%:%1579=478%:%
%:%1580=478%:%
%:%1581=479%:%
%:%1582=479%:%
%:%1583=479%:%
%:%1584=480%:%
%:%1585=480%:%
%:%1586=481%:%
%:%1587=481%:%
%:%1588=481%:%
%:%1589=482%:%
%:%1590=482%:%
%:%1591=483%:%
%:%1592=483%:%
%:%1593=484%:%
%:%1594=484%:%
%:%1595=485%:%
%:%1596=485%:%
%:%1597=485%:%
%:%1598=486%:%
%:%1599=486%:%
%:%1600=486%:%
%:%1601=487%:%
%:%1602=487%:%
%:%1603=487%:%
%:%1604=488%:%
%:%1605=488%:%
%:%1606=488%:%
%:%1607=489%:%
%:%1608=489%:%
%:%1609=490%:%
%:%1610=490%:%
%:%1611=490%:%
%:%1612=491%:%
%:%1613=491%:%
%:%1614=492%:%
%:%1615=492%:%
%:%1616=492%:%
%:%1617=493%:%
%:%1618=493%:%
%:%1619=494%:%
%:%1620=494%:%
%:%1621=495%:%
%:%1622=495%:%
%:%1623=496%:%
%:%1624=496%:%
%:%1625=497%:%
%:%1631=497%:%
%:%1634=498%:%
%:%1635=499%:%
%:%1636=499%:%
%:%1637=500%:%
%:%1638=501%:%
%:%1639=502%:%
%:%1646=503%:%
%:%1647=503%:%
%:%1648=504%:%
%:%1649=504%:%
%:%1650=505%:%
%:%1651=505%:%
%:%1652=505%:%
%:%1653=506%:%
%:%1654=506%:%
%:%1655=506%:%
%:%1656=507%:%
%:%1657=507%:%
%:%1658=508%:%
%:%1659=508%:%
%:%1660=508%:%
%:%1661=509%:%
%:%1662=509%:%
%:%1663=510%:%
%:%1669=510%:%
%:%1672=511%:%
%:%1673=512%:%
%:%1674=512%:%
%:%1677=513%:%
%:%1681=513%:%
%:%1682=513%:%
%:%1687=513%:%
%:%1690=514%:%
%:%1691=515%:%
%:%1692=515%:%
%:%1695=516%:%
%:%1699=516%:%
%:%1700=516%:%
%:%1709=518%:%
%:%1710=519%:%
%:%1711=520%:%
%:%1713=522%:%
%:%1714=522%:%
%:%1715=523%:%
%:%1716=524%:%
%:%1717=525%:%
%:%1724=526%:%
%:%1725=526%:%
%:%1726=527%:%
%:%1727=527%:%
%:%1728=528%:%
%:%1729=528%:%
%:%1730=529%:%
%:%1731=529%:%
%:%1732=530%:%
%:%1733=530%:%
%:%1734=531%:%
%:%1735=531%:%
%:%1736=532%:%
%:%1737=532%:%
%:%1738=532%:%
%:%1739=533%:%
%:%1740=533%:%
%:%1741=533%:%
%:%1742=534%:%
%:%1743=534%:%
%:%1744=534%:%
%:%1745=535%:%
%:%1746=535%:%
%:%1747=536%:%
%:%1753=536%:%
%:%1756=537%:%
%:%1757=538%:%
%:%1758=538%:%
%:%1759=539%:%
%:%1762=540%:%
%:%1766=540%:%
%:%1767=540%:%
%:%1768=540%:%
%:%1773=540%:%
%:%1776=541%:%
%:%1777=542%:%
%:%1778=543%:%
%:%1779=543%:%
%:%1780=544%:%
%:%1781=545%:%
%:%1782=546%:%
%:%1785=547%:%
%:%1789=547%:%
%:%1790=547%:%
%:%1791=547%:%
%:%1796=547%:%
%:%1799=548%:%
%:%1800=549%:%
%:%1801=550%:%
%:%1802=550%:%
%:%1805=551%:%
%:%1809=551%:%
%:%1810=551%:%
%:%1815=551%:%
%:%1818=552%:%
%:%1819=553%:%
%:%1820=554%:%
%:%1821=554%:%
%:%1824=555%:%
%:%1828=555%:%
%:%1829=555%:%
%:%1834=555%:%
%:%1837=556%:%
%:%1838=557%:%
%:%1839=557%:%
%:%1840=558%:%
%:%1841=559%:%
%:%1842=560%:%
%:%1849=561%:%
%:%1850=561%:%
%:%1851=562%:%
%:%1852=562%:%
%:%1853=563%:%
%:%1854=563%:%
%:%1855=563%:%
%:%1856=564%:%
%:%1857=564%:%
%:%1858=564%:%
%:%1859=565%:%
%:%1860=565%:%
%:%1861=565%:%
%:%1862=566%:%
%:%1863=566%:%
%:%1864=566%:%
%:%1865=567%:%
%:%1866=567%:%
%:%1867=567%:%
%:%1868=568%:%
%:%1869=568%:%
%:%1870=568%:%
%:%1871=569%:%
%:%1872=569%:%
%:%1873=570%:%
%:%1879=570%:%
%:%1882=571%:%
%:%1883=572%:%
%:%1884=572%:%
%:%1887=573%:%
%:%1891=573%:%
%:%1892=573%:%
%:%1906=576%:%
%:%1916=578%:%
%:%1917=578%:%
%:%1918=579%:%
%:%1919=580%:%
%:%1920=581%:%
%:%1927=582%:%
%:%1928=582%:%
%:%1929=583%:%
%:%1930=583%:%
%:%1931=584%:%
%:%1932=584%:%
%:%1933=584%:%
%:%1934=585%:%
%:%1935=585%:%
%:%1936=586%:%
%:%1937=586%:%
%:%1938=587%:%
%:%1939=587%:%
%:%1944=587%:%
%:%1947=588%:%
%:%1948=589%:%
%:%1949=589%:%
%:%1950=590%:%
%:%1951=591%:%
%:%1958=592%:%
%:%1959=592%:%
%:%1960=593%:%
%:%1961=593%:%
%:%1962=594%:%
%:%1963=594%:%
%:%1964=594%:%
%:%1965=595%:%
%:%1966=595%:%
%:%1967=596%:%
%:%1968=596%:%
%:%1977=598%:%
%:%1979=600%:%
%:%1980=600%:%
%:%1983=601%:%
%:%1987=601%:%
%:%1988=601%:%
%:%1993=601%:%
%:%1996=602%:%
%:%1997=603%:%
%:%1998=603%:%
%:%2001=604%:%
%:%2005=604%:%
%:%2006=604%:%
%:%2007=605%:%
%:%2012=605%:%
%:%2015=606%:%
%:%2016=607%:%
%:%2017=607%:%
%:%2020=608%:%
%:%2024=608%:%
%:%2025=608%:%
%:%2026=609%:%
%:%2031=609%:%
%:%2034=610%:%
%:%2035=611%:%
%:%2036=611%:%
%:%2039=612%:%
%:%2043=612%:%
%:%2044=612%:%
%:%2045=613%:%
%:%2050=613%:%
%:%2053=614%:%
%:%2054=615%:%
%:%2055=615%:%
%:%2058=616%:%
%:%2062=616%:%
%:%2063=616%:%
%:%2064=616%:%
%:%2073=618%:%
%:%2075=619%:%
%:%2076=619%:%
%:%2077=620%:%
%:%2078=621%:%
%:%2079=622%:%
%:%2086=623%:%
%:%2087=623%:%
%:%2088=624%:%
%:%2089=624%:%
%:%2090=625%:%
%:%2091=625%:%
%:%2092=626%:%
%:%2093=626%:%
%:%2094=627%:%
%:%2095=627%:%
%:%2096=627%:%
%:%2097=628%:%
%:%2107=630%:%
%:%2109=631%:%
%:%2110=631%:%
%:%2111=632%:%
%:%2112=633%:%
%:%2113=634%:%
%:%2120=635%:%
%:%2121=635%:%
%:%2122=636%:%
%:%2123=636%:%
%:%2124=637%:%
%:%2125=637%:%
%:%2126=638%:%
%:%2127=638%:%
%:%2128=638%:%
%:%2129=639%:%
%:%2130=639%:%
%:%2131=640%:%
%:%2137=640%:%
%:%2140=641%:%
%:%2141=642%:%
%:%2142=642%:%
%:%2143=643%:%
%:%2150=644%:%
%:%2151=644%:%
%:%2152=645%:%
%:%2153=645%:%
%:%2154=646%:%
%:%2155=646%:%
%:%2156=647%:%
%:%2157=647%:%
%:%2158=647%:%
%:%2159=648%:%
%:%2160=648%:%
%:%2161=649%:%
%:%2162=649%:%
%:%2163=649%:%
%:%2164=650%:%
%:%2165=650%:%
%:%2166=651%:%
%:%2172=651%:%
%:%2175=652%:%
%:%2176=653%:%
%:%2177=653%:%
%:%2178=654%:%
%:%2179=655%:%
%:%2180=656%:%
%:%2187=657%:%
%:%2188=657%:%
%:%2189=658%:%
%:%2190=658%:%
%:%2191=658%:%
%:%2192=659%:%
%:%2193=659%:%
%:%2194=660%:%
%:%2195=660%:%
%:%2196=660%:%
%:%2197=660%:%
%:%2198=661%:%
%:%2199=661%:%
%:%2200=661%:%
%:%2201=662%:%
%:%2202=662%:%
%:%2203=663%:%
%:%2204=663%:%
%:%2205=663%:%
%:%2206=663%:%
%:%2207=664%:%
%:%2213=664%:%
%:%2216=665%:%
%:%2217=666%:%
%:%2218=666%:%
%:%2219=667%:%
%:%2220=668%:%
%:%2221=669%:%
%:%2224=670%:%
%:%2228=670%:%
%:%2229=670%:%
%:%2230=670%:%
%:%2235=670%:%
%:%2238=671%:%
%:%2239=672%:%
%:%2240=672%:%
%:%2241=673%:%
%:%2242=674%:%
%:%2245=675%:%
%:%2249=675%:%
%:%2250=675%:%
%:%2251=675%:%
%:%2256=675%:%
%:%2259=676%:%
%:%2260=677%:%
%:%2261=677%:%
%:%2262=678%:%
%:%2269=679%:%
%:%2270=679%:%
%:%2271=680%:%
%:%2272=680%:%
%:%2273=681%:%
%:%2274=681%:%
%:%2275=681%:%
%:%2276=682%:%
%:%2277=682%:%
%:%2278=682%:%
%:%2279=682%:%
%:%2280=683%:%
%:%2281=683%:%
%:%2282=683%:%
%:%2283=684%:%
%:%2284=684%:%
%:%2285=684%:%
%:%2286=684%:%
%:%2287=684%:%
%:%2288=685%:%
%:%2289=685%:%
%:%2290=686%:%
%:%2291=686%:%
%:%2292=686%:%
%:%2293=687%:%
%:%2294=687%:%
%:%2295=687%:%
%:%2296=688%:%
%:%2297=688%:%
%:%2298=688%:%
%:%2299=688%:%
%:%2300=688%:%
%:%2301=689%:%
%:%2302=689%:%
%:%2303=689%:%
%:%2304=689%:%
%:%2305=689%:%
%:%2306=690%:%
%:%2307=690%:%
%:%2308=691%:%
%:%2309=691%:%
%:%2310=691%:%
%:%2311=691%:%
%:%2312=691%:%
%:%2313=692%:%
%:%2314=692%:%
%:%2315=692%:%
%:%2316=693%:%
%:%2317=693%:%
%:%2318=693%:%
%:%2319=694%:%
%:%2334=697%:%
%:%2346=700%:%
%:%2347=701%:%
%:%2348=702%:%
%:%2349=703%:%
%:%2350=704%:%
%:%2352=707%:%
%:%2353=707%:%
%:%2354=708%:%
%:%2355=709%:%
%:%2356=710%:%
%:%2357=711%:%
%:%2358=712%:%
%:%2359=713%:%
%:%2360=714%:%
%:%2361=715%:%
%:%2362=716%:%
%:%2363=717%:%
%:%2364=718%:%
%:%2365=719%:%
%:%2366=720%:%
%:%2368=722%:%
%:%2369=723%:%
%:%2370=723%:%
%:%2371=724%:%
%:%2372=725%:%
%:%2373=725%:%
%:%2374=726%:%
%:%2375=727%:%
%:%2376=728%:%
%:%2377=728%:%
%:%2378=729%:%
%:%2379=730%:%
%:%2380=731%:%
%:%2387=732%:%
%:%2388=732%:%
%:%2389=733%:%
%:%2390=733%:%
%:%2391=733%:%
%:%2392=734%:%
%:%2393=734%:%
%:%2394=735%:%
%:%2395=735%:%
%:%2396=735%:%
%:%2397=735%:%
%:%2398=736%:%
%:%2399=736%:%
%:%2400=736%:%
%:%2401=736%:%
%:%2402=737%:%
%:%2403=737%:%
%:%2404=737%:%
%:%2405=737%:%
%:%2406=738%:%
%:%2407=738%:%
%:%2408=739%:%
%:%2409=739%:%
%:%2410=739%:%
%:%2411=739%:%
%:%2412=740%:%
%:%2413=740%:%
%:%2414=741%:%
%:%2415=741%:%
%:%2416=742%:%
%:%2417=742%:%
%:%2418=742%:%
%:%2419=743%:%
%:%2420=743%:%
%:%2421=744%:%
%:%2422=744%:%
%:%2423=744%:%
%:%2424=744%:%
%:%2425=745%:%
%:%2426=745%:%
%:%2427=746%:%
%:%2428=746%:%
%:%2429=747%:%
%:%2430=747%:%
%:%2431=747%:%
%:%2432=747%:%
%:%2433=748%:%
%:%2434=748%:%
%:%2435=748%:%
%:%2436=749%:%
%:%2437=749%:%
%:%2438=750%:%
%:%2444=750%:%
%:%2447=751%:%
%:%2448=752%:%
%:%2449=752%:%
%:%2450=753%:%
%:%2451=754%:%
%:%2452=755%:%
%:%2459=756%:%
%:%2460=756%:%
%:%2461=757%:%
%:%2462=757%:%
%:%2463=758%:%
%:%2464=758%:%
%:%2465=758%:%
%:%2466=758%:%
%:%2467=759%:%
%:%2468=759%:%
%:%2469=760%:%
%:%2470=760%:%
%:%2471=761%:%
%:%2472=761%:%
%:%2473=761%:%
%:%2474=762%:%
%:%2475=762%:%
%:%2476=763%:%
%:%2477=763%:%
%:%2478=763%:%
%:%2479=763%:%
%:%2480=764%:%
%:%2481=764%:%
%:%2482=764%:%
%:%2483=764%:%
%:%2484=765%:%
%:%2485=765%:%
%:%2486=765%:%
%:%2487=765%:%
%:%2488=766%:%
%:%2489=766%:%
%:%2490=767%:%
%:%2491=767%:%
%:%2492=767%:%
%:%2493=768%:%
%:%2494=768%:%
%:%2495=768%:%
%:%2496=768%:%
%:%2497=769%:%
%:%2498=769%:%
%:%2499=769%:%
%:%2500=769%:%
%:%2501=770%:%
%:%2502=770%:%
%:%2503=771%:%
%:%2504=771%:%
%:%2505=772%:%
%:%2506=772%:%
%:%2507=772%:%
%:%2508=772%:%
%:%2509=773%:%
%:%2510=773%:%
%:%2511=773%:%
%:%2512=774%:%
%:%2513=774%:%
%:%2514=775%:%
%:%2520=775%:%
%:%2523=776%:%
%:%2524=777%:%
%:%2525=777%:%
%:%2526=778%:%
%:%2527=779%:%
%:%2534=780%:%
%:%2535=780%:%
%:%2536=781%:%
%:%2537=781%:%
%:%2538=782%:%
%:%2539=782%:%
%:%2540=782%:%
%:%2541=782%:%
%:%2542=782%:%
%:%2543=783%:%
%:%2544=783%:%
%:%2545=784%:%
%:%2546=784%:%
%:%2547=785%:%
%:%2548=785%:%
%:%2549=786%:%
%:%2550=786%:%
%:%2551=786%:%
%:%2552=787%:%
%:%2553=787%:%
%:%2554=788%:%
%:%2555=788%:%
%:%2556=789%:%
%:%2557=789%:%
%:%2558=789%:%
%:%2559=790%:%
%:%2565=790%:%
%:%2568=791%:%
%:%2569=792%:%
%:%2570=792%:%
%:%2571=793%:%
%:%2574=794%:%
%:%2578=794%:%
%:%2579=794%:%
%:%2584=794%:%
%:%2587=795%:%
%:%2588=796%:%
%:%2589=796%:%
%:%2590=797%:%
%:%2593=798%:%
%:%2597=798%:%
%:%2598=798%:%
%:%2607=801%:%
%:%2608=802%:%
%:%2609=803%:%
%:%2610=804%:%
%:%2612=807%:%
%:%2613=807%:%
%:%2614=808%:%
%:%2615=809%:%
%:%2618=810%:%
%:%2622=810%:%
%:%2623=810%:%
%:%2632=813%:%
%:%2633=814%:%
%:%2634=815%:%
%:%2635=816%:%
%:%2636=817%:%
%:%2638=820%:%
%:%2639=820%:%
%:%2640=821%:%
%:%2641=822%:%
%:%2648=823%:%
%:%2649=823%:%
%:%2650=824%:%
%:%2651=824%:%
%:%2652=824%:%
%:%2653=824%:%
%:%2654=824%:%
%:%2655=825%:%
%:%2656=825%:%
%:%2657=825%:%
%:%2658=826%:%
%:%2659=826%:%
%:%2660=827%:%
%:%2661=827%:%
%:%2662=828%:%
%:%2663=828%:%
%:%2664=829%:%
%:%2665=829%:%
%:%2667=831%:%
%:%2668=832%:%
%:%2669=832%:%
%:%2670=833%:%
%:%2671=833%:%
%:%2672=834%:%
%:%2673=834%:%
%:%2674=835%:%
%:%2675=835%:%
%:%2676=836%:%
%:%2677=837%:%
%:%2678=837%:%
%:%2679=838%:%
%:%2680=838%:%
%:%2681=838%:%
%:%2682=839%:%
%:%2683=839%:%
%:%2684=840%:%
%:%2685=841%:%
%:%2686=841%:%
%:%2687=842%:%
%:%2688=842%:%
%:%2689=842%:%
%:%2690=842%:%
%:%2691=843%:%
%:%2692=843%:%
%:%2693=844%:%
%:%2694=844%:%
%:%2695=844%:%
%:%2696=844%:%
%:%2697=845%:%
%:%2698=845%:%
%:%2699=846%:%
%:%2700=846%:%
%:%2701=847%:%
%:%2702=847%:%
%:%2703=848%:%
%:%2704=849%:%
%:%2705=849%:%
%:%2706=850%:%
%:%2707=850%:%
%:%2708=850%:%
%:%2709=851%:%
%:%2710=851%:%
%:%2711=852%:%
%:%2712=853%:%
%:%2713=853%:%
%:%2714=854%:%
%:%2715=854%:%
%:%2716=854%:%
%:%2717=854%:%
%:%2718=855%:%
%:%2719=855%:%
%:%2720=856%:%
%:%2721=856%:%
%:%2722=856%:%
%:%2724=858%:%
%:%2725=859%:%
%:%2726=859%:%
%:%2727=860%:%
%:%2728=860%:%
%:%2729=860%:%
%:%2730=861%:%
%:%2731=861%:%
%:%2732=862%:%
%:%2733=862%:%
%:%2734=862%:%
%:%2735=862%:%
%:%2736=863%:%
%:%2746=865%:%
%:%2748=867%:%
%:%2749=867%:%
%:%2750=868%:%
%:%2751=869%:%
%:%2752=870%:%
%:%2755=871%:%
%:%2759=871%:%
%:%2760=871%:%
%:%2761=871%:%
%:%2770=873%:%
%:%2772=875%:%
%:%2773=875%:%
%:%2774=876%:%
%:%2775=877%:%
%:%2782=878%:%
%:%2783=878%:%
%:%2784=879%:%
%:%2785=879%:%
%:%2786=880%:%
%:%2787=881%:%
%:%2788=881%:%
%:%2789=882%:%
%:%2790=882%:%
%:%2791=882%:%
%:%2792=883%:%
%:%2793=883%:%
%:%2794=883%:%
%:%2795=884%:%
%:%2796=884%:%
%:%2797=885%:%
%:%2798=886%:%
%:%2799=887%:%
%:%2809=889%:%
%:%2811=891%:%
%:%2812=891%:%
%:%2813=892%:%
%:%2817=896%:%
%:%2818=897%:%
%:%2822=901%:%
%:%2825=902%:%
%:%2829=902%:%
%:%2830=902%:%
%:%2835=902%:%
%:%2838=903%:%
%:%2839=904%:%
%:%2840=904%:%
%:%2842=906%:%
%:%2844=908%:%
%:%2845=908%:%
%:%2846=909%:%
%:%2847=910%:%
%:%2848=911%:%
%:%2849=912%:%
%:%2850=912%:%
%:%2851=913%:%
%:%2854=914%:%
%:%2858=914%:%
%:%2859=914%:%
%:%2864=914%:%
%:%2867=915%:%
%:%2868=916%:%
%:%2869=916%:%
%:%2870=917%:%
%:%2873=918%:%
%:%2877=918%:%
%:%2878=918%:%
%:%2887=920%:%
%:%2889=922%:%
%:%2890=922%:%
%:%2891=923%:%
%:%2894=924%:%
%:%2898=924%:%
%:%2899=924%:%
%:%2904=924%:%
%:%2907=925%:%
%:%2908=926%:%
%:%2909=926%:%
%:%2910=927%:%
%:%2913=928%:%
%:%2917=928%:%
%:%2918=928%:%
%:%2923=928%:%
%:%2926=929%:%
%:%2927=930%:%
%:%2928=930%:%
%:%2929=931%:%
%:%2932=932%:%
%:%2936=932%:%
%:%2937=932%:%
%:%2942=932%:%
%:%2945=933%:%
%:%2946=934%:%
%:%2947=934%:%
%:%2948=935%:%
%:%2951=936%:%
%:%2955=936%:%
%:%2956=936%:%
%:%2965=938%:%
%:%2967=940%:%
%:%2968=940%:%
%:%2969=941%:%
%:%2970=942%:%
%:%2971=943%:%
%:%2972=944%:%
%:%2973=945%:%
%:%2974=946%:%
%:%2975=947%:%
%:%2976=948%:%
%:%2977=949%:%
%:%2978=950%:%
%:%2979=951%:%
%:%2980=952%:%
%:%2981=953%:%
%:%2982=954%:%
%:%2983=955%:%
%:%2984=956%:%
%:%2985=957%:%
%:%2986=958%:%
%:%2987=959%:%
%:%2988=960%:%
%:%2989=961%:%
%:%2990=962%:%
%:%2991=963%:%
%:%2992=964%:%
%:%2993=965%:%
%:%2994=966%:%
%:%2997=967%:%
%:%3001=967%:%
%:%3002=967%:%
%:%3007=967%:%
%:%3010=968%:%
%:%3011=969%:%
%:%3012=969%:%
%:%3013=970%:%
%:%3014=971%:%
%:%3015=971%:%
%:%3016=972%:%
%:%3017=973%:%
%:%3018=973%:%
%:%3019=974%:%
%:%3020=975%:%
%:%3021=976%:%
%:%3022=976%:%
%:%3023=977%:%
%:%3024=978%:%
%:%3025=979%:%
%:%3026=980%:%
%:%3027=980%:%
%:%3028=981%:%
%:%3029=982%:%
%:%3031=984%:%
%:%3032=985%:%
%:%3033=986%:%
%:%3036=986%:%
%:%3040=986%:%
%:%3041=986%:%
%:%3042=987%:%
%:%3049=987%:%
%:%3050=988%:%
%:%3051=989%:%
%:%3052=989%:%
%:%3053=990%:%
%:%3054=991%:%
%:%3055=991%:%
%:%3056=992%:%
%:%3057=993%:%
%:%3058=993%:%
%:%3059=994%:%
%:%3060=995%:%
%:%3063=996%:%
%:%3067=996%:%
%:%3068=996%:%
%:%3073=996%:%
%:%3076=997%:%
%:%3077=998%:%
%:%3078=998%:%
%:%3079=999%:%
%:%3080=1000%:%
%:%3083=1001%:%
%:%3087=1001%:%
%:%3088=1001%:%
%:%3093=1001%:%
%:%3096=1002%:%
%:%3097=1003%:%
%:%3098=1003%:%
%:%3099=1004%:%
%:%3100=1005%:%
%:%3101=1006%:%
%:%3102=1006%:%
%:%3103=1007%:%
%:%3104=1008%:%
%:%3105=1009%:%
%:%3106=1010%:%
%:%3107=1010%:%
%:%3108=1011%:%
%:%3109=1012%:%
%:%3111=1014%:%
%:%3112=1015%:%
%:%3113=1016%:%
%:%3114=1016%:%
%:%3117=1017%:%
%:%3121=1017%:%
%:%3122=1017%:%
%:%3123=1018%:%
%:%3128=1018%:%
%:%3131=1019%:%
%:%3132=1020%:%
%:%3133=1020%:%
%:%3134=1021%:%
%:%3135=1022%:%
%:%3136=1022%:%
%:%3137=1023%:%
%:%3138=1024%:%
%:%3139=1024%:%
%:%3140=1025%:%
%:%3141=1026%:%
%:%3142=1027%:%
%:%3143=1027%:%
%:%3144=1028%:%
%:%3145=1029%:%
%:%3146=1030%:%
%:%3147=1031%:%
%:%3148=1031%:%
%:%3149=1032%:%
%:%3152=1033%:%
%:%3156=1033%:%
%:%3157=1033%:%
%:%3158=1034%:%
%:%3159=1035%:%
%:%3166=1035%:%
%:%3167=1035%:%
%:%3168=1036%:%
%:%3169=1037%:%
%:%3170=1038%:%
%:%3171=1039%:%
%:%3172=1039%:%
%:%3173=1040%:%
%:%3180=1041%:%
%:%3181=1041%:%
%:%3182=1042%:%
%:%3183=1042%:%
%:%3184=1043%:%
%:%3185=1043%:%
%:%3186=1044%:%
%:%3187=1044%:%
%:%3188=1044%:%
%:%3189=1045%:%
%:%3190=1045%:%
%:%3191=1046%:%
%:%3197=1046%:%
%:%3200=1047%:%
%:%3201=1048%:%
%:%3202=1048%:%
%:%3203=1049%:%
%:%3210=1050%:%
%:%3211=1050%:%
%:%3212=1051%:%
%:%3213=1051%:%
%:%3214=1052%:%
%:%3215=1052%:%
%:%3216=1052%:%
%:%3217=1053%:%
%:%3218=1053%:%
%:%3219=1054%:%
%:%3220=1054%:%
%:%3221=1055%:%
%:%3222=1055%:%
%:%3223=1056%:%
%:%3224=1056%:%
%:%3225=1056%:%
%:%3226=1057%:%
%:%3227=1057%:%
%:%3228=1058%:%
%:%3229=1058%:%
%:%3230=1058%:%
%:%3231=1059%:%
%:%3232=1059%:%
%:%3233=1060%:%
%:%3234=1061%:%
%:%3240=1061%:%
%:%3243=1062%:%
%:%3244=1063%:%
%:%3245=1063%:%
%:%3246=1064%:%
%:%3253=1065%:%
%:%3254=1065%:%
%:%3255=1066%:%
%:%3256=1066%:%
%:%3257=1067%:%
%:%3258=1067%:%
%:%3259=1068%:%
%:%3260=1068%:%
%:%3261=1068%:%
%:%3262=1069%:%
%:%3263=1069%:%
%:%3264=1070%:%
%:%3270=1070%:%
%:%3273=1071%:%
%:%3274=1072%:%
%:%3275=1072%:%
%:%3276=1073%:%
%:%3283=1074%:%
%:%3284=1074%:%
%:%3285=1075%:%
%:%3286=1075%:%
%:%3287=1076%:%
%:%3288=1076%:%
%:%3289=1076%:%
%:%3290=1077%:%
%:%3291=1077%:%
%:%3292=1078%:%
%:%3293=1078%:%
%:%3294=1079%:%
%:%3295=1079%:%
%:%3296=1080%:%
%:%3297=1080%:%
%:%3298=1080%:%
%:%3299=1081%:%
%:%3300=1081%:%
%:%3301=1082%:%
%:%3302=1082%:%
%:%3303=1082%:%
%:%3304=1083%:%
%:%3305=1083%:%
%:%3306=1084%:%
%:%3307=1085%:%
%:%3313=1085%:%
%:%3316=1086%:%
%:%3317=1087%:%
%:%3318=1087%:%
%:%3319=1088%:%
%:%3322=1089%:%
%:%3326=1089%:%
%:%3327=1089%:%
%:%3328=1089%:%
%:%3333=1089%:%
%:%3336=1090%:%
%:%3337=1091%:%
%:%3338=1091%:%
%:%3339=1092%:%
%:%3342=1093%:%
%:%3346=1093%:%
%:%3347=1093%:%
%:%3348=1093%:%
%:%3353=1093%:%
%:%3356=1094%:%
%:%3357=1095%:%
%:%3358=1095%:%
%:%3359=1096%:%
%:%3362=1097%:%
%:%3366=1097%:%
%:%3367=1097%:%
%:%3368=1097%:%
%:%3373=1097%:%
%:%3376=1098%:%
%:%3377=1099%:%
%:%3378=1099%:%
%:%3379=1100%:%
%:%3382=1101%:%
%:%3386=1101%:%
%:%3387=1101%:%
%:%3388=1101%:%
%:%3393=1101%:%
%:%3396=1102%:%
%:%3397=1103%:%
%:%3398=1103%:%
%:%3399=1104%:%
%:%3400=1105%:%
%:%3401=1105%:%
%:%3402=1106%:%
%:%3405=1107%:%
%:%3409=1107%:%
%:%3410=1107%:%
%:%3415=1107%:%
%:%3418=1108%:%
%:%3419=1109%:%
%:%3420=1109%:%
%:%3421=1110%:%
%:%3424=1111%:%
%:%3428=1111%:%
%:%3429=1111%:%
%:%3430=1111%:%
%:%3444=1114%:%
%:%3456=1117%:%
%:%3457=1118%:%
%:%3458=1119%:%
%:%3466=1122%:%
%:%3467=1122%:%
%:%3468=1123%:%
%:%3469=1124%:%
%:%3470=1125%:%
%:%3471=1126%:%
%:%3472=1127%:%
%:%3473=1128%:%
%:%3474=1129%:%
%:%3475=1130%:%
%:%3476=1131%:%
%:%3477=1132%:%
%:%3478=1133%:%
%:%3479=1134%:%
%:%3480=1135%:%
%:%3481=1136%:%
%:%3482=1137%:%
%:%3483=1138%:%
%:%3484=1139%:%
%:%3485=1140%:%
%:%3486=1141%:%
%:%3487=1142%:%
%:%3488=1143%:%
%:%3489=1144%:%
%:%3490=1145%:%
%:%3491=1146%:%
%:%3528=1172%:%
%:%3538=1174%:%
%:%3539=1174%:%
%:%3540=1175%:%
%:%3541=1176%:%
%:%3542=1177%:%
%:%3543=1177%:%
%:%3544=1178%:%
%:%3547=1179%:%
%:%3551=1179%:%
%:%3552=1179%:%
%:%3557=1179%:%
%:%3560=1180%:%
%:%3561=1181%:%
%:%3562=1181%:%
%:%3563=1182%:%
%:%3566=1183%:%
%:%3570=1183%:%
%:%3571=1183%:%
%:%3576=1183%:%
%:%3579=1184%:%
%:%3580=1185%:%
%:%3581=1185%:%
%:%3582=1186%:%
%:%3583=1187%:%
%:%3586=1188%:%
%:%3590=1188%:%
%:%3591=1188%:%
%:%3596=1188%:%
%:%3599=1189%:%
%:%3600=1190%:%
%:%3601=1190%:%
%:%3602=1191%:%
%:%3603=1192%:%
%:%3606=1193%:%
%:%3610=1193%:%
%:%3611=1193%:%
%:%3616=1193%:%
%:%3619=1194%:%
%:%3620=1195%:%
%:%3621=1195%:%
%:%3622=1196%:%
%:%3623=1197%:%
%:%3624=1198%:%
%:%3625=1199%:%
%:%3626=1200%:%
%:%3627=1201%:%
%:%3628=1202%:%
%:%3629=1203%:%
%:%3630=1204%:%
%:%3631=1205%:%
%:%3632=1206%:%
%:%3633=1207%:%
%:%3634=1208%:%
%:%3635=1209%:%
%:%3636=1210%:%
%:%3637=1211%:%
%:%3638=1212%:%
%:%3639=1213%:%
%:%3642=1214%:%
%:%3646=1214%:%
%:%3647=1214%:%
%:%3652=1214%:%
%:%3655=1215%:%
%:%3656=1216%:%
%:%3657=1216%:%
%:%3658=1217%:%
%:%3665=1220%:%
%:%3675=1222%:%
%:%3676=1222%:%
%:%3679=1223%:%
%:%3683=1223%:%
%:%3684=1223%:%
%:%3689=1223%:%
%:%3692=1224%:%
%:%3693=1225%:%
%:%3694=1225%:%
%:%3697=1226%:%
%:%3701=1226%:%
%:%3702=1226%:%
%:%3707=1226%:%
%:%3710=1227%:%
%:%3711=1228%:%
%:%3712=1228%:%
%:%3715=1229%:%
%:%3719=1229%:%
%:%3720=1229%:%
%:%3721=1229%:%
%:%3726=1229%:%
%:%3729=1230%:%
%:%3730=1231%:%
%:%3731=1231%:%
%:%3734=1232%:%
%:%3738=1232%:%
%:%3739=1232%:%
%:%3744=1232%:%
%:%3747=1233%:%
%:%3748=1234%:%
%:%3749=1234%:%
%:%3752=1235%:%
%:%3756=1235%:%
%:%3757=1235%:%
%:%3762=1235%:%
%:%3765=1236%:%
%:%3766=1237%:%
%:%3767=1237%:%
%:%3770=1238%:%
%:%3774=1238%:%
%:%3775=1238%:%
%:%3780=1238%:%
%:%3783=1239%:%
%:%3784=1240%:%
%:%3785=1241%:%
%:%3786=1241%:%
%:%3789=1242%:%
%:%3793=1242%:%
%:%3794=1242%:%
%:%3795=1242%:%
%:%3800=1242%:%
%:%3805=1243%:%
%:%3810=1244%:%
