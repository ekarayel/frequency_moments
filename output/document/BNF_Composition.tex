%
\begin{isabellebody}%
\setisabellecontext{BNF{\isacharunderscore}{\kern0pt}Composition}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Composition of Bounded Natural Functors%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ BNF{\isacharunderscore}{\kern0pt}Composition\isanewline
\isakeyword{imports}\ BNF{\isacharunderscore}{\kern0pt}Def\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ ssubst{\isacharunderscore}{\kern0pt}mem{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlbrakk}t\ {\isacharequal}{\kern0pt}\ s{\isacharsemicolon}{\kern0pt}\ s\ {\isasymin}\ X{\isasymrbrakk}\ {\isasymLongrightarrow}\ t\ {\isasymin}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ empty{\isacharunderscore}{\kern0pt}natural{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\ f\ {\isacharequal}{\kern0pt}\ image\ g\ {\isasymcirc}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Union{\isacharunderscore}{\kern0pt}natural{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Union\ {\isasymcirc}\ image\ {\isacharparenleft}{\kern0pt}image\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ image\ f\ {\isasymcirc}\ Union{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp\ only{\isacharcolon}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}apply{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ in{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}o{\isacharunderscore}{\kern0pt}assoc{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharparenleft}{\kern0pt}Union\ {\isasymcirc}\ gset\ {\isasymcirc}\ gmap{\isacharparenright}{\kern0pt}\ A\ {\isasymLongrightarrow}\ x\ {\isasymin}\ {\isacharparenleft}{\kern0pt}Union\ {\isasymcirc}\ {\isacharparenleft}{\kern0pt}gset\ {\isasymcirc}\ gmap{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}unfold\ comp{\isacharunderscore}{\kern0pt}assoc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}single{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}bd{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ fbd{\isacharunderscore}{\kern0pt}Card{\isacharunderscore}{\kern0pt}order{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Card{\isacharunderscore}{\kern0pt}order\ fbd{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ fset{\isacharunderscore}{\kern0pt}bd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ {\isacharbar}{\kern0pt}fset\ x{\isacharbar}{\kern0pt}\ {\isasymle}o\ fbd{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ gset{\isacharunderscore}{\kern0pt}bd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ {\isacharbar}{\kern0pt}gset\ x{\isacharbar}{\kern0pt}\ {\isasymle}o\ gbd{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharbar}{\kern0pt}{\isasymUnion}{\isacharparenleft}{\kern0pt}fset\ {\isacharbackquote}{\kern0pt}\ gset\ x{\isacharparenright}{\kern0pt}{\isacharbar}{\kern0pt}\ {\isasymle}o\ gbd\ {\isacharasterisk}{\kern0pt}c\ fbd{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ordLeq{\isacharunderscore}{\kern0pt}transitive{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ card{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}UNION{\isacharunderscore}{\kern0pt}Sigma{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ SIGMA{\isacharunderscore}{\kern0pt}CSUM{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ordLeq{\isacharunderscore}{\kern0pt}transitive{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ card{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Csum{\isacharunderscore}{\kern0pt}Times{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ fbd{\isacharunderscore}{\kern0pt}Card{\isacharunderscore}{\kern0pt}order{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ballI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ fset{\isacharunderscore}{\kern0pt}bd{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ordLeq{\isacharunderscore}{\kern0pt}transitive{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ cprod{\isacharunderscore}{\kern0pt}mono{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ gset{\isacharunderscore}{\kern0pt}bd{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ordIso{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}ordLeq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ordIso{\isacharunderscore}{\kern0pt}refl{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ Card{\isacharunderscore}{\kern0pt}order{\isacharunderscore}{\kern0pt}cprod{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ csum{\isacharunderscore}{\kern0pt}dup{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cinfinite\ r\ {\isasymLongrightarrow}\ Card{\isacharunderscore}{\kern0pt}order\ r\ {\isasymLongrightarrow}\ p\ {\isacharplus}{\kern0pt}c\ p{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}o\ r\ {\isacharplus}{\kern0pt}c\ r\ {\isasymLongrightarrow}\ p\ {\isacharplus}{\kern0pt}c\ p{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}o\ r{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}erule\ ordIso{\isacharunderscore}{\kern0pt}transitive{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}frule\ csum{\isacharunderscore}{\kern0pt}absorb{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}erule\ ordLeq{\isacharunderscore}{\kern0pt}refl{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cprod{\isacharunderscore}{\kern0pt}dup{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}cinfinite\ r\ {\isasymLongrightarrow}\ Card{\isacharunderscore}{\kern0pt}order\ r\ {\isasymLongrightarrow}\ p\ {\isacharasterisk}{\kern0pt}c\ p{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}o\ r\ {\isacharasterisk}{\kern0pt}c\ r\ {\isasymLongrightarrow}\ p\ {\isacharasterisk}{\kern0pt}c\ p{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}o\ r{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}erule\ ordIso{\isacharunderscore}{\kern0pt}transitive{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ cprod{\isacharunderscore}{\kern0pt}infinite{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Union{\isacharunderscore}{\kern0pt}image{\isacharunderscore}{\kern0pt}insert{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymUnion}{\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ insert\ a\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ a\ {\isasymunion}\ {\isasymUnion}{\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Union{\isacharunderscore}{\kern0pt}image{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymunion}\ {\isasymUnion}{\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ image{\isacharunderscore}{\kern0pt}o{\isacharunderscore}{\kern0pt}collect{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}collect\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}f{\isachardot}{\kern0pt}\ image\ g\ {\isasymcirc}\ f{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ image\ g\ {\isasymcirc}\ collect\ F{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ collect{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ conj{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ P\ x\ {\isasymand}\ Q\ x{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ P\ x{\isacharbraceright}{\kern0pt}\ {\isasymand}\ A\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ Q\ x{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ UN{\isacharunderscore}{\kern0pt}image{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymUnion}{\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ g\ x{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ X\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ x\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ f\ x\ {\isasymsubseteq}\ X{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ comp{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}bd{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}o{\isacharunderscore}{\kern0pt}collect{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbar}{\kern0pt}{\isasymUnion}{\isacharparenleft}{\kern0pt}{\isasymUnion}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}f{\isachardot}{\kern0pt}\ f\ x{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbar}{\kern0pt}\ {\isasymle}o\ hbd\ {\isasymLongrightarrow}\ {\isacharbar}{\kern0pt}{\isacharparenleft}{\kern0pt}Union\ {\isasymcirc}\ collect\ X{\isacharparenright}{\kern0pt}\ x{\isacharbar}{\kern0pt}\ {\isasymle}o\ hbd{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}unfold\ comp{\isacharunderscore}{\kern0pt}apply\ collect{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Collect{\isacharunderscore}{\kern0pt}inj{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Collect\ P\ {\isacharequal}{\kern0pt}\ Collect\ Q\ {\isasymLongrightarrow}\ P\ {\isacharequal}{\kern0pt}\ Q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Grp{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}Grp\ {\isacharparenleft}{\kern0pt}Collect\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ R{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ fst{\isacharparenright}{\kern0pt}{\isasyminverse}{\isasyminverse}\ OO\ Grp\ {\isacharparenleft}{\kern0pt}Collect\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ R{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ snd\ {\isacharequal}{\kern0pt}\ R{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Grp{\isacharunderscore}{\kern0pt}def\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ relcompp{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ OO{\isacharunderscore}{\kern0pt}Grp{\isacharunderscore}{\kern0pt}cong{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isacharequal}{\kern0pt}\ B\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}Grp\ A\ f{\isacharparenright}{\kern0pt}{\isasyminverse}{\isasyminverse}\ OO\ Grp\ A\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Grp\ B\ f{\isacharparenright}{\kern0pt}{\isasyminverse}{\isasyminverse}\ OO\ Grp\ B\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ vimage{\isadigit{2}}p{\isacharunderscore}{\kern0pt}relcompp{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}R\ OO\ S\ {\isasymle}\ T\ {\isasymLongrightarrow}\isanewline
\ \ vimage{\isadigit{2}}p\ f\ g\ R\ OO\ vimage{\isadigit{2}}p\ g\ h\ S\ {\isasymle}\ vimage{\isadigit{2}}p\ f\ h\ T{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ vimage{\isadigit{2}}p{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}copy{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}cong{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}M\ {\isacharparenleft}{\kern0pt}g\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ N\ {\isacharparenleft}{\kern0pt}h\ x{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\ M\ {\isasymcirc}\ g{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\ N\ {\isasymcirc}\ h{\isacharparenright}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}copy{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}bd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}y{\isachardot}{\kern0pt}\ {\isacharbar}{\kern0pt}S\ y{\isacharbar}{\kern0pt}\ {\isasymle}o\ bd{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharbar}{\kern0pt}{\isacharparenleft}{\kern0pt}S\ {\isasymcirc}\ Rep{\isacharparenright}{\kern0pt}\ x{\isacharbar}{\kern0pt}\ {\isasymle}o\ bd{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ vimage{\isadigit{2}}p{\isacharunderscore}{\kern0pt}cong{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}R\ {\isacharequal}{\kern0pt}\ S\ {\isasymLongrightarrow}\ vimage{\isadigit{2}}p\ f\ g\ R\ {\isacharequal}{\kern0pt}\ vimage{\isadigit{2}}p\ f\ g\ S{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Ball{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ Ball\ {\isacharparenleft}{\kern0pt}A\ x{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ {\isasymcirc}\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ Ball\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymcirc}\ g{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ o{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ conj{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ P\ x\ {\isasymand}\ Q\ x{\isacharparenright}{\kern0pt}\ {\isasymcirc}\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}P\ {\isasymcirc}\ g{\isacharparenright}{\kern0pt}\ x\ {\isasymand}\ {\isacharparenleft}{\kern0pt}Q\ {\isasymcirc}\ g{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ o{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{context}\isamarkupfalse%
\isanewline
\ \ \isakeyword{fixes}\ Rep\ Abs\isanewline
\ \ \isakeyword{assumes}\ type{\isacharunderscore}{\kern0pt}copy{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}type{\isacharunderscore}{\kern0pt}definition\ Rep\ Abs\ UNIV{\isachardoublequoteclose}\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}copy{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}id{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}M\ {\isacharequal}{\kern0pt}\ id\ {\isasymLongrightarrow}\ Abs\ {\isasymcirc}\ M\ {\isasymcirc}\ Rep\ {\isacharequal}{\kern0pt}\ id{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}definition{\isachardot}{\kern0pt}Rep{\isacharunderscore}{\kern0pt}inverse{\isacharbrackleft}{\kern0pt}OF\ type{\isacharunderscore}{\kern0pt}copy{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}copy{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}comp{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}M\ {\isacharequal}{\kern0pt}\ M{\isadigit{1}}\ {\isasymcirc}\ M{\isadigit{2}}\ {\isasymLongrightarrow}\ f\ {\isasymcirc}\ M\ {\isasymcirc}\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\ M{\isadigit{1}}\ {\isasymcirc}\ Rep{\isacharparenright}{\kern0pt}\ {\isasymcirc}\ {\isacharparenleft}{\kern0pt}Abs\ {\isasymcirc}\ M{\isadigit{2}}\ {\isasymcirc}\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}definition{\isachardot}{\kern0pt}Abs{\isacharunderscore}{\kern0pt}inverse{\isacharbrackleft}{\kern0pt}OF\ type{\isacharunderscore}{\kern0pt}copy\ UNIV{\isacharunderscore}{\kern0pt}I{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}copy{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}map{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}S\ {\isasymcirc}\ M\ {\isacharequal}{\kern0pt}\ image\ f\ {\isasymcirc}\ S{\isacharprime}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}S\ {\isasymcirc}\ Rep{\isacharparenright}{\kern0pt}\ {\isasymcirc}\ {\isacharparenleft}{\kern0pt}Abs\ {\isasymcirc}\ M\ {\isasymcirc}\ g{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ image\ f\ {\isasymcirc}\ {\isacharparenleft}{\kern0pt}S{\isacharprime}{\kern0pt}\ {\isasymcirc}\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}definition{\isachardot}{\kern0pt}Abs{\isacharunderscore}{\kern0pt}inverse{\isacharbrackleft}{\kern0pt}OF\ type{\isacharunderscore}{\kern0pt}copy\ UNIV{\isacharunderscore}{\kern0pt}I{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ o{\isacharunderscore}{\kern0pt}def\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}copy{\isacharunderscore}{\kern0pt}wit{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharparenleft}{\kern0pt}S\ {\isasymcirc}\ Rep{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Abs\ y{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ x\ {\isasymin}\ S\ y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}definition{\isachardot}{\kern0pt}Abs{\isacharunderscore}{\kern0pt}inverse{\isacharbrackleft}{\kern0pt}OF\ type{\isacharunderscore}{\kern0pt}copy\ UNIV{\isacharunderscore}{\kern0pt}I{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}copy{\isacharunderscore}{\kern0pt}vimage{\isadigit{2}}p{\isacharunderscore}{\kern0pt}Grp{\isacharunderscore}{\kern0pt}Rep{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}vimage{\isadigit{2}}p\ f\ Rep\ {\isacharparenleft}{\kern0pt}Grp\ {\isacharparenleft}{\kern0pt}Collect\ P{\isacharparenright}{\kern0pt}\ h{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ Grp\ {\isacharparenleft}{\kern0pt}Collect\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Abs\ {\isasymcirc}\ h\ {\isasymcirc}\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ vimage{\isadigit{2}}p{\isacharunderscore}{\kern0pt}def\ Grp{\isacharunderscore}{\kern0pt}def\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ type{\isacharunderscore}{\kern0pt}definition{\isachardot}{\kern0pt}Abs{\isacharunderscore}{\kern0pt}inverse{\isacharbrackleft}{\kern0pt}OF\ type{\isacharunderscore}{\kern0pt}copy\ UNIV{\isacharunderscore}{\kern0pt}I{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ type{\isacharunderscore}{\kern0pt}definition{\isachardot}{\kern0pt}Rep{\isacharunderscore}{\kern0pt}inverse{\isacharbrackleft}{\kern0pt}OF\ type{\isacharunderscore}{\kern0pt}copy{\isacharbrackright}{\kern0pt}\ dest{\isacharcolon}{\kern0pt}\ sym{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}copy{\isacharunderscore}{\kern0pt}vimage{\isadigit{2}}p{\isacharunderscore}{\kern0pt}Grp{\isacharunderscore}{\kern0pt}Abs{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymAnd}h{\isachardot}{\kern0pt}\ vimage{\isadigit{2}}p\ g\ Abs\ {\isacharparenleft}{\kern0pt}Grp\ {\isacharparenleft}{\kern0pt}Collect\ P{\isacharparenright}{\kern0pt}\ h{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Grp\ {\isacharparenleft}{\kern0pt}Collect\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}g\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Rep\ {\isasymcirc}\ h\ {\isasymcirc}\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ vimage{\isadigit{2}}p{\isacharunderscore}{\kern0pt}def\ Grp{\isacharunderscore}{\kern0pt}def\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ type{\isacharunderscore}{\kern0pt}definition{\isachardot}{\kern0pt}Abs{\isacharunderscore}{\kern0pt}inverse{\isacharbrackleft}{\kern0pt}OF\ type{\isacharunderscore}{\kern0pt}copy\ UNIV{\isacharunderscore}{\kern0pt}I{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ type{\isacharunderscore}{\kern0pt}definition{\isachardot}{\kern0pt}Rep{\isacharunderscore}{\kern0pt}inverse{\isacharbrackleft}{\kern0pt}OF\ type{\isacharunderscore}{\kern0pt}copy{\isacharbrackright}{\kern0pt}\ dest{\isacharcolon}{\kern0pt}\ sym{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}copy{\isacharunderscore}{\kern0pt}ex{\isacharunderscore}{\kern0pt}RepI{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymexists}b{\isachardot}{\kern0pt}\ F\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymexists}b{\isachardot}{\kern0pt}\ F\ {\isacharparenleft}{\kern0pt}Rep\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ b\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}F\ b{\isachardoublequoteclose}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}b{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ F\ {\isacharparenleft}{\kern0pt}Rep\ b{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ exI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ {\isacartoucheopen}F\ b{\isacartoucheclose}\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}F\ {\isacharparenleft}{\kern0pt}Rep\ {\isacharparenleft}{\kern0pt}Abs\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}definition{\isachardot}{\kern0pt}Abs{\isacharunderscore}{\kern0pt}inverse{\isacharbrackleft}{\kern0pt}OF\ type{\isacharunderscore}{\kern0pt}copy{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ vimage{\isadigit{2}}p{\isacharunderscore}{\kern0pt}relcompp{\isacharunderscore}{\kern0pt}converse{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}vimage{\isadigit{2}}p\ f\ g\ {\isacharparenleft}{\kern0pt}R{\isasyminverse}{\isasyminverse}\ OO\ S{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}vimage{\isadigit{2}}p\ Rep\ f\ R{\isacharparenright}{\kern0pt}{\isasyminverse}{\isasyminverse}\ OO\ vimage{\isadigit{2}}p\ Rep\ g\ S{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ vimage{\isadigit{2}}p{\isacharunderscore}{\kern0pt}def\ relcompp{\isachardot}{\kern0pt}simps\ conversep{\isachardot}{\kern0pt}simps\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ image{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ type{\isacharunderscore}{\kern0pt}copy{\isacharunderscore}{\kern0pt}ex{\isacharunderscore}{\kern0pt}RepI{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{bnf}\isamarkupfalse%
\ DEADID{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\isanewline
\ \ map{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\isanewline
\ \ bd{\isacharcolon}{\kern0pt}\ natLeq\isanewline
\ \ rel{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharequal}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ natLeq{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}order\ natLeq{\isacharunderscore}{\kern0pt}cinfinite{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}bnf\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}id{\isacharunderscore}{\kern0pt}bnf\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}bnf{\isacharunderscore}{\kern0pt}apply{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id{\isacharunderscore}{\kern0pt}bnf\ x\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}bnf{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{bnf}\isamarkupfalse%
\ ID{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\isanewline
\ \ map{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id{\isacharunderscore}{\kern0pt}bnf\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b{\isachardoublequoteclose}\isanewline
\ \ sets{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ bd{\isacharcolon}{\kern0pt}\ natLeq\isanewline
\ \ rel{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id{\isacharunderscore}{\kern0pt}bnf\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ bool{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ pred{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}id{\isacharunderscore}{\kern0pt}bnf\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ bool{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}bnf{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ Grp{\isacharunderscore}{\kern0pt}def\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ relcompp{\isachardot}{\kern0pt}simps\ natLeq{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}order\ natLeq{\isacharunderscore}{\kern0pt}cinfinite{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ordLess{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}ordLeq{\isacharbrackleft}{\kern0pt}OF\ finite{\isacharunderscore}{\kern0pt}ordLess{\isacharunderscore}{\kern0pt}infinite{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ natLeq{\isacharunderscore}{\kern0pt}Well{\isacharunderscore}{\kern0pt}order{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ Field{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}of\ Field{\isacharunderscore}{\kern0pt}natLeq\ card{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}well{\isacharunderscore}{\kern0pt}order{\isacharunderscore}{\kern0pt}on{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isadigit{3}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ type{\isacharunderscore}{\kern0pt}definition{\isacharunderscore}{\kern0pt}id{\isacharunderscore}{\kern0pt}bnf{\isacharunderscore}{\kern0pt}UNIV{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}type{\isacharunderscore}{\kern0pt}definition\ id{\isacharunderscore}{\kern0pt}bnf\ id{\isacharunderscore}{\kern0pt}bnf\ UNIV{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ id{\isacharunderscore}{\kern0pt}bnf{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ unfold{\isacharunderscore}{\kern0pt}locales\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{ML{\isacharunderscore}{\kern0pt}file}\isamarkupfalse%
\ {\isacartoucheopen}Tools{\isacharslash}{\kern0pt}BNF{\isacharslash}{\kern0pt}bnf{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}tactics{\isachardot}{\kern0pt}ML{\isacartoucheclose}\isanewline
\isacommand{ML{\isacharunderscore}{\kern0pt}file}\isamarkupfalse%
\ {\isacartoucheopen}Tools{\isacharslash}{\kern0pt}BNF{\isacharslash}{\kern0pt}bnf{\isacharunderscore}{\kern0pt}comp{\isachardot}{\kern0pt}ML{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
\isanewline
%
\endisadelimML
\isanewline
\isacommand{hide{\isacharunderscore}{\kern0pt}fact}\isamarkupfalse%
\isanewline
\ \ DEADID{\isachardot}{\kern0pt}inj{\isacharunderscore}{\kern0pt}map\ DEADID{\isachardot}{\kern0pt}inj{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}strong\ DEADID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}comp\ DEADID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}cong\ DEADID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}cong{\isadigit{0}}\isanewline
\ \ DEADID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}cong{\isacharunderscore}{\kern0pt}simp\ DEADID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}id\ DEADID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}id{\isadigit{0}}\ DEADID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}ident\ DEADID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}transfer\isanewline
\ \ DEADID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}Grp\ DEADID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}compp\ DEADID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}compp{\isacharunderscore}{\kern0pt}Grp\ DEADID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}conversep\ DEADID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}eq\isanewline
\ \ DEADID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}flip\ DEADID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}map\ DEADID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}mono\ DEADID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}transfer\isanewline
\ \ ID{\isachardot}{\kern0pt}inj{\isacharunderscore}{\kern0pt}map\ ID{\isachardot}{\kern0pt}inj{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}strong\ ID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}comp\ ID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}cong\ ID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}cong{\isadigit{0}}\ ID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}cong{\isacharunderscore}{\kern0pt}simp\ ID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}id\isanewline
\ \ ID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}id{\isadigit{0}}\ ID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}ident\ ID{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}transfer\ ID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}Grp\ ID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}compp\ ID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}compp{\isacharunderscore}{\kern0pt}Grp\ ID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}conversep\isanewline
\ \ ID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}eq\ ID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}flip\ ID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}map\ ID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}mono\ ID{\isachardot}{\kern0pt}rel{\isacharunderscore}{\kern0pt}transfer\ ID{\isachardot}{\kern0pt}set{\isacharunderscore}{\kern0pt}map\ ID{\isachardot}{\kern0pt}set{\isacharunderscore}{\kern0pt}transfer\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=BNF_Composition.tex%:%
%:%11=9%:%
%:%27=11%:%
%:%28=11%:%
%:%29=12%:%
%:%30=13%:%
%:%35=13%:%
%:%38=14%:%
%:%39=15%:%
%:%40=15%:%
%:%43=16%:%
%:%47=16%:%
%:%48=16%:%
%:%53=16%:%
%:%56=17%:%
%:%57=18%:%
%:%58=18%:%
%:%61=19%:%
%:%65=19%:%
%:%66=19%:%
%:%71=19%:%
%:%74=20%:%
%:%75=21%:%
%:%76=21%:%
%:%79=22%:%
%:%83=22%:%
%:%84=22%:%
%:%89=22%:%
%:%92=23%:%
%:%93=24%:%
%:%94=24%:%
%:%97=25%:%
%:%101=25%:%
%:%102=25%:%
%:%107=25%:%
%:%110=26%:%
%:%111=27%:%
%:%112=27%:%
%:%113=28%:%
%:%114=29%:%
%:%115=30%:%
%:%116=31%:%
%:%119=32%:%
%:%123=32%:%
%:%124=32%:%
%:%125=33%:%
%:%126=33%:%
%:%127=34%:%
%:%128=34%:%
%:%129=35%:%
%:%130=35%:%
%:%131=36%:%
%:%132=36%:%
%:%133=37%:%
%:%134=37%:%
%:%135=38%:%
%:%136=38%:%
%:%137=39%:%
%:%138=39%:%
%:%139=40%:%
%:%140=40%:%
%:%141=41%:%
%:%142=41%:%
%:%143=42%:%
%:%144=42%:%
%:%145=43%:%
%:%146=43%:%
%:%147=44%:%
%:%148=44%:%
%:%149=45%:%
%:%150=45%:%
%:%151=46%:%
%:%152=46%:%
%:%153=47%:%
%:%159=47%:%
%:%162=48%:%
%:%163=49%:%
%:%164=49%:%
%:%167=50%:%
%:%171=50%:%
%:%172=50%:%
%:%173=51%:%
%:%174=51%:%
%:%175=52%:%
%:%176=52%:%
%:%177=53%:%
%:%178=53%:%
%:%183=53%:%
%:%186=54%:%
%:%187=55%:%
%:%188=55%:%
%:%191=56%:%
%:%195=56%:%
%:%196=56%:%
%:%197=57%:%
%:%198=57%:%
%:%199=58%:%
%:%200=58%:%
%:%205=58%:%
%:%208=59%:%
%:%209=60%:%
%:%210=60%:%
%:%213=61%:%
%:%217=61%:%
%:%218=61%:%
%:%223=61%:%
%:%226=62%:%
%:%227=63%:%
%:%228=63%:%
%:%231=64%:%
%:%235=64%:%
%:%236=64%:%
%:%241=64%:%
%:%244=65%:%
%:%245=66%:%
%:%246=66%:%
%:%249=67%:%
%:%253=67%:%
%:%254=67%:%
%:%259=67%:%
%:%262=68%:%
%:%263=69%:%
%:%264=69%:%
%:%267=70%:%
%:%271=70%:%
%:%272=70%:%
%:%277=70%:%
%:%280=71%:%
%:%281=72%:%
%:%282=72%:%
%:%285=73%:%
%:%289=73%:%
%:%290=73%:%
%:%295=73%:%
%:%298=74%:%
%:%299=75%:%
%:%300=75%:%
%:%303=76%:%
%:%307=76%:%
%:%308=76%:%
%:%313=76%:%
%:%316=77%:%
%:%317=78%:%
%:%318=78%:%
%:%321=79%:%
%:%325=79%:%
%:%326=79%:%
%:%331=79%:%
%:%334=80%:%
%:%335=81%:%
%:%336=81%:%
%:%339=82%:%
%:%343=82%:%
%:%344=82%:%
%:%345=82%:%
%:%350=82%:%
%:%353=83%:%
%:%354=84%:%
%:%355=84%:%
%:%358=85%:%
%:%362=85%:%
%:%363=85%:%
%:%368=85%:%
%:%371=86%:%
%:%372=87%:%
%:%373=87%:%
%:%374=88%:%
%:%377=89%:%
%:%381=89%:%
%:%382=89%:%
%:%383=89%:%
%:%388=89%:%
%:%391=90%:%
%:%392=91%:%
%:%393=91%:%
%:%396=92%:%
%:%400=92%:%
%:%401=92%:%
%:%406=92%:%
%:%409=93%:%
%:%410=94%:%
%:%411=94%:%
%:%414=95%:%
%:%418=95%:%
%:%419=95%:%
%:%424=95%:%
%:%427=96%:%
%:%428=97%:%
%:%429=97%:%
%:%432=98%:%
%:%436=98%:%
%:%437=98%:%
%:%442=98%:%
%:%445=99%:%
%:%446=100%:%
%:%447=100%:%
%:%450=101%:%
%:%454=101%:%
%:%455=101%:%
%:%456=101%:%
%:%461=101%:%
%:%464=102%:%
%:%465=103%:%
%:%466=103%:%
%:%469=104%:%
%:%473=104%:%
%:%474=104%:%
%:%475=104%:%
%:%480=104%:%
%:%483=105%:%
%:%484=106%:%
%:%485=106%:%
%:%486=107%:%
%:%487=108%:%
%:%488=109%:%
%:%489=110%:%
%:%490=111%:%
%:%491=111%:%
%:%494=112%:%
%:%498=112%:%
%:%499=112%:%
%:%500=112%:%
%:%505=112%:%
%:%508=113%:%
%:%509=114%:%
%:%510=114%:%
%:%513=115%:%
%:%517=115%:%
%:%518=115%:%
%:%519=115%:%
%:%524=115%:%
%:%527=116%:%
%:%528=117%:%
%:%529=117%:%
%:%532=118%:%
%:%536=118%:%
%:%537=118%:%
%:%538=118%:%
%:%543=118%:%
%:%546=119%:%
%:%547=120%:%
%:%548=120%:%
%:%551=121%:%
%:%555=121%:%
%:%556=121%:%
%:%557=121%:%
%:%562=121%:%
%:%565=122%:%
%:%566=123%:%
%:%567=123%:%
%:%568=124%:%
%:%571=125%:%
%:%575=125%:%
%:%576=125%:%
%:%577=126%:%
%:%578=126%:%
%:%579=127%:%
%:%584=127%:%
%:%587=128%:%
%:%588=129%:%
%:%589=129%:%
%:%590=130%:%
%:%593=131%:%
%:%597=131%:%
%:%598=131%:%
%:%599=132%:%
%:%600=132%:%
%:%601=133%:%
%:%606=133%:%
%:%609=134%:%
%:%610=135%:%
%:%611=135%:%
%:%618=136%:%
%:%619=136%:%
%:%620=137%:%
%:%621=137%:%
%:%622=137%:%
%:%623=138%:%
%:%624=138%:%
%:%625=139%:%
%:%626=139%:%
%:%627=140%:%
%:%628=140%:%
%:%629=140%:%
%:%630=140%:%
%:%631=140%:%
%:%632=141%:%
%:%633=141%:%
%:%634=142%:%
%:%635=142%:%
%:%640=142%:%
%:%643=143%:%
%:%644=144%:%
%:%645=144%:%
%:%646=145%:%
%:%649=146%:%
%:%653=146%:%
%:%654=146%:%
%:%655=147%:%
%:%656=147%:%
%:%661=147%:%
%:%664=148%:%
%:%665=149%:%
%:%666=149%:%
%:%667=150%:%
%:%668=151%:%
%:%669=151%:%
%:%670=152%:%
%:%671=153%:%
%:%672=154%:%
%:%675=155%:%
%:%679=155%:%
%:%680=155%:%
%:%685=155%:%
%:%688=156%:%
%:%689=157%:%
%:%690=157%:%
%:%691=158%:%
%:%692=159%:%
%:%693=160%:%
%:%694=160%:%
%:%697=161%:%
%:%701=161%:%
%:%702=161%:%
%:%703=161%:%
%:%708=161%:%
%:%711=162%:%
%:%712=163%:%
%:%713=163%:%
%:%714=164%:%
%:%715=165%:%
%:%716=166%:%
%:%717=167%:%
%:%718=168%:%
%:%721=169%:%
%:%725=169%:%
%:%726=169%:%
%:%727=170%:%
%:%728=170%:%
%:%729=171%:%
%:%730=171%:%
%:%731=172%:%
%:%732=172%:%
%:%733=173%:%
%:%739=173%:%
%:%742=174%:%
%:%743=175%:%
%:%744=175%:%
%:%747=176%:%
%:%751=176%:%
%:%752=176%:%
%:%753=176%:%
%:%758=176%:%
%:%763=177%:%
%:%768=178%:%
%:%769=178%:%
%:%770=179%:%
%:%771=179%:%
%:%776=179%:%
%:%779=180%:%
%:%780=181%:%
%:%781=181%:%
%:%782=182%:%
%:%783=183%:%
%:%784=184%:%
%:%785=185%:%
%:%786=186%:%
%:%787=187%:%
%:%788=188%:%
%:%791=189%:%
%:%796=190%:%
