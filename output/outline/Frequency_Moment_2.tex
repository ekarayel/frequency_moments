%
\begin{isabellebody}%
\setisabellecontext{Frequency{\isacharunderscore}{\kern0pt}Moment{\isacharunderscore}{\kern0pt}{\isadigit{2}}}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Frequency Moment $2$%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Frequency{\isacharunderscore}{\kern0pt}Moment{\isacharunderscore}{\kern0pt}{\isadigit{2}}\isanewline
\ \ \isakeyword{imports}\ Main\ Median\ Partitions\ Primes{\isacharunderscore}{\kern0pt}Ext\ Encoding\ List{\isacharunderscore}{\kern0pt}Ext\ \isanewline
\ \ \ \ UniversalHashFamilyOfPrime\ Frequency{\isacharunderscore}{\kern0pt}Moments\ Landau{\isacharunderscore}{\kern0pt}Ext\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
This section contains a formalization of the algorithm for the second frequency moment.
It is based on the algorithm described in \cite[\textsection 2.2]{alon1999}.
The only difference is that the algorithm is adapted to work with prime field of odd order, which
greatly reduces the implementation complexity.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ h\ k\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ hash\ p\ k\ h\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}k\ {\isacharless}{\kern0pt}\ p{\isacharbraceright}{\kern0pt}\ then\ int\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ else\ {\isacharminus}{\kern0pt}\ int\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{type{\isacharunderscore}{\kern0pt}synonym}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ int\ set\ list{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}rat\ {\isasymRightarrow}\ rat\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ pmf{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isasymdelta}\ {\isasymepsilon}\ n\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isasymdelta}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ p\ {\isacharequal}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}max\ n\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ h\ {\isasymleftarrow}\ prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ pmf{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ x\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ sketch{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ {\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}h\ i{\isacharparenright}{\kern0pt}\ x\ {\isacharplus}{\kern0pt}\ sketch\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ rat\ pmf{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ sketch{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}median\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i\isactrlsub {\isadigit{2}}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymSum}i\isactrlsub {\isadigit{1}}{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}sketch\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ i\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\isanewline
\ \ \ \ {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isacharunderscore}{\kern0pt}exp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}Factorial{\isacharunderscore}{\kern0pt}Ring{\isachardot}{\kern0pt}prime\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isacharless}{\kern0pt}\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\isanewline
\ \ \ \ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isacharparenleft}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isasymomega}\ k{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}m{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ g{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ prime{\isacharunderscore}{\kern0pt}gt{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}nat\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}odd\ p{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ prime{\isacharunderscore}{\kern0pt}odd{\isacharunderscore}{\kern0pt}nat\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ t\ \isakeyword{where}\ t{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p{\isacharequal}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}t{\isacharplus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ oddE\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymOmega}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymOmega}\ {\isacharequal}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}set{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fin{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharbrackleft}{\kern0pt}OF\ g{\isacharbrackright}{\kern0pt}\ ne{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ p{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}t{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ Int{\isacharunderscore}{\kern0pt}absorb{\isadigit{2}}{\isacharcomma}{\kern0pt}\ rule\ subsetI{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}card{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}antisym{\isacharcomma}{\kern0pt}\ rule\ subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isacharplus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ p{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}{\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ p\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ k{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ {\isacharbraceleft}{\kern0pt}t{\isacharplus}{\kern0pt}{\isadigit{1}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}card{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}antisym{\isacharcomma}{\kern0pt}\ rule\ subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ p\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}t{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ p\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ k{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}{\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}integral\isactrlsup L\ {\isasymOmega}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ x\ k{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ integral\isactrlsup L\ {\isasymOmega}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ indicator\ {\isacharbraceleft}{\kern0pt}{\isasymomega}{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ hash\ p\ k\ {\isasymomega}\ {\isacharless}{\kern0pt}\ p{\isacharbraceright}{\kern0pt}\ {\isasymomega}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}m\ {\isacharplus}{\kern0pt}\ \isanewline
\ \ \ \ \ \ indicator\ {\isacharbraceleft}{\kern0pt}{\isasymomega}{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ hash\ p\ k\ {\isasymomega}\ {\isasymge}\ p{\isacharbraceright}{\kern0pt}\ {\isasymomega}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ {\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ measure{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}{\isachardot}{\kern0pt}\ hash\ p\ k\ {\isasymomega}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ \ {\isacharplus}{\kern0pt}\ \isanewline
\ \ \ \ \ {\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ measure{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}{\isachardot}{\kern0pt}\ hash\ p\ k\ {\isasymomega}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ k\ {\isasymge}\ p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}add{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ b{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ b{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}{\isasymOmega}{\isacharunderscore}{\kern0pt}def\ hash{\isacharunderscore}{\kern0pt}prob{\isacharunderscore}{\kern0pt}range{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ zero{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharbrackright}{\kern0pt}\ c{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ c{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}add{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}distrib\ ac{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}integral\isactrlsup L\ {\isasymOmega}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ x\ k{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ a{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}Factorial{\isacharunderscore}{\kern0pt}Ring{\isachardot}{\kern0pt}prime\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymAnd}a{\isachardot}{\kern0pt}\ a\ {\isasymin}\ set\ as\ {\isasymLongrightarrow}\ a\ {\isacharless}{\kern0pt}\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}M\ {\isasymequiv}\ measure{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}f\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isasymomega}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ var{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ M\ f\ {\isasymle}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}A{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{and}\ exp{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ M\ f\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}B{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ h\ \isakeyword{where}\ {\isachardoublequoteopen}h\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}\ x{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isasymomega}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ c\ \isakeyword{where}\ {\isachardoublequoteopen}c\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ as\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ r\ \isakeyword{where}\ {\isachardoublequoteopen}r\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}m{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}prod\ \isakeyword{where}\ {\isachardoublequoteopen}h{\isacharunderscore}{\kern0pt}prod\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}as\ {\isasymomega}{\isachardot}{\kern0pt}\ prod{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}h\ {\isasymomega}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ list\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymProd}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ r\ {\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ as\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{interpret}\isamarkupfalse%
\ prob{\isacharunderscore}{\kern0pt}space\ M\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf\ M{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}x\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ x\ {\isacharasterisk}{\kern0pt}\ h\ {\isasymomega}\ x{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isacharunderscore}{\kern0pt}def\ c{\isacharunderscore}{\kern0pt}def\ h{\isacharunderscore}{\kern0pt}def\ sum{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}eval\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ int{\isacharunderscore}{\kern0pt}M{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}f{\isachardot}{\kern0pt}\ integrable\ M\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}f\ {\isasymomega}{\isacharparenright}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}real{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}M{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ ne{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ fin{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}one{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}r\ {\isacharparenleft}{\kern0pt}Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}r{\isacharunderscore}{\kern0pt}def\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}two{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}r\ {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}r{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ nonzero{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}four{\isacharunderscore}{\kern0pt}est{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}r\ {\isadigit{4}}\ {\isasymle}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}r{\isacharunderscore}{\kern0pt}two{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}r{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ pos{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ power{\isadigit{4}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}xxxx{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ y{\isacharequal}{\kern0pt}{\isachardoublequoteopen}real\ p\ {\isacharasterisk}{\kern0pt}\ {\isadigit{1}}{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ real\ p\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ p\ {\isacharasterisk}{\kern0pt}\ {\isadigit{1}}{\isadigit{6}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}less\ num{\isacharunderscore}{\kern0pt}double\ numeral{\isacharunderscore}{\kern0pt}mult\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}power\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}le\ prime{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}nat\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp{\isacharplus}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}sym{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymnoteq}\ y\ {\isasymand}\ y\ {\isasymnoteq}\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymnoteq}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}elim{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}as{\isachardot}{\kern0pt}\ prod{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}r\ {\isasymcirc}\ count{\isacharunderscore}{\kern0pt}list\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}remdups\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ prod{\isachardot}{\kern0pt}set{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}list{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ set\ x\ {\isasymsubseteq}\ set\ as\ {\isasymLongrightarrow}\ length\ x\ {\isasymle}\ {\isadigit{4}}\ {\isasymLongrightarrow}\ expectation\ {\isacharparenleft}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ x\ {\isasymsubseteq}\ set\ as{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}sub{\isacharunderscore}{\kern0pt}p{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set\ x\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ atLeastLessThan{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}p{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}k{\isachardot}{\kern0pt}\ k\ {\isasymin}\ set\ x\ {\isasymLongrightarrow}\ k\ {\isacharless}{\kern0pt}\ p{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ x\ {\isasymle}\ {\isadigit{4}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}x{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{4}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}length\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}trans\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}expectation\ {\isacharparenleft}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ expectation\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ {\isasymProd}\ i\ {\isasymin}\ set\ x{\isachardot}{\kern0pt}\ h\ {\isasymomega}\ i{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ x\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}expectation{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ prod{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}eval{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymProd}i\ {\isasymin}\ set\ x{\isachardot}{\kern0pt}\ expectation\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ h\ {\isasymomega}\ i{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ x\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}lebesgue{\isacharunderscore}{\kern0pt}integral{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}h{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}compose{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X{\isacharequal}{\kern0pt}{\isachardoublequoteopen}hash\ p{\isachardoublequoteclose}\ \isakeyword{and}\ M{\isacharprime}{\kern0pt}{\isacharequal}{\kern0pt}{\isachardoublequoteopen}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}p{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ hash{\isacharunderscore}{\kern0pt}k{\isacharunderscore}{\kern0pt}wise{\isacharunderscore}{\kern0pt}indep{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ n{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{4}}{\isachardoublequoteclose}\ \isakeyword{and}\ p{\isacharequal}{\kern0pt}{\isachardoublequoteopen}p{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ card{\isacharunderscore}{\kern0pt}x\ x{\isacharunderscore}{\kern0pt}sub{\isacharunderscore}{\kern0pt}p\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}k{\isacharunderscore}{\kern0pt}wise{\isacharunderscore}{\kern0pt}indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}def\ M{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ int{\isacharunderscore}{\kern0pt}M{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymProd}i\ {\isasymin}\ set\ x{\isachardot}{\kern0pt}\ r\ {\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ x\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isacharunderscore}{\kern0pt}exp{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ x{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}p\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}h{\isacharunderscore}{\kern0pt}def\ r{\isacharunderscore}{\kern0pt}def\ M{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}expectation\ {\isacharparenleft}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}cong{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ x\ y\ {\isasymLongrightarrow}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ y{\isachardoublequoteclose}\ \isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ y\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ list{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ x\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ f\ \isakeyword{where}\ b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bij{\isacharunderscore}{\kern0pt}betw\ f\ {\isacharparenleft}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ c{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymAnd}z{\isachardot}{\kern0pt}\ z\ {\isasymin}\ set\ x\ {\isasymLongrightarrow}\ count{\isacharunderscore}{\kern0pt}list\ x\ z\ {\isacharequal}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ y\ {\isacharparenleft}{\kern0pt}f\ z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ eq{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}obtain{\isacharunderscore}{\kern0pt}bij{\isacharbrackleft}{\kern0pt}OF\ a{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x\ {\isacharequal}{\kern0pt}\ prod\ {\isacharparenleft}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ r{\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\ f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ c{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymProd}i\ {\isasymin}\ f\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ r{\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isachardot}{\kern0pt}reindex{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ b\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isachardot}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ b\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x\ {\isacharequal}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ y{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}cong{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}p\ x{\isachardot}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ p\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ p\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ p\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ x{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}expectation\ f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isasymin}set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j{\isasymin}set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharasterisk}{\kern0pt}\ c\ j\ {\isacharasterisk}{\kern0pt}\ expectation\ {\isacharparenleft}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}i{\isacharcomma}{\kern0pt}j{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isacharunderscore}{\kern0pt}eq\ h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right\ Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}sum{\isacharbrackleft}{\kern0pt}OF\ int{\isacharunderscore}{\kern0pt}M{\isacharbrackright}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isasymin}set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j{\isasymin}set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharasterisk}{\kern0pt}\ c\ j\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}i{\isacharcomma}{\kern0pt}j{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ \ \isanewline
\ \ \ \ c\ i\ {\isacharasterisk}{\kern0pt}\ c\ j\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}p{\isachardot}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ p\ {\isacharbrackleft}{\kern0pt}i{\isacharcomma}{\kern0pt}j{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}enum{\isacharunderscore}{\kern0pt}partitions\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isacharunderscore}{\kern0pt}partitions{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isasymin}set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharasterisk}{\kern0pt}\ c\ i\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Suc\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}elim\ r{\isacharunderscore}{\kern0pt}one{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation{\isacharunderscore}{\kern0pt}elim\ distrib{\isacharunderscore}{\kern0pt}left\ sum{\isachardot}{\kern0pt}distrib\ sum{\isacharunderscore}{\kern0pt}collapse\ fold{\isacharunderscore}{\kern0pt}sym{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}c{\isacharunderscore}{\kern0pt}def\ F{\isacharunderscore}{\kern0pt}def\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult\ r{\isacharunderscore}{\kern0pt}two{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}{\isacharquery}{\kern0pt}B\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}expectation\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{1}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{2}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{3}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{4}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\isanewline
\ \ \ \ c\ i{\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ expectation\ {\isacharparenleft}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}i{\isadigit{1}}{\isacharcomma}{\kern0pt}\ i{\isadigit{2}}{\isacharcomma}{\kern0pt}\ i{\isadigit{3}}{\isacharcomma}{\kern0pt}\ i{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isacharunderscore}{\kern0pt}eq\ h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ power{\isadigit{4}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}xxxx\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right\ Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}sum{\isacharbrackleft}{\kern0pt}OF\ int{\isacharunderscore}{\kern0pt}M{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{1}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{2}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{3}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{4}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ c\ i{\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}i{\isadigit{1}}{\isacharcomma}{\kern0pt}i{\isadigit{2}}{\isacharcomma}{\kern0pt}i{\isadigit{3}}{\isacharcomma}{\kern0pt}i{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{1}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{2}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{3}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isadigit{4}}\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ c\ i{\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ c\ i{\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}p{\isachardot}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation\ p\ {\isacharbrackleft}{\kern0pt}i{\isadigit{1}}{\isacharcomma}{\kern0pt}i{\isadigit{2}}{\isacharcomma}{\kern0pt}i{\isadigit{3}}{\isacharcomma}{\kern0pt}i{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}enum{\isacharunderscore}{\kern0pt}partitions\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isacharunderscore}{\kern0pt}partitions{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ c\ j{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymSum}\ i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i{\isacharcircum}{\kern0pt}{\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{4}}{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}{\isasymSum}\ i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharcircum}{\kern0pt}\ {\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Suc\ exp{\isacharunderscore}{\kern0pt}h{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}elim\ r{\isacharunderscore}{\kern0pt}one{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ has{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}relation{\isacharunderscore}{\kern0pt}elim\ distrib{\isacharunderscore}{\kern0pt}left\ sum{\isachardot}{\kern0pt}distrib\ sum{\isacharunderscore}{\kern0pt}collapse\ fold{\isacharunderscore}{\kern0pt}sym{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps\ sum{\isacharunderscore}{\kern0pt}subtractf\ sum{\isacharunderscore}{\kern0pt}collapse{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}\ i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharcircum}{\kern0pt}\ {\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}r\ {\isadigit{4}}\ {\isacharminus}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left\ sum{\isacharunderscore}{\kern0pt}subtractf{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}r\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ c\ i\ {\isacharcircum}{\kern0pt}\ {\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}power{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}distrib\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}right{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}four{\isacharunderscore}{\kern0pt}est\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharplus}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}c{\isacharunderscore}{\kern0pt}def\ r{\isacharunderscore}{\kern0pt}two\ F{\isacharunderscore}{\kern0pt}def\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ v{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}expectation\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}variance\ f\ {\isasymle}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ variance{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}OF\ int{\isacharunderscore}{\kern0pt}M\ int{\isacharunderscore}{\kern0pt}M{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ subst\ b{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}power{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}distrib{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ v{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}A\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}sketch{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ n\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\ \ \isakeyword{fixes}\ as\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ list{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}{\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymdelta}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isasymequiv}\ nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isasymdelta}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isasymequiv}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}{\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}p\ {\isasymequiv}\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}max\ n\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}sketch\ {\isasymequiv}\ fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ a{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}{\isasymOmega}\ {\isasymequiv}\ prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sketch\ {\isacharequal}{\kern0pt}\ {\isasymOmega}\ {\isasymbind}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}h{\isachardot}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}h\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ ys\ \isakeyword{where}\ {\isachardoublequoteopen}ys\ {\isacharequal}{\kern0pt}\ rev\ as{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}sketch\ {\isacharequal}{\kern0pt}\ foldr\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ x{\isacharparenright}{\kern0pt}\ ys\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ foldr{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}fold\ ys{\isacharunderscore}{\kern0pt}def\ sketch{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymOmega}\ {\isasymbind}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}h{\isachardot}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}h\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ ys{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ ys{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def\ restrict{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ a\ as{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ a\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ a\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharcomma}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ snd\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Cons\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isachardot}{\kern0pt}simps\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ a{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}assoc{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}return{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}def\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isachardot}{\kern0pt}simps\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init{\isachardot}{\kern0pt}simps\ cong{\isacharcolon}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymOmega}\ {\isasymbind}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}h{\isachardot}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ h{\isacharcomma}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}h\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ ys{\isacharunderscore}{\kern0pt}def\ rev{\isacharunderscore}{\kern0pt}map{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}correct{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}{\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymdelta}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ as\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}M\ {\isasymequiv}\ fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ a{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}\ {\isasymbind}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ measure{\isacharunderscore}{\kern0pt}pmf\ M{\isachardot}{\kern0pt}\ {\isasymbar}{\isasymomega}\ {\isacharminus}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isasymbar}\ {\isasymle}\ {\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isadigit{1}}{\isacharminus}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{1}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isasymdelta}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{2}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}{\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ p\ \isakeyword{where}\ {\isachardoublequoteopen}p\ {\isacharequal}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}max\ n\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from\ {\isacharequal}{\kern0pt}\ fst{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from\ {\isacharequal}{\kern0pt}\ fst\ {\isasymcirc}\ snd{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}from\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}p{\isacharunderscore}{\kern0pt}from\ {\isacharequal}{\kern0pt}\ fst\ {\isasymcirc}\ snd\ {\isasymcirc}\ snd{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}from\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ int\ set\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}h{\isacharunderscore}{\kern0pt}from\ {\isacharequal}{\kern0pt}\ fst\ {\isasymcirc}\ snd\ {\isasymcirc}\ snd\ {\isasymcirc}\ snd{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ sketch{\isacharunderscore}{\kern0pt}from\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ int{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}sketch{\isacharunderscore}{\kern0pt}from\ {\isacharequal}{\kern0pt}\ snd\ {\isasymcirc}\ snd\ {\isasymcirc}\ snd\ {\isasymcirc}\ snd{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}prime{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Factorial{\isacharunderscore}{\kern0pt}Ring{\isachardot}{\kern0pt}prime\ p{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}p{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}prime\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isasymge}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}p{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}lower{\isacharunderscore}{\kern0pt}bound\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}trans\ max{\isachardot}{\kern0pt}cobounded{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}sq{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isasymnoteq}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Num{\isachardot}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ nat{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ nat{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}as{\isacharunderscore}{\kern0pt}int\ nat{\isacharunderscore}{\kern0pt}power{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff\ not{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}one\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}power\ zero{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}numeral{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}set{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fin{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharbrackleft}{\kern0pt}OF\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}\ ne{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}set{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def\ set{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ finite{\isacharunderscore}{\kern0pt}PiE{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ as{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}p{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ set\ as\ {\isasymLongrightarrow}\ x\ {\isacharless}{\kern0pt}\ p{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ y{\isacharequal}{\kern0pt}{\isachardoublequoteopen}n{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ atLeastLessThan{\isacharunderscore}{\kern0pt}iff\ \isacommand{apply}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}p{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}lower{\isacharunderscore}{\kern0pt}bound\ max{\isachardot}{\kern0pt}boundedE{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fin{\isacharunderscore}{\kern0pt}poly{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ fin{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ s{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ h{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ sketch{\isacharunderscore}{\kern0pt}from\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ p{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ h{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ sketch{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}conv{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ h{\isacharunderscore}{\kern0pt}from\ x{\isacharcomma}{\kern0pt}\ sketch{\isacharunderscore}{\kern0pt}from\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}split{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f\ \isakeyword{where}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ median\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymSum}i\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}x\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ s\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f{\isadigit{3}}\ \isakeyword{where}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}f{\isadigit{3}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{2}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}x\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ i\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f{\isadigit{2}}\ \isakeyword{where}\ {\isachardoublequoteopen}f{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isasymlambda}i{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ f{\isadigit{3}}\ x\ i\isactrlsub {\isadigit{1}}\ i{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}var{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isasymLongrightarrow}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharslash}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}indep{\isacharunderscore}{\kern0pt}vars\ {\isacharparenleft}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ borel{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i\isactrlsub {\isadigit{1}}\ x{\isachardot}{\kern0pt}\ f{\isadigit{3}}\ x\ i\isactrlsub {\isadigit{1}}\ i{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ rule\ indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}intro\ {\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}j{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}j{\isacharcomma}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a\ f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def\ disjoint{\isacharunderscore}{\kern0pt}family{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def\ s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero\ s{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{3}}\ {\isasymomega}\ j\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ a\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ del{\isacharcolon}{\kern0pt}Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}zero{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance{\isacharunderscore}{\kern0pt}divide{\isacharbrackleft}{\kern0pt}OF\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}var{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}indep{\isacharbrackleft}{\kern0pt}OF\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ b{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ {\isadigit{2}}{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ divide{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ variance{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}slice{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}a{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ var{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharbrackleft}{\kern0pt}OF\ p{\isacharunderscore}{\kern0pt}prime\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ as{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}p{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ frac{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero{\isacharcomma}{\kern0pt}\ metis\ p{\isacharunderscore}{\kern0pt}sq{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ divide{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ opaque{\isacharunderscore}{\kern0pt}lifting{\isacharparenright}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}ceiling\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}divide\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}eq\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power\ real{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}ceiling{\isacharunderscore}{\kern0pt}ge{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}pos{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharslash}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharslash}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}exp{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isasymLongrightarrow}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{3}}\ {\isasymomega}\ j\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ a\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ Bochner{\isacharunderscore}{\kern0pt}Integration{\isachardot}{\kern0pt}integral{\isacharunderscore}{\kern0pt}sum{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharslash}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ integral{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}slice{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}a{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ exp{\isacharunderscore}{\kern0pt}f{\isadigit{2}}{\isacharbrackleft}{\kern0pt}OF\ p{\isacharunderscore}{\kern0pt}prime\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ as{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}p{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero\ p{\isacharunderscore}{\kern0pt}sq{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f{\isacharprime}{\kern0pt}\ \isakeyword{where}\ {\isachardoublequoteopen}f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ median\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}\ x{\isacharparenright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ real{\isacharunderscore}{\kern0pt}f{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isacharprime}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ s{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}def\ median{\isacharunderscore}{\kern0pt}rat\ median{\isacharunderscore}{\kern0pt}restrict\ cong{\isacharcolon}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}divide\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}diff{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ distr{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}M\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}pmf\ f\ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ \ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}sketch{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ as{\isacharequal}{\kern0pt}{\isachardoublequoteopen}as{\isachardoublequoteclose}\ \isakeyword{and}\ n{\isacharequal}{\kern0pt}{\isachardoublequoteopen}n{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}M{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}assoc{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}return{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}conv{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ p{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ h{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ sketch{\isacharunderscore}{\kern0pt}from{\isacharunderscore}{\kern0pt}def\ cong{\isacharcolon}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}map{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ f{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ g\ \isakeyword{where}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isasymbar}{\isasymomega}\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ e{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isasymomega}{\isachardot}{\kern0pt}\ {\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as\ {\isasymge}\ {\isasymbar}{\isasymomega}\ {\isacharminus}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isasymbar}{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isasymomega}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}\ {\isasymomega}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}g{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}antisym{\isacharcomma}{\kern0pt}\ rule\ subsetI{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ abs{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}diff\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ subsetI{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ abs{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}diff\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}indep{\isacharunderscore}{\kern0pt}vars\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ borel{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i\ {\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}intro\ {\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}j{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}j{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}disjoint{\isacharunderscore}{\kern0pt}family{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ fastforce{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}mem{\isacharunderscore}{\kern0pt}Times{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ real\ s\isactrlsub {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}ceiling\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ {\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymbar}f{\isadigit{2}}\ {\isasymomega}\ i\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymbar}f{\isadigit{2}}\ {\isasymomega}\ i\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}as\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ a\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ F{\isacharunderscore}{\kern0pt}def\ f{\isadigit{3}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ F{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}F\ {\isadigit{2}}\ as\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ F{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackleft}{\kern0pt}OF\ False{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \ \ \ \ \isacommand{define}\isamarkupfalse%
\ var\ \isakeyword{where}\ \ {\isachardoublequoteopen}var\ {\isacharequal}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}exp{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ a\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ F{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}integrable\ {\isasymOmega}\isactrlsub {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isasymin}\ borel{\isacharunderscore}{\kern0pt}measurable\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymbar}f{\isadigit{2}}\ {\isasymomega}\ i\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}\ {\isasymle}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isasymbar}f{\isadigit{2}}\ {\isasymomega}\ i\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ pmf{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\ \isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ var\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}Chebyshev{\isacharunderscore}{\kern0pt}inequality{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ M{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ {\isadigit{2}}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isakeyword{and}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}simplified{\isacharbrackright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ p{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ F{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\isanewline
\ \ \ \ \ \ \ \ \ \ b{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ b{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ b{\isacharunderscore}{\kern0pt}{\isadigit{3}}\ b{\isacharunderscore}{\kern0pt}{\isadigit{4}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}var{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{3}}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isacharquery}{\kern0pt}ths{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ pos{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ F{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}var{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}var{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ a\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ distr{\isacharprime}{\kern0pt}\ e\ real{\isacharunderscore}{\kern0pt}f\ f{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}def\ {\isasymOmega}\isactrlsub {\isadigit{0}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ M{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymOmega}\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isasymepsilon}{\isacharequal}{\kern0pt}{\isachardoublequoteopen}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isachardoublequoteclose}\ \isakeyword{and}\ X{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}i\ {\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{apply}\isamarkupfalse%
\ simp\ \isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{4}}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{fun}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ let\ s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isasymdelta}\isactrlsup {\isadigit{2}}\ {\isasymrceil}\ in\isanewline
\ \ \ \ let\ s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}\ in\ \isanewline
\ \ \ \ {\isadigit{5}}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{2}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ s\isactrlsub {\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ encode{\isacharunderscore}{\kern0pt}state\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}encode{\isacharunderscore}{\kern0pt}state\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ N\isactrlsub S\ {\isasymtimes}\isactrlsub D\ {\isacharparenleft}{\kern0pt}{\isasymlambda}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ N\isactrlsub S\ {\isasymtimes}\isactrlsub D\ {\isacharparenleft}{\kern0pt}{\isasymlambda}s\isactrlsub {\isadigit{2}}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ N\isactrlsub S\ {\isasymtimes}\isactrlsub D\ {\isacharparenleft}{\kern0pt}{\isasymlambda}p{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}List{\isachardot}{\kern0pt}product\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbrackright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub S\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ {\isacharparenleft}{\kern0pt}zfact\isactrlsub S\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub S\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}List{\isachardot}{\kern0pt}product\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbrackright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub S\ I\isactrlsub S{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ encode{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}dom\ encode{\isacharunderscore}{\kern0pt}state{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ encoding{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}inj{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ dependent{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ dependent{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ dependent{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ encode{\isacharunderscore}{\kern0pt}extensional\ list{\isacharunderscore}{\kern0pt}encoding\ zfact{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ encode{\isacharunderscore}{\kern0pt}extensional\ int{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}exact{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}{\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymdelta}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ as\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}M\ {\isasymequiv}\ fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}update\ a{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}init\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}AE\ {\isasymomega}\ in\ M{\isachardot}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state\ {\isasymomega}{\isacharparenright}{\kern0pt}\ {\isasymle}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{1}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isasymdelta}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{2}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ p\ \isakeyword{where}\ {\isachardoublequoteopen}p\ {\isacharequal}{\kern0pt}\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}max\ n\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above\ {\isadigit{3}}\ {\isacharequal}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}min\ p{\isacharunderscore}{\kern0pt}def\ gr{\isadigit{0}}I\ not{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}zero{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}n{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}n\ {\isasymle}\ {\isadigit{3}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ One{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}def\ find{\isacharunderscore}{\kern0pt}prime{\isacharunderscore}{\kern0pt}above{\isacharunderscore}{\kern0pt}upper{\isacharunderscore}{\kern0pt}bound\ Suc{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ add{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}right\ linear\ not{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq\ numeral{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}y{\isachardot}{\kern0pt}\ y{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub E\ bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ y{\isacharcomma}{\kern0pt}\ {\isasymlambda}i{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ \ \ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ y\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}y\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub E\ bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials\ {\isacharparenleft}{\kern0pt}ZFact\ {\isacharparenleft}{\kern0pt}int\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{4}}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\ extensional\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ \ PiE{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ y\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ {\isacharparenleft}{\kern0pt}zfact\isactrlsub S\ p{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{9}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{5}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ y\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ {\isacharparenleft}{\kern0pt}zfact\isactrlsub S\ p{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}\ real\ {\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ p{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomial{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharbrackleft}{\kern0pt}OF\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ a{\isacharunderscore}{\kern0pt}{\isadigit{5}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}real\ {\isadigit{4}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ log{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}cancel{\isacharunderscore}{\kern0pt}iff{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}n\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{9}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ {\isacharparenleft}{\kern0pt}zfact\isactrlsub S\ p{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{9}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ \ \ x\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ {\isasymbar}x{\isasymbar}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ int\ n{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ int\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ i\ \isakeyword{where}\ {\isachardoublequoteopen}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ x{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}abs\ x\ {\isasymle}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ abs\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ x{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ rule\ sum{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}abs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}int\ p{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ \isacommand{by}\isamarkupfalse%
\ simp\ \isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ int\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}int\ p{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}triv{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ int\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharplus}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}int\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}n\ \isacommand{apply}\isamarkupfalse%
\ linarith\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}abs\ x\ {\isasymle}\ \ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ int\ n{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ int\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mult{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ y{\isacharcomma}{\kern0pt}\ {\isasymlambda}i{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{2}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}n{\isacharplus}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{0}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}{\isadigit{2}}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ encode{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ dependent{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ prod{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ fun\isactrlsub S{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ del{\isacharcolon}{\kern0pt}encode{\isacharunderscore}{\kern0pt}dependent{\isacharunderscore}{\kern0pt}sum{\isachardot}{\kern0pt}simps\ encode{\isacharunderscore}{\kern0pt}prod{\isachardot}{\kern0pt}simps\ N\isactrlsub S{\isachardot}{\kern0pt}simps\ plus{\isacharunderscore}{\kern0pt}ereal{\isachardot}{\kern0pt}simps\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}add{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharcomma}{\kern0pt}\ metis\ p{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}n{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}estI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{9}}\ {\isacharplus}{\kern0pt}\ {\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ rule\ a{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}estI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharplus}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}n{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ length\ as{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ int{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}a{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ y{\isacharcomma}{\kern0pt}\ {\isasymlambda}i{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}hash\ p\ {\isacharparenleft}{\kern0pt}y\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ AE{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ M{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}sketch{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ n{\isacharequal}{\kern0pt}{\isachardoublequoteopen}n{\isachardoublequoteclose}\ \isakeyword{and}\ as{\isacharequal}{\kern0pt}{\isachardoublequoteopen}as{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ p{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ set{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ PiE{\isacharunderscore}{\kern0pt}iff\ \ del{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharcomma}{\kern0pt}\ metis\ ne{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharcomma}{\kern0pt}\ metis\ fin{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}degree{\isacharunderscore}{\kern0pt}polynomials{\isacharbrackleft}{\kern0pt}OF\ p{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ a{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}asympotic{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}complexity{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}at{\isacharunderscore}{\kern0pt}top\ {\isasymtimes}\isactrlsub F\ at{\isacharunderscore}{\kern0pt}top\ {\isasymtimes}\isactrlsub F\ at{\isacharunderscore}{\kern0pt}right\ {\isadigit{0}}\ {\isasymtimes}\isactrlsub F\ at{\isacharunderscore}{\kern0pt}right\ {\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ \isanewline
\ \ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ m{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}rhs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ n{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}n{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ m{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}m{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ g\ \isakeyword{where}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ n{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}n{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}top{\isacharunderscore}{\kern0pt}linorder\ nat{\isacharunderscore}{\kern0pt}ceiling{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ m{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}m{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}top{\isacharunderscore}{\kern0pt}linorder\ nat{\isacharunderscore}{\kern0pt}ceiling{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ eps{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inv{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ delta{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inv{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}rightI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ b{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}delta{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}rightI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ b{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}delta\ delta{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ one{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}power\ power{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}over{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps\ eps{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}exp\ {\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ abs{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}self\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}trans\ exp{\isacharunderscore}{\kern0pt}gt{\isacharunderscore}{\kern0pt}zero\ ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff\ order{\isacharunderscore}{\kern0pt}trans{\isacharunderscore}{\kern0pt}rules{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ n{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ m{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{5}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono\ {\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}exp\ {\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ abs{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}self\ linorder{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le\ ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff\ not{\isacharunderscore}{\kern0pt}exp{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}zero\ order{\isachardot}{\kern0pt}trans{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono\ {\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps\ eps{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{8}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{9}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}\ unit{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}rightI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ b{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}nat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isachardot}{\kern0pt}in{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ always{\isacharunderscore}{\kern0pt}eventually{\isacharcomma}{\kern0pt}\ rule\ allI{\isacharcomma}{\kern0pt}\ rule\ arg{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ opaque{\isacharunderscore}{\kern0pt}lifting{\isacharparenright}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}ceiling\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}divide\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}eq\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ceil{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}const{\isacharunderscore}{\kern0pt}inv{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}nat{\isacharcomma}{\kern0pt}\ rule\ landau{\isacharunderscore}{\kern0pt}ceil{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ minus{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ cmult{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}iff{\isacharcomma}{\kern0pt}\ rule\ disjI{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ ln{\isacharunderscore}{\kern0pt}div{\isacharcomma}{\kern0pt}\ simp{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}trans\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono\ mult{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}commute\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}iff\ verit{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}simplify{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ mult{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}mult{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{9}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isachardot}{\kern0pt}in{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ ln{\isacharunderscore}{\kern0pt}mult{\isacharcomma}{\kern0pt}\ simp{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ n{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{5}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isadigit{6}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharcomma}{\kern0pt}\ rule\ l{\isadigit{1}}{\isacharcomma}{\kern0pt}\ rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{6}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ l{\isadigit{4}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{7}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}eps{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}ceil{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ minus{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ cmult{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}iff{\isacharcomma}{\kern0pt}\ rule\ disjI{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isachardot}{\kern0pt}in{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln{\isacharparenleft}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ ln{\isacharunderscore}{\kern0pt}div{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharbrackleft}{\kern0pt}OF\ eps{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ \ unit{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharcomma}{\kern0pt}\ m{\isacharunderscore}{\kern0pt}of\ x{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}\ n{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ m{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}g{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharcomma}{\kern0pt}\ subst\ mult{\isachardot}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}mult{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}mult{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{4}}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def\ l{\isadigit{6}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def\ l{\isadigit{7}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def\ l{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{8}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}rhs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}bigo{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}\ g{\isacharunderscore}{\kern0pt}def\ n{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ m{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=Frequency_Moment_2.tex%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%31=6%:%
%:%40=8%:%
%:%41=9%:%
%:%42=10%:%
%:%43=11%:%
%:%45=13%:%
%:%46=13%:%
%:%47=14%:%
%:%48=15%:%
%:%49=16%:%
%:%50=16%:%
%:%51=17%:%
%:%52=18%:%
%:%53=18%:%
%:%54=19%:%
%:%61=26%:%
%:%62=27%:%
%:%63=28%:%
%:%64=28%:%
%:%65=29%:%
%:%66=30%:%
%:%67=31%:%
%:%68=32%:%
%:%69=32%:%
%:%70=33%:%
%:%73=36%:%
%:%74=37%:%
%:%75=38%:%
%:%76=38%:%
%:%77=39%:%
%:%78=40%:%
%:%79=41%:%
%:%80=42%:%
%:%81=43%:%
%:%83=45%:%
%:%90=46%:%
%:%91=46%:%
%:%92=47%:%
%:%93=47%:%
%:%94=47%:%
%:%95=47%:%
%:%96=48%:%
%:%97=49%:%
%:%98=49%:%
%:%99=49%:%
%:%100=49%:%
%:%101=50%:%
%:%102=50%:%
%:%103=50%:%
%:%104=51%:%
%:%105=51%:%
%:%106=51%:%
%:%107=52%:%
%:%108=53%:%
%:%109=53%:%
%:%110=54%:%
%:%111=55%:%
%:%112=55%:%
%:%113=56%:%
%:%114=56%:%
%:%115=57%:%
%:%116=57%:%
%:%117=58%:%
%:%118=59%:%
%:%119=59%:%
%:%120=59%:%
%:%121=60%:%
%:%122=61%:%
%:%123=61%:%
%:%124=62%:%
%:%125=62%:%
%:%126=63%:%
%:%127=63%:%
%:%128=64%:%
%:%129=64%:%
%:%130=65%:%
%:%131=65%:%
%:%132=66%:%
%:%133=66%:%
%:%134=66%:%
%:%135=67%:%
%:%136=67%:%
%:%137=68%:%
%:%138=68%:%
%:%139=68%:%
%:%140=69%:%
%:%141=69%:%
%:%142=70%:%
%:%143=70%:%
%:%144=70%:%
%:%145=70%:%
%:%146=71%:%
%:%147=72%:%
%:%148=72%:%
%:%149=73%:%
%:%150=73%:%
%:%151=74%:%
%:%152=74%:%
%:%153=75%:%
%:%154=75%:%
%:%155=76%:%
%:%156=76%:%
%:%157=76%:%
%:%158=76%:%
%:%159=77%:%
%:%160=77%:%
%:%161=77%:%
%:%162=78%:%
%:%163=78%:%
%:%164=79%:%
%:%165=79%:%
%:%166=79%:%
%:%167=79%:%
%:%168=80%:%
%:%169=81%:%
%:%170=81%:%
%:%172=83%:%
%:%173=84%:%
%:%174=84%:%
%:%175=85%:%
%:%176=85%:%
%:%177=85%:%
%:%179=87%:%
%:%180=88%:%
%:%181=88%:%
%:%182=89%:%
%:%183=89%:%
%:%184=90%:%
%:%185=90%:%
%:%186=91%:%
%:%187=91%:%
%:%188=92%:%
%:%189=92%:%
%:%190=92%:%
%:%191=93%:%
%:%192=93%:%
%:%193=94%:%
%:%194=94%:%
%:%195=95%:%
%:%196=95%:%
%:%197=95%:%
%:%198=96%:%
%:%199=97%:%
%:%200=97%:%
%:%201=98%:%
%:%202=98%:%
%:%203=98%:%
%:%204=99%:%
%:%205=99%:%
%:%206=100%:%
%:%207=101%:%
%:%208=101%:%
%:%209=102%:%
%:%210=102%:%
%:%211=103%:%
%:%212=103%:%
%:%213=104%:%
%:%219=104%:%
%:%222=105%:%
%:%223=106%:%
%:%224=106%:%
%:%225=107%:%
%:%226=108%:%
%:%227=109%:%
%:%228=110%:%
%:%229=111%:%
%:%230=112%:%
%:%231=113%:%
%:%238=114%:%
%:%239=114%:%
%:%240=115%:%
%:%241=115%:%
%:%242=116%:%
%:%243=116%:%
%:%244=117%:%
%:%245=117%:%
%:%246=118%:%
%:%247=118%:%
%:%248=119%:%
%:%249=120%:%
%:%250=120%:%
%:%251=121%:%
%:%252=122%:%
%:%253=122%:%
%:%254=123%:%
%:%255=123%:%
%:%256=123%:%
%:%257=124%:%
%:%258=125%:%
%:%259=125%:%
%:%260=126%:%
%:%261=126%:%
%:%262=127%:%
%:%263=128%:%
%:%264=128%:%
%:%265=128%:%
%:%266=128%:%
%:%267=129%:%
%:%268=130%:%
%:%269=130%:%
%:%270=131%:%
%:%271=131%:%
%:%272=132%:%
%:%273=132%:%
%:%274=133%:%
%:%275=133%:%
%:%276=134%:%
%:%277=135%:%
%:%278=135%:%
%:%279=135%:%
%:%280=136%:%
%:%281=137%:%
%:%282=137%:%
%:%283=138%:%
%:%284=138%:%
%:%285=139%:%
%:%286=139%:%
%:%287=139%:%
%:%288=139%:%
%:%289=140%:%
%:%290=140%:%
%:%291=141%:%
%:%292=142%:%
%:%293=143%:%
%:%294=143%:%
%:%295=144%:%
%:%296=144%:%
%:%297=145%:%
%:%298=145%:%
%:%299=146%:%
%:%300=146%:%
%:%301=146%:%
%:%302=146%:%
%:%303=147%:%
%:%304=147%:%
%:%305=148%:%
%:%306=148%:%
%:%307=149%:%
%:%308=149%:%
%:%309=150%:%
%:%310=150%:%
%:%311=151%:%
%:%312=151%:%
%:%313=152%:%
%:%314=152%:%
%:%315=153%:%
%:%316=153%:%
%:%317=154%:%
%:%318=154%:%
%:%319=155%:%
%:%320=155%:%
%:%321=156%:%
%:%322=156%:%
%:%323=157%:%
%:%324=157%:%
%:%325=158%:%
%:%326=159%:%
%:%327=159%:%
%:%328=159%:%
%:%329=160%:%
%:%330=161%:%
%:%331=161%:%
%:%332=162%:%
%:%333=162%:%
%:%334=163%:%
%:%335=163%:%
%:%336=164%:%
%:%337=164%:%
%:%338=165%:%
%:%339=165%:%
%:%340=166%:%
%:%341=167%:%
%:%342=167%:%
%:%343=168%:%
%:%344=168%:%
%:%345=169%:%
%:%346=169%:%
%:%347=170%:%
%:%348=170%:%
%:%349=171%:%
%:%350=171%:%
%:%351=171%:%
%:%352=171%:%
%:%353=172%:%
%:%354=172%:%
%:%355=172%:%
%:%356=173%:%
%:%357=173%:%
%:%358=174%:%
%:%359=174%:%
%:%360=174%:%
%:%361=174%:%
%:%362=175%:%
%:%363=176%:%
%:%364=176%:%
%:%365=177%:%
%:%366=177%:%
%:%367=178%:%
%:%368=178%:%
%:%369=179%:%
%:%370=179%:%
%:%371=179%:%
%:%372=180%:%
%:%373=180%:%
%:%374=181%:%
%:%375=181%:%
%:%376=182%:%
%:%377=182%:%
%:%378=183%:%
%:%379=183%:%
%:%380=184%:%
%:%381=184%:%
%:%382=185%:%
%:%383=185%:%
%:%384=186%:%
%:%385=186%:%
%:%386=187%:%
%:%387=187%:%
%:%388=188%:%
%:%389=188%:%
%:%390=188%:%
%:%391=189%:%
%:%392=189%:%
%:%393=190%:%
%:%394=190%:%
%:%395=191%:%
%:%396=191%:%
%:%397=192%:%
%:%398=192%:%
%:%399=192%:%
%:%400=193%:%
%:%401=193%:%
%:%402=194%:%
%:%403=194%:%
%:%404=194%:%
%:%405=194%:%
%:%406=195%:%
%:%407=195%:%
%:%408=196%:%
%:%409=197%:%
%:%410=197%:%
%:%411=198%:%
%:%412=198%:%
%:%413=199%:%
%:%414=199%:%
%:%415=200%:%
%:%416=200%:%
%:%417=201%:%
%:%418=201%:%
%:%419=201%:%
%:%420=202%:%
%:%421=202%:%
%:%422=202%:%
%:%423=203%:%
%:%424=203%:%
%:%425=204%:%
%:%426=204%:%
%:%427=205%:%
%:%428=205%:%
%:%429=205%:%
%:%430=206%:%
%:%431=206%:%
%:%432=207%:%
%:%433=207%:%
%:%434=207%:%
%:%435=208%:%
%:%436=208%:%
%:%437=208%:%
%:%438=209%:%
%:%439=209%:%
%:%440=210%:%
%:%441=210%:%
%:%442=211%:%
%:%443=211%:%
%:%444=212%:%
%:%445=212%:%
%:%446=213%:%
%:%447=214%:%
%:%448=214%:%
%:%449=214%:%
%:%450=214%:%
%:%451=215%:%
%:%452=215%:%
%:%453=216%:%
%:%454=217%:%
%:%455=217%:%
%:%456=218%:%
%:%457=218%:%
%:%458=219%:%
%:%459=220%:%
%:%460=220%:%
%:%461=221%:%
%:%462=221%:%
%:%463=222%:%
%:%464=222%:%
%:%465=222%:%
%:%466=223%:%
%:%467=223%:%
%:%468=224%:%
%:%469=224%:%
%:%470=225%:%
%:%471=225%:%
%:%472=226%:%
%:%473=226%:%
%:%474=227%:%
%:%475=227%:%
%:%476=227%:%
%:%477=228%:%
%:%478=229%:%
%:%479=229%:%
%:%480=230%:%
%:%481=230%:%
%:%482=231%:%
%:%483=231%:%
%:%484=232%:%
%:%485=232%:%
%:%486=232%:%
%:%487=233%:%
%:%488=233%:%
%:%489=234%:%
%:%490=234%:%
%:%491=235%:%
%:%492=235%:%
%:%493=235%:%
%:%494=236%:%
%:%495=236%:%
%:%496=237%:%
%:%497=237%:%
%:%498=238%:%
%:%499=238%:%
%:%500=238%:%
%:%501=238%:%
%:%502=239%:%
%:%503=240%:%
%:%504=240%:%
%:%505=241%:%
%:%506=242%:%
%:%507=242%:%
%:%508=243%:%
%:%509=243%:%
%:%510=244%:%
%:%511=244%:%
%:%512=244%:%
%:%513=245%:%
%:%514=246%:%
%:%515=246%:%
%:%516=247%:%
%:%517=247%:%
%:%518=248%:%
%:%519=248%:%
%:%520=249%:%
%:%521=249%:%
%:%522=250%:%
%:%523=250%:%
%:%524=251%:%
%:%525=251%:%
%:%526=252%:%
%:%527=252%:%
%:%528=252%:%
%:%530=254%:%
%:%531=255%:%
%:%532=255%:%
%:%533=256%:%
%:%534=256%:%
%:%535=257%:%
%:%536=257%:%
%:%537=258%:%
%:%538=258%:%
%:%539=258%:%
%:%540=259%:%
%:%541=260%:%
%:%542=260%:%
%:%543=261%:%
%:%544=261%:%
%:%545=262%:%
%:%546=262%:%
%:%547=263%:%
%:%548=263%:%
%:%549=263%:%
%:%550=264%:%
%:%551=264%:%
%:%552=265%:%
%:%553=265%:%
%:%554=266%:%
%:%555=266%:%
%:%556=267%:%
%:%557=267%:%
%:%558=268%:%
%:%559=268%:%
%:%560=269%:%
%:%561=269%:%
%:%562=269%:%
%:%563=270%:%
%:%564=270%:%
%:%565=271%:%
%:%566=271%:%
%:%567=272%:%
%:%568=272%:%
%:%569=273%:%
%:%570=273%:%
%:%571=273%:%
%:%572=274%:%
%:%573=274%:%
%:%574=274%:%
%:%575=275%:%
%:%576=275%:%
%:%577=276%:%
%:%578=277%:%
%:%579=277%:%
%:%580=277%:%
%:%581=278%:%
%:%582=278%:%
%:%583=279%:%
%:%584=280%:%
%:%585=280%:%
%:%586=281%:%
%:%587=281%:%
%:%588=282%:%
%:%589=282%:%
%:%590=283%:%
%:%591=283%:%
%:%592=283%:%
%:%593=284%:%
%:%594=285%:%
%:%595=285%:%
%:%596=285%:%
%:%597=286%:%
%:%603=286%:%
%:%606=287%:%
%:%607=288%:%
%:%608=288%:%
%:%609=289%:%
%:%610=290%:%
%:%611=291%:%
%:%612=292%:%
%:%613=293%:%
%:%614=294%:%
%:%615=295%:%
%:%616=296%:%
%:%617=297%:%
%:%618=298%:%
%:%619=299%:%
%:%626=300%:%
%:%627=300%:%
%:%628=301%:%
%:%629=301%:%
%:%630=302%:%
%:%631=302%:%
%:%632=303%:%
%:%633=303%:%
%:%634=304%:%
%:%635=304%:%
%:%636=304%:%
%:%637=305%:%
%:%638=306%:%
%:%639=306%:%
%:%640=307%:%
%:%641=307%:%
%:%642=308%:%
%:%643=308%:%
%:%644=308%:%
%:%645=309%:%
%:%646=309%:%
%:%647=310%:%
%:%648=310%:%
%:%649=311%:%
%:%650=311%:%
%:%651=312%:%
%:%652=312%:%
%:%653=313%:%
%:%654=313%:%
%:%655=314%:%
%:%656=314%:%
%:%657=315%:%
%:%658=315%:%
%:%659=315%:%
%:%660=316%:%
%:%661=316%:%
%:%662=317%:%
%:%663=317%:%
%:%664=318%:%
%:%665=318%:%
%:%666=319%:%
%:%667=319%:%
%:%668=320%:%
%:%669=320%:%
%:%670=321%:%
%:%671=321%:%
%:%672=321%:%
%:%673=322%:%
%:%674=323%:%
%:%675=323%:%
%:%676=324%:%
%:%677=324%:%
%:%678=324%:%
%:%679=324%:%
%:%680=325%:%
%:%686=325%:%
%:%689=326%:%
%:%690=327%:%
%:%691=327%:%
%:%692=328%:%
%:%693=329%:%
%:%694=330%:%
%:%695=331%:%
%:%696=332%:%
%:%703=333%:%
%:%704=333%:%
%:%705=334%:%
%:%706=334%:%
%:%707=335%:%
%:%708=335%:%
%:%709=336%:%
%:%710=336%:%
%:%711=337%:%
%:%712=337%:%
%:%713=338%:%
%:%714=339%:%
%:%715=340%:%
%:%716=340%:%
%:%717=341%:%
%:%718=341%:%
%:%719=342%:%
%:%720=342%:%
%:%721=343%:%
%:%722=343%:%
%:%723=344%:%
%:%724=344%:%
%:%725=345%:%
%:%726=346%:%
%:%727=346%:%
%:%728=347%:%
%:%729=347%:%
%:%730=348%:%
%:%731=348%:%
%:%732=348%:%
%:%733=349%:%
%:%734=350%:%
%:%735=350%:%
%:%736=351%:%
%:%737=351%:%
%:%738=352%:%
%:%739=352%:%
%:%740=353%:%
%:%741=354%:%
%:%742=354%:%
%:%743=354%:%
%:%744=355%:%
%:%745=356%:%
%:%746=356%:%
%:%747=357%:%
%:%748=357%:%
%:%749=358%:%
%:%750=359%:%
%:%751=359%:%
%:%752=359%:%
%:%753=359%:%
%:%754=360%:%
%:%755=361%:%
%:%756=361%:%
%:%757=362%:%
%:%758=362%:%
%:%759=363%:%
%:%760=364%:%
%:%761=364%:%
%:%762=365%:%
%:%763=365%:%
%:%764=366%:%
%:%765=366%:%
%:%766=367%:%
%:%767=367%:%
%:%768=368%:%
%:%769=369%:%
%:%770=369%:%
%:%771=370%:%
%:%772=370%:%
%:%773=371%:%
%:%774=371%:%
%:%775=371%:%
%:%776=372%:%
%:%777=372%:%
%:%778=373%:%
%:%779=373%:%
%:%780=374%:%
%:%781=375%:%
%:%782=375%:%
%:%783=376%:%
%:%784=376%:%
%:%785=377%:%
%:%786=377%:%
%:%787=377%:%
%:%788=378%:%
%:%789=379%:%
%:%790=379%:%
%:%791=380%:%
%:%792=380%:%
%:%793=380%:%
%:%794=381%:%
%:%795=382%:%
%:%796=382%:%
%:%797=383%:%
%:%798=383%:%
%:%799=383%:%
%:%800=384%:%
%:%801=385%:%
%:%802=385%:%
%:%803=386%:%
%:%804=386%:%
%:%805=387%:%
%:%806=388%:%
%:%807=388%:%
%:%808=389%:%
%:%809=389%:%
%:%810=390%:%
%:%811=391%:%
%:%812=391%:%
%:%816=395%:%
%:%817=396%:%
%:%818=397%:%
%:%819=397%:%
%:%820=398%:%
%:%821=399%:%
%:%822=400%:%
%:%823=400%:%
%:%824=401%:%
%:%825=402%:%
%:%826=402%:%
%:%827=403%:%
%:%828=403%:%
%:%829=404%:%
%:%830=404%:%
%:%831=405%:%
%:%832=405%:%
%:%833=406%:%
%:%834=406%:%
%:%835=407%:%
%:%836=407%:%
%:%837=408%:%
%:%838=408%:%
%:%839=408%:%
%:%840=409%:%
%:%841=410%:%
%:%842=410%:%
%:%843=411%:%
%:%844=411%:%
%:%845=412%:%
%:%846=412%:%
%:%847=413%:%
%:%848=413%:%
%:%849=414%:%
%:%850=414%:%
%:%851=415%:%
%:%852=415%:%
%:%853=416%:%
%:%854=416%:%
%:%855=417%:%
%:%856=417%:%
%:%857=418%:%
%:%858=418%:%
%:%859=419%:%
%:%860=419%:%
%:%861=420%:%
%:%862=420%:%
%:%863=420%:%
%:%864=421%:%
%:%865=421%:%
%:%866=422%:%
%:%867=422%:%
%:%868=423%:%
%:%869=423%:%
%:%870=424%:%
%:%871=424%:%
%:%872=425%:%
%:%873=425%:%
%:%874=426%:%
%:%875=426%:%
%:%876=427%:%
%:%877=427%:%
%:%878=428%:%
%:%879=428%:%
%:%880=428%:%
%:%881=429%:%
%:%882=429%:%
%:%883=430%:%
%:%884=430%:%
%:%885=431%:%
%:%886=431%:%
%:%887=432%:%
%:%888=432%:%
%:%889=432%:%
%:%890=433%:%
%:%891=433%:%
%:%892=434%:%
%:%893=434%:%
%:%894=435%:%
%:%895=435%:%
%:%896=436%:%
%:%897=436%:%
%:%898=437%:%
%:%899=437%:%
%:%900=438%:%
%:%901=438%:%
%:%902=438%:%
%:%903=439%:%
%:%904=439%:%
%:%905=439%:%
%:%906=440%:%
%:%907=440%:%
%:%908=440%:%
%:%909=441%:%
%:%910=441%:%
%:%911=442%:%
%:%912=442%:%
%:%913=442%:%
%:%914=443%:%
%:%915=443%:%
%:%916=444%:%
%:%917=444%:%
%:%918=445%:%
%:%919=446%:%
%:%920=446%:%
%:%921=447%:%
%:%922=447%:%
%:%923=448%:%
%:%924=448%:%
%:%925=449%:%
%:%926=449%:%
%:%927=450%:%
%:%928=450%:%
%:%929=451%:%
%:%930=451%:%
%:%931=452%:%
%:%932=452%:%
%:%933=453%:%
%:%934=453%:%
%:%935=454%:%
%:%936=454%:%
%:%937=455%:%
%:%938=455%:%
%:%939=455%:%
%:%940=456%:%
%:%941=456%:%
%:%942=457%:%
%:%943=457%:%
%:%944=458%:%
%:%945=458%:%
%:%946=459%:%
%:%947=459%:%
%:%948=460%:%
%:%949=460%:%
%:%950=461%:%
%:%951=461%:%
%:%952=462%:%
%:%953=462%:%
%:%954=463%:%
%:%955=463%:%
%:%956=463%:%
%:%957=464%:%
%:%958=464%:%
%:%959=465%:%
%:%960=465%:%
%:%961=465%:%
%:%962=466%:%
%:%963=466%:%
%:%964=467%:%
%:%965=467%:%
%:%966=468%:%
%:%967=469%:%
%:%968=469%:%
%:%969=470%:%
%:%970=470%:%
%:%971=471%:%
%:%972=471%:%
%:%973=471%:%
%:%974=472%:%
%:%975=472%:%
%:%976=473%:%
%:%977=474%:%
%:%978=474%:%
%:%979=475%:%
%:%980=475%:%
%:%981=476%:%
%:%982=476%:%
%:%983=477%:%
%:%984=477%:%
%:%985=478%:%
%:%986=478%:%
%:%987=479%:%
%:%988=479%:%
%:%989=480%:%
%:%990=480%:%
%:%991=481%:%
%:%992=481%:%
%:%993=482%:%
%:%994=483%:%
%:%995=483%:%
%:%996=484%:%
%:%997=484%:%
%:%998=485%:%
%:%999=485%:%
%:%1000=486%:%
%:%1001=486%:%
%:%1002=487%:%
%:%1003=487%:%
%:%1004=488%:%
%:%1005=488%:%
%:%1006=489%:%
%:%1007=489%:%
%:%1008=490%:%
%:%1009=491%:%
%:%1010=491%:%
%:%1011=492%:%
%:%1012=492%:%
%:%1013=493%:%
%:%1014=493%:%
%:%1015=494%:%
%:%1016=494%:%
%:%1017=495%:%
%:%1018=495%:%
%:%1019=496%:%
%:%1020=496%:%
%:%1021=497%:%
%:%1022=497%:%
%:%1023=498%:%
%:%1024=498%:%
%:%1025=499%:%
%:%1026=499%:%
%:%1027=500%:%
%:%1028=501%:%
%:%1029=501%:%
%:%1030=502%:%
%:%1031=502%:%
%:%1032=503%:%
%:%1033=503%:%
%:%1034=503%:%
%:%1035=504%:%
%:%1036=505%:%
%:%1037=505%:%
%:%1038=506%:%
%:%1039=507%:%
%:%1040=507%:%
%:%1041=508%:%
%:%1042=508%:%
%:%1043=509%:%
%:%1044=509%:%
%:%1045=510%:%
%:%1046=510%:%
%:%1047=511%:%
%:%1048=511%:%
%:%1049=512%:%
%:%1050=512%:%
%:%1051=513%:%
%:%1052=513%:%
%:%1053=513%:%
%:%1054=513%:%
%:%1055=513%:%
%:%1056=514%:%
%:%1057=514%:%
%:%1058=515%:%
%:%1059=515%:%
%:%1060=516%:%
%:%1061=516%:%
%:%1062=516%:%
%:%1063=516%:%
%:%1064=517%:%
%:%1065=518%:%
%:%1066=518%:%
%:%1067=519%:%
%:%1068=519%:%
%:%1069=520%:%
%:%1070=520%:%
%:%1071=520%:%
%:%1072=521%:%
%:%1073=521%:%
%:%1074=522%:%
%:%1075=522%:%
%:%1076=522%:%
%:%1077=523%:%
%:%1078=523%:%
%:%1079=524%:%
%:%1080=524%:%
%:%1081=525%:%
%:%1082=525%:%
%:%1083=526%:%
%:%1084=526%:%
%:%1085=527%:%
%:%1086=527%:%
%:%1087=528%:%
%:%1088=529%:%
%:%1089=529%:%
%:%1090=530%:%
%:%1091=530%:%
%:%1092=531%:%
%:%1093=531%:%
%:%1094=532%:%
%:%1095=532%:%
%:%1096=532%:%
%:%1097=533%:%
%:%1098=533%:%
%:%1099=534%:%
%:%1100=535%:%
%:%1101=535%:%
%:%1102=536%:%
%:%1103=536%:%
%:%1104=536%:%
%:%1105=537%:%
%:%1106=537%:%
%:%1107=538%:%
%:%1108=538%:%
%:%1109=538%:%
%:%1110=539%:%
%:%1111=539%:%
%:%1112=540%:%
%:%1113=540%:%
%:%1114=540%:%
%:%1115=541%:%
%:%1116=541%:%
%:%1117=541%:%
%:%1118=542%:%
%:%1119=542%:%
%:%1120=543%:%
%:%1121=543%:%
%:%1122=544%:%
%:%1123=544%:%
%:%1124=545%:%
%:%1125=546%:%
%:%1126=546%:%
%:%1127=547%:%
%:%1128=547%:%
%:%1129=548%:%
%:%1130=548%:%
%:%1131=549%:%
%:%1132=549%:%
%:%1133=550%:%
%:%1134=550%:%
%:%1135=550%:%
%:%1136=551%:%
%:%1137=551%:%
%:%1138=552%:%
%:%1139=552%:%
%:%1140=553%:%
%:%1141=553%:%
%:%1142=553%:%
%:%1143=554%:%
%:%1149=554%:%
%:%1152=555%:%
%:%1153=556%:%
%:%1154=556%:%
%:%1155=557%:%
%:%1162=564%:%
%:%1163=565%:%
%:%1164=566%:%
%:%1165=566%:%
%:%1166=567%:%
%:%1171=572%:%
%:%1172=573%:%
%:%1173=574%:%
%:%1174=574%:%
%:%1177=575%:%
%:%1181=575%:%
%:%1182=575%:%
%:%1183=576%:%
%:%1184=576%:%
%:%1185=577%:%
%:%1186=577%:%
%:%1187=578%:%
%:%1188=578%:%
%:%1189=579%:%
%:%1190=579%:%
%:%1191=580%:%
%:%1192=580%:%
%:%1193=581%:%
%:%1194=581%:%
%:%1199=581%:%
%:%1202=582%:%
%:%1203=583%:%
%:%1204=583%:%
%:%1205=584%:%
%:%1206=585%:%
%:%1207=586%:%
%:%1208=587%:%
%:%1209=588%:%
%:%1216=589%:%
%:%1217=589%:%
%:%1218=590%:%
%:%1219=590%:%
%:%1220=591%:%
%:%1221=591%:%
%:%1222=592%:%
%:%1223=592%:%
%:%1224=593%:%
%:%1225=594%:%
%:%1226=594%:%
%:%1227=595%:%
%:%1228=595%:%
%:%1229=596%:%
%:%1230=597%:%
%:%1231=597%:%
%:%1232=598%:%
%:%1233=598%:%
%:%1234=599%:%
%:%1235=599%:%
%:%1236=600%:%
%:%1237=600%:%
%:%1238=601%:%
%:%1239=601%:%
%:%1240=602%:%
%:%1241=602%:%
%:%1242=603%:%
%:%1243=603%:%
%:%1244=604%:%
%:%1245=605%:%
%:%1246=605%:%
%:%1249=608%:%
%:%1250=609%:%
%:%1251=609%:%
%:%1252=610%:%
%:%1253=610%:%
%:%1254=611%:%
%:%1255=611%:%
%:%1256=612%:%
%:%1257=613%:%
%:%1258=613%:%
%:%1259=613%:%
%:%1260=613%:%
%:%1261=614%:%
%:%1262=615%:%
%:%1263=615%:%
%:%1264=616%:%
%:%1265=617%:%
%:%1266=617%:%
%:%1267=618%:%
%:%1268=618%:%
%:%1269=619%:%
%:%1270=619%:%
%:%1271=620%:%
%:%1272=620%:%
%:%1273=621%:%
%:%1274=621%:%
%:%1275=622%:%
%:%1276=622%:%
%:%1277=622%:%
%:%1278=623%:%
%:%1279=623%:%
%:%1280=623%:%
%:%1281=624%:%
%:%1282=624%:%
%:%1283=625%:%
%:%1284=625%:%
%:%1285=626%:%
%:%1286=626%:%
%:%1287=626%:%
%:%1288=627%:%
%:%1289=627%:%
%:%1290=627%:%
%:%1291=628%:%
%:%1292=628%:%
%:%1293=629%:%
%:%1294=629%:%
%:%1295=629%:%
%:%1296=630%:%
%:%1297=630%:%
%:%1298=631%:%
%:%1299=631%:%
%:%1300=632%:%
%:%1301=633%:%
%:%1302=633%:%
%:%1304=635%:%
%:%1305=636%:%
%:%1306=636%:%
%:%1307=637%:%
%:%1308=637%:%
%:%1309=638%:%
%:%1310=638%:%
%:%1311=639%:%
%:%1312=639%:%
%:%1313=639%:%
%:%1314=640%:%
%:%1315=640%:%
%:%1316=641%:%
%:%1317=641%:%
%:%1318=642%:%
%:%1319=642%:%
%:%1320=643%:%
%:%1321=643%:%
%:%1322=643%:%
%:%1323=644%:%
%:%1324=644%:%
%:%1325=645%:%
%:%1326=645%:%
%:%1327=646%:%
%:%1328=646%:%
%:%1329=646%:%
%:%1330=647%:%
%:%1331=647%:%
%:%1332=647%:%
%:%1333=648%:%
%:%1334=648%:%
%:%1335=649%:%
%:%1336=649%:%
%:%1337=649%:%
%:%1338=650%:%
%:%1339=650%:%
%:%1340=651%:%
%:%1341=651%:%
%:%1342=651%:%
%:%1343=652%:%
%:%1344=652%:%
%:%1345=653%:%
%:%1346=653%:%
%:%1347=653%:%
%:%1348=654%:%
%:%1349=654%:%
%:%1350=655%:%
%:%1351=655%:%
%:%1352=656%:%
%:%1353=657%:%
%:%1354=657%:%
%:%1360=663%:%
%:%1361=664%:%
%:%1362=664%:%
%:%1363=665%:%
%:%1364=665%:%
%:%1365=666%:%
%:%1366=667%:%
%:%1367=668%:%
%:%1368=668%:%
%:%1369=669%:%
%:%1370=669%:%
%:%1371=670%:%
%:%1372=670%:%
%:%1373=671%:%
%:%1374=671%:%
%:%1375=672%:%
%:%1376=672%:%
%:%1377=673%:%
%:%1378=673%:%
%:%1379=674%:%
%:%1380=674%:%
%:%1381=675%:%
%:%1382=675%:%
%:%1383=676%:%
%:%1384=676%:%
%:%1385=677%:%
%:%1386=677%:%
%:%1387=677%:%
%:%1388=678%:%
%:%1389=678%:%
%:%1390=679%:%
%:%1391=679%:%
%:%1392=679%:%
%:%1394=681%:%
%:%1395=681%:%
%:%1396=682%:%
%:%1397=682%:%
%:%1398=683%:%
%:%1399=684%:%
%:%1400=684%:%
%:%1401=685%:%
%:%1402=685%:%
%:%1403=686%:%
%:%1404=686%:%
%:%1405=687%:%
%:%1406=687%:%
%:%1407=688%:%
%:%1408=688%:%
%:%1409=689%:%
%:%1410=689%:%
%:%1411=690%:%
%:%1412=690%:%
%:%1413=691%:%
%:%1414=691%:%
%:%1415=692%:%
%:%1416=692%:%
%:%1417=693%:%
%:%1423=693%:%
%:%1426=694%:%
%:%1427=695%:%
%:%1428=695%:%
%:%1429=696%:%
%:%1430=697%:%
%:%1431=698%:%
%:%1438=699%:%
%:%1439=699%:%
%:%1440=700%:%
%:%1441=700%:%
%:%1442=701%:%
%:%1443=701%:%
%:%1444=702%:%
%:%1445=702%:%
%:%1446=703%:%
%:%1447=703%:%
%:%1448=704%:%
%:%1449=705%:%
%:%1450=705%:%
%:%1451=706%:%
%:%1452=707%:%
%:%1453=707%:%
%:%1454=708%:%
%:%1455=708%:%
%:%1456=709%:%
%:%1457=709%:%
%:%1458=710%:%
%:%1459=710%:%
%:%1460=711%:%
%:%1461=712%:%
%:%1462=712%:%
%:%1463=713%:%
%:%1464=713%:%
%:%1465=714%:%
%:%1466=714%:%
%:%1467=715%:%
%:%1468=715%:%
%:%1469=716%:%
%:%1470=716%:%
%:%1471=717%:%
%:%1472=718%:%
%:%1473=718%:%
%:%1474=719%:%
%:%1475=719%:%
%:%1476=720%:%
%:%1477=720%:%
%:%1478=721%:%
%:%1479=721%:%
%:%1480=722%:%
%:%1481=722%:%
%:%1482=723%:%
%:%1483=723%:%
%:%1484=724%:%
%:%1485=725%:%
%:%1486=725%:%
%:%1487=726%:%
%:%1488=726%:%
%:%1489=727%:%
%:%1490=727%:%
%:%1491=728%:%
%:%1492=728%:%
%:%1493=729%:%
%:%1494=729%:%
%:%1495=730%:%
%:%1496=730%:%
%:%1497=731%:%
%:%1498=732%:%
%:%1499=732%:%
%:%1500=733%:%
%:%1501=733%:%
%:%1502=734%:%
%:%1503=734%:%
%:%1504=735%:%
%:%1505=735%:%
%:%1506=736%:%
%:%1507=736%:%
%:%1508=737%:%
%:%1509=737%:%
%:%1510=738%:%
%:%1511=739%:%
%:%1512=739%:%
%:%1513=740%:%
%:%1514=740%:%
%:%1515=741%:%
%:%1516=741%:%
%:%1517=742%:%
%:%1518=742%:%
%:%1519=743%:%
%:%1520=743%:%
%:%1521=744%:%
%:%1522=744%:%
%:%1523=745%:%
%:%1524=746%:%
%:%1525=746%:%
%:%1526=747%:%
%:%1527=747%:%
%:%1528=748%:%
%:%1529=748%:%
%:%1530=749%:%
%:%1531=749%:%
%:%1532=750%:%
%:%1533=751%:%
%:%1534=751%:%
%:%1535=752%:%
%:%1536=752%:%
%:%1537=753%:%
%:%1538=753%:%
%:%1539=754%:%
%:%1540=754%:%
%:%1541=755%:%
%:%1542=756%:%
%:%1543=756%:%
%:%1544=757%:%
%:%1545=757%:%
%:%1546=758%:%
%:%1547=759%:%
%:%1548=759%:%
%:%1549=760%:%
%:%1550=760%:%
%:%1551=761%:%
%:%1552=762%:%
%:%1553=762%:%
%:%1554=763%:%
%:%1555=763%:%
%:%1556=764%:%
%:%1557=764%:%
%:%1558=765%:%
%:%1559=765%:%
%:%1560=766%:%
%:%1561=767%:%
%:%1562=767%:%
%:%1563=768%:%
%:%1564=768%:%
%:%1565=769%:%
%:%1566=769%:%
%:%1567=770%:%
%:%1568=770%:%
%:%1569=771%:%
%:%1570=771%:%
%:%1571=772%:%
%:%1572=773%:%
%:%1573=773%:%
%:%1574=774%:%
%:%1575=774%:%
%:%1576=775%:%
%:%1577=775%:%
%:%1578=776%:%
%:%1579=776%:%
%:%1580=777%:%
%:%1581=778%:%
%:%1582=778%:%
%:%1583=779%:%
%:%1584=780%:%
%:%1585=780%:%
%:%1586=781%:%
%:%1587=781%:%
%:%1588=782%:%
%:%1589=782%:%
%:%1590=783%:%
%:%1591=784%:%
%:%1592=784%:%
%:%1593=785%:%
%:%1594=785%:%
%:%1595=786%:%
%:%1596=787%:%
%:%1597=787%:%
%:%1598=788%:%
%:%1599=788%:%
%:%1600=789%:%
%:%1601=789%:%
%:%1602=790%:%
%:%1603=790%:%
%:%1604=791%:%
%:%1605=791%:%
%:%1606=792%:%
%:%1607=792%:%
%:%1608=793%:%
%:%1609=794%:%
%:%1610=794%:%
%:%1611=795%:%
%:%1612=795%:%
%:%1613=796%:%
%:%1614=796%:%
%:%1615=797%:%
%:%1616=797%:%
%:%1617=798%:%
%:%1618=798%:%
%:%1619=799%:%
%:%1620=799%:%
%:%1621=800%:%
%:%1622=800%:%
%:%1623=801%:%
%:%1624=802%:%
%:%1625=802%:%
%:%1626=803%:%
%:%1627=803%:%
%:%1628=804%:%
%:%1629=804%:%
%:%1630=805%:%
%:%1631=805%:%
%:%1632=806%:%
%:%1633=806%:%
%:%1634=807%:%
%:%1635=807%:%
%:%1636=808%:%
%:%1637=808%:%
%:%1638=809%:%
%:%1639=810%:%
%:%1640=810%:%
%:%1641=811%:%
%:%1642=811%:%
%:%1643=812%:%
%:%1644=812%:%
%:%1645=813%:%
%:%1646=813%:%
%:%1647=814%:%
%:%1648=814%:%
%:%1649=815%:%
%:%1650=815%:%
%:%1651=816%:%
%:%1652=816%:%
%:%1653=817%:%
%:%1654=817%:%
%:%1655=818%:%
%:%1656=818%:%
%:%1657=819%:%
%:%1658=819%:%
%:%1659=820%:%
%:%1660=820%:%
%:%1661=821%:%
%:%1662=821%:%
%:%1663=822%:%
%:%1664=822%:%
%:%1665=823%:%
%:%1666=823%:%
%:%1667=824%:%
%:%1668=824%:%
%:%1669=825%:%
%:%1670=826%:%
%:%1671=826%:%
%:%1672=827%:%
%:%1673=827%:%
%:%1674=828%:%
%:%1675=828%:%
%:%1676=829%:%
%:%1677=829%:%
%:%1678=830%:%
%:%1679=830%:%
%:%1680=831%:%
%:%1681=831%:%
%:%1682=832%:%
%:%1683=832%:%
%:%1684=833%:%
%:%1685=833%:%
%:%1686=834%:%
%:%1687=835%:%
%:%1688=835%:%
%:%1689=836%:%
%:%1690=837%:%
%:%1691=837%:%
%:%1692=838%:%
%:%1693=838%:%
%:%1694=839%:%
%:%1695=839%:%
%:%1696=840%:%
%:%1697=840%:%
%:%1698=841%:%
%:%1699=841%:%
%:%1700=842%:%
%:%1701=843%:%
%:%1702=843%:%
%:%1703=844%:%
%:%1704=845%:%
%:%1705=845%:%
%:%1706=846%:%
%:%1707=846%:%
%:%1708=847%:%
%:%1709=847%:%
%:%1710=848%:%
%:%1711=848%:%
%:%1712=848%:%
%:%1713=849%:%
%:%1714=850%:%
%:%1715=850%:%
%:%1716=851%:%
%:%1717=852%:%
%:%1718=852%:%
%:%1719=853%:%
%:%1720=853%:%
%:%1721=854%:%
%:%1722=854%:%
%:%1723=855%:%
%:%1724=855%:%
%:%1725=856%:%
%:%1726=856%:%
%:%1727=857%:%
%:%1728=857%:%
%:%1729=858%:%
%:%1730=858%:%
%:%1731=859%:%
%:%1732=859%:%
%:%1733=860%:%
%:%1734=860%:%
%:%1735=861%:%
%:%1736=861%:%
%:%1737=862%:%
%:%1738=862%:%
%:%1739=863%:%
%:%1740=863%:%
%:%1741=864%:%
%:%1742=864%:%
%:%1743=865%:%
%:%1744=865%:%
%:%1745=866%:%
%:%1746=867%:%
%:%1747=867%:%
%:%1748=868%:%
%:%1749=868%:%
%:%1750=869%:%
%:%1751=869%:%
%:%1752=870%:%
%:%1753=870%:%
%:%1754=870%:%
%:%1755=871%:%
%:%1756=871%:%
%:%1757=872%:%
%:%1758=872%:%
%:%1759=873%:%
%:%1760=873%:%
%:%1761=874%:%
%:%1762=874%:%
%:%1763=875%:%
%:%1764=875%:%
%:%1765=876%:%
%:%1766=876%:%
%:%1767=877%:%
%:%1768=877%:%
%:%1769=878%:%
%:%1770=878%:%
%:%1771=879%:%
%:%1772=879%:%
%:%1773=880%:%
%:%1774=880%:%
%:%1775=881%:%
%:%1776=881%:%
%:%1777=882%:%
%:%1778=882%:%
%:%1779=882%:%
%:%1780=883%:%
%:%1781=883%:%
%:%1782=884%:%
%:%1783=884%:%
%:%1784=885%:%
%:%1785=885%:%
%:%1786=886%:%
%:%1787=886%:%
%:%1788=886%:%
%:%1789=886%:%
%:%1790=887%:%
%:%1796=887%:%
%:%1801=888%:%
%:%1806=889%:%
