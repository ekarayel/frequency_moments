%
\begin{isabellebody}%
\setisabellecontext{Encoding}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Encoding%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Encoding\isanewline
\ \ \isakeyword{imports}\ Main\ {\isachardoublequoteopen}HOL{\isacharminus}{\kern0pt}Library{\isachardot}{\kern0pt}Sublist{\isachardoublequoteclose}\ {\isachardoublequoteopen}HOL{\isacharminus}{\kern0pt}Library{\isachardot}{\kern0pt}Extended{\isacharunderscore}{\kern0pt}Real{\isachardoublequoteclose}\ {\isachardoublequoteopen}HOL{\isacharminus}{\kern0pt}Library{\isachardot}{\kern0pt}FuncSet{\isachardoublequoteclose}\ \isanewline
\ \ HOL{\isachardot}{\kern0pt}Transcendental\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
This section contains a flexible library for encoding high level data structures into bit
strings. The library defines encoding functions for primitive types, as well as combinators
to build encodings for more complex types. It is used to measure the size of the data structures.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}prefix\ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}Some\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Some\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ prefix\ x\ y{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}prefix\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ False{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{type{\isacharunderscore}{\kern0pt}synonym}\isamarkupfalse%
\ {\isacharprime}{\kern0pt}a\ encoding\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymrightharpoonup}\ bool\ list{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}encoding\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ encoding\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}x\ y{\isachardot}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ y{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ x\ {\isacharequal}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ encoding{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}inj{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ f\ {\isacharparenleft}{\kern0pt}dom\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inj{\isacharunderscore}{\kern0pt}onI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}is{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ decode\ \isakeyword{where}\ \isanewline
\ \ {\isachardoublequoteopen}decode\ f\ t\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ if\ {\isacharparenleft}{\kern0pt}{\isasymexists}{\isacharbang}{\kern0pt}z{\isachardot}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}f\ z{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Some\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ then\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}let\ z\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}THE\ z{\isachardot}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}f\ z{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Some\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ in\ {\isacharparenleft}{\kern0pt}z{\isacharcomma}{\kern0pt}\ drop\ {\isacharparenleft}{\kern0pt}length\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}f\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ else\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}undefined{\isacharcomma}{\kern0pt}\ t{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ decode{\isacharunderscore}{\kern0pt}elim{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ x\ {\isacharequal}{\kern0pt}\ Some\ r{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}decode\ f\ {\isacharparenleft}{\kern0pt}r{\isacharat}{\kern0pt}r{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}r{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymAnd}y{\isachardot}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}f\ y{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Some\ {\isacharparenleft}{\kern0pt}r{\isacharat}{\kern0pt}r{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ y\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ y\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}f\ y{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Some\ {\isacharparenleft}{\kern0pt}r{\isacharat}{\kern0pt}r{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ u\ \isakeyword{where}\ u{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ y\ {\isacharequal}{\kern0pt}\ Some\ u{\isachardoublequoteclose}\ {\isachardoublequoteopen}prefix\ u\ {\isacharparenleft}{\kern0pt}r{\isacharat}{\kern0pt}r{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ is{\isacharunderscore}{\kern0pt}prefix{\isachardot}{\kern0pt}elims{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ option{\isachardot}{\kern0pt}sel{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}prefix\ u\ r\ {\isasymor}\ prefix\ r\ u{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ prefix{\isacharunderscore}{\kern0pt}def\ prefix{\isacharunderscore}{\kern0pt}same{\isacharunderscore}{\kern0pt}cases\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}f\ y{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\ {\isasymor}\ is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ u{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}is{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Some\ {\isacharparenleft}{\kern0pt}r{\isacharat}{\kern0pt}r{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ c{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymexists}{\isacharbang}{\kern0pt}z{\isachardot}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}f\ z{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Some\ {\isacharparenleft}{\kern0pt}r{\isacharat}{\kern0pt}r{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a\ b\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ d{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}THE\ z{\isachardot}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}f\ z{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Some\ {\isacharparenleft}{\kern0pt}r{\isacharat}{\kern0pt}r{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a\ b\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}decode\ f\ {\isacharparenleft}{\kern0pt}r{\isacharat}{\kern0pt}r{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}r{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ c\ d\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ \ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ decode{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ decode{\isacharunderscore}{\kern0pt}elim{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isasymin}\ dom\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}decode\ f\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}{\isacharat}{\kern0pt}r{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}r{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ decode{\isacharunderscore}{\kern0pt}elim\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}decode{\isacharunderscore}{\kern0pt}suffix{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}suffix\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}decode\ f\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}{\isasymexists}{\isacharbang}{\kern0pt}z{\isachardot}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}f\ z{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Some\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ z\ \isakeyword{where}\ \ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}f\ z{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Some\ t{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}THE\ z{\isachardot}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}f\ z{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Some\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ z{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ True\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ True\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ decode{\isacharunderscore}{\kern0pt}def\ suffix{\isacharunderscore}{\kern0pt}drop{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}decode{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}decode{\isacharunderscore}{\kern0pt}len{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}decode\ f\ t\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}length\ v\ {\isasymle}\ length\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}decode{\isacharunderscore}{\kern0pt}suffix\ assms\ suffix{\isacharunderscore}{\kern0pt}length{\isacharunderscore}{\kern0pt}le\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ snd{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ encoding{\isacharunderscore}{\kern0pt}by{\isacharunderscore}{\kern0pt}witness{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ x\ {\isasymin}\ dom\ f\ {\isasymLongrightarrow}\ g\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}{\isacharat}{\kern0pt}y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ y{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ y\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}prefix\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ d\ \isakeyword{where}\ d{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}the\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}{\isacharat}{\kern0pt}d\ {\isacharequal}{\kern0pt}\ the\ {\isacharparenleft}{\kern0pt}f\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}tac\ {\isacharbrackleft}{\kern0pt}{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isachardoublequoteopen}f\ x{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}tac\ {\isacharbrackleft}{\kern0pt}{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isachardoublequoteopen}f\ y{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ prefixE{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ dom\ f{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ a\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}dom{\isacharunderscore}{\kern0pt}def\ del{\isacharcolon}{\kern0pt}not{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ is{\isacharunderscore}{\kern0pt}prefix{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}f\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}d{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\ dom\ f{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ a\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}dom{\isacharunderscore}{\kern0pt}def\ del{\isacharcolon}{\kern0pt}not{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ is{\isacharunderscore}{\kern0pt}prefix{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}f\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}y{\isacharcomma}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ y{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}is{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{fun}\isamarkupfalse%
\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bool\ list\ option\ {\isasymRightarrow}\ ereal{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ None\ {\isacharequal}{\kern0pt}\ {\isasyminfinity}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}Some\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}length\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ append{\isacharunderscore}{\kern0pt}encoding\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bool\ list\ option\ {\isasymRightarrow}\ bool\ list\ option\ {\isasymRightarrow}\ bool\ list\ option{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isacharat}{\kern0pt}\isactrlsub S{\isachardoublequoteclose}\ {\isadigit{6}}{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}append{\isacharunderscore}{\kern0pt}encoding\ {\isacharparenleft}{\kern0pt}Some\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Some\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ {\isacharparenleft}{\kern0pt}x{\isacharat}{\kern0pt}y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}append{\isacharunderscore}{\kern0pt}encoding\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ None{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}append{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}x{\isadigit{1}}{\isacharat}{\kern0pt}\isactrlsub Sx{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ x{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ x{\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isadigit{1}}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ cases\ x{\isadigit{2}}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Encodings for lists%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ list\isactrlsub S\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}list\isactrlsub S\ f\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ {\isacharbrackleft}{\kern0pt}False{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}list\isactrlsub S\ f\ {\isacharparenleft}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ {\isacharbrackleft}{\kern0pt}True{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}\isactrlsub Sf\ x{\isacharat}{\kern0pt}\isactrlsub Slist\isactrlsub S\ f\ xs{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{function}\isamarkupfalse%
\ decode{\isacharunderscore}{\kern0pt}list\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ bool\ list\ option{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ bool\ list\ \isanewline
\ \ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ list\ {\isasymtimes}\ bool\ list{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{where}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}list\ e\ {\isacharparenleft}{\kern0pt}True{\isacharhash}{\kern0pt}x{\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ {\isacharparenleft}{\kern0pt}r{\isadigit{1}}{\isacharcomma}{\kern0pt}x{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ decode\ e\ x{\isadigit{0}}\ in\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ let\ {\isacharparenleft}{\kern0pt}r{\isadigit{2}}{\isacharcomma}{\kern0pt}x{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ decode{\isacharunderscore}{\kern0pt}list\ e\ x{\isadigit{1}}\ in\ {\isacharparenleft}{\kern0pt}r{\isadigit{1}}{\isacharhash}{\kern0pt}r{\isadigit{2}}{\isacharcomma}{\kern0pt}x{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}list\ e\ {\isacharparenleft}{\kern0pt}False{\isacharhash}{\kern0pt}x{\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ x{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}list\ e\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ undefined{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ pat{\isacharunderscore}{\kern0pt}completeness\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isacommand{termination}\isamarkupfalse%
\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}relation\ {\isachardoublequoteopen}measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}x{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ length\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharplus}{\kern0pt}{\isacharcomma}{\kern0pt}\ metis\ le{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}Suc\ snd{\isacharunderscore}{\kern0pt}decode{\isacharunderscore}{\kern0pt}len{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ l\ {\isasymsubseteq}\ dom\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}l\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ l{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}dom{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ f\ xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}x\ {\isasymleftarrow}\ xs{\isachardot}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ xs{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}append{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ add{\isachardot}{\kern0pt}commute\ add{\isachardot}{\kern0pt}left{\isacharunderscore}{\kern0pt}commute\ one{\isacharunderscore}{\kern0pt}ereal{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ a{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ f\ xs{\isacharparenright}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}length\ xs{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}sum{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ length\ xs\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ xs{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ subst\ plus{\isacharunderscore}{\kern0pt}ereal{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ subst\ ereal{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}distrib{\isacharcomma}{\kern0pt}\ simp{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}{\isadigit{1}}\ {\isasymle}\ a{\isacharplus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ add{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ a\ \ b\ sum{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ a{\isacharplus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\ \isakeyword{and}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\ \isakeyword{and}\ xs{\isacharequal}{\kern0pt}{\isachardoublequoteopen}xs{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ ereal{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}iff{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}estI{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ set\ xs\ {\isasymLongrightarrow}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ a{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}ereal\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}length\ xs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isasymle}\ h{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ f\ xs{\isacharparenright}{\kern0pt}\ {\isasymle}\ h{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ order{\isacharunderscore}{\kern0pt}trans\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}x\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ f{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ decode{\isacharunderscore}{\kern0pt}list\ f\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ f\ x{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ \ {\isacharparenleft}{\kern0pt}induction\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ a\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}f\ a{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}dom{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}list\isactrlsub S\ f\ x{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}dom{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ dom{\isacharunderscore}{\kern0pt}def\ decode{\isacharunderscore}{\kern0pt}elim{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}encoding{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ {\isacharparenleft}{\kern0pt}list\isactrlsub S\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ encoding{\isacharunderscore}{\kern0pt}by{\isacharunderscore}{\kern0pt}witness{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}list\ f{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}aux\ assms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Encoding for natural numbers%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}aux\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ bool\ list{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}aux\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}False{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}nat{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}aux\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ True{\isacharhash}{\kern0pt}{\isacharparenleft}{\kern0pt}odd\ n{\isacharparenright}{\kern0pt}{\isacharhash}{\kern0pt}nat{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}aux\ {\isacharparenleft}{\kern0pt}n\ div\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ N\isactrlsub S\ \isakeyword{where}\ {\isachardoublequoteopen}N\isactrlsub S\ n\ {\isacharequal}{\kern0pt}\ Some\ {\isacharparenleft}{\kern0pt}nat{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}aux\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ decode{\isacharunderscore}{\kern0pt}nat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ nat\ {\isasymtimes}\ bool\ list{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}nat\ {\isacharparenleft}{\kern0pt}False{\isacharhash}{\kern0pt}y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}nat\ {\isacharparenleft}{\kern0pt}True{\isacharhash}{\kern0pt}x{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}\ rs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ decode{\isacharunderscore}{\kern0pt}nat\ xs\ in\ {\isacharparenleft}{\kern0pt}n\ {\isacharasterisk}{\kern0pt}\ {\isadigit{2}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ x\ then\ {\isadigit{1}}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ rs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}nat\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ undefined{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}nat\ {\isacharparenleft}{\kern0pt}nat{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}aux\ x\ {\isacharat}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ x\ rule{\isacharcolon}{\kern0pt}nat{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}aux{\isachardot}{\kern0pt}induct{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}mult{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ N\isactrlsub S{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ encoding{\isacharunderscore}{\kern0pt}by{\isacharunderscore}{\kern0pt}witness{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}nat{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}nat{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}aux{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}N\isactrlsub S\ n{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ n{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n\ rule{\isacharcolon}{\kern0pt}nat{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}aux{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}log\ {\isadigit{2}}\ {\isadigit{2}}\ {\isacharplus}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n\ div\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ log{\isacharunderscore}{\kern0pt}mult{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ log{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}cancel{\isacharunderscore}{\kern0pt}iff{\isacharcomma}{\kern0pt}\ simp{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n\ div\ {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ {\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}add{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}n\ {\isasymle}\ m{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}N\isactrlsub S\ n{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharplus}{\kern0pt}real\ m{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharplus}{\kern0pt}real\ m{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ le{\isacharunderscore}{\kern0pt}ereal{\isacharunderscore}{\kern0pt}le\ \ add{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Encoding for integers%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ I\isactrlsub S\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}int\ {\isasymRightarrow}\ bool\ list\ option{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}I\isactrlsub S\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ n\ {\isasymge}\ {\isadigit{0}}\ then\ Some\ {\isacharbrackleft}{\kern0pt}True{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}\isactrlsub SN\isactrlsub S\ {\isacharparenleft}{\kern0pt}nat\ n{\isacharparenright}{\kern0pt}\ else\ Some\ {\isacharbrackleft}{\kern0pt}False{\isacharbrackright}{\kern0pt}{\isacharat}{\kern0pt}\isactrlsub S\ {\isacharparenleft}{\kern0pt}N\isactrlsub S\ {\isacharparenleft}{\kern0pt}nat\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}n{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ decode{\isacharunderscore}{\kern0pt}int\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bool\ list\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}int\ {\isasymtimes}\ bool\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}True{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}x{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharcomma}{\kern0pt}y{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}int\ x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}decode{\isacharunderscore}{\kern0pt}nat\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}False{\isacharhash}{\kern0pt}xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}x{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharcomma}{\kern0pt}y{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}int\ x{\isacharparenright}{\kern0pt}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}decode{\isacharunderscore}{\kern0pt}nat\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}int\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ undefined{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ int{\isacharunderscore}{\kern0pt}encoding{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ I\isactrlsub S{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ encoding{\isacharunderscore}{\kern0pt}by{\isacharunderscore}{\kern0pt}witness{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}int{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}nat{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}aux{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ int{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}I\isactrlsub S\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isasymbar}x{\isasymbar}{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymnot}{\isacharparenleft}{\kern0pt}{\isadigit{0}}\ {\isasymle}\ x{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}x\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ n{\isacharequal}{\kern0pt}{\isachardoublequoteopen}nat\ x{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}append\ add{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ n{\isacharequal}{\kern0pt}{\isachardoublequoteopen}nat\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}x{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}append\ add{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a\ order{\isacharunderscore}{\kern0pt}trans\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ int{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}abs\ n\ {\isasymle}\ m{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}I\isactrlsub S\ n{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}m{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}abs\ n{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isasymle}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}m{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ assms\ le{\isacharunderscore}{\kern0pt}ereal{\isacharunderscore}{\kern0pt}le\ int{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Encoding for Cartesian products%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ encode{\isacharunderscore}{\kern0pt}prod\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ encoding\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ encoding\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ encoding{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isasymtimes}\isactrlsub S{\isachardoublequoteclose}\ {\isadigit{6}}{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{where}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}encode{\isacharunderscore}{\kern0pt}prod\ e{\isadigit{1}}\ e{\isadigit{2}}\ x\ {\isacharequal}{\kern0pt}\ e{\isadigit{1}}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isacharat}{\kern0pt}\isactrlsub S\ e{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ decode{\isacharunderscore}{\kern0pt}prod\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ encoding\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ encoding\ {\isasymRightarrow}\ bool\ list\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ bool\ list{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}prod\ e{\isadigit{1}}\ e{\isadigit{2}}\ x{\isadigit{0}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ {\isacharparenleft}{\kern0pt}r{\isadigit{1}}{\isacharcomma}{\kern0pt}x{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ decode\ e{\isadigit{1}}\ x{\isadigit{0}}\ in\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ let\ {\isacharparenleft}{\kern0pt}r{\isadigit{2}}{\isacharcomma}{\kern0pt}x{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ decode\ e{\isadigit{2}}\ x{\isadigit{1}}\ in\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}r{\isadigit{1}}{\isacharcomma}{\kern0pt}r{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}x{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}dom{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}x\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}e{\isadigit{1}}\ {\isasymtimes}\isactrlsub S\ e{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ x\ {\isasymin}\ dom\ e{\isadigit{1}}\ {\isasymand}\ snd\ x\ {\isasymin}\ dom\ e{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}tac\ {\isacharbrackleft}{\kern0pt}{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isachardoublequoteopen}e{\isadigit{1}}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}tac\ {\isacharbrackleft}{\kern0pt}{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isachardoublequoteopen}e{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}dom{\isacharunderscore}{\kern0pt}def\ del{\isacharcolon}{\kern0pt}not{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}encoding{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ e{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ e{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}prod\ e{\isadigit{1}}\ e{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ \ {\isacharparenleft}{\kern0pt}rule\ encoding{\isacharunderscore}{\kern0pt}by{\isacharunderscore}{\kern0pt}witness{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}prod\ e{\isadigit{1}}\ e{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ y\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}e{\isadigit{1}}\ {\isasymtimes}\isactrlsub S\ e{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e{\isadigit{1}}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}e{\isadigit{1}}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ a\ prod{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}dom\ domIff\ option{\isachardot}{\kern0pt}exhaust{\isacharunderscore}{\kern0pt}sel{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ c{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}e{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}e{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ a\ prod{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}dom\ domIff\ option{\isachardot}{\kern0pt}exhaust{\isacharunderscore}{\kern0pt}sel{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}decode{\isacharunderscore}{\kern0pt}prod\ e{\isadigit{1}}\ e{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isadigit{1}}\ {\isasymtimes}\isactrlsub S\ e{\isadigit{2}}{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ subst\ b{\isacharcomma}{\kern0pt}\ subst\ c{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ b\ c\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}decode{\isacharunderscore}{\kern0pt}elim{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e\isactrlsub {\isadigit{1}}\ {\isasymtimes}\isactrlsub S\ e\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}x\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}e\isactrlsub {\isadigit{1}}\ x\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}e\isactrlsub {\isadigit{2}}\ x\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}append{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e{\isadigit{1}}\ {\isasymtimes}\isactrlsub S\ e{\isadigit{2}}{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}e{\isadigit{1}}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}e{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}append{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Encoding for dependent sums%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ encode{\isacharunderscore}{\kern0pt}dependent{\isacharunderscore}{\kern0pt}sum\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ encoding\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ encoding{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ encoding{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isasymtimes}\isactrlsub D{\isachardoublequoteclose}\ {\isadigit{6}}{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{where}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}encode{\isacharunderscore}{\kern0pt}dependent{\isacharunderscore}{\kern0pt}sum\ e{\isadigit{1}}\ e{\isadigit{2}}\ x\ {\isacharequal}{\kern0pt}\ e{\isadigit{1}}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isacharat}{\kern0pt}\isactrlsub S\ e{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ dependent{\isacharunderscore}{\kern0pt}encoding{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ e{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}encoding\ {\isacharparenleft}{\kern0pt}e{\isadigit{2}}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}dependent{\isacharunderscore}{\kern0pt}sum\ e{\isadigit{1}}\ e{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ d\ \isakeyword{where}\ {\isachardoublequoteopen}d\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isadigit{0}}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ let\ {\isacharparenleft}{\kern0pt}r{\isadigit{1}}{\isacharcomma}{\kern0pt}\ x{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ decode\ e{\isadigit{1}}\ x{\isadigit{0}}\ in\ \isanewline
\ \ \ \ let\ {\isacharparenleft}{\kern0pt}r{\isadigit{2}}{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ decode\ {\isacharparenleft}{\kern0pt}e{\isadigit{2}}\ r{\isadigit{1}}{\isacharparenright}{\kern0pt}\ x{\isadigit{1}}\ in\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}r{\isadigit{1}}{\isacharcomma}{\kern0pt}r{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ x{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}e{\isadigit{1}}\ {\isasymtimes}\isactrlsub D\ e{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ fst\ x\ {\isasymin}\ dom\ e{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}dom{\isacharunderscore}{\kern0pt}def\ del{\isacharcolon}{\kern0pt}not{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ append{\isacharunderscore}{\kern0pt}encoding{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}e{\isadigit{1}}\ {\isasymtimes}\isactrlsub D\ e{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ snd\ x\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}e{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}dom{\isacharunderscore}{\kern0pt}def\ del{\isacharcolon}{\kern0pt}not{\isacharunderscore}{\kern0pt}None{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ append{\isacharunderscore}{\kern0pt}encoding{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ c{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}e{\isadigit{1}}\ {\isasymtimes}\isactrlsub D\ e{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ e{\isadigit{1}}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}e{\isadigit{1}}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ domIff{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ d{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ dom\ {\isacharparenleft}{\kern0pt}e{\isadigit{1}}\ {\isasymtimes}\isactrlsub D\ e{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ e{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Some\ {\isacharparenleft}{\kern0pt}the\ {\isacharparenleft}{\kern0pt}e{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ b\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ domIff{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ encoding{\isacharunderscore}{\kern0pt}by{\isacharunderscore}{\kern0pt}witness{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}d{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}d{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ subst\ c{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ subst\ d{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ a\ b\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}d{\isacharunderscore}{\kern0pt}def\ decode{\isacharunderscore}{\kern0pt}elim{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ dependent{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}e\isactrlsub {\isadigit{1}}\ {\isasymtimes}\isactrlsub D\ e\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}x\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}e\isactrlsub {\isadigit{1}}\ x\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}e\isactrlsub {\isadigit{2}}\ x\isactrlsub {\isadigit{1}}\ x\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}append{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
This lemma helps derive an encoding on the domain of an injective function using an 
existing encoding on its image.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ encoding{\isacharunderscore}{\kern0pt}compose{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ f{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ g\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ P\ x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ if\ P\ x\ then\ f\ {\isacharparenleft}{\kern0pt}g\ x{\isacharparenright}{\kern0pt}\ else\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ inj{\isacharunderscore}{\kern0pt}onD\ is{\isacharunderscore}{\kern0pt}encoding{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Encoding for extensional maps defined on an enumerable set.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ fun\isactrlsub S\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ list\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ encoding\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ encoding{\isachardoublequoteclose}\ \ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isasymrightarrow}\isactrlsub S{\isachardoublequoteclose}\ {\isadigit{6}}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ \ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}fun\isactrlsub S\ xs\ e\ f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ if\ f\ {\isasymin}\ extensional\ {\isacharparenleft}{\kern0pt}set\ xs{\isacharparenright}{\kern0pt}\ then\ \isanewline
\ \ \ \ \ \ list\isactrlsub S\ e\ {\isacharparenleft}{\kern0pt}map\ f\ xs{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ else\isanewline
\ \ \ \ \ \ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ encode{\isacharunderscore}{\kern0pt}extensional{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ e{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}xs\ {\isasymrightarrow}\isactrlsub S\ e{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}fun\isactrlsub S{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ encoding{\isacharunderscore}{\kern0pt}compose{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}list\isactrlsub S\ e{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ list{\isacharunderscore}{\kern0pt}encoding\ assms{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inj{\isacharunderscore}{\kern0pt}onI{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ extensionalityI\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ extensional{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isasymin}\ extensional\ {\isacharparenleft}{\kern0pt}set\ xs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}xs\ {\isasymrightarrow}\isactrlsub S\ e{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}x\ {\isasymleftarrow}\ xs{\isachardot}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}e\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}fun\isactrlsub S{\isacharunderscore}{\kern0pt}def\ list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ comp{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Encoding for ordered sets.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ set\isactrlsub S\ \isakeyword{where}\ {\isachardoublequoteopen}set\isactrlsub S\ e\ S\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ finite\ S\ then\ list\isactrlsub S\ e\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ S{\isacharparenright}{\kern0pt}\ else\ None{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ encode{\isacharunderscore}{\kern0pt}set{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ e{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}encoding\ {\isacharparenleft}{\kern0pt}{\isasymlambda}S{\isachardot}{\kern0pt}\ set\isactrlsub S\ e\ S{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ encoding{\isacharunderscore}{\kern0pt}compose{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}list\isactrlsub S\ e{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms\ list{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inj{\isacharunderscore}{\kern0pt}onI{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isachardot}{\kern0pt}set{\isacharunderscore}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}key{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ S{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}set\isactrlsub S\ e\ S{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}x\ {\isasymin}\ S{\isachardot}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}e\ x{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ sum{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}distinct{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ set{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ S{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}card\ S\ {\isasymle}\ m{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ a{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ S\ {\isasymLongrightarrow}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ a{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}set\isactrlsub S\ f\ S{\isacharparenright}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}real\ m{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}set\isactrlsub S\ f\ S{\isacharparenright}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}length\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ S{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ xs{\isacharequal}{\kern0pt}{\isachardoublequoteopen}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ S{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}real\ m{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ereal{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharplus}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=Encoding.tex%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%31=6%:%
%:%40=8%:%
%:%41=9%:%
%:%42=10%:%
%:%44=12%:%
%:%45=12%:%
%:%46=13%:%
%:%47=14%:%
%:%48=15%:%
%:%49=16%:%
%:%50=16%:%
%:%51=17%:%
%:%52=18%:%
%:%53=18%:%
%:%54=19%:%
%:%55=20%:%
%:%56=21%:%
%:%57=21%:%
%:%58=22%:%
%:%59=23%:%
%:%62=24%:%
%:%66=24%:%
%:%67=24%:%
%:%68=25%:%
%:%69=25%:%
%:%70=25%:%
%:%75=25%:%
%:%78=26%:%
%:%79=27%:%
%:%80=27%:%
%:%81=28%:%
%:%86=33%:%
%:%87=34%:%
%:%88=35%:%
%:%89=35%:%
%:%90=36%:%
%:%91=37%:%
%:%92=38%:%
%:%99=39%:%
%:%100=39%:%
%:%101=40%:%
%:%102=40%:%
%:%103=41%:%
%:%104=41%:%
%:%105=42%:%
%:%106=42%:%
%:%107=43%:%
%:%108=43%:%
%:%109=44%:%
%:%110=44%:%
%:%111=44%:%
%:%112=45%:%
%:%113=45%:%
%:%114=46%:%
%:%115=46%:%
%:%116=47%:%
%:%117=47%:%
%:%118=47%:%
%:%119=48%:%
%:%120=48%:%
%:%121=49%:%
%:%122=49%:%
%:%123=49%:%
%:%124=50%:%
%:%125=50%:%
%:%126=51%:%
%:%127=51%:%
%:%128=51%:%
%:%129=51%:%
%:%130=52%:%
%:%131=52%:%
%:%132=53%:%
%:%133=53%:%
%:%134=54%:%
%:%135=54%:%
%:%136=54%:%
%:%137=55%:%
%:%138=55%:%
%:%139=56%:%
%:%140=56%:%
%:%141=56%:%
%:%142=57%:%
%:%143=57%:%
%:%144=58%:%
%:%145=58%:%
%:%146=58%:%
%:%147=59%:%
%:%148=59%:%
%:%149=60%:%
%:%150=60%:%
%:%151=60%:%
%:%152=61%:%
%:%158=61%:%
%:%161=62%:%
%:%162=63%:%
%:%163=63%:%
%:%164=64%:%
%:%165=65%:%
%:%166=66%:%
%:%169=67%:%
%:%173=67%:%
%:%174=67%:%
%:%175=67%:%
%:%180=67%:%
%:%183=68%:%
%:%184=69%:%
%:%185=69%:%
%:%186=70%:%
%:%193=71%:%
%:%194=71%:%
%:%195=72%:%
%:%196=72%:%
%:%197=73%:%
%:%198=73%:%
%:%199=73%:%
%:%200=73%:%
%:%201=74%:%
%:%202=74%:%
%:%203=74%:%
%:%204=74%:%
%:%205=75%:%
%:%206=75%:%
%:%207=75%:%
%:%208=75%:%
%:%209=76%:%
%:%210=76%:%
%:%211=77%:%
%:%212=77%:%
%:%213=78%:%
%:%214=78%:%
%:%215=78%:%
%:%216=78%:%
%:%217=79%:%
%:%223=79%:%
%:%226=80%:%
%:%227=81%:%
%:%228=81%:%
%:%229=82%:%
%:%230=83%:%
%:%233=84%:%
%:%237=84%:%
%:%238=84%:%
%:%239=85%:%
%:%240=85%:%
%:%245=85%:%
%:%248=86%:%
%:%249=87%:%
%:%250=87%:%
%:%251=88%:%
%:%252=89%:%
%:%259=90%:%
%:%260=90%:%
%:%261=91%:%
%:%262=91%:%
%:%263=92%:%
%:%264=92%:%
%:%265=93%:%
%:%266=93%:%
%:%267=94%:%
%:%268=94%:%
%:%269=95%:%
%:%270=95%:%
%:%271=95%:%
%:%272=96%:%
%:%273=96%:%
%:%274=97%:%
%:%275=97%:%
%:%276=98%:%
%:%277=98%:%
%:%278=98%:%
%:%279=98%:%
%:%280=99%:%
%:%281=99%:%
%:%282=100%:%
%:%283=100%:%
%:%284=100%:%
%:%285=100%:%
%:%286=101%:%
%:%287=101%:%
%:%288=101%:%
%:%289=101%:%
%:%290=101%:%
%:%291=102%:%
%:%292=102%:%
%:%293=103%:%
%:%294=103%:%
%:%295=103%:%
%:%296=103%:%
%:%297=104%:%
%:%298=104%:%
%:%299=104%:%
%:%300=104%:%
%:%301=105%:%
%:%302=105%:%
%:%303=106%:%
%:%304=106%:%
%:%305=106%:%
%:%306=107%:%
%:%312=107%:%
%:%315=108%:%
%:%316=109%:%
%:%317=109%:%
%:%318=110%:%
%:%319=111%:%
%:%320=112%:%
%:%321=113%:%
%:%322=113%:%
%:%323=114%:%
%:%324=115%:%
%:%325=116%:%
%:%326=117%:%
%:%327=118%:%
%:%328=118%:%
%:%331=119%:%
%:%335=119%:%
%:%336=119%:%
%:%345=121%:%
%:%347=123%:%
%:%348=123%:%
%:%349=124%:%
%:%350=125%:%
%:%351=126%:%
%:%352=127%:%
%:%353=127%:%
%:%354=128%:%
%:%355=129%:%
%:%356=130%:%
%:%358=132%:%
%:%359=133%:%
%:%360=134%:%
%:%363=135%:%
%:%367=135%:%
%:%368=135%:%
%:%373=135%:%
%:%376=136%:%
%:%377=136%:%
%:%380=137%:%
%:%384=137%:%
%:%385=137%:%
%:%386=138%:%
%:%387=138%:%
%:%392=138%:%
%:%395=139%:%
%:%396=140%:%
%:%397=140%:%
%:%398=141%:%
%:%399=142%:%
%:%402=143%:%
%:%406=143%:%
%:%407=143%:%
%:%408=143%:%
%:%409=143%:%
%:%414=143%:%
%:%417=144%:%
%:%418=145%:%
%:%419=145%:%
%:%420=146%:%
%:%423=147%:%
%:%427=147%:%
%:%428=147%:%
%:%429=148%:%
%:%430=148%:%
%:%435=148%:%
%:%438=149%:%
%:%439=150%:%
%:%440=150%:%
%:%441=151%:%
%:%442=152%:%
%:%449=153%:%
%:%450=153%:%
%:%451=154%:%
%:%452=154%:%
%:%453=155%:%
%:%454=155%:%
%:%455=156%:%
%:%456=156%:%
%:%457=157%:%
%:%458=158%:%
%:%459=158%:%
%:%460=159%:%
%:%461=159%:%
%:%462=159%:%
%:%463=160%:%
%:%464=161%:%
%:%465=161%:%
%:%466=162%:%
%:%467=162%:%
%:%468=163%:%
%:%469=163%:%
%:%470=164%:%
%:%476=164%:%
%:%479=165%:%
%:%480=166%:%
%:%481=166%:%
%:%482=167%:%
%:%483=168%:%
%:%484=169%:%
%:%487=170%:%
%:%491=170%:%
%:%492=170%:%
%:%493=170%:%
%:%498=170%:%
%:%501=171%:%
%:%502=172%:%
%:%503=172%:%
%:%504=173%:%
%:%505=174%:%
%:%512=175%:%
%:%513=175%:%
%:%514=176%:%
%:%515=176%:%
%:%516=177%:%
%:%517=177%:%
%:%518=177%:%
%:%519=177%:%
%:%520=178%:%
%:%521=178%:%
%:%522=179%:%
%:%523=179%:%
%:%524=180%:%
%:%525=180%:%
%:%526=180%:%
%:%527=181%:%
%:%528=181%:%
%:%529=182%:%
%:%530=182%:%
%:%531=183%:%
%:%532=183%:%
%:%533=183%:%
%:%534=184%:%
%:%540=184%:%
%:%543=185%:%
%:%544=186%:%
%:%545=186%:%
%:%546=187%:%
%:%547=188%:%
%:%550=189%:%
%:%554=189%:%
%:%555=189%:%
%:%564=191%:%
%:%566=193%:%
%:%567=193%:%
%:%568=194%:%
%:%569=195%:%
%:%570=196%:%
%:%571=197%:%
%:%572=198%:%
%:%573=198%:%
%:%574=199%:%
%:%575=200%:%
%:%576=200%:%
%:%577=201%:%
%:%578=202%:%
%:%579=203%:%
%:%580=204%:%
%:%581=205%:%
%:%582=206%:%
%:%583=207%:%
%:%584=207%:%
%:%585=208%:%
%:%588=209%:%
%:%592=209%:%
%:%593=209%:%
%:%598=209%:%
%:%601=210%:%
%:%602=211%:%
%:%603=211%:%
%:%604=212%:%
%:%607=213%:%
%:%611=213%:%
%:%612=213%:%
%:%617=213%:%
%:%620=214%:%
%:%621=215%:%
%:%622=215%:%
%:%623=216%:%
%:%630=217%:%
%:%631=217%:%
%:%632=218%:%
%:%633=218%:%
%:%634=219%:%
%:%635=219%:%
%:%636=219%:%
%:%637=219%:%
%:%638=220%:%
%:%639=220%:%
%:%640=221%:%
%:%641=221%:%
%:%642=222%:%
%:%643=222%:%
%:%644=223%:%
%:%645=223%:%
%:%646=224%:%
%:%647=224%:%
%:%648=225%:%
%:%649=225%:%
%:%650=226%:%
%:%651=226%:%
%:%652=227%:%
%:%653=227%:%
%:%654=227%:%
%:%655=227%:%
%:%656=228%:%
%:%662=228%:%
%:%665=229%:%
%:%666=230%:%
%:%667=230%:%
%:%668=231%:%
%:%669=232%:%
%:%676=233%:%
%:%677=233%:%
%:%678=234%:%
%:%679=234%:%
%:%680=235%:%
%:%681=235%:%
%:%682=235%:%
%:%683=236%:%
%:%684=236%:%
%:%685=237%:%
%:%686=237%:%
%:%687=238%:%
%:%697=240%:%
%:%699=242%:%
%:%700=242%:%
%:%701=243%:%
%:%702=244%:%
%:%703=245%:%
%:%704=246%:%
%:%705=246%:%
%:%706=247%:%
%:%707=248%:%
%:%708=249%:%
%:%709=250%:%
%:%710=251%:%
%:%711=252%:%
%:%712=252%:%
%:%715=253%:%
%:%719=253%:%
%:%720=253%:%
%:%721=254%:%
%:%722=254%:%
%:%727=254%:%
%:%730=255%:%
%:%731=256%:%
%:%732=256%:%
%:%733=257%:%
%:%740=258%:%
%:%741=258%:%
%:%742=259%:%
%:%743=259%:%
%:%744=260%:%
%:%745=260%:%
%:%746=261%:%
%:%747=261%:%
%:%748=262%:%
%:%749=262%:%
%:%750=263%:%
%:%751=263%:%
%:%752=263%:%
%:%753=264%:%
%:%754=264%:%
%:%755=264%:%
%:%756=265%:%
%:%757=265%:%
%:%758=265%:%
%:%759=266%:%
%:%765=266%:%
%:%768=267%:%
%:%769=268%:%
%:%770=268%:%
%:%771=269%:%
%:%772=270%:%
%:%779=271%:%
%:%780=271%:%
%:%781=272%:%
%:%782=272%:%
%:%783=272%:%
%:%784=272%:%
%:%785=273%:%
%:%786=273%:%
%:%787=273%:%
%:%788=273%:%
%:%789=274%:%
%:%799=276%:%
%:%801=278%:%
%:%802=278%:%
%:%803=279%:%
%:%804=280%:%
%:%805=281%:%
%:%806=282%:%
%:%807=282%:%
%:%808=283%:%
%:%809=284%:%
%:%811=286%:%
%:%812=287%:%
%:%813=288%:%
%:%814=288%:%
%:%815=289%:%
%:%818=290%:%
%:%822=290%:%
%:%823=290%:%
%:%824=291%:%
%:%825=291%:%
%:%826=292%:%
%:%827=292%:%
%:%832=292%:%
%:%835=293%:%
%:%836=294%:%
%:%837=294%:%
%:%838=295%:%
%:%839=296%:%
%:%840=297%:%
%:%847=298%:%
%:%848=298%:%
%:%849=299%:%
%:%850=299%:%
%:%851=300%:%
%:%852=300%:%
%:%853=301%:%
%:%854=302%:%
%:%855=302%:%
%:%856=303%:%
%:%857=303%:%
%:%858=304%:%
%:%859=304%:%
%:%860=305%:%
%:%861=305%:%
%:%862=306%:%
%:%863=307%:%
%:%864=307%:%
%:%865=308%:%
%:%866=308%:%
%:%867=309%:%
%:%868=309%:%
%:%869=310%:%
%:%870=310%:%
%:%871=310%:%
%:%872=311%:%
%:%878=311%:%
%:%881=312%:%
%:%882=313%:%
%:%883=313%:%
%:%884=314%:%
%:%887=315%:%
%:%891=315%:%
%:%892=315%:%
%:%897=315%:%
%:%900=316%:%
%:%901=317%:%
%:%902=317%:%
%:%903=318%:%
%:%906=319%:%
%:%910=319%:%
%:%911=319%:%
%:%920=321%:%
%:%922=323%:%
%:%923=323%:%
%:%924=324%:%
%:%925=325%:%
%:%926=326%:%
%:%927=327%:%
%:%928=327%:%
%:%929=328%:%
%:%930=329%:%
%:%931=330%:%
%:%938=331%:%
%:%939=331%:%
%:%940=332%:%
%:%941=332%:%
%:%943=334%:%
%:%944=335%:%
%:%945=336%:%
%:%946=336%:%
%:%947=337%:%
%:%948=337%:%
%:%949=338%:%
%:%950=338%:%
%:%951=338%:%
%:%952=339%:%
%:%953=339%:%
%:%954=340%:%
%:%955=340%:%
%:%956=341%:%
%:%957=341%:%
%:%958=341%:%
%:%959=342%:%
%:%960=342%:%
%:%961=343%:%
%:%962=343%:%
%:%963=343%:%
%:%964=344%:%
%:%965=344%:%
%:%966=345%:%
%:%967=345%:%
%:%968=345%:%
%:%969=346%:%
%:%970=346%:%
%:%971=347%:%
%:%972=347%:%
%:%973=348%:%
%:%974=348%:%
%:%975=349%:%
%:%976=349%:%
%:%977=349%:%
%:%978=350%:%
%:%984=350%:%
%:%987=351%:%
%:%988=352%:%
%:%989=352%:%
%:%990=353%:%
%:%993=354%:%
%:%997=354%:%
%:%998=354%:%
%:%1007=356%:%
%:%1008=357%:%
%:%1010=359%:%
%:%1011=359%:%
%:%1012=360%:%
%:%1013=361%:%
%:%1014=362%:%
%:%1017=363%:%
%:%1021=363%:%
%:%1022=363%:%
%:%1023=363%:%
%:%1032=365%:%
%:%1034=367%:%
%:%1035=367%:%
%:%1036=368%:%
%:%1040=372%:%
%:%1041=373%:%
%:%1042=374%:%
%:%1043=374%:%
%:%1044=375%:%
%:%1045=376%:%
%:%1048=377%:%
%:%1052=377%:%
%:%1053=377%:%
%:%1054=378%:%
%:%1055=378%:%
%:%1056=379%:%
%:%1057=379%:%
%:%1058=380%:%
%:%1059=380%:%
%:%1060=381%:%
%:%1061=381%:%
%:%1062=381%:%
%:%1067=381%:%
%:%1070=382%:%
%:%1071=383%:%
%:%1072=383%:%
%:%1073=384%:%
%:%1074=385%:%
%:%1077=386%:%
%:%1081=386%:%
%:%1082=386%:%
%:%1083=387%:%
%:%1084=387%:%
%:%1093=389%:%
%:%1095=391%:%
%:%1096=391%:%
%:%1097=392%:%
%:%1098=393%:%
%:%1099=393%:%
%:%1100=394%:%
%:%1101=395%:%
%:%1104=396%:%
%:%1108=396%:%
%:%1109=396%:%
%:%1110=397%:%
%:%1111=397%:%
%:%1112=398%:%
%:%1113=398%:%
%:%1114=399%:%
%:%1115=399%:%
%:%1116=400%:%
%:%1117=400%:%
%:%1122=400%:%
%:%1125=401%:%
%:%1126=402%:%
%:%1127=402%:%
%:%1128=403%:%
%:%1129=404%:%
%:%1132=405%:%
%:%1136=405%:%
%:%1137=405%:%
%:%1138=406%:%
%:%1139=406%:%
%:%1144=406%:%
%:%1147=407%:%
%:%1148=408%:%
%:%1149=408%:%
%:%1150=409%:%
%:%1151=410%:%
%:%1152=411%:%
%:%1153=412%:%
%:%1154=413%:%
%:%1161=414%:%
%:%1162=414%:%
%:%1163=415%:%
%:%1164=415%:%
%:%1165=416%:%
%:%1166=416%:%
%:%1167=416%:%
%:%1168=417%:%
%:%1169=417%:%
%:%1170=417%:%
%:%1171=418%:%
%:%1172=418%:%
%:%1173=419%:%
%:%1174=419%:%
%:%1175=420%:%
%:%1176=420%:%
%:%1177=420%:%
%:%1178=421%:%
%:%1179=421%:%
%:%1180=421%:%
%:%1181=421%:%
%:%1182=422%:%
%:%1188=422%:%
%:%1193=423%:%
%:%1198=424%:%
