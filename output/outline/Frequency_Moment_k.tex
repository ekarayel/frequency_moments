%
\begin{isabellebody}%
\setisabellecontext{Frequency{\isacharunderscore}{\kern0pt}Moment{\isacharunderscore}{\kern0pt}k}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Frequency Moment $k$%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Frequency{\isacharunderscore}{\kern0pt}Moment{\isacharunderscore}{\kern0pt}k\isanewline
\ \ \isakeyword{imports}\ Main\ Median\ Product{\isacharunderscore}{\kern0pt}PMF{\isacharunderscore}{\kern0pt}Ext\ Lp{\isachardot}{\kern0pt}Lp\ List{\isacharunderscore}{\kern0pt}Ext\ Encoding\ Frequency{\isacharunderscore}{\kern0pt}Moments\ Landau{\isacharunderscore}{\kern0pt}Ext\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
This section contains a formalization of the algorithm for the $k$-th frequency moment.
It is based on the algorithm described in \cite[\textsection 2.1]{alon1999}.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{type{\isacharunderscore}{\kern0pt}synonym}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}state\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}init\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ rat\ {\isasymRightarrow}\ rat\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ fk{\isacharunderscore}{\kern0pt}state\ pmf{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}fk{\isacharunderscore}{\kern0pt}init\ k\ {\isasymdelta}\ {\isasymepsilon}\ n\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{3}}{\isacharasterisk}{\kern0pt}real\ k{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ n{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ let\ s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ {\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}update\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ fk{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ fk{\isacharunderscore}{\kern0pt}state\ pmf{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}fk{\isacharunderscore}{\kern0pt}update\ a\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ \ \ coins\ {\isasymleftarrow}\ prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ bernoulli{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ m{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ m{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ if\ coins\ i\ then\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ else\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ let\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}l{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ r\ i\ in\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ l\ {\isacharplus}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}x{\isacharequal}{\kern0pt}a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}result\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fk{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ rat\ pmf{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}fk{\isacharunderscore}{\kern0pt}result\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}median\ s\isactrlsub {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i\isactrlsub {\isadigit{2}}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymSum}i\isactrlsub {\isadigit{1}}{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isachardot}{\kern0pt}\ rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ {\isacharparenleft}{\kern0pt}let\ t\ {\isacharequal}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}r\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ i\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ in\ m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}t{\isacharcircum}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}t\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ nat{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ nat{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ pmf{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}\ a\ s\isactrlsub {\isadigit{1}}\ s\isactrlsub {\isadigit{2}}\ m\ r\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ \ \ coins\ {\isasymleftarrow}\ prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ bernoulli{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ m{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ if\ coins\ i\ then\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ else\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ let\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}l{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ r\ i\ in\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ l\ {\isacharplus}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}x{\isacharequal}{\kern0pt}a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ nat{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ nat{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ pmf{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ a\ m\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}l{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ do\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ \ \ coin\ {\isasymleftarrow}\ bernoulli{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ m{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ if\ coin\ then\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ else\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ l\ {\isacharplus}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}x{\isacharequal}{\kern0pt}a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ bernoulli{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bernoulli{\isacharunderscore}{\kern0pt}pmf\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ True{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ pmf{\isacharunderscore}{\kern0pt}eqI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}indicator{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}space{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymSum}a{\isasymin}{\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isacharparenleft}{\kern0pt}snd\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ {\isacharparenleft}{\kern0pt}{\isasymSum}u\ {\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}v\ {\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}lhs\ {\isacharequal}{\kern0pt}\ {\isacharquery}{\kern0pt}rhs{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ A\ \isakeyword{where}\ {\isachardoublequoteopen}A\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}u{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}u{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}v{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a\ {\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymAnd}u\ v{\isachardot}{\kern0pt}\ u\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ v\ {\isasymLongrightarrow}\ v\ {\isasymin}\ set\ as{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ count{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}lhs\ {\isacharequal}{\kern0pt}\ sum\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\ snd{\isacharparenright}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ {\isacharparenleft}{\kern0pt}A\ {\isacharbackquote}{\kern0pt}\ set\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ rule\ order{\isacharunderscore}{\kern0pt}antisym{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}A{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}\ mem{\isacharunderscore}{\kern0pt}Times{\isacharunderscore}{\kern0pt}iff\ a{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}A{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}\ mem{\isacharunderscore}{\kern0pt}Times{\isacharunderscore}{\kern0pt}iff\ a{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ sum\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ sum\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\ snd{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}UNION{\isacharunderscore}{\kern0pt}disjoint{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}A{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}A{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharquery}{\kern0pt}rhs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isachardot}{\kern0pt}reindex{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}A{\isacharunderscore}{\kern0pt}def\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}A{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ lessThan{\isacharunderscore}{\kern0pt}atLeast{\isadigit{0}}\ \isacommand{apply}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}as\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ fin{\isacharunderscore}{\kern0pt}space{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ non{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}space{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ card{\isacharunderscore}{\kern0pt}space{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ length\ as{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}\ {\isasymsubseteq}\ set\ as\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ length\ as{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta\ mem{\isacharunderscore}{\kern0pt}Times{\isacharunderscore}{\kern0pt}iff\ count{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ count{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}length\ order{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}trans{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ fin{\isacharunderscore}{\kern0pt}space{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ \ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}subset\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ {\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ count{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ gr{\isadigit{0}}I\ length{\isacharunderscore}{\kern0pt}greater{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}conv\ not{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}zero\ nth{\isacharunderscore}{\kern0pt}mem{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ length\ as{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ fin{\isacharunderscore}{\kern0pt}space\ split{\isacharunderscore}{\kern0pt}space{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ as{\isacharequal}{\kern0pt}{\isachardoublequoteopen}as{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}sum{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}set{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X{\isacharequal}{\kern0pt}{\isachardoublequoteopen}set\ as{\isachardoublequoteclose}\ \isakeyword{and}\ xs{\isacharequal}{\kern0pt}{\isachardoublequoteopen}as{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}{\isadigit{5}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}as\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ length\ as{\isacharbraceright}{\kern0pt}\ {\isasymbind}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}k{\isachardot}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}k{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isacharequal}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f\ \isakeyword{where}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}k{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}k{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ y\ {\isacharless}{\kern0pt}\ length\ as\ {\isasymLongrightarrow}\ x\ {\isacharless}{\kern0pt}\ y\ {\isasymLongrightarrow}\ as\ {\isacharbang}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ as\ {\isacharbang}{\kern0pt}\ y\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}Suc\ x{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}Suc\ y{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharunderscore}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharunderscore}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharquery}{\kern0pt}ths\ x\ y{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ y\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isadigit{3}}{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isacharless}{\kern0pt}\ length\ as{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isadigit{3}}{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharless}{\kern0pt}\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isadigit{3}}{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}as\ {\isacharbang}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ as\ {\isacharbang}{\kern0pt}\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{3}}{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}drop\ {\isacharparenleft}{\kern0pt}Suc\ x{\isacharparenright}{\kern0pt}\ as\ {\isacharequal}{\kern0pt}\ take\ {\isacharparenleft}{\kern0pt}y{\isacharminus}{\kern0pt}x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}Suc\ x{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharat}{\kern0pt}\ drop\ {\isacharparenleft}{\kern0pt}Suc\ y{\isacharparenright}{\kern0pt}\ as{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ append{\isacharunderscore}{\kern0pt}take{\isacharunderscore}{\kern0pt}drop{\isacharunderscore}{\kern0pt}id{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ xs{\isacharequal}{\kern0pt}{\isachardoublequoteopen}drop\ {\isacharparenleft}{\kern0pt}Suc\ x{\isacharparenright}{\kern0pt}\ as{\isachardoublequoteclose}\ \isakeyword{and}\ n{\isacharequal}{\kern0pt}{\isachardoublequoteopen}y\ {\isacharminus}{\kern0pt}\ x{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isadigit{3}}{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}Suc\ x{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}take\ {\isacharparenleft}{\kern0pt}y{\isacharminus}{\kern0pt}x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}Suc\ x{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}Suc\ y{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isadigit{3}}{\isacharunderscore}{\kern0pt}{\isadigit{3}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ a{\isadigit{3}}{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}count{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}append{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}take\ {\isacharparenleft}{\kern0pt}y{\isacharminus}{\kern0pt}x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}Suc\ x{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ count{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}set{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}nth{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ exI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ x{\isacharequal}{\kern0pt}{\isachardoublequoteopen}y{\isacharminus}{\kern0pt}x{\isacharminus}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ nth{\isacharunderscore}{\kern0pt}take{\isacharcomma}{\kern0pt}\ meson\ diff{\isacharunderscore}{\kern0pt}less\ a{\isadigit{3}}{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ \ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}diff\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}one{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ nth{\isacharunderscore}{\kern0pt}drop{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ a{\isadigit{3}}{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ a{\isadigit{3}}{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ conjI{\isacharcomma}{\kern0pt}\ rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharbang}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isadigit{3}}{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ conjI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isadigit{3}}{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ a{\isadigit{3}}{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ diff{\isacharunderscore}{\kern0pt}less\ a{\isadigit{3}}{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ \ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}diff\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}one{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}ths\ x\ y{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ f\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ length\ as{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inj{\isacharunderscore}{\kern0pt}onI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ y\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ length\ as{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ length\ as{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ x\ {\isacharequal}{\kern0pt}\ f\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}x\ {\isacharless}{\kern0pt}\ y{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}f{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ metis\ a{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}y\ {\isacharless}{\kern0pt}\ x{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}f{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ metis\ a{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{2}}{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ {\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isacharless}{\kern0pt}\ length\ as\ {\isasymLongrightarrow}\ count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}Suc\ x{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}x\ {\isacharless}{\kern0pt}\ length\ as{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}\ {\isasymle}\ count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}take\ {\isacharparenleft}{\kern0pt}Suc\ x{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ count{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ a\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ take{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}nth{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}Suc\ x{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}take\ {\isacharparenleft}{\kern0pt}Suc\ x{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}Suc\ x{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}count{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}append{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}Suc\ x{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharbackquote}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ length\ as{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ card{\isacharunderscore}{\kern0pt}seteq{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fin{\isacharunderscore}{\kern0pt}space{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ image{\isacharunderscore}{\kern0pt}subsetI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}f{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ a{\isadigit{2}}{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ card{\isacharunderscore}{\kern0pt}image{\isacharbrackleft}{\kern0pt}OF\ a{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ card{\isacharunderscore}{\kern0pt}space{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bij{\isacharunderscore}{\kern0pt}betw\ f\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ length\ as{\isacharbraceright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isadigit{1}}\ a{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ map{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ map{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}bij{\isacharunderscore}{\kern0pt}betw{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}f{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ blast{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}as\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ {\isacharparenleft}{\kern0pt}c{\isacharcomma}{\kern0pt}state{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}c{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ state\ {\isasymbind}\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ x\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ {\isacharparenleft}{\kern0pt}length\ as{\isacharcomma}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ length\ as{\isacharbraceright}{\kern0pt}\ {\isasymbind}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}k{\isachardot}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}k{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}as\ {\isacharbang}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ as\ rule{\isacharcolon}{\kern0pt}rev{\isacharunderscore}{\kern0pt}nonempty{\isacharunderscore}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}single\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}bernoulli{\isacharunderscore}{\kern0pt}pmf\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ True{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ pmf{\isacharunderscore}{\kern0pt}eqI{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}indicator{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ single\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}bind{\isacharunderscore}{\kern0pt}return{\isacharunderscore}{\kern0pt}pmf\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}singleton\ a{\isacharparenright}{\kern0pt}\ \isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}snoc\ x\ xs{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ c{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ x\ c\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a{\isachardot}{\kern0pt}\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ x\ c\ {\isacharparenleft}{\kern0pt}fst\ a{\isacharcomma}{\kern0pt}snd\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}y{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ length\ xs{\isacharbraceright}{\kern0pt}\ {\isasymbind}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}k{\isachardot}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}xs\ {\isacharbang}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}Suc\ k{\isacharparenright}{\kern0pt}\ xs{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}xs\ {\isacharbang}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymbind}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}xa{\isachardot}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}if\ y\ then\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}fst\ xa{\isacharcomma}{\kern0pt}\ snd\ xa\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}bool\ {\isacharparenleft}{\kern0pt}fst\ xa\ {\isacharequal}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharequal}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbraceleft}{\kern0pt}k{\isachardot}{\kern0pt}\ k\ {\isacharless}{\kern0pt}\ length\ xs{\isacharbraceright}{\kern0pt}\ {\isasymbind}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}k{\isachardot}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}if\ y\ then\ {\isacharparenleft}{\kern0pt}length\ xs{\isacharparenright}{\kern0pt}\ else\ k{\isacharparenright}{\kern0pt}\ {\isasymbind}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}k{\isachardot}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}xs{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbang}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}drop\ {\isacharparenleft}{\kern0pt}Suc\ k{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}xs{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}xs{\isacharat}{\kern0pt}{\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbang}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}bind{\isacharunderscore}{\kern0pt}return{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ bind{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ snoc\ \isacommand{apply}\isamarkupfalse%
\ blast\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}nth{\isacharunderscore}{\kern0pt}append\ count{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}append{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ snoc\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ del{\isacharcolon}{\kern0pt}drop{\isacharunderscore}{\kern0pt}append{\isacharcomma}{\kern0pt}\ subst\ c{\isacharcomma}{\kern0pt}\ subst\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}commute{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}assoc{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}a\ del{\isacharcolon}{\kern0pt}drop{\isacharunderscore}{\kern0pt}append{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}assoc{\isacharunderscore}{\kern0pt}pmf{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}assoc{\isacharunderscore}{\kern0pt}pmf{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}bind{\isacharunderscore}{\kern0pt}pmf{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ pmf{\isacharunderscore}{\kern0pt}eqI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ pmf{\isacharunderscore}{\kern0pt}bind{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharcomma}{\kern0pt}\ blast{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ pmf{\isacharunderscore}{\kern0pt}bind{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharcomma}{\kern0pt}\ blast{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}indicator{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ frac{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ linarith{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ if{\isacharunderscore}{\kern0pt}then{\isacharunderscore}{\kern0pt}else\ \isakeyword{where}\ {\isachardoublequoteopen}if{\isacharunderscore}{\kern0pt}then{\isacharunderscore}{\kern0pt}else\ p\ q\ r\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ p\ then\ q\ else\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
This definition is introduced to be able to temporarily substitute \isa{if\ p\ then\ q\ else\ r}
with \isa{if{\isacharunderscore}{\kern0pt}then{\isacharunderscore}{\kern0pt}else\ p\ q\ r}, which unblocks the simplifier to process \isa{q} and \isa{r}.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ {\isacharparenleft}{\kern0pt}c{\isacharcomma}{\kern0pt}\ state{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}c{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ state\ {\isasymbind}\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}\ x\ s\isactrlsub {\isadigit{1}}\ s\isactrlsub {\isadigit{2}}\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}length\ as{\isacharcomma}{\kern0pt}\ prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ {\isacharparenleft}{\kern0pt}c{\isacharcomma}{\kern0pt}state{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}c{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ state\ {\isasymbind}\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ x\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}lhs\ {\isacharequal}{\kern0pt}\ {\isacharquery}{\kern0pt}rhs{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ as\ rule{\isacharcolon}{\kern0pt}rev{\isacharunderscore}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ rule\ pmf{\isacharunderscore}{\kern0pt}eqI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ conjI{\isacharcomma}{\kern0pt}\ rule\ impI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}indicator{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ rule\ conjI{\isacharcomma}{\kern0pt}\ rule\ impI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ extensional{\isacharunderscore}{\kern0pt}arb\ \isacommand{apply}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}extensional{\isacharunderscore}{\kern0pt}def\ indicator{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ SigmaD{\isadigit{1}}\ SigmaD{\isadigit{2}}\ atLeastLessThan{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}snoc\ x\ xs{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ t{\isadigit{1}}\ t{\isadigit{2}}\ \isakeyword{where}\ t{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}t{\isadigit{1}}{\isacharcomma}{\kern0pt}t{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ {\isacharparenleft}{\kern0pt}c{\isacharcomma}{\kern0pt}\ state{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ c{\isacharcomma}{\kern0pt}\ state\ {\isasymbind}\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ x\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ xs\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ surj{\isacharunderscore}{\kern0pt}pair\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}\ x\ s\isactrlsub {\isadigit{1}}\ s\isactrlsub {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}length\ xs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a{\isachardot}{\kern0pt}\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}\ x\ s\isactrlsub {\isadigit{1}}\ s\isactrlsub {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}length\ xs{\isacharparenright}{\kern0pt}\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ c{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ x\ c\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a{\isachardot}{\kern0pt}\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ x\ c\ {\isacharparenleft}{\kern0pt}fst\ a{\isacharcomma}{\kern0pt}snd\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}fst\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ {\isacharparenleft}{\kern0pt}c{\isacharcomma}{\kern0pt}\ state{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ c{\isacharcomma}{\kern0pt}\ state\ {\isasymbind}\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ x\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ xs\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ length\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ xs\ rule{\isacharcolon}{\kern0pt}rev{\isacharunderscore}{\kern0pt}induct{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ d{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}t{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ length\ xs{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ t{\isacharunderscore}{\kern0pt}def\ fst{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ snoc\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ del{\isacharcolon}{\kern0pt}fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}simps\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}t{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ a{\isacharbrackleft}{\kern0pt}simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ pair{\isacharunderscore}{\kern0pt}pmfI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ pair{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}ptw{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}assoc{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}return{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ if{\isacharunderscore}{\kern0pt}then{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}comp{\isacharunderscore}{\kern0pt}def\ cong{\isacharcolon}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ map{\isacharunderscore}{\kern0pt}ptw{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ if{\isacharunderscore}{\kern0pt}then{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}prod{\isacharunderscore}{\kern0pt}pmf{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ c{\isacharcomma}{\kern0pt}\ subst\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}simps{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}d{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ pair{\isacharunderscore}{\kern0pt}pmfI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}bind{\isacharunderscore}{\kern0pt}pmf{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ k\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\ \ \isakeyword{fixes}\ {\isasymepsilon}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymdelta}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ as\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}as\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}sketch\ {\isasymequiv}\ fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ fk{\isacharunderscore}{\kern0pt}update\ a{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}fk{\isacharunderscore}{\kern0pt}init\ k\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isasymequiv}\ nat\ {\isasymlceil}{\isadigit{3}}{\isacharasterisk}{\kern0pt}real\ k{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ n{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isasymequiv}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sketch\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ map{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}k{\isacharcomma}{\kern0pt}length\ as{\isacharcomma}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ {\isacharparenleft}{\kern0pt}c{\isacharcomma}{\kern0pt}\ state{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}c{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ state\ {\isasymbind}\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}\ x\ s\isactrlsub {\isadigit{1}}\ s\isactrlsub {\isadigit{2}}\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sketch{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ induction\ as\ rule{\isacharcolon}{\kern0pt}rev{\isacharunderscore}{\kern0pt}nonempty{\isacharunderscore}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}single\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}bind{\isacharunderscore}{\kern0pt}pmf\ bind{\isacharunderscore}{\kern0pt}return{\isacharunderscore}{\kern0pt}pmf\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}bind{\isacharunderscore}{\kern0pt}pmf{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharcomma}{\kern0pt}\ subst\ restrict{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}snoc\ x\ xs{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ t{\isadigit{1}}\ t{\isadigit{2}}\ \isakeyword{where}\ t{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ {\isacharparenleft}{\kern0pt}c{\isacharcomma}{\kern0pt}\ state{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ c{\isacharcomma}{\kern0pt}\ state\ {\isasymbind}\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}\ x\ s\isactrlsub {\isadigit{1}}\ s\isactrlsub {\isadigit{2}}\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ xs\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ if\ i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}\ then\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ else\ undefined{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}t{\isadigit{1}}{\isacharcomma}{\kern0pt}t{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}fst\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ {\isacharparenleft}{\kern0pt}c{\isacharcomma}{\kern0pt}\ state{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ c{\isacharcomma}{\kern0pt}\ state\ {\isasymbind}\ fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}\ x\ s\isactrlsub {\isadigit{1}}\ s\isactrlsub {\isadigit{2}}\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ xs\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ if\ i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}\ then\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ else\ undefined{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharequal}{\kern0pt}\ length\ xs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ xs\ rule{\isacharcolon}{\kern0pt}rev{\isacharunderscore}{\kern0pt}induct{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}split{\isacharunderscore}{\kern0pt}beta{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ t{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}t{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ length\ xs{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ t\ fst{\isacharunderscore}{\kern0pt}conv\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ snoc\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ \ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ t\ del{\isacharcolon}{\kern0pt}fk{\isacharunderscore}{\kern0pt}update{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}simps\ fk{\isacharunderscore}{\kern0pt}update{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ map{\isacharunderscore}{\kern0pt}bind{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ map{\isacharunderscore}{\kern0pt}bind{\isacharunderscore}{\kern0pt}pmf{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}t{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}sum{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}comm{\isacharunderscore}{\kern0pt}ring{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}power{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}k\ {\isacharminus}{\kern0pt}b{\isacharcircum}{\kern0pt}k\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharminus}{\kern0pt}b{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ sum\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ a{\isacharcircum}{\kern0pt}i\ {\isacharasterisk}{\kern0pt}\ b{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}k{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}lhs\ {\isacharequal}{\kern0pt}\ {\isacharquery}{\kern0pt}rhs{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}rhs\ {\isacharequal}{\kern0pt}\ sum\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ a\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcircum}{\kern0pt}i\ {\isacharasterisk}{\kern0pt}\ b{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}k{\isacharbraceright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ sum\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcircum}{\kern0pt}i\ {\isacharasterisk}{\kern0pt}\ b{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}k{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ sum\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcircum}{\kern0pt}i\ {\isacharasterisk}{\kern0pt}\ b{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymcirc}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ i{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}k{\isacharbraceright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ sum\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcircum}{\kern0pt}i\ {\isacharasterisk}{\kern0pt}\ b{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}k{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ mult{\isachardot}{\kern0pt}assoc{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ subst\ mult{\isachardot}{\kern0pt}commute{\isacharcomma}{\kern0pt}\ subst\ mult{\isachardot}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ power{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ sum\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcircum}{\kern0pt}i\ {\isacharasterisk}{\kern0pt}\ b{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}insert\ k\ {\isacharbraceleft}{\kern0pt}{\isadigit{1}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}k{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ sum\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcircum}{\kern0pt}i\ {\isacharasterisk}{\kern0pt}\ b{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}insert\ {\isadigit{0}}\ {\isacharbraceleft}{\kern0pt}{\isadigit{1}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}k{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isachardot}{\kern0pt}reindex{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}atLeastLessThanSuc{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ assms\ Icc{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}insert{\isacharunderscore}{\kern0pt}lb{\isacharunderscore}{\kern0pt}nat\ \isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ One{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}def\ Suc{\isacharunderscore}{\kern0pt}pred\ atLeastLessThanSuc{\isacharunderscore}{\kern0pt}atLeastAtMost\ le{\isacharunderscore}{\kern0pt}add{\isadigit{1}}\ le{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}same{\isacharunderscore}{\kern0pt}cancel{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharquery}{\kern0pt}lhs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ power{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}est{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ real{\isacharparenright}{\kern0pt}\ {\isasymge}\ b{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}b\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}a{\isacharcircum}{\kern0pt}k\ {\isacharminus}{\kern0pt}b{\isacharcircum}{\kern0pt}k\ {\isasymle}\ {\isacharparenleft}{\kern0pt}a{\isacharminus}{\kern0pt}b{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ k\ {\isacharasterisk}{\kern0pt}\ a{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ {\isasymAnd}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ k\ {\isasymLongrightarrow}\ a\ {\isacharcircum}{\kern0pt}\ i\ {\isacharasterisk}{\kern0pt}\ b\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharminus}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isasymle}\ a\ {\isacharcircum}{\kern0pt}\ i\ {\isacharasterisk}{\kern0pt}\ a\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ power{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ k\ {\isasymLongrightarrow}\ a\ {\isacharcircum}{\kern0pt}\ i\ {\isacharasterisk}{\kern0pt}\ a\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharminus}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ power{\isacharunderscore}{\kern0pt}add{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}power{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ t{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ k\ {\isasymLongrightarrow}\ a\ {\isacharcircum}{\kern0pt}\ i\ {\isacharasterisk}{\kern0pt}\ b\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharminus}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isasymle}\ a\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a{\isacharcircum}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ b{\isacharcircum}{\kern0pt}k\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharminus}{\kern0pt}b{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ sum\ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ a{\isacharcircum}{\kern0pt}i\ {\isacharasterisk}{\kern0pt}\ b{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}k{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ power{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}sum{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}a{\isacharminus}{\kern0pt}b{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ k\ {\isacharasterisk}{\kern0pt}\ a{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ mult{\isachardot}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ a{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ K{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}k{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ t{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Specialization of the Hoelder inquality for sums.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ Holder{\isacharunderscore}{\kern0pt}inequality{\isacharunderscore}{\kern0pt}sum{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}real{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}q\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{1}}{\isacharslash}{\kern0pt}p\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharslash}{\kern0pt}q\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymbar}sum\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ f\ x\ {\isacharasterisk}{\kern0pt}\ g\ x{\isacharparenright}{\kern0pt}\ A{\isasymbar}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}sum\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isasymbar}f\ x{\isasymbar}\ powr\ p{\isacharparenright}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}p{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sum\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isasymbar}g\ x{\isasymbar}\ powr\ q{\isacharparenright}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}q{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ lebesgue{\isacharunderscore}{\kern0pt}integral{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ Lp{\isachardot}{\kern0pt}Holder{\isacharunderscore}{\kern0pt}inequality{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}integrable{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}space{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}estimate{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}as\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ as\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isasymge}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}real\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isasymle}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}lhs\ {\isasymle}\ {\isacharquery}{\kern0pt}rhs{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}k\ {\isasymge}\ {\isadigit{2}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ M\ \isakeyword{where}\ {\isachardoublequoteopen}M\ {\isacharequal}{\kern0pt}\ Max\ {\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ as\ {\isacharbackquote}{\kern0pt}\ set\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ m\ \isakeyword{where}\ m{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}m\ {\isasymin}\ set\ as{\isachardoublequoteclose}\ \isakeyword{and}\ m{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}M\ {\isacharequal}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ m{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ List{\isachardot}{\kern0pt}finite{\isacharunderscore}{\kern0pt}set\ Max{\isacharunderscore}{\kern0pt}in\ finite{\isacharunderscore}{\kern0pt}imageI\ image{\isacharunderscore}{\kern0pt}iff\ image{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}empty\ set{\isacharunderscore}{\kern0pt}empty\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}real\ M\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}M{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ opaque{\isacharunderscore}{\kern0pt}lifting{\isacharparenright}{\kern0pt}\ List{\isachardot}{\kern0pt}finite{\isacharunderscore}{\kern0pt}set\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ Max{\isacharunderscore}{\kern0pt}in\ bot{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}not{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}extremum\ count{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ finite{\isacharunderscore}{\kern0pt}imageI\ imageE\ image{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}empty\ linorder{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}less\ set{\isacharunderscore}{\kern0pt}empty\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}one{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{2}}{\isacharasterisk}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ k{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ k\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}M\ powr\ k\ {\isasymle}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}m{\isacharunderscore}{\kern0pt}def\ F{\isacharunderscore}{\kern0pt}def\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ powr{\isacharunderscore}{\kern0pt}realpow{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ m{\isacharunderscore}{\kern0pt}in\ \ count{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ \isacommand{apply}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ member{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}sum{\isacharcomma}{\kern0pt}\ metis\ m{\isacharunderscore}{\kern0pt}in{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{5}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ F{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ order{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}less{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ a{\isadigit{6}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}\ powr\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}real\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ real\ k\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ real\ k\ {\isacharplus}{\kern0pt}\ real\ k\ {\isacharslash}{\kern0pt}\ real\ k{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ True\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ real\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ k\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ real\ k{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ add{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}distrib{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharslash}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}diff{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ True\ \isacommand{apply}\isamarkupfalse%
\ linarith\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}diff{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ True\ \isacommand{apply}\isamarkupfalse%
\ linarith\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp{\isacharplus}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ a{\isadigit{7}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}real\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ real\ k\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ k\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ real\ k{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isasymle}\ M\ powr\ {\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a{\isadigit{1}}\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}F{\isacharunderscore}{\kern0pt}def\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult\ power{\isacharunderscore}{\kern0pt}add\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ powr{\isacharunderscore}{\kern0pt}realpow{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ a{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ power{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}M{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ \ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}k{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ a{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ powr{\isacharunderscore}{\kern0pt}powr{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ powr{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ metis\ a{\isadigit{3}}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ metis\ a{\isadigit{5}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ a{\isadigit{6}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ powr{\isacharunderscore}{\kern0pt}add{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}powr{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ metis\ a{\isadigit{7}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ b{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}set\ as{\isacharparenright}{\kern0pt}\ {\isasymle}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ card{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ B{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ rule\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}real\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ abs\ {\isacharparenleft}{\kern0pt}sum\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ as\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}sum{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}card\ {\isacharparenleft}{\kern0pt}set\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}k{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sum\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ abs\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ as\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ powr\ k{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ Holder{\isacharunderscore}{\kern0pt}inequality{\isacharunderscore}{\kern0pt}sum{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ p{\isacharequal}{\kern0pt}{\isachardoublequoteopen}k{\isacharslash}{\kern0pt}{\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ q{\isacharequal}{\kern0pt}{\isachardoublequoteopen}k{\isachardoublequoteclose}\ \isakeyword{and}\ A{\isacharequal}{\kern0pt}{\isachardoublequoteopen}set\ as{\isachardoublequoteclose}\ \isakeyword{and}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ True\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ True\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ add{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}distrib{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ True\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}real\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}diff{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ assms\ True\ \isacommand{apply}\isamarkupfalse%
\ linarith\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ diff{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}distrib{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ assms\ True\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ powr{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}{\isacharcomma}{\kern0pt}\ force{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ b{\isadigit{1}}\ \ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}iff\ \isacommand{apply}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ powr{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}F{\isacharunderscore}{\kern0pt}def\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ powr{\isacharunderscore}{\kern0pt}realpow{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ count{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ gr{\isadigit{0}}I\ not{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}zero{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}real\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isasymle}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}real\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ c{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k\ {\isacharplus}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ k\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ real\ k\ {\isacharequal}{\kern0pt}\ real\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ add{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}distrib{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}diff{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ True\ \isacommand{apply}\isamarkupfalse%
\ linarith\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ True\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}lhs\ {\isasymle}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}real\ k{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ metis\ b{\isacharcomma}{\kern0pt}\ metis\ a{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}F{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}rat{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isacharquery}{\kern0pt}rhs{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ mult{\isachardot}{\kern0pt}assoc{\isacharcomma}{\kern0pt}\ subst\ powr{\isacharunderscore}{\kern0pt}add{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ subst\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ c{\isacharcomma}{\kern0pt}\ subst\ powr{\isacharunderscore}{\kern0pt}realpow{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ F{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharplus}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}n\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}n{\isacharequal}{\kern0pt}{\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ equals{\isadigit{0}}I\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}k\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ False\ \isacommand{by}\isamarkupfalse%
\ linarith\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}F{\isacharunderscore}{\kern0pt}def\ sum{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}set\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}sum{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ del{\isacharcolon}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}sum{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ F{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ order{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}less\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}core{\isacharunderscore}{\kern0pt}exp{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}as\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isasymge}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}has{\isacharunderscore}{\kern0pt}bochner{\isacharunderscore}{\kern0pt}integral\ {\isacharparenleft}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}a{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}Suc\ {\isacharparenleft}{\kern0pt}snd\ a{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ k\ {\isacharminus}{\kern0pt}\ snd\ a\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ has{\isacharunderscore}{\kern0pt}bochner{\isacharunderscore}{\kern0pt}integral{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ conjI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharcomma}{\kern0pt}\ metis\ non{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}space\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ metis\ fin{\isacharunderscore}{\kern0pt}space\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ integral{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}real{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}space{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharbrackleft}{\kern0pt}OF\ non{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}space{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ fin{\isacharunderscore}{\kern0pt}space{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharbrackleft}{\kern0pt}OF\ non{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}space{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ fin{\isacharunderscore}{\kern0pt}space{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}card{\isacharunderscore}{\kern0pt}space\ F{\isacharunderscore}{\kern0pt}def\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ split{\isacharunderscore}{\kern0pt}space{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}diff{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ power{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}diff{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ linarith\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}core{\isacharunderscore}{\kern0pt}var{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}as\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isasymge}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ as\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isacharparenleft}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}a{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}Suc\ {\isacharparenleft}{\kern0pt}snd\ a{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ k\ {\isacharminus}{\kern0pt}\ snd\ a\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isasymle}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ k\ {\isacharasterisk}{\kern0pt}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeyword{where}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}Suc\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ k\ {\isacharminus}{\kern0pt}\ snd\ x\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymOmega}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymOmega}\ {\isacharequal}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ integrable{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}k\ f{\isachardot}{\kern0pt}\ integrable\ {\isacharparenleft}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isasymomega}{\isacharparenright}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}real{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ fin{\isacharunderscore}{\kern0pt}space\ non{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}space\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ k{\isacharunderscore}{\kern0pt}g{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}k\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ linarith\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ c{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymAnd}a\ v{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ a\ {\isasymLongrightarrow}\ real\ {\isacharparenleft}{\kern0pt}Suc\ v\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}v\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}\ {\isasymle}\ real\ k\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ as\ a{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ a\ v\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}real\ {\isacharparenleft}{\kern0pt}Suc\ v\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}v\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}v{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ real\ v{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ k\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ real\ v{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ k{\isacharunderscore}{\kern0pt}g{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ power{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}est{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}Suc\ v{\isachardoublequoteclose}\ \isakeyword{and}\ b{\isacharequal}{\kern0pt}{\isachardoublequoteopen}v{\isachardoublequoteclose}\ \isakeyword{and}\ k\ {\isacharequal}{\kern0pt}{\isachardoublequoteopen}k{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}v{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ real\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}real\ {\isacharparenleft}{\kern0pt}Suc\ v\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}v\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}\ {\isasymle}\ real\ k\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ real\ v{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k\ {\isacharminus}{\kern0pt}\ Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ real\ k\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ as\ a{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}\ Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ power{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ \isacommand{apply}\isamarkupfalse%
\ linarith\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}real\ {\isacharparenleft}{\kern0pt}Suc\ v\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}v\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}\ {\isasymle}\ real\ k\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}count{\isacharunderscore}{\kern0pt}list\ as\ a{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}\ Suc\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}real\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}a{\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}v\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ a{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}Suc\ v\ {\isacharcircum}{\kern0pt}\ k\ {\isacharminus}{\kern0pt}\ v\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymle}\ real\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}a{\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}v\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ a{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}k\ {\isacharasterisk}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ a\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ v\ {\isacharcircum}{\kern0pt}\ k\ {\isacharminus}{\kern0pt}\ v\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ sum{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}diff{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}power{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ c{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}a{\isasymin}\ set\ as{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}k\ {\isacharasterisk}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ a\ {\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}diff{\isacharcomma}{\kern0pt}\ rule\ power{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}diff{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ zero{\isacharunderscore}{\kern0pt}power{\isacharbrackleft}{\kern0pt}OF\ k{\isacharunderscore}{\kern0pt}g{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharbrackright}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ power{\isacharunderscore}{\kern0pt}add{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ k\ {\isacharasterisk}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharasterisk}{\kern0pt}k{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ mult{\isachardot}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ F{\isacharunderscore}{\kern0pt}def\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ real\ k\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ mult{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ mult{\isachardot}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}estimate{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mult{\isachardot}{\kern0pt}commute{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}real\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}a{\isasymin}\ set\ as{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}v\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ a{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}Suc\ v\ {\isacharcircum}{\kern0pt}\ k\ {\isacharminus}{\kern0pt}\ v\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymle}\ real\ k\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}measure{\isacharunderscore}{\kern0pt}pmf{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f\ {\isasymomega}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\ f{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isasymle}\ \isanewline
\ \ \ \ measure{\isacharunderscore}{\kern0pt}pmf{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f\ {\isasymomega}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ measure{\isacharunderscore}{\kern0pt}pmf{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f\ {\isasymomega}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ k\ {\isacharasterisk}{\kern0pt}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymOmega}{\isacharunderscore}{\kern0pt}def\ f{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ integral{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}real{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}space{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharbrackleft}{\kern0pt}OF\ non{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}space\ fin{\isacharunderscore}{\kern0pt}space{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharbrackleft}{\kern0pt}OF\ non{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}space\ fin{\isacharunderscore}{\kern0pt}space{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}card{\isacharunderscore}{\kern0pt}space{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ power{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}distrib{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ mult{\isachardot}{\kern0pt}commute{\isacharcomma}{\kern0pt}\ subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square{\isacharcomma}{\kern0pt}\ subst\ split{\isacharunderscore}{\kern0pt}space{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps\ sum{\isacharunderscore}{\kern0pt}distrib{\isacharunderscore}{\kern0pt}left{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}measure{\isacharunderscore}{\kern0pt}pmf{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f\ {\isasymomega}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isachardot}{\kern0pt}expectation\ {\isasymOmega}\ f{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}\ {\isasymle}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ k\ {\isacharasterisk}{\kern0pt}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ measure{\isacharunderscore}{\kern0pt}pmf{\isachardot}{\kern0pt}variance{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ metis\ integrable{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ metis\ integrable{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ a\ f{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}sketch{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ {\isasymepsilon}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isasymge}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymdelta}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ as\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}as\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}sketch\ {\isasymequiv}\ fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ fk{\isacharunderscore}{\kern0pt}update\ a{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}fk{\isacharunderscore}{\kern0pt}init\ k\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isasymequiv}\ nat\ {\isasymlceil}{\isadigit{3}}{\isacharasterisk}{\kern0pt}real\ k{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ n{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isasymequiv}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sketch\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}k{\isacharcomma}{\kern0pt}length\ as{\isacharcomma}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}sketch{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ k{\isacharequal}{\kern0pt}{\isachardoublequoteopen}k{\isachardoublequoteclose}\ \isakeyword{and}\ {\isasymepsilon}{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymepsilon}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}map{\isacharunderscore}{\kern0pt}pmf{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}{\isadigit{2}}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}simplified{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}aux{\isacharunderscore}{\kern0pt}{\isadigit{5}}{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}correct{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isasymge}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}{\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymdelta}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ as\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}M\ {\isasymequiv}\ fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ fk{\isacharunderscore}{\kern0pt}update\ a{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}fk{\isacharunderscore}{\kern0pt}init\ k\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}\ {\isasymbind}\ fk{\isacharunderscore}{\kern0pt}result{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymP}{\isacharparenleft}{\kern0pt}{\isasymomega}\ in\ measure{\isacharunderscore}{\kern0pt}pmf\ M{\isachardot}{\kern0pt}\ {\isasymbar}{\isasymomega}\ {\isacharminus}{\kern0pt}\ F\ k\ as{\isasymbar}\ {\isasymle}\ {\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ k\ as{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isadigit{1}}\ {\isacharminus}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}as\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymlceil}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ simp\ \isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ True\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}F{\isacharunderscore}{\kern0pt}def\ M{\isacharunderscore}{\kern0pt}def\ bind{\isacharunderscore}{\kern0pt}return{\isacharunderscore}{\kern0pt}pmf\ median{\isacharunderscore}{\kern0pt}const{\isacharbrackleft}{\kern0pt}OF\ a{\isacharbrackright}{\kern0pt}\ Let{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{1}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{3}}{\isacharasterisk}{\kern0pt}real\ k{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ n{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{2}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{where}\ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ median\ s\isactrlsub {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i\isactrlsub {\isadigit{2}}{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymSum}i\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ {\isacharparenleft}{\kern0pt}length\ as\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}x\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ i\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ k\ {\isacharminus}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}x\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ i\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\isanewline
\ \ \ \ \ \ \ rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f{\isadigit{2}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ real{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{where}\ {\isachardoublequoteopen}f{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ i\isactrlsub {\isadigit{1}}\ i\isactrlsub {\isadigit{2}}{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}length\ as\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}x\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ i\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ k\ {\isacharminus}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}x\ {\isacharparenleft}{\kern0pt}i\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ i\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f{\isadigit{1}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymRightarrow}\ real{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{where}\ {\isachardoublequoteopen}f{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ i\isactrlsub {\isadigit{2}}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ x\ i\isactrlsub {\isadigit{1}}\ i\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ f{\isacharprime}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{where}\ {\isachardoublequoteopen}f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ median\ s\isactrlsub {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}f{\isadigit{1}}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ as\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ False\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ n{\isacharunderscore}{\kern0pt}nonzero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}n\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}nonzero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}F\ k\ as\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ F{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ assms\ False\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ divide{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}pos{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}pos{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{apply}\isamarkupfalse%
\ linarith\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}n{\isacharunderscore}{\kern0pt}nonzero{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ assms\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}iff\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ s{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}f{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ f{\isacharprime}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ s{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isacharunderscore}{\kern0pt}def\ f{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ f{\isadigit{1}}{\isacharunderscore}{\kern0pt}def\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ median{\isacharunderscore}{\kern0pt}rat\ median{\isacharunderscore}{\kern0pt}restrict{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}median{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}divide\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymOmega}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymOmega}\ {\isacharequal}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fin{\isacharunderscore}{\kern0pt}omega{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}set{\isacharunderscore}{\kern0pt}pmf\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ subst\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ fin{\isacharunderscore}{\kern0pt}space\ non{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}space\ False\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}set{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ set{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ finite{\isacharunderscore}{\kern0pt}PiE{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}fin{\isacharunderscore}{\kern0pt}omega{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ fk{\isacharunderscore}{\kern0pt}update\ x{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}fk{\isacharunderscore}{\kern0pt}init\ k\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}k{\isacharcomma}{\kern0pt}length\ as{\isacharcomma}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}sketch{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ False{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}exp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fk{\isacharunderscore}{\kern0pt}result\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}y{\isacharcomma}{\kern0pt}z{\isacharcomma}{\kern0pt}u{\isacharcomma}{\kern0pt}v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ fk{\isacharunderscore}{\kern0pt}result\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}y{\isacharcomma}{\kern0pt}z{\isacharcomma}{\kern0pt}u{\isacharcomma}{\kern0pt}v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharcomma}{\kern0pt}\ fastforce{\isacharparenright}{\kern0pt}\ \isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}M\ {\isacharequal}{\kern0pt}\ prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymOmega}{\isacharparenright}{\kern0pt}\ {\isasymbind}\ return{\isacharunderscore}{\kern0pt}pmf\ {\isasymcirc}\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ M{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ a{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ fk{\isacharunderscore}{\kern0pt}result{\isacharunderscore}{\kern0pt}exp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}map{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}assoc{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ bind{\isacharunderscore}{\kern0pt}return{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isacharunderscore}{\kern0pt}def\ comp{\isacharunderscore}{\kern0pt}def\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ c{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}y{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ k\ as{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isasymbar}f{\isacharprime}{\kern0pt}\ y\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharbraceleft}{\kern0pt}y{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ k\ as{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isasymbar}f\ y\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}f{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ abs{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}diff\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}exp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}i\isactrlsub {\isadigit{1}}\ i\isactrlsub {\isadigit{2}}{\isachardot}{\kern0pt}\ i\isactrlsub {\isadigit{1}}\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{1}}\ {\isasymLongrightarrow}\ i\isactrlsub {\isadigit{2}}\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isasymLongrightarrow}\ \isanewline
\ \ \ \ has{\isacharunderscore}{\kern0pt}bochner{\isacharunderscore}{\kern0pt}integral\ {\isacharparenleft}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ x\ i\isactrlsub {\isadigit{1}}\ i\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult\ \ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ has{\isacharunderscore}{\kern0pt}bochner{\isacharunderscore}{\kern0pt}integral{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}sliceI{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}core{\isacharunderscore}{\kern0pt}exp{\isacharcomma}{\kern0pt}\ metis\ False{\isacharcomma}{\kern0pt}\ metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ real\ k\ {\isacharasterisk}{\kern0pt}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ real\ k\ {\isacharasterisk}{\kern0pt}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ \ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}ceiling{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}var{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ real\ k\ {\isacharasterisk}{\kern0pt}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ k\ {\isacharasterisk}{\kern0pt}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ k\ {\isacharasterisk}{\kern0pt}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}ac{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as\ {\isacharasterisk}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult{\isacharcomma}{\kern0pt}\ subst\ power{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}distrib{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ mult{\isachardot}{\kern0pt}assoc{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}real\ s\isactrlsub {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}var{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharplus}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}var{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ k\ {\isacharasterisk}{\kern0pt}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mult{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}var{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}i\isactrlsub {\isadigit{1}}\ i\isactrlsub {\isadigit{2}}{\isachardot}{\kern0pt}\ i\isactrlsub {\isadigit{1}}\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{1}}\ {\isasymLongrightarrow}\ i\isactrlsub {\isadigit{2}}\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isacharparenleft}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ i\isactrlsub {\isadigit{1}}\ i\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isasymle}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isadigit{3}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ variance{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}slice{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ order{\isacharunderscore}{\kern0pt}trans\ {\isacharbrackleft}{\kern0pt}\isakeyword{where}\ y{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ real\ k\ {\isacharasterisk}{\kern0pt}\ real\ n\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isasymOmega}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ False\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}core{\isacharunderscore}{\kern0pt}var{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ k{\isacharequal}{\kern0pt}{\isachardoublequoteopen}k{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}var{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharunderscore}{\kern0pt}exp{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharunderscore}{\kern0pt}exp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isasymLongrightarrow}\ \isanewline
\ \ \ \ \ \ has{\isacharunderscore}{\kern0pt}bochner{\isacharunderscore}{\kern0pt}integral\ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{1}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{1}}{\isacharunderscore}{\kern0pt}def\ sum{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}distrib{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ f{\isadigit{1}}{\isacharunderscore}{\kern0pt}exp{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ has{\isacharunderscore}{\kern0pt}bochner{\isacharunderscore}{\kern0pt}integral{\isacharunderscore}{\kern0pt}sum{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ has{\isacharunderscore}{\kern0pt}bochner{\isacharunderscore}{\kern0pt}integral{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}zero{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}exp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharunderscore}{\kern0pt}var{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isasymLongrightarrow}\ \isanewline
\ \ \ \ \ \ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{1}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isasymle}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ k\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharslash}{\kern0pt}{\isadigit{3}}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharquery}{\kern0pt}rhs\ i{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharunderscore}{\kern0pt}var{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{1}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ \ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ j\ i\ {\isacharslash}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{1}}{\isacharunderscore}{\kern0pt}def\ sum{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}distrib{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ measure{\isacharunderscore}{\kern0pt}pmf{\isachardot}{\kern0pt}var{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}indep{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}intro{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}j{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}j{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}i{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}disjoint{\isacharunderscore}{\kern0pt}family{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{1}}{\isacharunderscore}{\kern0pt}var{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ \ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{2}}\ {\isasymomega}\ j\ i{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isachardot}{\kern0pt}cong{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ measure{\isacharunderscore}{\kern0pt}pmf{\isachardot}{\kern0pt}variance{\isacharunderscore}{\kern0pt}divide{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ k\ as{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isadigit{3}}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ divide{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}var{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ f{\isadigit{1}}{\isacharunderscore}{\kern0pt}var{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ k\ as{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isacharslash}{\kern0pt}{\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ nonzero{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{1}}{\isacharunderscore}{\kern0pt}nonzero{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}rhs\ i{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ d{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ {\isasymAnd}i{\isachardot}{\kern0pt}\ i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isasymLongrightarrow}\ measure{\isacharunderscore}{\kern0pt}pmf{\isachardot}{\kern0pt}prob\ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ {\isacharbraceleft}{\kern0pt}y{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ k\ as{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymbar}f{\isadigit{1}}\ y\ i\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharbraceright}{\kern0pt}\ {\isasymle}\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{3}}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isasymAnd}i{\isachardot}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharquery}{\kern0pt}lhs\ i\ {\isasymle}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ i\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ d{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{define}\isamarkupfalse%
\ a\ \isakeyword{where}\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ k\ as{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ d{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ a{\isachardoublequoteclose}\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}a{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ fk{\isacharunderscore}{\kern0pt}nonzero\ mult{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}pos\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ d{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}integrable\ {\isacharparenleft}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f{\isadigit{1}}\ x\ i{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ integrable{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}finite{\isacharbrackleft}{\kern0pt}OF\ fin{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}lhs\ i\ {\isasymle}\ measure{\isacharunderscore}{\kern0pt}pmf{\isachardot}{\kern0pt}prob\ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}y{\isachardot}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}\ {\isacharasterisk}{\kern0pt}\ F\ k\ as{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isasymbar}f{\isadigit{1}}\ y\ i\ {\isacharminus}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}F\ k\ as{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ pmf{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}variance\ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{1}}\ {\isasymomega}\ i{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}a{\isacharcircum}{\kern0pt}{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharunderscore}{\kern0pt}exp{\isacharbrackleft}{\kern0pt}OF\ d{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}Chebyshev{\isacharunderscore}{\kern0pt}inequality{\isacharbrackleft}{\kern0pt}OF\ prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf\ {\isacharunderscore}{\kern0pt}\ d{\isacharunderscore}{\kern0pt}{\isadigit{3}}\ d{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}a{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ has{\isacharunderscore}{\kern0pt}bochner{\isacharunderscore}{\kern0pt}integral{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{3}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ d{\isacharunderscore}{\kern0pt}{\isadigit{2}}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharunderscore}{\kern0pt}var{\isacharbrackleft}{\kern0pt}OF\ d{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}a{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}lhs\ i\ {\isasymle}\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{3}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ b\ comp{\isacharunderscore}{\kern0pt}def\ map{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ c{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prob{\isacharunderscore}{\kern0pt}space{\isachardot}{\kern0pt}median{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ X{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}i\ {\isasymomega}{\isachardot}{\kern0pt}\ f{\isadigit{1}}\ {\isasymomega}\ i{\isachardoublequoteclose}\ \isakeyword{and}\ M{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymOmega}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}prob{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}f{\isadigit{1}}{\isacharunderscore}{\kern0pt}def\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ indep{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}restrict{\isacharunderscore}{\kern0pt}intro{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isasymtimes}{\isacharbraceleft}{\kern0pt}i{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}disjoint{\isacharunderscore}{\kern0pt}family{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ blast{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s{\isadigit{2}}{\isacharunderscore}{\kern0pt}nonzero{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ subsetI{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ force{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}ceiling\ \isacommand{apply}\isamarkupfalse%
\ blast\ \isanewline
\ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ d\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{fun}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}fk{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}k{\isacharcomma}{\kern0pt}\ n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ let\ s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{3}}{\isacharasterisk}{\kern0pt}real\ k{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ n{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isasymrceil}\ in\isanewline
\ \ \ \ let\ s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}\ in\ \isanewline
\ \ \ \ {\isadigit{5}}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{2}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ k\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ m\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ s\isactrlsub {\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ s\isactrlsub {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ n{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ m{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ encode{\isacharunderscore}{\kern0pt}state\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fk{\isacharunderscore}{\kern0pt}state\ {\isasymRightarrow}\ bool\ list\ option{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}encode{\isacharunderscore}{\kern0pt}state\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ N\isactrlsub S\ {\isasymtimes}\isactrlsub D\ {\isacharparenleft}{\kern0pt}{\isasymlambda}s\isactrlsub {\isadigit{1}}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ N\isactrlsub S\ {\isasymtimes}\isactrlsub D\ {\isacharparenleft}{\kern0pt}{\isasymlambda}s\isactrlsub {\isadigit{2}}{\isachardot}{\kern0pt}\ \isanewline
\ \ \ \ N\isactrlsub S\ {\isasymtimes}\isactrlsub S\ \ \isanewline
\ \ \ \ N\isactrlsub S\ {\isasymtimes}\isactrlsub S\ \ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}List{\isachardot}{\kern0pt}product\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbrackright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub S\ {\isacharparenleft}{\kern0pt}N\isactrlsub S\ {\isasymtimes}\isactrlsub S\ N\isactrlsub S{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ encode{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}dom\ encode{\isacharunderscore}{\kern0pt}state{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ encoding{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}inj{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ dependent{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ dependent{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isacharunderscore}{\kern0pt}encoding{\isacharcomma}{\kern0pt}\ metis\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ encode{\isacharunderscore}{\kern0pt}extensional\ prod{\isacharunderscore}{\kern0pt}encoding\ nat{\isacharunderscore}{\kern0pt}encoding{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}exact{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}k\ {\isasymge}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}{\isadigit{1}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymdelta}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ as\ {\isasymsubseteq}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}M\ {\isasymequiv}\ fold\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a\ state{\isachardot}{\kern0pt}\ state\ {\isasymbind}\ fk{\isacharunderscore}{\kern0pt}update\ a{\isacharparenright}{\kern0pt}\ as\ {\isacharparenleft}{\kern0pt}fk{\isacharunderscore}{\kern0pt}init\ k\ {\isasymdelta}\ {\isasymepsilon}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}AE\ {\isasymomega}\ in\ M{\isachardot}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state\ {\isasymomega}{\isacharparenright}{\kern0pt}\ {\isasymle}\ fk{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}k{\isacharcomma}{\kern0pt}\ n{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}AE\ {\isasymomega}\ in\ M{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}\ \ {\isasymle}\ {\isacharquery}{\kern0pt}rhs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}as\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}M\ {\isacharequal}{\kern0pt}\ fk{\isacharunderscore}{\kern0pt}init\ k\ {\isasymdelta}\ {\isasymepsilon}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ True\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}M{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{1}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{3}}{\isacharasterisk}{\kern0pt}real\ k{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ n{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{2}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ w\ \isakeyword{where}\ {\isachardoublequoteopen}w\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}ereal{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ h{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}N\isactrlsub S\ {\isasymtimes}\isactrlsub S\ N\isactrlsub S{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}a{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat{\isacharcomma}{\kern0pt}\ {\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fst\ x\ {\isasymle}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}a\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ x\ {\isasymle}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ h{\isacharunderscore}{\kern0pt}a\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}N\isactrlsub S\ {\isasymtimes}\isactrlsub S\ N\isactrlsub S{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ \ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ real\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ \ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ real\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ prod{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharcomma}{\kern0pt}\ rule\ h{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharcomma}{\kern0pt}\ rule\ h{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}N\isactrlsub S\ {\isasymtimes}\isactrlsub S\ N\isactrlsub S{\isacharparenright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}N\isactrlsub S\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}N\isactrlsub S\ s\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}N\isactrlsub S\ k{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}N\isactrlsub S\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ \isanewline
\ \ \ \ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}List{\isachardot}{\kern0pt}product\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbrackright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub S\ N\isactrlsub S\ {\isasymtimes}\isactrlsub S\ N\isactrlsub S{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{2}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ \isanewline
\ \ \ \ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ k\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ {\isadigit{0}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ \isanewline
\ \ \ {\isacharparenleft}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}w\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}fun\isactrlsub S{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ xs{\isacharequal}{\kern0pt}{\isachardoublequoteopen}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}List{\isachardot}{\kern0pt}product\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ w{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ metis\ h{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}fk{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}k{\isacharcomma}{\kern0pt}\ n{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ w{\isacharunderscore}{\kern0pt}def\ True{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp{\isacharplus}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}N\isactrlsub S\ s\isactrlsub {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}N\isactrlsub S\ s\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}N\isactrlsub S\ k{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}N\isactrlsub S\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\isanewline
\ \ \ \ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}List{\isachardot}{\kern0pt}product\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbrackright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub S\ N\isactrlsub S\ {\isasymtimes}\isactrlsub S\ N\isactrlsub S{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymle}\ ereal\ {\isacharparenleft}{\kern0pt}fk{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}k{\isacharcomma}{\kern0pt}\ n{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}add{\isachardot}{\kern0pt}assoc\ del{\isacharcolon}{\kern0pt}fk{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage{\isachardot}{\kern0pt}simps\ N\isactrlsub S{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ a\ Let{\isacharunderscore}{\kern0pt}def\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def\ encode{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def\ \ AE{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}iff\ dependent{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ prod{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\isanewline
\ \ \ \ \ \ \ \ del{\isacharcolon}{\kern0pt}fk{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage{\isachardot}{\kern0pt}simps\ N\isactrlsub S{\isachardot}{\kern0pt}simps\ encode{\isacharunderscore}{\kern0pt}prod{\isachardot}{\kern0pt}simps\ encode{\isacharunderscore}{\kern0pt}dependent{\isacharunderscore}{\kern0pt}sum{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\ \isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{1}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isadigit{3}}{\isacharasterisk}{\kern0pt}real\ k{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ n{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ s\isactrlsub {\isadigit{2}}\ \isakeyword{where}\ {\isachardoublequoteopen}s\isactrlsub {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ nat\ {\isasymlceil}{\isacharminus}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ a{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}M\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}k{\isacharcomma}{\kern0pt}length\ as{\isacharcomma}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ M{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ fk{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}sketch{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ False{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ as\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ False\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ n{\isacharunderscore}{\kern0pt}nonzero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}n\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ length{\isacharunderscore}{\kern0pt}xs{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}length\ as\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ False\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ b{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymAnd}y{\isachardot}{\kern0pt}\ y{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub E\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharquery}{\kern0pt}rhs{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ y\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ b{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}y\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}\ {\isasymrightarrow}\isactrlsub E\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ v\ {\isacharless}{\kern0pt}\ count{\isacharunderscore}{\kern0pt}list\ as\ u{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ y\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isadigit{1}}\ {\isasymle}\ count{\isacharunderscore}{\kern0pt}list\ as\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ b{\isadigit{0}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}PiE{\isacharunderscore}{\kern0pt}iff\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharcomma}{\kern0pt}\ fastforce{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ b{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ y\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ fst\ x\ {\isasymle}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ assms{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ atLeastLessThan{\isacharunderscore}{\kern0pt}iff\ count{\isacharunderscore}{\kern0pt}notin\ in{\isacharunderscore}{\kern0pt}mono\ less{\isacharunderscore}{\kern0pt}or{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}le\ not{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}zero{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ y\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ snd\ x\ {\isasymle}\ length\ as{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ count{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}length\ b{\isadigit{0}}\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}PiE{\isacharunderscore}{\kern0pt}iff\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}strict{\isacharunderscore}{\kern0pt}trans{\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ b{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\ extensional\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ b{\isadigit{0}}\ PiE{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ \isanewline
\ \ \ \ \ \ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ \ \ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{2}}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\ \isanewline
\ \ \ \ \ \ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ k\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ \ \ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}real\ s\isactrlsub {\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ real\ s\isactrlsub {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}n{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ereal\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}length\ as{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state{\isacharunderscore}{\kern0pt}def\ dependent{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ prod{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count\ PiE{\isacharunderscore}{\kern0pt}iff\ comp{\isacharunderscore}{\kern0pt}def\ fun\isactrlsub S{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \ \ del{\isacharcolon}{\kern0pt}N\isactrlsub S{\isachardot}{\kern0pt}simps\ encode{\isacharunderscore}{\kern0pt}prod{\isachardot}{\kern0pt}simps\ encode{\isacharunderscore}{\kern0pt}dependent{\isacharunderscore}{\kern0pt}sum{\isachardot}{\kern0pt}simps\ plus{\isacharunderscore}{\kern0pt}ereal{\isachardot}{\kern0pt}simps\ sum{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}ereal\ times{\isacharunderscore}{\kern0pt}ereal{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharbrackleft}{\kern0pt}simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharbrackleft}{\kern0pt}simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharbrackleft}{\kern0pt}simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharbrackleft}{\kern0pt}simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ list{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ xs{\isacharequal}{\kern0pt}{\isachardoublequoteopen}map\ y\ {\isacharparenleft}{\kern0pt}List{\isachardot}{\kern0pt}product\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}s\isactrlsub {\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ prod{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ add{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharcomma}{\kern0pt}\ metis\ b{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ nat{\isacharunderscore}{\kern0pt}bit{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}est{\isacharcomma}{\kern0pt}\ metis\ b{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymle}\ {\isacharquery}{\kern0pt}rhs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ n{\isacharunderscore}{\kern0pt}nonzero\ length{\isacharunderscore}{\kern0pt}xs{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ s\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharcomma}{\kern0pt}simplified{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}bit{\isacharunderscore}{\kern0pt}count\ {\isacharparenleft}{\kern0pt}encode{\isacharunderscore}{\kern0pt}state\ {\isacharparenleft}{\kern0pt}s\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ s\isactrlsub {\isadigit{2}}{\isacharcomma}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ length\ as{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharquery}{\kern0pt}rhs{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ a\ AE{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}iff\ del{\isacharcolon}{\kern0pt}fk{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ set{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}pmf{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}PiE{\isacharunderscore}{\kern0pt}def\ del{\isacharcolon}{\kern0pt}fk{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ set{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharbrackleft}{\kern0pt}OF\ non{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}space{\isacharbrackleft}{\kern0pt}OF\ False{\isacharbrackright}{\kern0pt}\ fin{\isacharunderscore}{\kern0pt}space{\isacharbrackleft}{\kern0pt}OF\ False{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ PiE{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ b{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fk{\isacharunderscore}{\kern0pt}asympotic{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}complexity{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}fk{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isasymin}\ \isanewline
\ \ O{\isacharbrackleft}{\kern0pt}at{\isacharunderscore}{\kern0pt}top\ {\isasymtimes}\isactrlsub F\ at{\isacharunderscore}{\kern0pt}top\ {\isasymtimes}\isactrlsub F\ at{\isacharunderscore}{\kern0pt}top\ {\isasymtimes}\isactrlsub F\ at{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}rat{\isacharparenright}{\kern0pt}\ {\isasymtimes}\isactrlsub F\ at{\isacharunderscore}{\kern0pt}right\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}rat{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}\ {\isacharparenleft}{\kern0pt}k{\isacharcomma}{\kern0pt}\ n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\isanewline
\ \ real\ k{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ n{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}\ real\ k{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymdelta}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ n{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ m{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}rhs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ k{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}k{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}k{\isacharcomma}{\kern0pt}\ n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ n{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}n{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}k{\isacharcomma}{\kern0pt}\ n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ m{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}m{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}k{\isacharcomma}{\kern0pt}\ n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}k{\isacharcomma}{\kern0pt}\ n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymepsilon}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ nat\ {\isasymtimes}\ rat\ {\isasymtimes}\ rat\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}k{\isacharcomma}{\kern0pt}\ n{\isacharcomma}{\kern0pt}\ m{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymdelta}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ g{\isadigit{1}}\ \isakeyword{where}\ {\isachardoublequoteopen}g{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}k{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}k{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ g\ \isakeyword{where}\ {\isachardoublequoteopen}g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ g{\isadigit{1}}\ x\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ k{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}k{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}k{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}top{\isacharunderscore}{\kern0pt}linorder\ nat{\isacharunderscore}{\kern0pt}ceiling{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ n{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}n{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}top{\isacharunderscore}{\kern0pt}linorder\ nat{\isacharunderscore}{\kern0pt}ceiling{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ m{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}m{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}top{\isacharunderscore}{\kern0pt}linorder\ nat{\isacharunderscore}{\kern0pt}ceiling{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ eps{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inv{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ delta{\isacharunderscore}{\kern0pt}inf{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}c{\isachardot}{\kern0pt}\ eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c\ {\isasymle}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}prod{\isacharunderscore}{\kern0pt}filter{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bot{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inv{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}rightI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ b{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}delta{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}F{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ eventually{\isacharunderscore}{\kern0pt}prod{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}at{\isacharunderscore}{\kern0pt}rightI{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ b{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{9}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}k{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ k{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ ge{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}powr{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}zero{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{8}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}k{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ k{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ m{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}n{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ n{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps\ eps{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}exp\ {\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ abs{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}self\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}trans\ exp{\isacharunderscore}{\kern0pt}gt{\isacharunderscore}{\kern0pt}zero\ ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff\ order{\isacharunderscore}{\kern0pt}trans{\isacharunderscore}{\kern0pt}rules{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono\ {\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}exp\ {\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ abs{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}self\ linorder{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}le\ ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff\ not{\isacharunderscore}{\kern0pt}exp{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}zero\ order{\isachardot}{\kern0pt}trans{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}conj{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}delta\ delta{\isacharunderscore}{\kern0pt}inf{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ c{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ one{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}power\ power{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}over{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}g{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}g{\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{8}}\ unit{\isacharunderscore}{\kern0pt}{\isadigit{9}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{5}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ g{\isadigit{1}}\ x\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{4}}\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}g{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{5}}\ unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{6}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}k{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}k{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}g{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}ceil{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}g{\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharcomma}{\kern0pt}\ subst\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}mult{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{9}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}ceil{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ minus{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ cmult{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}iff{\isacharcomma}{\kern0pt}\ rule\ disjI{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isachardot}{\kern0pt}in{\isacharunderscore}{\kern0pt}cong{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ g{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln{\isacharparenleft}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ eventually{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eps{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ ln{\isacharunderscore}{\kern0pt}div{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}k{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}k{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ log\ {\isadigit{2}}\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}g{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}mult{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}mult{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{6}}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{9}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ n{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}n{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}log{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ {\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ m{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}m{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}g{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{5}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ {\isacharbrackleft}{\kern0pt}OF\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}\ eventually{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}iff{\isacharbrackleft}{\kern0pt}OF\ m{\isacharunderscore}{\kern0pt}inf{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ a{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isadigit{2}}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ m{\isacharunderscore}{\kern0pt}inf{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{7}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}k{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}g{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}g{\isadigit{1}}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{7}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{8}}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ unit{\isacharunderscore}{\kern0pt}{\isadigit{9}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}k{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}g{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{7}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}\ rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{8}}\ {\isacharasterisk}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isasymrceil}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}g{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ unit{\isacharunderscore}{\kern0pt}{\isadigit{4}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{9}}{\isacharcomma}{\kern0pt}\ rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}\ rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ l{\isadigit{5}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ ln\ {\isacharparenleft}{\kern0pt}real\ {\isacharparenleft}{\kern0pt}nat\ {\isasymlceil}{\isadigit{3}}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}k{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}n{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}\ powr\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ real\ {\isacharparenleft}{\kern0pt}k{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isasymrceil}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}ln{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}g{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ landau{\isacharunderscore}{\kern0pt}o{\isachardot}{\kern0pt}big{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{6}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}\ rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{3}}{\isacharcomma}{\kern0pt}\ rule\ unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}fk{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ fk{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}usage\ {\isacharparenleft}{\kern0pt}k{\isacharunderscore}{\kern0pt}of\ x{\isacharcomma}{\kern0pt}\ n{\isacharunderscore}{\kern0pt}of\ x{\isacharcomma}{\kern0pt}\ m{\isacharunderscore}{\kern0pt}of\ x{\isacharcomma}{\kern0pt}\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of\ x{\isacharcomma}{\kern0pt}\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}\ k{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ n{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ m{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymin}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Let{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{2}}\ log{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{3}}\ log{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{4}}\ log{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sum{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}bigo{\isacharunderscore}{\kern0pt}r{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{4}}\ log{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}l{\isadigit{5}}{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}unit{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharequal}{\kern0pt}\ O{\isacharbrackleft}{\kern0pt}{\isacharquery}{\kern0pt}F{\isacharbrackright}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}rhs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ arg{\isacharunderscore}{\kern0pt}cong{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}bigo{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}\ g{\isadigit{1}}{\isacharunderscore}{\kern0pt}def\ g{\isacharunderscore}{\kern0pt}def\ n{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymepsilon}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ {\isasymdelta}{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ m{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def\ k{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=Frequency_Moment_k.tex%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%39=7%:%
%:%40=8%:%
%:%42=10%:%
%:%43=10%:%
%:%44=11%:%
%:%45=12%:%
%:%46=12%:%
%:%47=13%:%
%:%52=18%:%
%:%53=19%:%
%:%54=20%:%
%:%55=20%:%
%:%56=21%:%
%:%66=31%:%
%:%67=32%:%
%:%68=33%:%
%:%69=33%:%
%:%70=34%:%
%:%73=37%:%
%:%74=38%:%
%:%75=39%:%
%:%76=39%:%
%:%77=40%:%
%:%87=50%:%
%:%88=51%:%
%:%89=52%:%
%:%90=52%:%
%:%91=53%:%
%:%101=63%:%
%:%102=64%:%
%:%103=65%:%
%:%104=65%:%
%:%107=66%:%
%:%111=66%:%
%:%112=66%:%
%:%117=66%:%
%:%120=67%:%
%:%121=68%:%
%:%122=68%:%
%:%123=69%:%
%:%124=70%:%
%:%131=71%:%
%:%132=71%:%
%:%133=72%:%
%:%134=72%:%
%:%135=73%:%
%:%136=74%:%
%:%137=74%:%
%:%138=75%:%
%:%139=75%:%
%:%140=76%:%
%:%141=77%:%
%:%142=77%:%
%:%143=78%:%
%:%144=78%:%
%:%145=79%:%
%:%146=79%:%
%:%147=80%:%
%:%148=80%:%
%:%149=81%:%
%:%150=81%:%
%:%151=82%:%
%:%152=82%:%
%:%153=82%:%
%:%154=83%:%
%:%155=83%:%
%:%156=84%:%
%:%157=84%:%
%:%158=84%:%
%:%159=85%:%
%:%160=85%:%
%:%161=86%:%
%:%162=86%:%
%:%163=87%:%
%:%164=87%:%
%:%165=88%:%
%:%166=88%:%
%:%167=89%:%
%:%168=89%:%
%:%169=90%:%
%:%170=90%:%
%:%171=90%:%
%:%172=91%:%
%:%173=91%:%
%:%174=92%:%
%:%175=92%:%
%:%176=92%:%
%:%177=92%:%
%:%178=93%:%
%:%184=93%:%
%:%187=94%:%
%:%188=95%:%
%:%189=95%:%
%:%190=96%:%
%:%191=97%:%
%:%192=98%:%
%:%193=99%:%
%:%200=100%:%
%:%201=100%:%
%:%202=101%:%
%:%203=101%:%
%:%204=102%:%
%:%205=102%:%
%:%206=103%:%
%:%207=103%:%
%:%208=104%:%
%:%209=105%:%
%:%210=105%:%
%:%211=106%:%
%:%212=106%:%
%:%213=106%:%
%:%214=107%:%
%:%215=108%:%
%:%216=108%:%
%:%217=109%:%
%:%218=109%:%
%:%219=110%:%
%:%220=110%:%
%:%221=111%:%
%:%222=111%:%
%:%223=112%:%
%:%224=112%:%
%:%225=112%:%
%:%226=113%:%
%:%227=114%:%
%:%228=114%:%
%:%229=115%:%
%:%230=115%:%
%:%231=116%:%
%:%232=116%:%
%:%233=117%:%
%:%239=117%:%
%:%242=118%:%
%:%243=119%:%
%:%244=119%:%
%:%245=120%:%
%:%246=121%:%
%:%247=122%:%
%:%254=123%:%
%:%255=123%:%
%:%256=124%:%
%:%257=124%:%
%:%258=125%:%
%:%259=126%:%
%:%260=126%:%
%:%261=127%:%
%:%262=128%:%
%:%263=129%:%
%:%264=129%:%
%:%265=130%:%
%:%266=130%:%
%:%267=131%:%
%:%268=131%:%
%:%269=132%:%
%:%270=132%:%
%:%271=133%:%
%:%272=133%:%
%:%273=134%:%
%:%274=134%:%
%:%275=135%:%
%:%276=135%:%
%:%277=136%:%
%:%278=136%:%
%:%279=136%:%
%:%280=137%:%
%:%281=137%:%
%:%282=138%:%
%:%283=139%:%
%:%284=139%:%
%:%285=139%:%
%:%286=140%:%
%:%287=140%:%
%:%288=140%:%
%:%289=141%:%
%:%290=141%:%
%:%291=142%:%
%:%292=142%:%
%:%293=143%:%
%:%294=143%:%
%:%295=144%:%
%:%296=144%:%
%:%297=145%:%
%:%298=145%:%
%:%299=145%:%
%:%300=145%:%
%:%301=146%:%
%:%302=146%:%
%:%303=147%:%
%:%304=147%:%
%:%305=147%:%
%:%306=148%:%
%:%307=148%:%
%:%308=149%:%
%:%309=149%:%
%:%310=149%:%
%:%311=150%:%
%:%312=150%:%
%:%313=151%:%
%:%314=151%:%
%:%315=151%:%
%:%316=151%:%
%:%317=152%:%
%:%318=152%:%
%:%319=153%:%
%:%320=154%:%
%:%321=154%:%
%:%322=155%:%
%:%323=155%:%
%:%324=156%:%
%:%325=156%:%
%:%326=157%:%
%:%327=157%:%
%:%328=158%:%
%:%329=158%:%
%:%330=158%:%
%:%331=159%:%
%:%332=159%:%
%:%333=159%:%
%:%334=160%:%
%:%335=160%:%
%:%336=160%:%
%:%337=161%:%
%:%338=161%:%
%:%339=162%:%
%:%340=162%:%
%:%341=163%:%
%:%342=163%:%
%:%343=164%:%
%:%344=164%:%
%:%345=165%:%
%:%346=165%:%
%:%347=166%:%
%:%348=166%:%
%:%349=167%:%
%:%350=167%:%
%:%351=168%:%
%:%352=168%:%
%:%353=169%:%
%:%354=169%:%
%:%355=170%:%
%:%356=170%:%
%:%357=171%:%
%:%358=171%:%
%:%359=171%:%
%:%360=172%:%
%:%361=172%:%
%:%362=173%:%
%:%363=173%:%
%:%364=174%:%
%:%365=174%:%
%:%366=174%:%
%:%367=175%:%
%:%368=175%:%
%:%369=176%:%
%:%370=176%:%
%:%371=176%:%
%:%372=177%:%
%:%373=177%:%
%:%374=178%:%
%:%375=178%:%
%:%376=179%:%
%:%377=179%:%
%:%378=180%:%
%:%379=180%:%
%:%380=181%:%
%:%381=181%:%
%:%382=182%:%
%:%383=182%:%
%:%384=183%:%
%:%385=183%:%
%:%386=184%:%
%:%387=184%:%
%:%388=185%:%
%:%389=185%:%
%:%390=186%:%
%:%391=187%:%
%:%392=187%:%
%:%393=188%:%
%:%394=188%:%
%:%395=188%:%
%:%396=189%:%
%:%397=189%:%
%:%398=190%:%
%:%399=190%:%
%:%400=190%:%
%:%401=191%:%
%:%402=191%:%
%:%403=192%:%
%:%409=192%:%
%:%412=193%:%
%:%413=194%:%
%:%414=194%:%
%:%415=195%:%
%:%416=196%:%
%:%417=197%:%
%:%420=198%:%
%:%424=198%:%
%:%425=198%:%
%:%426=199%:%
%:%427=199%:%
%:%428=200%:%
%:%429=200%:%
%:%430=201%:%
%:%431=201%:%
%:%432=202%:%
%:%433=202%:%
%:%434=203%:%
%:%435=203%:%
%:%436=203%:%
%:%437=204%:%
%:%438=204%:%
%:%439=205%:%
%:%440=205%:%
%:%441=206%:%
%:%442=206%:%
%:%443=207%:%
%:%444=207%:%
%:%445=208%:%
%:%446=208%:%
%:%447=209%:%
%:%448=209%:%
%:%450=211%:%
%:%451=212%:%
%:%452=212%:%
%:%453=213%:%
%:%454=213%:%
%:%455=214%:%
%:%456=214%:%
%:%457=215%:%
%:%458=215%:%
%:%459=215%:%
%:%460=215%:%
%:%461=216%:%
%:%462=216%:%
%:%463=217%:%
%:%464=218%:%
%:%465=218%:%
%:%466=218%:%
%:%467=219%:%
%:%468=219%:%
%:%469=220%:%
%:%470=220%:%
%:%471=221%:%
%:%472=221%:%
%:%473=222%:%
%:%474=222%:%
%:%475=223%:%
%:%476=223%:%
%:%477=224%:%
%:%478=224%:%
%:%479=225%:%
%:%480=225%:%
%:%481=226%:%
%:%482=226%:%
%:%483=227%:%
%:%484=227%:%
%:%485=228%:%
%:%486=228%:%
%:%487=229%:%
%:%488=229%:%
%:%489=230%:%
%:%490=230%:%
%:%491=231%:%
%:%492=231%:%
%:%493=232%:%
%:%494=232%:%
%:%495=233%:%
%:%496=233%:%
%:%497=234%:%
%:%498=234%:%
%:%499=235%:%
%:%500=235%:%
%:%501=236%:%
%:%507=236%:%
%:%510=237%:%
%:%511=238%:%
%:%512=238%:%
%:%514=240%:%
%:%515=241%:%
%:%517=243%:%
%:%518=243%:%
%:%519=244%:%
%:%520=245%:%
%:%521=246%:%
%:%528=247%:%
%:%529=247%:%
%:%530=248%:%
%:%531=248%:%
%:%532=249%:%
%:%533=249%:%
%:%534=250%:%
%:%535=250%:%
%:%536=251%:%
%:%537=251%:%
%:%538=252%:%
%:%539=252%:%
%:%540=253%:%
%:%541=253%:%
%:%542=254%:%
%:%543=254%:%
%:%544=255%:%
%:%545=255%:%
%:%546=255%:%
%:%547=256%:%
%:%548=256%:%
%:%549=257%:%
%:%550=257%:%
%:%551=258%:%
%:%552=258%:%
%:%553=259%:%
%:%554=259%:%
%:%555=260%:%
%:%556=260%:%
%:%557=261%:%
%:%558=262%:%
%:%559=262%:%
%:%560=263%:%
%:%561=263%:%
%:%562=264%:%
%:%563=264%:%
%:%564=265%:%
%:%565=265%:%
%:%566=266%:%
%:%567=266%:%
%:%568=267%:%
%:%569=267%:%
%:%570=268%:%
%:%571=268%:%
%:%572=269%:%
%:%573=269%:%
%:%574=270%:%
%:%575=270%:%
%:%576=271%:%
%:%577=271%:%
%:%578=272%:%
%:%579=273%:%
%:%580=273%:%
%:%581=273%:%
%:%582=274%:%
%:%583=274%:%
%:%584=275%:%
%:%585=275%:%
%:%586=276%:%
%:%587=276%:%
%:%588=277%:%
%:%589=277%:%
%:%590=278%:%
%:%591=278%:%
%:%592=279%:%
%:%593=279%:%
%:%594=280%:%
%:%595=280%:%
%:%596=281%:%
%:%597=281%:%
%:%598=282%:%
%:%599=282%:%
%:%600=283%:%
%:%601=283%:%
%:%602=284%:%
%:%603=284%:%
%:%604=285%:%
%:%605=285%:%
%:%606=286%:%
%:%607=286%:%
%:%608=287%:%
%:%609=287%:%
%:%610=288%:%
%:%611=288%:%
%:%612=289%:%
%:%613=289%:%
%:%614=290%:%
%:%615=290%:%
%:%616=291%:%
%:%617=291%:%
%:%618=292%:%
%:%624=292%:%
%:%627=293%:%
%:%628=294%:%
%:%629=294%:%
%:%630=295%:%
%:%631=296%:%
%:%632=297%:%
%:%633=298%:%
%:%634=299%:%
%:%635=300%:%
%:%636=301%:%
%:%637=302%:%
%:%638=303%:%
%:%640=305%:%
%:%643=306%:%
%:%647=306%:%
%:%648=306%:%
%:%649=307%:%
%:%650=307%:%
%:%651=308%:%
%:%652=308%:%
%:%653=309%:%
%:%654=309%:%
%:%655=309%:%
%:%656=310%:%
%:%657=310%:%
%:%658=311%:%
%:%659=311%:%
%:%660=312%:%
%:%661=312%:%
%:%662=313%:%
%:%663=313%:%
%:%664=314%:%
%:%665=314%:%
%:%666=315%:%
%:%667=315%:%
%:%668=316%:%
%:%669=317%:%
%:%670=318%:%
%:%671=318%:%
%:%672=319%:%
%:%673=320%:%
%:%674=320%:%
%:%675=321%:%
%:%676=322%:%
%:%677=322%:%
%:%678=323%:%
%:%679=323%:%
%:%680=323%:%
%:%681=323%:%
%:%682=324%:%
%:%683=325%:%
%:%684=325%:%
%:%685=325%:%
%:%686=326%:%
%:%687=326%:%
%:%688=327%:%
%:%689=327%:%
%:%690=328%:%
%:%691=328%:%
%:%692=329%:%
%:%693=329%:%
%:%694=330%:%
%:%695=330%:%
%:%696=331%:%
%:%702=331%:%
%:%705=332%:%
%:%706=333%:%
%:%707=333%:%
%:%708=334%:%
%:%709=335%:%
%:%716=336%:%
%:%717=336%:%
%:%718=337%:%
%:%719=337%:%
%:%720=338%:%
%:%721=338%:%
%:%722=339%:%
%:%723=339%:%
%:%724=339%:%
%:%725=340%:%
%:%726=340%:%
%:%727=341%:%
%:%728=341%:%
%:%729=342%:%
%:%730=342%:%
%:%731=343%:%
%:%732=343%:%
%:%733=344%:%
%:%734=344%:%
%:%735=345%:%
%:%736=345%:%
%:%737=345%:%
%:%738=346%:%
%:%739=346%:%
%:%740=347%:%
%:%741=347%:%
%:%742=348%:%
%:%743=348%:%
%:%744=348%:%
%:%745=348%:%
%:%746=349%:%
%:%747=349%:%
%:%748=349%:%
%:%749=350%:%
%:%750=350%:%
%:%751=351%:%
%:%752=351%:%
%:%753=352%:%
%:%754=352%:%
%:%755=352%:%
%:%756=353%:%
%:%757=353%:%
%:%758=354%:%
%:%759=354%:%
%:%760=354%:%
%:%761=354%:%
%:%762=355%:%
%:%768=355%:%
%:%771=356%:%
%:%772=357%:%
%:%773=357%:%
%:%774=358%:%
%:%775=359%:%
%:%776=360%:%
%:%777=361%:%
%:%784=362%:%
%:%785=362%:%
%:%786=363%:%
%:%787=363%:%
%:%788=364%:%
%:%789=364%:%
%:%790=365%:%
%:%791=365%:%
%:%792=365%:%
%:%793=366%:%
%:%794=366%:%
%:%795=366%:%
%:%796=367%:%
%:%797=367%:%
%:%798=368%:%
%:%799=368%:%
%:%800=369%:%
%:%801=369%:%
%:%802=369%:%
%:%803=370%:%
%:%804=370%:%
%:%805=370%:%
%:%806=371%:%
%:%807=371%:%
%:%808=372%:%
%:%809=372%:%
%:%810=373%:%
%:%811=373%:%
%:%812=374%:%
%:%813=374%:%
%:%814=374%:%
%:%815=375%:%
%:%816=375%:%
%:%817=376%:%
%:%818=376%:%
%:%819=377%:%
%:%820=377%:%
%:%821=378%:%
%:%822=378%:%
%:%823=379%:%
%:%824=379%:%
%:%825=379%:%
%:%826=380%:%
%:%827=380%:%
%:%828=380%:%
%:%829=380%:%
%:%830=381%:%
%:%840=383%:%
%:%842=384%:%
%:%843=384%:%
%:%844=385%:%
%:%845=386%:%
%:%846=387%:%
%:%849=388%:%
%:%853=388%:%
%:%854=388%:%
%:%855=388%:%
%:%856=389%:%
%:%857=389%:%
%:%858=390%:%
%:%859=390%:%
%:%864=390%:%
%:%867=391%:%
%:%868=392%:%
%:%869=392%:%
%:%870=393%:%
%:%871=394%:%
%:%872=395%:%
%:%873=396%:%
%:%874=397%:%
%:%881=398%:%
%:%882=398%:%
%:%883=399%:%
%:%884=399%:%
%:%885=400%:%
%:%886=400%:%
%:%887=401%:%
%:%888=401%:%
%:%889=401%:%
%:%890=402%:%
%:%891=402%:%
%:%892=403%:%
%:%893=404%:%
%:%894=404%:%
%:%895=404%:%
%:%896=405%:%
%:%897=405%:%
%:%898=406%:%
%:%899=406%:%
%:%900=406%:%
%:%901=407%:%
%:%902=407%:%
%:%903=407%:%
%:%904=408%:%
%:%905=409%:%
%:%906=409%:%
%:%907=410%:%
%:%908=410%:%
%:%909=411%:%
%:%910=411%:%
%:%911=412%:%
%:%912=412%:%
%:%913=412%:%
%:%914=413%:%
%:%915=413%:%
%:%916=414%:%
%:%917=415%:%
%:%918=415%:%
%:%919=416%:%
%:%920=416%:%
%:%921=417%:%
%:%922=417%:%
%:%923=418%:%
%:%924=418%:%
%:%925=418%:%
%:%926=419%:%
%:%927=420%:%
%:%928=420%:%
%:%929=421%:%
%:%930=421%:%
%:%931=421%:%
%:%932=422%:%
%:%933=422%:%
%:%934=422%:%
%:%935=423%:%
%:%936=423%:%
%:%937=424%:%
%:%938=424%:%
%:%939=425%:%
%:%940=425%:%
%:%941=425%:%
%:%942=425%:%
%:%943=426%:%
%:%944=426%:%
%:%945=426%:%
%:%946=426%:%
%:%947=427%:%
%:%948=427%:%
%:%949=428%:%
%:%950=428%:%
%:%951=428%:%
%:%952=429%:%
%:%953=429%:%
%:%954=430%:%
%:%955=431%:%
%:%956=431%:%
%:%957=432%:%
%:%958=432%:%
%:%959=432%:%
%:%960=433%:%
%:%961=433%:%
%:%962=434%:%
%:%963=434%:%
%:%964=435%:%
%:%965=435%:%
%:%966=436%:%
%:%967=436%:%
%:%968=437%:%
%:%969=437%:%
%:%970=438%:%
%:%971=438%:%
%:%972=439%:%
%:%973=439%:%
%:%974=439%:%
%:%975=440%:%
%:%976=440%:%
%:%977=441%:%
%:%978=441%:%
%:%979=442%:%
%:%980=442%:%
%:%981=443%:%
%:%982=443%:%
%:%983=444%:%
%:%984=444%:%
%:%985=444%:%
%:%986=445%:%
%:%987=445%:%
%:%988=446%:%
%:%989=446%:%
%:%990=447%:%
%:%991=447%:%
%:%992=448%:%
%:%993=448%:%
%:%994=448%:%
%:%995=449%:%
%:%996=449%:%
%:%997=450%:%
%:%998=451%:%
%:%999=451%:%
%:%1000=452%:%
%:%1001=452%:%
%:%1002=453%:%
%:%1003=454%:%
%:%1004=454%:%
%:%1005=455%:%
%:%1006=455%:%
%:%1007=456%:%
%:%1008=456%:%
%:%1009=457%:%
%:%1010=457%:%
%:%1011=457%:%
%:%1012=458%:%
%:%1013=458%:%
%:%1014=459%:%
%:%1015=459%:%
%:%1016=459%:%
%:%1017=460%:%
%:%1018=460%:%
%:%1019=460%:%
%:%1020=461%:%
%:%1021=461%:%
%:%1022=462%:%
%:%1023=462%:%
%:%1024=462%:%
%:%1025=463%:%
%:%1026=463%:%
%:%1027=463%:%
%:%1028=464%:%
%:%1029=464%:%
%:%1030=465%:%
%:%1031=465%:%
%:%1032=465%:%
%:%1033=465%:%
%:%1034=466%:%
%:%1035=466%:%
%:%1036=466%:%
%:%1037=466%:%
%:%1038=467%:%
%:%1039=467%:%
%:%1040=468%:%
%:%1041=468%:%
%:%1042=468%:%
%:%1043=469%:%
%:%1044=469%:%
%:%1045=470%:%
%:%1046=470%:%
%:%1047=471%:%
%:%1048=471%:%
%:%1049=472%:%
%:%1050=472%:%
%:%1051=473%:%
%:%1052=473%:%
%:%1053=474%:%
%:%1054=474%:%
%:%1055=475%:%
%:%1056=475%:%
%:%1057=476%:%
%:%1058=476%:%
%:%1059=477%:%
%:%1060=477%:%
%:%1061=477%:%
%:%1062=478%:%
%:%1063=478%:%
%:%1064=479%:%
%:%1065=480%:%
%:%1066=480%:%
%:%1067=481%:%
%:%1068=481%:%
%:%1069=482%:%
%:%1070=482%:%
%:%1071=482%:%
%:%1072=482%:%
%:%1073=483%:%
%:%1074=483%:%
%:%1075=483%:%
%:%1076=484%:%
%:%1077=485%:%
%:%1078=485%:%
%:%1079=486%:%
%:%1080=486%:%
%:%1081=487%:%
%:%1082=487%:%
%:%1083=488%:%
%:%1084=488%:%
%:%1085=489%:%
%:%1086=489%:%
%:%1087=489%:%
%:%1088=490%:%
%:%1089=490%:%
%:%1090=491%:%
%:%1091=491%:%
%:%1092=492%:%
%:%1093=492%:%
%:%1094=492%:%
%:%1095=493%:%
%:%1096=493%:%
%:%1097=493%:%
%:%1098=494%:%
%:%1099=494%:%
%:%1100=495%:%
%:%1101=495%:%
%:%1102=496%:%
%:%1103=496%:%
%:%1104=497%:%
%:%1105=497%:%
%:%1106=498%:%
%:%1107=498%:%
%:%1108=499%:%
%:%1109=499%:%
%:%1110=499%:%
%:%1111=500%:%
%:%1112=500%:%
%:%1113=500%:%
%:%1114=500%:%
%:%1115=500%:%
%:%1116=501%:%
%:%1117=501%:%
%:%1118=501%:%
%:%1119=502%:%
%:%1120=502%:%
%:%1121=503%:%
%:%1122=503%:%
%:%1123=504%:%
%:%1124=504%:%
%:%1125=505%:%
%:%1126=505%:%
%:%1127=505%:%
%:%1128=506%:%
%:%1134=506%:%
%:%1137=507%:%
%:%1138=508%:%
%:%1139=508%:%
%:%1140=509%:%
%:%1141=510%:%
%:%1142=511%:%
%:%1143=512%:%
%:%1150=513%:%
%:%1151=513%:%
%:%1152=514%:%
%:%1153=514%:%
%:%1154=515%:%
%:%1155=515%:%
%:%1156=516%:%
%:%1157=516%:%
%:%1158=517%:%
%:%1159=517%:%
%:%1160=518%:%
%:%1161=518%:%
%:%1162=519%:%
%:%1163=519%:%
%:%1164=520%:%
%:%1165=520%:%
%:%1166=521%:%
%:%1167=521%:%
%:%1168=522%:%
%:%1169=522%:%
%:%1170=522%:%
%:%1171=523%:%
%:%1172=523%:%
%:%1173=524%:%
%:%1174=524%:%
%:%1175=525%:%
%:%1176=525%:%
%:%1177=526%:%
%:%1178=526%:%
%:%1179=527%:%
%:%1180=527%:%
%:%1181=528%:%
%:%1182=528%:%
%:%1183=528%:%
%:%1184=529%:%
%:%1190=529%:%
%:%1193=530%:%
%:%1194=531%:%
%:%1195=531%:%
%:%1196=532%:%
%:%1197=533%:%
%:%1198=534%:%
%:%1199=535%:%
%:%1201=537%:%
%:%1208=538%:%
%:%1209=538%:%
%:%1210=539%:%
%:%1211=539%:%
%:%1212=540%:%
%:%1213=541%:%
%:%1214=541%:%
%:%1215=542%:%
%:%1216=543%:%
%:%1217=543%:%
%:%1218=544%:%
%:%1219=544%:%
%:%1220=545%:%
%:%1221=545%:%
%:%1222=546%:%
%:%1223=546%:%
%:%1224=547%:%
%:%1225=547%:%
%:%1226=547%:%
%:%1227=548%:%
%:%1228=549%:%
%:%1229=549%:%
%:%1230=549%:%
%:%1231=549%:%
%:%1232=550%:%
%:%1233=551%:%
%:%1234=551%:%
%:%1235=552%:%
%:%1236=552%:%
%:%1237=553%:%
%:%1238=553%:%
%:%1239=554%:%
%:%1240=554%:%
%:%1241=555%:%
%:%1242=555%:%
%:%1243=556%:%
%:%1244=556%:%
%:%1245=557%:%
%:%1246=557%:%
%:%1247=558%:%
%:%1248=558%:%
%:%1249=558%:%
%:%1250=558%:%
%:%1251=559%:%
%:%1252=559%:%
%:%1253=559%:%
%:%1254=560%:%
%:%1255=560%:%
%:%1256=561%:%
%:%1257=561%:%
%:%1258=561%:%
%:%1259=562%:%
%:%1260=562%:%
%:%1261=563%:%
%:%1262=563%:%
%:%1263=563%:%
%:%1264=564%:%
%:%1265=564%:%
%:%1266=565%:%
%:%1267=565%:%
%:%1268=565%:%
%:%1269=566%:%
%:%1270=566%:%
%:%1271=567%:%
%:%1272=567%:%
%:%1273=568%:%
%:%1274=569%:%
%:%1275=569%:%
%:%1276=570%:%
%:%1277=571%:%
%:%1278=571%:%
%:%1279=572%:%
%:%1280=572%:%
%:%1281=573%:%
%:%1282=573%:%
%:%1283=574%:%
%:%1284=574%:%
%:%1285=575%:%
%:%1286=575%:%
%:%1287=576%:%
%:%1288=576%:%
%:%1289=577%:%
%:%1290=577%:%
%:%1291=577%:%
%:%1292=578%:%
%:%1293=578%:%
%:%1294=579%:%
%:%1295=579%:%
%:%1296=580%:%
%:%1297=580%:%
%:%1298=581%:%
%:%1299=581%:%
%:%1300=582%:%
%:%1301=582%:%
%:%1302=583%:%
%:%1303=583%:%
%:%1304=584%:%
%:%1305=584%:%
%:%1306=584%:%
%:%1307=585%:%
%:%1308=585%:%
%:%1309=585%:%
%:%1310=586%:%
%:%1311=586%:%
%:%1312=587%:%
%:%1313=587%:%
%:%1314=588%:%
%:%1315=588%:%
%:%1316=589%:%
%:%1317=589%:%
%:%1318=589%:%
%:%1319=590%:%
%:%1320=590%:%
%:%1321=591%:%
%:%1322=591%:%
%:%1323=592%:%
%:%1324=592%:%
%:%1325=593%:%
%:%1326=593%:%
%:%1327=594%:%
%:%1328=594%:%
%:%1329=595%:%
%:%1330=595%:%
%:%1331=595%:%
%:%1332=596%:%
%:%1333=597%:%
%:%1334=597%:%
%:%1335=598%:%
%:%1336=599%:%
%:%1337=599%:%
%:%1338=600%:%
%:%1339=601%:%
%:%1340=601%:%
%:%1341=602%:%
%:%1342=602%:%
%:%1343=602%:%
%:%1344=603%:%
%:%1345=604%:%
%:%1346=604%:%
%:%1347=605%:%
%:%1348=605%:%
%:%1349=606%:%
%:%1350=606%:%
%:%1351=607%:%
%:%1352=607%:%
%:%1353=608%:%
%:%1354=608%:%
%:%1355=609%:%
%:%1356=609%:%
%:%1357=610%:%
%:%1358=610%:%
%:%1359=610%:%
%:%1360=611%:%
%:%1361=611%:%
%:%1362=611%:%
%:%1363=612%:%
%:%1364=613%:%
%:%1365=613%:%
%:%1366=614%:%
%:%1367=615%:%
%:%1368=615%:%
%:%1369=616%:%
%:%1370=616%:%
%:%1371=617%:%
%:%1372=617%:%
%:%1373=618%:%
%:%1374=618%:%
%:%1375=619%:%
%:%1376=619%:%
%:%1377=620%:%
%:%1378=620%:%
%:%1379=620%:%
%:%1380=621%:%
%:%1386=621%:%
%:%1389=622%:%
%:%1390=623%:%
%:%1391=623%:%
%:%1392=624%:%
%:%1393=625%:%
%:%1394=626%:%
%:%1395=627%:%
%:%1396=628%:%
%:%1397=629%:%
%:%1398=630%:%
%:%1399=631%:%
%:%1400=632%:%
%:%1401=633%:%
%:%1404=634%:%
%:%1408=634%:%
%:%1409=634%:%
%:%1410=635%:%
%:%1411=635%:%
%:%1412=636%:%
%:%1413=636%:%
%:%1414=637%:%
%:%1415=637%:%
%:%1416=638%:%
%:%1417=638%:%
%:%1418=639%:%
%:%1419=639%:%
%:%1420=640%:%
%:%1421=640%:%
%:%1422=641%:%
%:%1423=641%:%
%:%1428=641%:%
%:%1431=642%:%
%:%1432=643%:%
%:%1433=643%:%
%:%1434=644%:%
%:%1435=645%:%
%:%1436=646%:%
%:%1437=647%:%
%:%1438=648%:%
%:%1439=649%:%
%:%1446=650%:%
%:%1447=650%:%
%:%1448=651%:%
%:%1449=651%:%
%:%1450=652%:%
%:%1451=652%:%
%:%1452=652%:%
%:%1453=652%:%
%:%1454=653%:%
%:%1455=653%:%
%:%1456=653%:%
%:%1457=653%:%
%:%1458=654%:%
%:%1459=654%:%
%:%1460=654%:%
%:%1461=655%:%
%:%1462=655%:%
%:%1463=656%:%
%:%1464=656%:%
%:%1465=657%:%
%:%1466=657%:%
%:%1467=658%:%
%:%1468=658%:%
%:%1469=659%:%
%:%1470=660%:%
%:%1471=660%:%
%:%1472=661%:%
%:%1474=663%:%
%:%1475=664%:%
%:%1476=665%:%
%:%1477=665%:%
%:%1478=666%:%
%:%1479=667%:%
%:%1480=667%:%
%:%1481=668%:%
%:%1482=669%:%
%:%1483=669%:%
%:%1484=670%:%
%:%1485=671%:%
%:%1486=672%:%
%:%1487=672%:%
%:%1488=672%:%
%:%1489=672%:%
%:%1490=673%:%
%:%1491=673%:%
%:%1492=673%:%
%:%1493=673%:%
%:%1494=674%:%
%:%1495=675%:%
%:%1496=675%:%
%:%1497=675%:%
%:%1498=675%:%
%:%1499=676%:%
%:%1500=677%:%
%:%1501=677%:%
%:%1502=678%:%
%:%1503=678%:%
%:%1504=679%:%
%:%1505=679%:%
%:%1506=680%:%
%:%1507=680%:%
%:%1508=681%:%
%:%1509=681%:%
%:%1510=681%:%
%:%1511=682%:%
%:%1512=682%:%
%:%1513=683%:%
%:%1514=683%:%
%:%1515=684%:%
%:%1516=684%:%
%:%1517=684%:%
%:%1518=684%:%
%:%1519=685%:%
%:%1520=685%:%
%:%1521=686%:%
%:%1522=686%:%
%:%1523=686%:%
%:%1524=687%:%
%:%1525=687%:%
%:%1526=688%:%
%:%1527=688%:%
%:%1528=689%:%
%:%1529=690%:%
%:%1530=690%:%
%:%1531=691%:%
%:%1532=691%:%
%:%1533=692%:%
%:%1534=692%:%
%:%1535=693%:%
%:%1536=693%:%
%:%1537=693%:%
%:%1538=694%:%
%:%1539=694%:%
%:%1540=695%:%
%:%1541=695%:%
%:%1542=696%:%
%:%1543=696%:%
%:%1544=697%:%
%:%1545=697%:%
%:%1546=698%:%
%:%1547=699%:%
%:%1548=699%:%
%:%1549=700%:%
%:%1550=701%:%
%:%1551=701%:%
%:%1552=702%:%
%:%1553=702%:%
%:%1554=703%:%
%:%1555=704%:%
%:%1556=704%:%
%:%1557=705%:%
%:%1558=705%:%
%:%1559=706%:%
%:%1560=707%:%
%:%1561=707%:%
%:%1562=708%:%
%:%1563=708%:%
%:%1564=709%:%
%:%1565=709%:%
%:%1566=710%:%
%:%1567=710%:%
%:%1568=711%:%
%:%1569=711%:%
%:%1570=712%:%
%:%1571=712%:%
%:%1572=713%:%
%:%1573=713%:%
%:%1574=714%:%
%:%1575=714%:%
%:%1576=715%:%
%:%1577=716%:%
%:%1578=716%:%
%:%1579=717%:%
%:%1580=718%:%
%:%1581=718%:%
%:%1582=719%:%
%:%1583=719%:%
%:%1584=720%:%
%:%1585=721%:%
%:%1586=721%:%
%:%1588=723%:%
%:%1589=724%:%
%:%1590=724%:%
%:%1591=725%:%
%:%1592=725%:%
%:%1593=726%:%
%:%1594=726%:%
%:%1595=727%:%
%:%1596=728%:%
%:%1597=728%:%
%:%1598=729%:%
%:%1599=729%:%
%:%1600=729%:%
%:%1601=730%:%
%:%1602=730%:%
%:%1603=730%:%
%:%1604=731%:%
%:%1605=731%:%
%:%1606=732%:%
%:%1607=732%:%
%:%1608=733%:%
%:%1609=733%:%
%:%1610=734%:%
%:%1611=734%:%
%:%1612=734%:%
%:%1613=735%:%
%:%1614=735%:%
%:%1615=736%:%
%:%1616=736%:%
%:%1617=736%:%
%:%1618=737%:%
%:%1619=737%:%
%:%1620=738%:%
%:%1621=738%:%
%:%1622=739%:%
%:%1623=740%:%
%:%1624=740%:%
%:%1625=741%:%
%:%1626=741%:%
%:%1627=741%:%
%:%1628=742%:%
%:%1629=742%:%
%:%1630=743%:%
%:%1631=743%:%
%:%1632=744%:%
%:%1633=744%:%
%:%1634=744%:%
%:%1635=745%:%
%:%1636=745%:%
%:%1637=746%:%
%:%1638=746%:%
%:%1639=746%:%
%:%1640=747%:%
%:%1641=747%:%
%:%1642=748%:%
%:%1643=749%:%
%:%1644=749%:%
%:%1646=751%:%
%:%1647=752%:%
%:%1648=752%:%
%:%1649=753%:%
%:%1650=753%:%
%:%1651=754%:%
%:%1652=754%:%
%:%1653=755%:%
%:%1654=756%:%
%:%1655=756%:%
%:%1656=757%:%
%:%1657=757%:%
%:%1658=757%:%
%:%1659=758%:%
%:%1660=758%:%
%:%1661=758%:%
%:%1662=759%:%
%:%1663=760%:%
%:%1664=760%:%
%:%1665=761%:%
%:%1666=761%:%
%:%1667=762%:%
%:%1668=763%:%
%:%1669=763%:%
%:%1671=765%:%
%:%1672=766%:%
%:%1673=766%:%
%:%1674=767%:%
%:%1675=767%:%
%:%1676=768%:%
%:%1677=768%:%
%:%1678=769%:%
%:%1679=769%:%
%:%1680=770%:%
%:%1681=770%:%
%:%1682=771%:%
%:%1683=772%:%
%:%1684=772%:%
%:%1686=774%:%
%:%1687=775%:%
%:%1688=775%:%
%:%1689=776%:%
%:%1690=776%:%
%:%1691=777%:%
%:%1692=777%:%
%:%1693=778%:%
%:%1694=778%:%
%:%1695=779%:%
%:%1696=780%:%
%:%1697=780%:%
%:%1698=781%:%
%:%1699=781%:%
%:%1700=782%:%
%:%1701=782%:%
%:%1702=783%:%
%:%1703=783%:%
%:%1704=784%:%
%:%1705=784%:%
%:%1706=785%:%
%:%1707=785%:%
%:%1708=786%:%
%:%1709=786%:%
%:%1710=787%:%
%:%1711=787%:%
%:%1712=788%:%
%:%1713=788%:%
%:%1714=789%:%
%:%1715=789%:%
%:%1716=790%:%
%:%1717=790%:%
%:%1718=791%:%
%:%1719=791%:%
%:%1720=791%:%
%:%1721=792%:%
%:%1722=792%:%
%:%1723=793%:%
%:%1724=793%:%
%:%1725=794%:%
%:%1726=794%:%
%:%1727=795%:%
%:%1728=795%:%
%:%1729=795%:%
%:%1730=796%:%
%:%1731=796%:%
%:%1732=797%:%
%:%1733=797%:%
%:%1734=798%:%
%:%1735=798%:%
%:%1736=799%:%
%:%1737=799%:%
%:%1738=800%:%
%:%1739=800%:%
%:%1740=800%:%
%:%1741=801%:%
%:%1742=801%:%
%:%1743=802%:%
%:%1744=802%:%
%:%1745=803%:%
%:%1746=803%:%
%:%1747=804%:%
%:%1748=804%:%
%:%1749=804%:%
%:%1750=804%:%
%:%1751=805%:%
%:%1752=805%:%
%:%1753=806%:%
%:%1754=807%:%
%:%1755=807%:%
%:%1756=808%:%
%:%1757=809%:%
%:%1758=809%:%
%:%1759=810%:%
%:%1760=810%:%
%:%1761=811%:%
%:%1762=811%:%
%:%1763=812%:%
%:%1764=812%:%
%:%1765=813%:%
%:%1766=813%:%
%:%1767=813%:%
%:%1768=814%:%
%:%1769=814%:%
%:%1770=814%:%
%:%1771=815%:%
%:%1772=815%:%
%:%1773=816%:%
%:%1774=816%:%
%:%1775=817%:%
%:%1776=817%:%
%:%1777=818%:%
%:%1778=819%:%
%:%1779=819%:%
%:%1780=820%:%
%:%1781=820%:%
%:%1782=820%:%
%:%1783=821%:%
%:%1784=821%:%
%:%1785=822%:%
%:%1786=822%:%
%:%1787=823%:%
%:%1788=823%:%
%:%1789=824%:%
%:%1790=824%:%
%:%1791=824%:%
%:%1792=824%:%
%:%1793=825%:%
%:%1794=825%:%
%:%1795=826%:%
%:%1796=826%:%
%:%1797=827%:%
%:%1798=827%:%
%:%1799=827%:%
%:%1800=828%:%
%:%1801=828%:%
%:%1802=829%:%
%:%1803=829%:%
%:%1804=830%:%
%:%1805=831%:%
%:%1806=831%:%
%:%1807=832%:%
%:%1808=832%:%
%:%1809=833%:%
%:%1810=833%:%
%:%1811=834%:%
%:%1812=834%:%
%:%1813=835%:%
%:%1814=835%:%
%:%1815=836%:%
%:%1816=836%:%
%:%1817=837%:%
%:%1818=837%:%
%:%1819=837%:%
%:%1820=838%:%
%:%1821=838%:%
%:%1822=838%:%
%:%1823=839%:%
%:%1824=839%:%
%:%1825=840%:%
%:%1826=840%:%
%:%1827=841%:%
%:%1828=841%:%
%:%1829=842%:%
%:%1830=842%:%
%:%1831=843%:%
%:%1832=843%:%
%:%1833=844%:%
%:%1834=844%:%
%:%1835=845%:%
%:%1836=845%:%
%:%1837=846%:%
%:%1838=846%:%
%:%1839=847%:%
%:%1840=847%:%
%:%1841=848%:%
%:%1842=848%:%
%:%1843=848%:%
%:%1844=849%:%
%:%1845=849%:%
%:%1846=849%:%
%:%1847=850%:%
%:%1853=850%:%
%:%1856=851%:%
%:%1857=852%:%
%:%1858=852%:%
%:%1859=853%:%
%:%1867=861%:%
%:%1868=862%:%
%:%1869=863%:%
%:%1870=863%:%
%:%1871=864%:%
%:%1876=869%:%
%:%1877=870%:%
%:%1878=871%:%
%:%1879=871%:%
%:%1882=872%:%
%:%1886=872%:%
%:%1887=872%:%
%:%1888=873%:%
%:%1889=873%:%
%:%1890=874%:%
%:%1891=874%:%
%:%1892=875%:%
%:%1893=875%:%
%:%1894=876%:%
%:%1895=876%:%
%:%1896=877%:%
%:%1897=877%:%
%:%1898=878%:%
%:%1899=878%:%
%:%1904=878%:%
%:%1907=879%:%
%:%1908=880%:%
%:%1909=880%:%
%:%1910=881%:%
%:%1911=882%:%
%:%1912=883%:%
%:%1913=884%:%
%:%1914=885%:%
%:%1915=886%:%
%:%1922=887%:%
%:%1923=887%:%
%:%1924=888%:%
%:%1925=888%:%
%:%1926=889%:%
%:%1927=889%:%
%:%1928=890%:%
%:%1929=890%:%
%:%1930=890%:%
%:%1931=891%:%
%:%1932=891%:%
%:%1933=892%:%
%:%1934=892%:%
%:%1935=893%:%
%:%1936=893%:%
%:%1937=894%:%
%:%1938=895%:%
%:%1939=895%:%
%:%1940=896%:%
%:%1941=896%:%
%:%1942=897%:%
%:%1943=897%:%
%:%1944=898%:%
%:%1945=898%:%
%:%1946=899%:%
%:%1947=899%:%
%:%1948=899%:%
%:%1949=899%:%
%:%1950=900%:%
%:%1951=900%:%
%:%1952=900%:%
%:%1953=900%:%
%:%1954=901%:%
%:%1955=902%:%
%:%1956=902%:%
%:%1957=903%:%
%:%1958=903%:%
%:%1959=904%:%
%:%1960=904%:%
%:%1961=905%:%
%:%1962=905%:%
%:%1963=906%:%
%:%1964=906%:%
%:%1965=907%:%
%:%1966=907%:%
%:%1967=907%:%
%:%1968=908%:%
%:%1969=908%:%
%:%1970=909%:%
%:%1971=909%:%
%:%1972=909%:%
%:%1973=909%:%
%:%1974=910%:%
%:%1975=910%:%
%:%1976=911%:%
%:%1977=912%:%
%:%1978=912%:%
%:%1982=916%:%
%:%1983=917%:%
%:%1984=917%:%
%:%1985=918%:%
%:%1986=918%:%
%:%1987=919%:%
%:%1988=919%:%
%:%1989=920%:%
%:%1990=920%:%
%:%1991=921%:%
%:%1992=921%:%
%:%1993=922%:%
%:%1994=922%:%
%:%1995=923%:%
%:%1996=923%:%
%:%1997=924%:%
%:%1998=924%:%
%:%1999=925%:%
%:%2000=925%:%
%:%2001=926%:%
%:%2002=926%:%
%:%2003=927%:%
%:%2004=927%:%
%:%2005=927%:%
%:%2006=928%:%
%:%2007=928%:%
%:%2008=929%:%
%:%2009=929%:%
%:%2010=930%:%
%:%2011=930%:%
%:%2012=931%:%
%:%2013=931%:%
%:%2014=931%:%
%:%2016=933%:%
%:%2017=934%:%
%:%2018=934%:%
%:%2019=935%:%
%:%2020=935%:%
%:%2021=936%:%
%:%2022=936%:%
%:%2023=937%:%
%:%2024=938%:%
%:%2025=938%:%
%:%2026=939%:%
%:%2027=939%:%
%:%2028=940%:%
%:%2029=940%:%
%:%2030=941%:%
%:%2031=941%:%
%:%2032=942%:%
%:%2033=943%:%
%:%2034=943%:%
%:%2035=944%:%
%:%2036=945%:%
%:%2037=945%:%
%:%2038=946%:%
%:%2039=946%:%
%:%2040=947%:%
%:%2041=947%:%
%:%2042=948%:%
%:%2043=949%:%
%:%2044=949%:%
%:%2045=949%:%
%:%2046=949%:%
%:%2047=950%:%
%:%2048=950%:%
%:%2049=950%:%
%:%2050=950%:%
%:%2051=951%:%
%:%2052=951%:%
%:%2053=951%:%
%:%2054=951%:%
%:%2055=952%:%
%:%2056=953%:%
%:%2057=953%:%
%:%2058=954%:%
%:%2059=955%:%
%:%2060=955%:%
%:%2061=956%:%
%:%2062=956%:%
%:%2063=957%:%
%:%2064=957%:%
%:%2065=958%:%
%:%2066=958%:%
%:%2067=959%:%
%:%2068=959%:%
%:%2069=959%:%
%:%2070=960%:%
%:%2071=960%:%
%:%2072=961%:%
%:%2073=961%:%
%:%2074=962%:%
%:%2075=962%:%
%:%2076=963%:%
%:%2077=963%:%
%:%2078=963%:%
%:%2079=964%:%
%:%2080=964%:%
%:%2081=964%:%
%:%2082=965%:%
%:%2083=965%:%
%:%2084=965%:%
%:%2085=965%:%
%:%2086=966%:%
%:%2087=966%:%
%:%2092=971%:%
%:%2093=972%:%
%:%2094=972%:%
%:%2095=973%:%
%:%2096=974%:%
%:%2097=974%:%
%:%2098=975%:%
%:%2099=975%:%
%:%2100=976%:%
%:%2101=976%:%
%:%2102=977%:%
%:%2103=977%:%
%:%2104=978%:%
%:%2105=978%:%
%:%2106=979%:%
%:%2107=979%:%
%:%2108=980%:%
%:%2109=980%:%
%:%2110=981%:%
%:%2111=981%:%
%:%2112=982%:%
%:%2113=982%:%
%:%2114=983%:%
%:%2115=983%:%
%:%2116=983%:%
%:%2117=984%:%
%:%2118=984%:%
%:%2119=984%:%
%:%2120=985%:%
%:%2121=985%:%
%:%2122=986%:%
%:%2123=986%:%
%:%2124=986%:%
%:%2125=987%:%
%:%2126=987%:%
%:%2127=988%:%
%:%2128=988%:%
%:%2129=989%:%
%:%2130=990%:%
%:%2131=990%:%
%:%2132=991%:%
%:%2133=991%:%
%:%2134=992%:%
%:%2135=992%:%
%:%2136=993%:%
%:%2137=993%:%
%:%2138=994%:%
%:%2139=994%:%
%:%2140=995%:%
%:%2141=995%:%
%:%2142=996%:%
%:%2148=996%:%
%:%2151=997%:%
%:%2152=998%:%
%:%2153=998%:%
%:%2154=999%:%
%:%2156=1001%:%
%:%2157=1002%:%
%:%2164=1003%:%
%:%2165=1003%:%
%:%2166=1004%:%
%:%2167=1004%:%
%:%2168=1005%:%
%:%2169=1005%:%
%:%2170=1006%:%
%:%2171=1006%:%
%:%2172=1007%:%
%:%2173=1007%:%
%:%2174=1008%:%
%:%2175=1008%:%
%:%2176=1009%:%
%:%2177=1010%:%
%:%2178=1010%:%
%:%2179=1011%:%
%:%2180=1012%:%
%:%2181=1013%:%
%:%2182=1013%:%
%:%2183=1014%:%
%:%2184=1015%:%
%:%2185=1015%:%
%:%2186=1016%:%
%:%2187=1016%:%
%:%2188=1017%:%
%:%2189=1017%:%
%:%2190=1018%:%
%:%2191=1018%:%
%:%2192=1019%:%
%:%2193=1020%:%
%:%2194=1020%:%
%:%2195=1021%:%
%:%2196=1021%:%
%:%2197=1022%:%
%:%2198=1022%:%
%:%2199=1023%:%
%:%2200=1023%:%
%:%2201=1024%:%
%:%2202=1024%:%
%:%2203=1025%:%
%:%2204=1026%:%
%:%2205=1026%:%
%:%2206=1027%:%
%:%2207=1027%:%
%:%2208=1028%:%
%:%2209=1028%:%
%:%2210=1029%:%
%:%2211=1029%:%
%:%2212=1030%:%
%:%2213=1030%:%
%:%2214=1031%:%
%:%2215=1031%:%
%:%2216=1032%:%
%:%2217=1033%:%
%:%2218=1033%:%
%:%2219=1034%:%
%:%2220=1034%:%
%:%2221=1035%:%
%:%2222=1035%:%
%:%2223=1036%:%
%:%2224=1036%:%
%:%2225=1037%:%
%:%2226=1037%:%
%:%2227=1038%:%
%:%2228=1038%:%
%:%2229=1039%:%
%:%2230=1039%:%
%:%2231=1040%:%
%:%2232=1041%:%
%:%2233=1041%:%
%:%2234=1042%:%
%:%2235=1042%:%
%:%2236=1043%:%
%:%2237=1043%:%
%:%2238=1044%:%
%:%2239=1044%:%
%:%2240=1045%:%
%:%2241=1045%:%
%:%2242=1046%:%
%:%2243=1046%:%
%:%2244=1047%:%
%:%2245=1047%:%
%:%2246=1048%:%
%:%2247=1049%:%
%:%2248=1049%:%
%:%2249=1050%:%
%:%2250=1050%:%
%:%2251=1051%:%
%:%2252=1051%:%
%:%2253=1052%:%
%:%2254=1052%:%
%:%2255=1053%:%
%:%2256=1053%:%
%:%2257=1054%:%
%:%2258=1054%:%
%:%2259=1055%:%
%:%2260=1055%:%
%:%2261=1056%:%
%:%2262=1057%:%
%:%2263=1057%:%
%:%2264=1058%:%
%:%2265=1058%:%
%:%2266=1059%:%
%:%2267=1059%:%
%:%2268=1060%:%
%:%2269=1060%:%
%:%2270=1061%:%
%:%2271=1061%:%
%:%2272=1062%:%
%:%2273=1062%:%
%:%2274=1063%:%
%:%2275=1063%:%
%:%2276=1064%:%
%:%2277=1065%:%
%:%2278=1065%:%
%:%2279=1066%:%
%:%2280=1066%:%
%:%2281=1067%:%
%:%2282=1067%:%
%:%2283=1068%:%
%:%2284=1068%:%
%:%2285=1069%:%
%:%2286=1070%:%
%:%2287=1070%:%
%:%2288=1071%:%
%:%2289=1071%:%
%:%2290=1072%:%
%:%2291=1072%:%
%:%2292=1073%:%
%:%2293=1073%:%
%:%2294=1074%:%
%:%2295=1074%:%
%:%2296=1075%:%
%:%2297=1075%:%
%:%2298=1076%:%
%:%2299=1077%:%
%:%2300=1077%:%
%:%2301=1078%:%
%:%2302=1078%:%
%:%2303=1079%:%
%:%2304=1079%:%
%:%2305=1080%:%
%:%2306=1080%:%
%:%2307=1081%:%
%:%2308=1082%:%
%:%2309=1082%:%
%:%2310=1083%:%
%:%2311=1083%:%
%:%2312=1084%:%
%:%2313=1084%:%
%:%2314=1085%:%
%:%2315=1085%:%
%:%2316=1086%:%
%:%2317=1087%:%
%:%2318=1087%:%
%:%2319=1088%:%
%:%2320=1088%:%
%:%2321=1089%:%
%:%2322=1089%:%
%:%2323=1090%:%
%:%2324=1090%:%
%:%2325=1091%:%
%:%2326=1091%:%
%:%2327=1092%:%
%:%2328=1093%:%
%:%2329=1093%:%
%:%2330=1094%:%
%:%2331=1094%:%
%:%2332=1095%:%
%:%2333=1095%:%
%:%2334=1096%:%
%:%2335=1096%:%
%:%2336=1097%:%
%:%2337=1098%:%
%:%2338=1098%:%
%:%2339=1099%:%
%:%2340=1099%:%
%:%2341=1100%:%
%:%2342=1100%:%
%:%2343=1101%:%
%:%2344=1101%:%
%:%2345=1102%:%
%:%2346=1102%:%
%:%2347=1103%:%
%:%2348=1104%:%
%:%2349=1104%:%
%:%2350=1105%:%
%:%2351=1105%:%
%:%2352=1106%:%
%:%2353=1107%:%
%:%2354=1107%:%
%:%2355=1108%:%
%:%2356=1108%:%
%:%2357=1109%:%
%:%2358=1109%:%
%:%2359=1110%:%
%:%2360=1111%:%
%:%2361=1111%:%
%:%2362=1112%:%
%:%2363=1113%:%
%:%2364=1113%:%
%:%2365=1114%:%
%:%2366=1114%:%
%:%2367=1115%:%
%:%2368=1115%:%
%:%2369=1116%:%
%:%2370=1116%:%
%:%2371=1117%:%
%:%2372=1117%:%
%:%2373=1118%:%
%:%2374=1119%:%
%:%2375=1119%:%
%:%2376=1120%:%
%:%2377=1121%:%
%:%2378=1121%:%
%:%2379=1122%:%
%:%2380=1122%:%
%:%2381=1123%:%
%:%2382=1123%:%
%:%2383=1124%:%
%:%2384=1124%:%
%:%2385=1125%:%
%:%2386=1125%:%
%:%2387=1126%:%
%:%2388=1126%:%
%:%2389=1127%:%
%:%2390=1128%:%
%:%2391=1128%:%
%:%2393=1130%:%
%:%2394=1131%:%
%:%2395=1131%:%
%:%2396=1132%:%
%:%2397=1132%:%
%:%2398=1133%:%
%:%2399=1133%:%
%:%2400=1134%:%
%:%2401=1134%:%
%:%2402=1135%:%
%:%2403=1135%:%
%:%2404=1136%:%
%:%2405=1136%:%
%:%2406=1137%:%
%:%2407=1137%:%
%:%2408=1138%:%
%:%2409=1138%:%
%:%2410=1139%:%
%:%2411=1139%:%
%:%2412=1140%:%
%:%2413=1140%:%
%:%2414=1141%:%
%:%2415=1141%:%
%:%2416=1142%:%
%:%2417=1142%:%
%:%2418=1143%:%
%:%2419=1143%:%
%:%2420=1144%:%
%:%2421=1145%:%
%:%2422=1145%:%
%:%2423=1146%:%
%:%2424=1146%:%
%:%2425=1147%:%
%:%2426=1147%:%
%:%2427=1148%:%
%:%2428=1148%:%
%:%2429=1149%:%
%:%2430=1149%:%
%:%2431=1150%:%
%:%2432=1150%:%
%:%2433=1151%:%
%:%2434=1152%:%
%:%2435=1152%:%
%:%2436=1153%:%
%:%2437=1153%:%
%:%2438=1154%:%
%:%2439=1154%:%
%:%2440=1155%:%
%:%2441=1155%:%
%:%2442=1156%:%
%:%2443=1156%:%
%:%2444=1157%:%
%:%2445=1157%:%
%:%2446=1158%:%
%:%2447=1158%:%
%:%2448=1159%:%
%:%2449=1160%:%
%:%2450=1160%:%
%:%2451=1161%:%
%:%2452=1161%:%
%:%2453=1162%:%
%:%2454=1162%:%
%:%2455=1163%:%
%:%2456=1163%:%
%:%2457=1164%:%
%:%2458=1164%:%
%:%2459=1165%:%
%:%2460=1165%:%
%:%2461=1166%:%
%:%2462=1167%:%
%:%2463=1167%:%
%:%2464=1168%:%
%:%2465=1168%:%
%:%2466=1169%:%
%:%2467=1169%:%
%:%2468=1170%:%
%:%2469=1170%:%
%:%2470=1171%:%
%:%2471=1171%:%
%:%2472=1172%:%
%:%2473=1172%:%
%:%2474=1173%:%
%:%2475=1174%:%
%:%2476=1174%:%
%:%2477=1175%:%
%:%2478=1176%:%
%:%2479=1176%:%
%:%2480=1177%:%
%:%2481=1177%:%
%:%2482=1178%:%
%:%2483=1178%:%
%:%2484=1179%:%
%:%2485=1179%:%
%:%2486=1180%:%
%:%2487=1180%:%
%:%2488=1181%:%
%:%2489=1181%:%
%:%2490=1182%:%
%:%2491=1182%:%
%:%2492=1183%:%
%:%2493=1184%:%
%:%2494=1184%:%
%:%2495=1185%:%
%:%2496=1185%:%
%:%2497=1186%:%
%:%2498=1186%:%
%:%2499=1187%:%
%:%2500=1187%:%
%:%2501=1187%:%
%:%2502=1188%:%
%:%2503=1188%:%
%:%2504=1189%:%
%:%2505=1189%:%
%:%2506=1190%:%
%:%2507=1190%:%
%:%2508=1191%:%
%:%2509=1191%:%
%:%2510=1192%:%
%:%2511=1192%:%
%:%2512=1193%:%
%:%2513=1193%:%
%:%2514=1194%:%
%:%2515=1194%:%
%:%2516=1195%:%
%:%2517=1195%:%
%:%2518=1195%:%
%:%2519=1196%:%
%:%2520=1196%:%
%:%2521=1197%:%
%:%2522=1197%:%
%:%2523=1198%:%
%:%2524=1198%:%
%:%2525=1199%:%
%:%2526=1199%:%
%:%2527=1199%:%
%:%2528=1199%:%
%:%2529=1200%:%
%:%2535=1200%:%
%:%2540=1201%:%
%:%2545=1202%:%
