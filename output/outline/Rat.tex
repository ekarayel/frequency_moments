%
\begin{isabellebody}%
\setisabellecontext{Rat}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Rational numbers%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Rat\isanewline
\ \ \isakeyword{imports}\ Archimedean{\isacharunderscore}{\kern0pt}Field\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Rational numbers as quotient%
}
\isamarkuptrue%
%
\isamarkupsubsubsection{Construction of the type of rational numbers%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ ratrel\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}int\ {\isasymtimes}\ int{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}int\ {\isasymtimes}\ int{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}ratrel\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ y{\isachardot}{\kern0pt}\ snd\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymand}\ snd\ y\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymand}\ fst\ x\ {\isacharasterisk}{\kern0pt}\ snd\ y\ {\isacharequal}{\kern0pt}\ fst\ y\ {\isacharasterisk}{\kern0pt}\ snd\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ ratrel{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ratrel\ x\ y\ {\isasymlongleftrightarrow}\ snd\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymand}\ snd\ y\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymand}\ fst\ x\ {\isacharasterisk}{\kern0pt}\ snd\ y\ {\isacharequal}{\kern0pt}\ fst\ y\ {\isacharasterisk}{\kern0pt}\ snd\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ ratrel{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ exists{\isacharunderscore}{\kern0pt}ratrel{\isacharunderscore}{\kern0pt}refl{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ ratrel\ x\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ one{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}zero{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ symp{\isacharunderscore}{\kern0pt}ratrel{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}symp\ ratrel{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ ratrel{\isacharunderscore}{\kern0pt}def\ symp{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ transp{\isacharunderscore}{\kern0pt}ratrel{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}transp\ ratrel{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ transpI{\isacharcomma}{\kern0pt}\ unfold\ split{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ a\ b\ a{\isacharprime}{\kern0pt}\ b{\isacharprime}{\kern0pt}\ a{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ratrel\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ratrel\ {\isacharparenleft}{\kern0pt}a{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ {\isacharasterisk}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ {\isacharasterisk}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharasterisk}{\kern0pt}\ b{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ b{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ b{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ {\isacharasterisk}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ b{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b{\isacharprime}{\kern0pt}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharasterisk}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ b{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}ratrel\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ part{\isacharunderscore}{\kern0pt}equivp{\isacharunderscore}{\kern0pt}ratrel{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}part{\isacharunderscore}{\kern0pt}equivp\ ratrel{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ part{\isacharunderscore}{\kern0pt}equivpI\ {\isacharbrackleft}{\kern0pt}OF\ exists{\isacharunderscore}{\kern0pt}ratrel{\isacharunderscore}{\kern0pt}refl\ symp{\isacharunderscore}{\kern0pt}ratrel\ transp{\isacharunderscore}{\kern0pt}ratrel{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{quotient{\isacharunderscore}{\kern0pt}type}\isamarkupfalse%
\ rat\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}int\ {\isasymtimes}\ int{\isachardoublequoteclose}\ {\isacharslash}{\kern0pt}\ partial{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ratrel{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{morphisms}\ Rep{\isacharunderscore}{\kern0pt}Rat\ Abs{\isacharunderscore}{\kern0pt}Rat\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ part{\isacharunderscore}{\kern0pt}equivp{\isacharunderscore}{\kern0pt}ratrel{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Domainp{\isacharunderscore}{\kern0pt}cr{\isacharunderscore}{\kern0pt}rat\ {\isacharbrackleft}{\kern0pt}transfer{\isacharunderscore}{\kern0pt}domain{\isacharunderscore}{\kern0pt}rule{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Domainp\ pcr{\isacharunderscore}{\kern0pt}rat\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ snd\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ rat{\isachardot}{\kern0pt}domain{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Representation and basic operations%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ Fract\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}int\ {\isasymRightarrow}\ int\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{is}\ {\isachardoublequoteopen}{\isasymlambda}a\ b{\isachardot}{\kern0pt}\ if\ b\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eq{\isacharunderscore}{\kern0pt}rat{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymAnd}a\ b\ c\ d{\isachardot}{\kern0pt}\ b\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ d\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ Fract\ a\ b\ {\isacharequal}{\kern0pt}\ Fract\ c\ d\ {\isasymlongleftrightarrow}\ a\ {\isacharasterisk}{\kern0pt}\ d\ {\isacharequal}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}{\isasymAnd}a{\isachardot}{\kern0pt}\ Fract\ a\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ Fract\ {\isadigit{0}}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}{\isasymAnd}a\ c{\isachardot}{\kern0pt}\ Fract\ {\isadigit{0}}\ a\ {\isacharequal}{\kern0pt}\ Fract\ {\isadigit{0}}\ c{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}transfer{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rat{\isacharunderscore}{\kern0pt}cases\ {\isacharbrackleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}names\ Fract{\isacharcomma}{\kern0pt}\ cases\ type{\isacharcolon}{\kern0pt}\ rat{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ that{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}a\ b{\isachardot}{\kern0pt}\ q\ {\isacharequal}{\kern0pt}\ Fract\ a\ b\ {\isasymLongrightarrow}\ b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ coprime\ a\ b\ {\isasymLongrightarrow}\ C{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ C\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ a\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\ \isakeyword{where}\ q{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ Fract\ a\ b{\isachardoublequoteclose}\ \isakeyword{and}\ b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ transfer\ simp\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}a\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}a\ div\ gcd\ a\ b{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}b\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}b\ div\ gcd\ a\ b{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ b\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}b\ {\isacharasterisk}{\kern0pt}\ gcd\ a\ b\ {\isacharequal}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ b\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}b\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ q\ b\ \isacommand{have}\isamarkupfalse%
\ q{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharquery}{\kern0pt}a\ {\isacharquery}{\kern0pt}b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ eq{\isacharunderscore}{\kern0pt}rat\ dvd{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}mult\ mult{\isachardot}{\kern0pt}commute\ {\isacharbrackleft}{\kern0pt}of\ a{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ b\ \isacommand{have}\isamarkupfalse%
\ coprime{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}coprime\ {\isacharquery}{\kern0pt}a\ {\isacharquery}{\kern0pt}b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ div{\isacharunderscore}{\kern0pt}gcd{\isacharunderscore}{\kern0pt}coprime{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ C\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ nonneg{\isadigit{1}}{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ q{\isadigit{2}}\ this\ coprime\ \isacommand{show}\isamarkupfalse%
\ C\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ that{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isacharquery}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isacharquery}{\kern0pt}b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ q{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ transfer\ simp\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ False\ b\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isacharquery}{\kern0pt}b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ pos{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ coprime\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}coprime\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isacharquery}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isacharquery}{\kern0pt}b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ C\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ that{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rat{\isacharunderscore}{\kern0pt}induct\ {\isacharbrackleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}names\ Fract{\isacharcomma}{\kern0pt}\ induct\ type{\isacharcolon}{\kern0pt}\ rat{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymAnd}a\ b{\isachardot}{\kern0pt}\ b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ coprime\ a\ b\ {\isasymLongrightarrow}\ P\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}P\ q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ q{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{instantiation}\isamarkupfalse%
\ rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ field\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}rat{\isachardoublequoteclose}\ \isakeyword{is}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}rat{\isachardoublequoteclose}\ \isakeyword{is}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Zero{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharequal}{\kern0pt}\ Fract\ {\isadigit{0}}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ One{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ Fract\ {\isadigit{1}}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ plus{\isacharunderscore}{\kern0pt}rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}rat\ {\isasymRightarrow}\ rat\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{is}\ {\isachardoublequoteopen}{\isasymlambda}x\ y{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ x\ {\isacharasterisk}{\kern0pt}\ snd\ y\ {\isacharplus}{\kern0pt}\ fst\ y\ {\isacharasterisk}{\kern0pt}\ snd\ x{\isacharcomma}{\kern0pt}\ snd\ x\ {\isacharasterisk}{\kern0pt}\ snd\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ distrib{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ ac{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}rat\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}b\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}d\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}Fract\ a\ b\ {\isacharplus}{\kern0pt}\ Fract\ c\ d\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}a\ {\isacharasterisk}{\kern0pt}\ d\ {\isacharplus}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b\ {\isacharasterisk}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ transfer\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ uminus{\isacharunderscore}{\kern0pt}rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}rat\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\ \isakeyword{is}\ {\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ fst\ x{\isacharcomma}{\kern0pt}\ snd\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ minus{\isacharunderscore}{\kern0pt}rat\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ Fract\ a\ b\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ minus{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}cancel\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Fract\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Fract\ a\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}b\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ eq{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ diff{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}q\ {\isacharminus}{\kern0pt}\ r\ {\isacharequal}{\kern0pt}\ q\ {\isacharplus}{\kern0pt}\ {\isacharminus}{\kern0pt}\ r{\isachardoublequoteclose}\ \isakeyword{for}\ q\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ diff{\isacharunderscore}{\kern0pt}rat\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}b\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ d\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ Fract\ a\ b\ {\isacharminus}{\kern0pt}\ Fract\ c\ d\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}a\ {\isacharasterisk}{\kern0pt}\ d\ {\isacharminus}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b\ {\isacharasterisk}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ diff{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ times{\isacharunderscore}{\kern0pt}rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}rat\ {\isasymRightarrow}\ rat\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{is}\ {\isachardoublequoteopen}{\isasymlambda}x\ y{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ x\ {\isacharasterisk}{\kern0pt}\ fst\ y{\isacharcomma}{\kern0pt}\ snd\ x\ {\isacharasterisk}{\kern0pt}\ snd\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ ac{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mult{\isacharunderscore}{\kern0pt}rat\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Fract\ a\ b\ {\isacharasterisk}{\kern0pt}\ Fract\ c\ d\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}a\ {\isacharasterisk}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b\ {\isacharasterisk}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mult{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}cancel{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}c\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ Fract\ {\isacharparenleft}{\kern0pt}c\ {\isacharasterisk}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}c\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Fract\ a\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}rat\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{is}\ {\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ if\ fst\ x\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharcomma}{\kern0pt}\ fst\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ mult{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inverse{\isacharunderscore}{\kern0pt}rat\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}inverse\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Fract\ b\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ divide{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}q\ div\ r\ {\isacharequal}{\kern0pt}\ q\ {\isacharasterisk}{\kern0pt}\ inverse\ r{\isachardoublequoteclose}\ \isakeyword{for}\ q\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ divide{\isacharunderscore}{\kern0pt}rat\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Fract\ a\ b\ div\ Fract\ c\ d\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}a\ {\isacharasterisk}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b\ {\isacharasterisk}{\kern0pt}\ c{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divide{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{instance}\isamarkupfalse%
\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ q\ r\ s\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}q\ {\isacharasterisk}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ s\ {\isacharequal}{\kern0pt}\ q\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}r\ {\isacharasterisk}{\kern0pt}\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ transfer\ simp\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}q\ {\isacharasterisk}{\kern0pt}\ r\ {\isacharequal}{\kern0pt}\ r\ {\isacharasterisk}{\kern0pt}\ q{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ transfer\ simp\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}\ {\isacharasterisk}{\kern0pt}\ q\ {\isacharequal}{\kern0pt}\ q{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ transfer\ simp\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}q\ {\isacharplus}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ s\ {\isacharequal}{\kern0pt}\ q\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}r\ {\isacharplus}{\kern0pt}\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ transfer\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}q\ {\isacharplus}{\kern0pt}\ r\ {\isacharequal}{\kern0pt}\ r\ {\isacharplus}{\kern0pt}\ q{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ transfer\ simp\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharplus}{\kern0pt}\ q\ {\isacharequal}{\kern0pt}\ q{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ transfer\ simp\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ q\ {\isacharplus}{\kern0pt}\ q\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ transfer\ simp\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}q\ {\isacharminus}{\kern0pt}\ r\ {\isacharequal}{\kern0pt}\ q\ {\isacharplus}{\kern0pt}\ {\isacharminus}{\kern0pt}\ r{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fact\ diff{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}q\ {\isacharplus}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ s\ {\isacharequal}{\kern0pt}\ q\ {\isacharasterisk}{\kern0pt}\ s\ {\isacharplus}{\kern0pt}\ r\ {\isacharasterisk}{\kern0pt}\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ transfer\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}rat{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ transfer\ simp\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}inverse\ q\ {\isacharasterisk}{\kern0pt}\ q\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isakeyword{if}\ {\isachardoublequoteopen}q\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ that\ \isacommand{by}\isamarkupfalse%
\ transfer\ simp\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}q\ div\ r\ {\isacharequal}{\kern0pt}\ q\ {\isacharasterisk}{\kern0pt}\ inverse\ r{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fact\ divide{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}inverse\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}rat{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ transfer\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}self{\isadigit{1}}{\isacharunderscore}{\kern0pt}no{\isacharunderscore}{\kern0pt}field\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}NO{\isacharunderscore}{\kern0pt}MATCH\ {\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ field{\isacharparenright}{\kern0pt}\ b{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}cancel{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}b\ {\isacharplus}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ div\ b\ {\isacharequal}{\kern0pt}\ a\ div\ b\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fact\ div{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}self{\isadigit{1}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ div{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}self{\isadigit{2}}{\isacharunderscore}{\kern0pt}no{\isacharunderscore}{\kern0pt}field\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}NO{\isacharunderscore}{\kern0pt}MATCH\ {\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ field{\isacharparenright}{\kern0pt}\ b{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ euclidean{\isacharunderscore}{\kern0pt}semiring{\isacharunderscore}{\kern0pt}cancel{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ div\ b\ {\isacharequal}{\kern0pt}\ a\ div\ b\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fact\ div{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}self{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}rat{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}nat\ k\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ k{\isacharparenright}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induct\ k{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ Zero{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ One{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}rat{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}int\ k\ {\isacharequal}{\kern0pt}\ Fract\ k\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ k\ rule{\isacharcolon}{\kern0pt}\ int{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Fract{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Fract\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ k{\isacharparenright}{\kern0pt}\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}nat\ k{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}rat\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Fract{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Fract\ k\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ k{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}rat\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}number{\isacharunderscore}{\kern0pt}collapse{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}Fract\ {\isadigit{0}}\ k\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}Fract\ {\isadigit{1}}\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}Fract\ {\isacharparenleft}{\kern0pt}numeral\ w{\isacharparenright}{\kern0pt}\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ numeral\ w{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}Fract\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ numeral\ w{\isacharparenright}{\kern0pt}\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ numeral\ w{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}Fract\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}Fract\ k\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ Fract{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}numeral\ w{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeyword{and}\ Fract{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ w{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ Zero{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ One{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ eq{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}number{\isacharunderscore}{\kern0pt}expand{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharequal}{\kern0pt}\ Fract\ {\isadigit{0}}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ Fract\ {\isadigit{1}}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}numeral\ k\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}numeral\ k{\isacharparenright}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ k\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ numeral\ k{\isacharparenright}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ rat{\isacharunderscore}{\kern0pt}number{\isacharunderscore}{\kern0pt}collapse{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rat{\isacharunderscore}{\kern0pt}cases{\isacharunderscore}{\kern0pt}nonzero\ {\isacharbrackleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}names\ Fract\ {\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ Fract{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}a\ b{\isachardot}{\kern0pt}\ q\ {\isacharequal}{\kern0pt}\ Fract\ a\ b\ {\isasymLongrightarrow}\ b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ a\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ coprime\ a\ b\ {\isasymLongrightarrow}\ C{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ C{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ C\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ C\ \isacommand{using}\isamarkupfalse%
\ {\isadigit{0}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ a\ b\ \isakeyword{where}\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ Fract\ a\ b{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}coprime\ a\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ q{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ False\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymnoteq}\ Fract\ a\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Zero{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ eq{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ Fract\ {\isacharasterisk}{\kern0pt}\ \isacommand{show}\isamarkupfalse%
\ C\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Function \isa{normalize}%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ Fract{\isacharunderscore}{\kern0pt}coprime{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Fract\ {\isacharparenleft}{\kern0pt}a\ div\ gcd\ a\ b{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b\ div\ gcd\ a\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Fract\ a\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}b\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ eq{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ div\ gcd\ a\ b\ {\isacharasterisk}{\kern0pt}\ gcd\ a\ b\ {\isacharequal}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ dvd{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}self{\isacharparenright}{\kern0pt}\ simp\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ div\ gcd\ a\ b\ {\isacharasterisk}{\kern0pt}\ gcd\ a\ b\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ div\ gcd\ a\ b\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ False\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ eq{\isacharunderscore}{\kern0pt}rat\ dvd{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}mult\ mult{\isachardot}{\kern0pt}commute\ {\isacharbrackleft}{\kern0pt}of\ a{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ normalize\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}int\ {\isasymtimes}\ int\ {\isasymRightarrow}\ int\ {\isasymtimes}\ int{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}normalize\ p\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ {\isacharparenleft}{\kern0pt}if\ snd\ p\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ then\ {\isacharparenleft}{\kern0pt}let\ a\ {\isacharequal}{\kern0pt}\ gcd\ {\isacharparenleft}{\kern0pt}fst\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ p{\isacharparenright}{\kern0pt}\ in\ {\isacharparenleft}{\kern0pt}fst\ p\ div\ a{\isacharcomma}{\kern0pt}\ snd\ p\ div\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ else\ if\ snd\ p\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ else\ {\isacharparenleft}{\kern0pt}let\ a\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ gcd\ {\isacharparenleft}{\kern0pt}fst\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ p{\isacharparenright}{\kern0pt}\ in\ {\isacharparenleft}{\kern0pt}fst\ p\ div\ a{\isacharcomma}{\kern0pt}\ snd\ p\ div\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ normalize{\isacharunderscore}{\kern0pt}crossproduct{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}q\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}s\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}normalize\ {\isacharparenleft}{\kern0pt}p{\isacharcomma}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ normalize\ {\isacharparenleft}{\kern0pt}r{\isacharcomma}{\kern0pt}\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}p\ {\isacharasterisk}{\kern0pt}\ s\ {\isacharequal}{\kern0pt}\ r\ {\isacharasterisk}{\kern0pt}\ q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isacharasterisk}{\kern0pt}\ s\ {\isacharequal}{\kern0pt}\ q\ {\isacharasterisk}{\kern0pt}\ r{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{if}\ {\isachardoublequoteopen}p\ {\isacharasterisk}{\kern0pt}\ gcd\ r\ s\ {\isacharequal}{\kern0pt}\ sgn\ {\isacharparenleft}{\kern0pt}q\ {\isacharasterisk}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ r\ {\isacharasterisk}{\kern0pt}\ gcd\ p\ q{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}q\ {\isacharasterisk}{\kern0pt}\ gcd\ r\ s\ {\isacharequal}{\kern0pt}\ sgn\ {\isacharparenleft}{\kern0pt}q\ {\isacharasterisk}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ s\ {\isacharasterisk}{\kern0pt}\ gcd\ p\ q{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ that\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}p\ {\isacharasterisk}{\kern0pt}\ gcd\ r\ s{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sgn\ {\isacharparenleft}{\kern0pt}q\ {\isacharasterisk}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ s\ {\isacharasterisk}{\kern0pt}\ gcd\ p\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}q\ {\isacharasterisk}{\kern0pt}\ gcd\ r\ s{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sgn\ {\isacharparenleft}{\kern0pt}q\ {\isacharasterisk}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ r\ {\isacharasterisk}{\kern0pt}\ gcd\ p\ q{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ assms\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ ac{\isacharunderscore}{\kern0pt}simps\ sgn{\isacharunderscore}{\kern0pt}mult\ sgn{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ normalize{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\ dvd{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}mult\ mult{\isachardot}{\kern0pt}commute\ sgn{\isacharunderscore}{\kern0pt}mult\isanewline
\ \ \ \ \ \ \ \ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}splits\ intro{\isacharcolon}{\kern0pt}\ {\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ normalize{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}normalize\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p{\isacharcomma}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ Fract\ p\ q\ {\isacharequal}{\kern0pt}\ Fract\ a\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ normalize{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\ Fract{\isacharunderscore}{\kern0pt}coprime\ dvd{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}neg\ rat{\isacharunderscore}{\kern0pt}number{\isacharunderscore}{\kern0pt}collapse\isanewline
\ \ \ \ \ \ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split{\isacharunderscore}{\kern0pt}asm{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ normalize{\isacharunderscore}{\kern0pt}denom{\isacharunderscore}{\kern0pt}pos{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}normalize\ r\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p{\isacharcomma}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ q\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ normalize{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\ dvd{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}neg\ pos{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}iff\ nonneg{\isadigit{1}}{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}zdiv{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}iff\isanewline
\ \ \ \ \ \ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split{\isacharunderscore}{\kern0pt}asm{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ normalize{\isacharunderscore}{\kern0pt}coprime{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}normalize\ r\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p{\isacharcomma}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ coprime\ p\ q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ normalize{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\ dvd{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}neg\ div{\isacharunderscore}{\kern0pt}gcd{\isacharunderscore}{\kern0pt}coprime\ split{\isacharcolon}{\kern0pt}\ if{\isacharunderscore}{\kern0pt}split{\isacharunderscore}{\kern0pt}asm{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ normalize{\isacharunderscore}{\kern0pt}stable\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}q\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ coprime\ p\ q\ {\isasymLongrightarrow}\ normalize\ {\isacharparenleft}{\kern0pt}p{\isacharcomma}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p{\isacharcomma}{\kern0pt}\ q{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ normalize{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ normalize{\isacharunderscore}{\kern0pt}denom{\isacharunderscore}{\kern0pt}zero\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}normalize\ {\isacharparenleft}{\kern0pt}p{\isacharcomma}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ normalize{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ normalize{\isacharunderscore}{\kern0pt}negative\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}q\ {\isacharless}{\kern0pt}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ normalize\ {\isacharparenleft}{\kern0pt}p{\isacharcomma}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ normalize\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ p{\isacharcomma}{\kern0pt}\ {\isacharminus}{\kern0pt}\ q{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ normalize{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def\ dvd{\isacharunderscore}{\kern0pt}div{\isacharunderscore}{\kern0pt}neg\ dvd{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}div{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Decompose a fraction into normalized, i.e. coprime numerator and denominator:%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}rat\ {\isasymRightarrow}\ int\ {\isasymtimes}\ int{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ x\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}THE\ pair{\isachardot}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}fst\ pair{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ pair{\isacharparenright}{\kern0pt}\ {\isasymand}\ snd\ pair\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ coprime\ {\isacharparenleft}{\kern0pt}fst\ pair{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ pair{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}unique{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymexists}{\isacharbang}{\kern0pt}p{\isachardot}{\kern0pt}\ r\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}fst\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ p{\isacharparenright}{\kern0pt}\ {\isasymand}\ snd\ p\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ coprime\ {\isacharparenleft}{\kern0pt}fst\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ r{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}r\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ snd\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ coprime\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ex{\isadigit{1}}I{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ p\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ r{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}r\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}fst\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ p{\isacharparenright}{\kern0pt}\ {\isasymand}\ snd\ p\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymand}\ coprime\ {\isacharparenleft}{\kern0pt}fst\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ c\ d\ \isakeyword{where}\ p{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}p\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}c{\isacharcomma}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ r\ \isacommand{have}\isamarkupfalse%
\ Fract{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}r\ {\isacharequal}{\kern0pt}\ Fract\ c\ d{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}coprime\ c\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}{\kern0pt}all\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}c{\isacharcomma}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ Fract\ Fract{\isacharprime}{\kern0pt}\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ eq{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ Fract\ Fract{\isacharprime}{\kern0pt}\ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}c\ {\isacharasterisk}{\kern0pt}\ b\ {\isacharequal}{\kern0pt}\ a\ {\isacharasterisk}{\kern0pt}\ d{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}c\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ eq{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}c\ {\isacharasterisk}{\kern0pt}\ b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ a\ {\isacharasterisk}{\kern0pt}\ d\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacartoucheclose}\ {\isacartoucheopen}d\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ c\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}a\ {\isasymnoteq}\ {\isadigit{0}}{\isacartoucheclose}\ {\isacartoucheopen}c\ {\isasymnoteq}\ {\isadigit{0}}{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ sgn{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}sgn\ a\ {\isacharequal}{\kern0pt}\ sgn\ c{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}less{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ {\isacartoucheopen}coprime\ a\ b{\isacartoucheclose}\ {\isacartoucheopen}coprime\ c\ d{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymbar}a{\isasymbar}\ {\isacharasterisk}{\kern0pt}\ {\isasymbar}d{\isasymbar}\ {\isacharequal}{\kern0pt}\ {\isasymbar}c{\isasymbar}\ {\isacharasterisk}{\kern0pt}\ {\isasymbar}b{\isasymbar}\ {\isasymlongleftrightarrow}\ {\isasymbar}a{\isasymbar}\ {\isacharequal}{\kern0pt}\ {\isasymbar}c{\isasymbar}\ {\isasymand}\ {\isasymbar}d{\isasymbar}\ {\isacharequal}{\kern0pt}\ {\isasymbar}b{\isasymbar}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ coprime{\isacharunderscore}{\kern0pt}crossproduct{\isacharunderscore}{\kern0pt}int{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacartoucheclose}\ {\isacartoucheopen}d\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymbar}a{\isasymbar}\ {\isacharasterisk}{\kern0pt}\ d\ {\isacharequal}{\kern0pt}\ {\isasymbar}c{\isasymbar}\ {\isacharasterisk}{\kern0pt}\ b\ {\isasymlongleftrightarrow}\ {\isasymbar}a{\isasymbar}\ {\isacharequal}{\kern0pt}\ {\isasymbar}c{\isasymbar}\ {\isasymand}\ d\ {\isacharequal}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharasterisk}{\kern0pt}\ sgn\ a\ {\isacharasterisk}{\kern0pt}\ d\ {\isacharequal}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ sgn\ c\ {\isacharasterisk}{\kern0pt}\ b\ {\isasymlongleftrightarrow}\ a\ {\isacharasterisk}{\kern0pt}\ sgn\ a\ {\isacharequal}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ sgn\ c\ {\isasymand}\ d\ {\isacharequal}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ abs{\isacharunderscore}{\kern0pt}sgn{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ sgn\ {\isacharasterisk}{\kern0pt}\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ sgn{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ p\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}p\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ normalize\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Fract\ a\ b\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}normalize\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}normalize\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isacharquery}{\kern0pt}Fract{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sym{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ normalize{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}normalize\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isacharquery}{\kern0pt}denom{\isacharunderscore}{\kern0pt}pos{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}normalize\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rule\ normalize{\isacharunderscore}{\kern0pt}denom{\isacharunderscore}{\kern0pt}pos{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}coprime\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}normalize\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}normalize\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isacharquery}{\kern0pt}coprime{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ normalize{\isacharunderscore}{\kern0pt}coprime{\isacharparenright}{\kern0pt}\ simp\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}Fract\ {\isasymand}\ {\isacharquery}{\kern0pt}denom{\isacharunderscore}{\kern0pt}pos\ {\isasymand}\ {\isacharquery}{\kern0pt}coprime{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}THE\ p{\isachardot}{\kern0pt}\ Fract\ a\ b\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}fst\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ p{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ snd\ p\ {\isasymand}\isanewline
\ \ \ \ coprime\ {\isacharparenleft}{\kern0pt}fst\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ normalize\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ the{\isadigit{1}}{\isacharunderscore}{\kern0pt}equality\ {\isacharbrackleft}{\kern0pt}OF\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}unique{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}number\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}numeral\ k{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}numeral\ k{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ numeral\ k{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ numeral\ k{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ rat{\isacharunderscore}{\kern0pt}number{\isacharunderscore}{\kern0pt}expand\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p{\isacharcomma}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ Fract\ p\ q\ {\isacharequal}{\kern0pt}\ Fract\ a\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract\ normalize{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}denom{\isacharunderscore}{\kern0pt}pos{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ r\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p{\isacharcomma}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ q\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ r{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract\ normalize{\isacharunderscore}{\kern0pt}denom{\isacharunderscore}{\kern0pt}pos{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}denom{\isacharunderscore}{\kern0pt}pos{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}quotient{\isacharunderscore}{\kern0pt}of\ r{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}denom{\isacharunderscore}{\kern0pt}pos\ {\isacharbrackleft}{\kern0pt}of\ r{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ prod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}coprime{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ r\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}p{\isacharcomma}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ coprime\ p\ q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ r{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract\ normalize{\isacharunderscore}{\kern0pt}coprime{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}inject{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ a\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ b{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ p\ q\ r\ s\ \isakeyword{where}\ a{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ Fract\ p\ q{\isachardoublequoteclose}\ \isakeyword{and}\ b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isacharequal}{\kern0pt}\ Fract\ r\ s{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}q\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}s\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ a{\isacharcomma}{\kern0pt}\ cases\ b{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ assms\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ eq{\isacharunderscore}{\kern0pt}rat\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract\ normalize{\isacharunderscore}{\kern0pt}crossproduct{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}inject{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ a\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ b\ {\isasymlongleftrightarrow}\ a\ {\isacharequal}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}inject{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Various%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ Fract{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}quotient{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Fract\ k\ l\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ k\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ l{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Fract{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Fract{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}one{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}n\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ Fract\ {\isacharparenleft}{\kern0pt}m\ {\isacharplus}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ n\ {\isacharequal}{\kern0pt}\ Fract\ m\ n\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ rat{\isacharunderscore}{\kern0pt}number{\isacharunderscore}{\kern0pt}expand{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}div{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ r{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ r\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharcomma}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}r\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ n\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ d{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ theI{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}unique{\isacharbrackleft}{\kern0pt}of\ r{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ unfolded\ r{\isacharbrackleft}{\kern0pt}unfolded\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}r\ {\isacharequal}{\kern0pt}\ Fract\ n\ d{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ Fract{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}quotient\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{The ordered field of rational numbers%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ positive\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}rat\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{is}\ {\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ fst\ x\ {\isacharasterisk}{\kern0pt}\ snd\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ clarsimp\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ a\ b\ c\ d\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}d\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}a\ {\isacharasterisk}{\kern0pt}\ d\ {\isacharequal}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharasterisk}{\kern0pt}\ d\ {\isacharasterisk}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ d\ {\isacharequal}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharasterisk}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ d\isactrlsup {\isadigit{2}}\ {\isacharequal}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ d\ {\isacharasterisk}{\kern0pt}\ b\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ power{\isadigit{2}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}square\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ ac{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ a\ {\isacharasterisk}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ d\isactrlsup {\isadigit{2}}\ {\isasymlongleftrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ d\ {\isacharasterisk}{\kern0pt}\ b\isactrlsup {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ a\ {\isacharasterisk}{\kern0pt}\ b\ {\isasymlongleftrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}b\ {\isasymnoteq}\ {\isadigit{0}}{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}d\ {\isasymnoteq}\ {\isadigit{0}}{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ positive{\isacharunderscore}{\kern0pt}zero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ positive\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ positive{\isacharunderscore}{\kern0pt}add{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}positive\ x\ {\isasymLongrightarrow}\ positive\ y\ {\isasymLongrightarrow}\ positive\ {\isacharparenleft}{\kern0pt}x\ {\isacharplus}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ transfer\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}iff\ add{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}pos\ add{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}neg\ mult{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}neg\ mult{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}pos\ mult{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}neg{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ positive{\isacharunderscore}{\kern0pt}mult{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}positive\ x\ {\isasymLongrightarrow}\ positive\ y\ {\isasymLongrightarrow}\ positive\ {\isacharparenleft}{\kern0pt}x\ {\isacharasterisk}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ transfer\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fst{\isacharunderscore}{\kern0pt}conv\ mult{\isachardot}{\kern0pt}commute\ mult{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}neg{\isadigit{2}}\ snd{\isacharunderscore}{\kern0pt}conv\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ positive{\isacharunderscore}{\kern0pt}minus{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ positive\ x\ {\isasymLongrightarrow}\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ positive\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ neq{\isacharunderscore}{\kern0pt}iff\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}iff\ mult{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{instantiation}\isamarkupfalse%
\ rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ linordered{\isacharunderscore}{\kern0pt}field\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharless}{\kern0pt}\ y\ {\isasymlongleftrightarrow}\ positive\ {\isacharparenleft}{\kern0pt}y\ {\isacharminus}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymle}\ y\ {\isasymlongleftrightarrow}\ x\ {\isacharless}{\kern0pt}\ y\ {\isasymor}\ x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\ \isakeyword{for}\ x\ y\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymbar}a{\isasymbar}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ a\ {\isacharless}{\kern0pt}\ {\isadigit{0}}\ then\ {\isacharminus}{\kern0pt}\ a\ else\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}sgn\ a\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ a\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ {\isadigit{0}}\ else\ if\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ a\ then\ {\isadigit{1}}\ else\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\isanewline
\isanewline
\isacommand{instance}\isamarkupfalse%
\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ a\ b\ c\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymbar}a{\isasymbar}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ a\ {\isacharless}{\kern0pt}\ {\isadigit{0}}\ then\ {\isacharminus}{\kern0pt}\ a\ else\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ abs{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharless}{\kern0pt}\ b\ {\isasymlongleftrightarrow}\ a\ {\isasymle}\ b\ {\isasymand}\ {\isasymnot}\ b\ {\isasymle}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ less{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ positive{\isacharunderscore}{\kern0pt}add\ positive{\isacharunderscore}{\kern0pt}zero\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymle}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymle}\ b\ {\isasymLongrightarrow}\ b\ {\isasymle}\ c\ {\isasymLongrightarrow}\ a\ {\isasymle}\ c{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ less{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ positive{\isacharunderscore}{\kern0pt}add\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymle}\ b\ {\isasymLongrightarrow}\ b\ {\isasymle}\ a\ {\isasymLongrightarrow}\ a\ {\isacharequal}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ less{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ positive{\isacharunderscore}{\kern0pt}add\ positive{\isacharunderscore}{\kern0pt}zero\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymle}\ b\ {\isasymLongrightarrow}\ c\ {\isacharplus}{\kern0pt}\ a\ {\isasymle}\ c\ {\isacharplus}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ less{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}sgn\ a\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ a\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ {\isadigit{0}}\ else\ if\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ a\ then\ {\isadigit{1}}\ else\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ sgn{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymle}\ b\ {\isasymor}\ b\ {\isasymle}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ less{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ dest{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ positive{\isacharunderscore}{\kern0pt}minus{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ c\ {\isasymLongrightarrow}\ c\ {\isacharasterisk}{\kern0pt}\ a\ {\isacharless}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ diff{\isacharunderscore}{\kern0pt}zero\ positive{\isacharunderscore}{\kern0pt}mult\ right{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}distrib{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{instantiation}\isamarkupfalse%
\ rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ distrib{\isacharunderscore}{\kern0pt}lattice\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}inf\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\ {\isasymRightarrow}\ rat\ {\isasymRightarrow}\ rat{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ min{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}sup\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\ {\isasymRightarrow}\ rat\ {\isasymRightarrow}\ rat{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ max{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{instance}\isamarkupfalse%
\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ standard\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ inf{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ sup{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ max{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}distrib{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ positive{\isacharunderscore}{\kern0pt}rat{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}positive\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ a\ {\isacharasterisk}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}rat\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}b\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ d\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ Fract\ a\ b\ {\isacharless}{\kern0pt}\ Fract\ c\ d\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}a\ {\isacharasterisk}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b\ {\isacharasterisk}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}c\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b\ {\isacharasterisk}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ less{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ positive{\isacharunderscore}{\kern0pt}rat\ algebra{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ le{\isacharunderscore}{\kern0pt}rat\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}b\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ d\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ Fract\ a\ b\ {\isasymle}\ Fract\ c\ d\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}a\ {\isacharasterisk}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b\ {\isacharasterisk}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}c\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b\ {\isacharasterisk}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ le{\isacharunderscore}{\kern0pt}less\ eq{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ abs{\isacharunderscore}{\kern0pt}rat\ {\isacharbrackleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymbar}Fract\ a\ b{\isasymbar}\ {\isacharequal}{\kern0pt}\ Fract\ {\isasymbar}a{\isasymbar}\ {\isasymbar}b{\isasymbar}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ abs{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ zabs{\isacharunderscore}{\kern0pt}def\ Zero{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ not{\isacharunderscore}{\kern0pt}less\ le{\isacharunderscore}{\kern0pt}less\ eq{\isacharunderscore}{\kern0pt}rat\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sgn{\isacharunderscore}{\kern0pt}rat\ {\isacharbrackleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}sgn\ a\ {\isacharasterisk}{\kern0pt}\ sgn\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Fract{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}eq\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ zsgn{\isacharunderscore}{\kern0pt}def\ sgn{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ Zero{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ eq{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ rat{\isacharunderscore}{\kern0pt}number{\isacharunderscore}{\kern0pt}collapse\ not{\isacharunderscore}{\kern0pt}less\ le{\isacharunderscore}{\kern0pt}less\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rat{\isacharunderscore}{\kern0pt}induct{\isacharunderscore}{\kern0pt}pos\ {\isacharbrackleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}names\ Fract{\isacharcomma}{\kern0pt}\ induct\ type{\isacharcolon}{\kern0pt}\ rat{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ step{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}a\ b{\isachardot}{\kern0pt}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ P\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}P\ q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ q{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ step{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}P\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{if}\ b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{for}\ a\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ b\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharminus}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}P\ {\isacharparenleft}{\kern0pt}Fract\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ step{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}P\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ order{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}OF\ b{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ Fract\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}P\ q{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}iff\ step\ step{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}Fract{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ Fract\ a\ b\ {\isasymlongleftrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Zero{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Fract{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ Fract\ a\ b\ {\isacharless}{\kern0pt}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ a\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Zero{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ mult{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}Fract{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isasymle}\ Fract\ a\ b\ {\isasymlongleftrightarrow}\ {\isadigit{0}}\ {\isasymle}\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Zero{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ zero{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Fract{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ Fract\ a\ b\ {\isasymle}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ a\ {\isasymle}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Zero{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ mult{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}Fract{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ {\isadigit{1}}\ {\isacharless}{\kern0pt}\ Fract\ a\ b\ {\isasymlongleftrightarrow}\ b\ {\isacharless}{\kern0pt}\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ One{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ mult{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}cancel{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}disj{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Fract{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ Fract\ a\ b\ {\isacharless}{\kern0pt}\ {\isadigit{1}}\ {\isasymlongleftrightarrow}\ a\ {\isacharless}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ One{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ mult{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}cancel{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}disj{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}Fract{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ {\isadigit{1}}\ {\isasymle}\ Fract\ a\ b\ {\isasymlongleftrightarrow}\ b\ {\isasymle}\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ One{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ mult{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}cancel{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Fract{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ b\ {\isasymLongrightarrow}\ Fract\ a\ b\ {\isasymle}\ {\isadigit{1}}\ {\isasymlongleftrightarrow}\ a\ {\isasymle}\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ One{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ mult{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}cancel{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Rationals are an Archimedean field%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}floor{\isacharunderscore}{\kern0pt}lemma{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}a\ div\ b{\isacharparenright}{\kern0pt}\ {\isasymle}\ Fract\ a\ b\ {\isasymand}\ Fract\ a\ b\ {\isacharless}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}a\ div\ b\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Fract\ a\ b\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}a\ div\ b{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}a\ mod\ b{\isacharparenright}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}b\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ simp\ add{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ Fract\ {\isacharparenleft}{\kern0pt}a\ mod\ b{\isacharparenright}{\kern0pt}\ b\ {\isasymand}\ Fract\ {\isacharparenleft}{\kern0pt}a\ mod\ b{\isacharparenright}{\kern0pt}\ b\ {\isacharless}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ Fract{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}quotient\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ linorder{\isacharunderscore}{\kern0pt}cases\ {\isacharbrackleft}{\kern0pt}of\ b\ {\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ divide{\isacharunderscore}{\kern0pt}nonpos{\isacharunderscore}{\kern0pt}neg{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{instance}\isamarkupfalse%
\ rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ archimedean{\isacharunderscore}{\kern0pt}field\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}z{\isachardot}{\kern0pt}\ r\ {\isasymle}\ of{\isacharunderscore}{\kern0pt}int\ z{\isachardoublequoteclose}\ \isakeyword{for}\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induct\ r{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Fract\ a\ b\ {\isasymle}\ of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}a\ div\ b\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}floor{\isacharunderscore}{\kern0pt}lemma\ {\isacharbrackleft}{\kern0pt}of\ a\ b{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}z{\isachardot}{\kern0pt}\ Fract\ a\ b\ {\isasymle}\ of{\isacharunderscore}{\kern0pt}int\ z{\isachardoublequoteclose}\ \isacommand{{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{instantiation}\isamarkupfalse%
\ rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ floor{\isacharunderscore}{\kern0pt}ceiling\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ floor{\isacharunderscore}{\kern0pt}rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}rat\ {\isasymRightarrow}\ int{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}{\isachardoublequoteopen}{\isasymlfloor}x{\isasymrfloor}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}THE\ z{\isachardot}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ z\ {\isasymle}\ x\ {\isasymand}\ x\ {\isacharless}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}z\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ x\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\isanewline
\isanewline
\isacommand{instance}\isamarkupfalse%
\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}int\ {\isasymlfloor}x{\isasymrfloor}\ {\isasymle}\ x\ {\isasymand}\ x\ {\isacharless}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}{\isasymlfloor}x{\isasymrfloor}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ x\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ floor{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ floor{\isacharunderscore}{\kern0pt}exists{\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ theI{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ floor{\isacharunderscore}{\kern0pt}Fract\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlfloor}Fract\ a\ b{\isasymrfloor}\ {\isacharequal}{\kern0pt}\ a\ div\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Fract{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}quotient\ floor{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Linear arithmetic setup%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{declaration}\isamarkupfalse%
\ {\isacartoucheopen}\isanewline
\ \ K\ {\isacharparenleft}{\kern0pt}Lin{\isacharunderscore}{\kern0pt}Arith{\isachardot}{\kern0pt}add{\isacharunderscore}{\kern0pt}inj{\isacharunderscore}{\kern0pt}thms\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}THEN\ iffD{\isadigit{2}}{\isacharbrackright}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}THEN\ iffD{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}\ not\ needed\ because\ x\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}y{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isacharparenright}{\kern0pt}\ can\ be\ rewritten\ as\ x\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\ {\isacharless}{\kern0pt}{\isacharequal}{\kern0pt}\ y{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}iff\ RS\ iffD{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isacharhash}{\kern0pt}{\isachargreater}{\kern0pt}\ Lin{\isacharunderscore}{\kern0pt}Arith{\isachardot}{\kern0pt}add{\isacharunderscore}{\kern0pt}inj{\isacharunderscore}{\kern0pt}const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}of{\isacharunderscore}{\kern0pt}nat{\isasymclose}{\isacharcomma}{\kern0pt}\ \isactrltyp {\isasymopen}nat\ {\isasymRightarrow}\ rat{\isasymclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isacharhash}{\kern0pt}{\isachargreater}{\kern0pt}\ Lin{\isacharunderscore}{\kern0pt}Arith{\isachardot}{\kern0pt}add{\isacharunderscore}{\kern0pt}inj{\isacharunderscore}{\kern0pt}const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}of{\isacharunderscore}{\kern0pt}int{\isasymclose}{\isacharcomma}{\kern0pt}\ \isactrltyp {\isasymopen}int\ {\isasymRightarrow}\ rat{\isasymclose}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Embedding from Rationals to other Fields%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{context}\isamarkupfalse%
\ field{\isacharunderscore}{\kern0pt}char{\isacharunderscore}{\kern0pt}{\isadigit{0}}\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}rat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{is}\ {\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ nonzero{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq\ nonzero{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}mult\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}rat{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ a\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}add{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ a\ {\isacharplus}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ add{\isacharunderscore}{\kern0pt}frac{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}minus{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}one\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}minus{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}diff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}a\ {\isacharminus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ a\ {\isacharminus}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}add\ {\isacharbrackleft}{\kern0pt}of\ a\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ b{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}minus{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}a\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ a\ {\isacharasterisk}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ transfer\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divide{\isacharunderscore}{\kern0pt}inverse\ nonzero{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}mult{\isacharunderscore}{\kern0pt}distrib\ ac{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}sum{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymSum}a{\isasymin}A{\isachardot}{\kern0pt}\ f\ a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}a{\isasymin}A{\isachardot}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}f\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induct\ rule{\isacharcolon}{\kern0pt}\ infinite{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}induct{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}add{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isasymProd}a{\isasymin}A{\isachardot}{\kern0pt}\ f\ a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymProd}a{\isasymin}A{\isachardot}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}f\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induct\ rule{\isacharcolon}{\kern0pt}\ infinite{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}induct{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nonzero{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inverse{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}inverse\ a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ inverse\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inverse{\isacharunderscore}{\kern0pt}unique\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inverse{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}inverse\ a{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}field{\isacharunderscore}{\kern0pt}char{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ inverse\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ nonzero{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inverse{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ nonzero{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}divide{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}a\ {\isacharslash}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ a\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divide{\isacharunderscore}{\kern0pt}inverse\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult\ nonzero{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inverse{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}divide{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}a\ {\isacharslash}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}field{\isacharunderscore}{\kern0pt}char{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ a\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}b\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ nonzero{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}divide{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}a\ {\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}field{\isacharunderscore}{\kern0pt}char{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ a\ {\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induct\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ a\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ b\ {\isasymlongleftrightarrow}\ a\ {\isacharequal}{\kern0pt}\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ transfer\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ nonzero{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}eq\ nonzero{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}eq\ flip{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}mult{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ a\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ a\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isadigit{0}}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ a\ {\isasymlongleftrightarrow}\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ a\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\ {\isasymlongleftrightarrow}\ a\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ a\ {\isasymlongleftrightarrow}\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linordered{\isacharunderscore}{\kern0pt}field{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ s\ {\isasymlongleftrightarrow}\ r\ {\isacharless}{\kern0pt}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induct\ r{\isacharcomma}{\kern0pt}\ induct\ s{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ a\ b\ c\ d\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ int\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}zero{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isacharasterisk}{\kern0pt}\ d\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ b\ {\isacharless}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ c\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ d\ {\isasymlongleftrightarrow}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ d\ {\isacharless}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ c\ {\isacharasterisk}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}zero\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ pos{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}eq\ pos{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linordered{\isacharunderscore}{\kern0pt}field{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}Fract\ c\ d{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\isanewline
\ \ \ \ \ \ Fract\ a\ b\ {\isacharless}{\kern0pt}\ Fract\ c\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ not{\isacharunderscore}{\kern0pt}zero\ {\isacartoucheopen}b\ {\isacharasterisk}{\kern0pt}\ d\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isacartoucheclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}rat\ of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq\ of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}mult\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ del{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}mult{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linordered{\isacharunderscore}{\kern0pt}field{\isacharparenright}{\kern0pt}\ {\isasymle}\ of{\isacharunderscore}{\kern0pt}rat\ s\ {\isasymlongleftrightarrow}\ r\ {\isasymle}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ le{\isacharunderscore}{\kern0pt}less\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linordered{\isacharunderscore}{\kern0pt}field{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ r\ {\isasymle}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}of\ r\ {\isadigit{0}}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ {\isacharprime}{\kern0pt}a\ {\isacharequal}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linordered{\isacharunderscore}{\kern0pt}field{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isadigit{0}}\ {\isasymle}\ r{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}of\ {\isadigit{0}}\ r{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ {\isacharprime}{\kern0pt}a\ {\isacharequal}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linordered{\isacharunderscore}{\kern0pt}field{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isadigit{1}}\ {\isasymlongleftrightarrow}\ r\ {\isasymle}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}of\ r\ {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linordered{\isacharunderscore}{\kern0pt}field{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isadigit{1}}\ {\isasymle}\ r{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}of\ {\isadigit{1}}\ r{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linordered{\isacharunderscore}{\kern0pt}field{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ r\ {\isacharless}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less\ {\isacharbrackleft}{\kern0pt}of\ r\ {\isadigit{0}}{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ {\isacharprime}{\kern0pt}a\ {\isacharequal}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linordered{\isacharunderscore}{\kern0pt}field{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ r{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less\ {\isacharbrackleft}{\kern0pt}of\ {\isadigit{0}}\ r{\isacharcomma}{\kern0pt}\ \isakeyword{where}\ {\isacharprime}{\kern0pt}a\ {\isacharequal}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linordered{\isacharunderscore}{\kern0pt}field{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isadigit{1}}\ {\isasymlongleftrightarrow}\ r\ {\isacharless}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less\ {\isacharbrackleft}{\kern0pt}of\ r\ {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linordered{\isacharunderscore}{\kern0pt}field{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isadigit{1}}\ {\isacharless}{\kern0pt}\ r{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}less\ {\isacharbrackleft}{\kern0pt}of\ {\isadigit{1}}\ r{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}id\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ {\isacharequal}{\kern0pt}\ id{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ a\ {\isacharequal}{\kern0pt}\ id\ a{\isachardoublequoteclose}\ \isakeyword{for}\ a\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induct\ a{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}rat\ Fract{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ abs{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymbar}of{\isacharunderscore}{\kern0pt}rat\ r{\isasymbar}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isasymbar}r{\isasymbar}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ linordered{\isacharunderscore}{\kern0pt}field{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}r\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}le\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}minus{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Collapse nested embeddings.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}nat\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induct\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}add{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ z{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ z{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ z\ rule{\isacharcolon}{\kern0pt}\ int{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}diff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}numeral\ w{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ numeral\ w{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}numeral\ w{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ numeral\ w{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ numeral\ w{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ w{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}floor\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymlfloor}of{\isacharunderscore}{\kern0pt}rat\ r{\isasymrfloor}\ {\isacharequal}{\kern0pt}\ {\isasymlfloor}r{\isasymrfloor}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ r{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Fract{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}quotient\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}divide\ floor{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}ceiling\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymlceil}of{\isacharunderscore}{\kern0pt}rat\ r{\isasymrceil}\ {\isacharequal}{\kern0pt}\ {\isasymlceil}r{\isasymrceil}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}floor\ {\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ r{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}minus\ ceiling{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ zero{\isacharunderscore}{\kern0pt}rat\ {\isacharequal}{\kern0pt}\ Zero{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ one{\isacharunderscore}{\kern0pt}rat\ {\isacharequal}{\kern0pt}\ One{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\isanewline
\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ {\isasymequiv}\ of{\isacharunderscore}{\kern0pt}nat{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}int\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isasymequiv}\ of{\isacharunderscore}{\kern0pt}int{\isachardoublequoteclose}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{The Set of Rational Numbers%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{context}\isamarkupfalse%
\ field{\isacharunderscore}{\kern0pt}char{\isacharunderscore}{\kern0pt}{\isadigit{0}}\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ Rats\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ set{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isasymrat}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}{\isasymrat}\ {\isacharequal}{\kern0pt}\ range\ of{\isacharunderscore}{\kern0pt}rat{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}cases\ {\isacharbrackleft}{\kern0pt}cases\ set{\isacharcolon}{\kern0pt}\ Rats{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}q\ {\isasymin}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{obtains}\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}\ r\ \isakeyword{where}\ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ r{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ {\isacartoucheopen}q\ {\isasymin}\ {\isasymrat}{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}q\ {\isasymin}\ range\ of{\isacharunderscore}{\kern0pt}rat{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ Rats{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ r\ \isakeyword{where}\ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ r{\isachardoublequoteclose}\ \isacommand{{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ thesis\ \isacommand{{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}cases{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ field{\isacharunderscore}{\kern0pt}char{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{obtains}\ a\ b\ \isakeyword{where}\ {\isachardoublequoteopen}b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}coprime\ a\ b{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ a\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{obtain}\isamarkupfalse%
\ r\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ r{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ Rats{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ a\ b\ \isakeyword{where}\ quot{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ r\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}b\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}denom{\isacharunderscore}{\kern0pt}pos{\isacharbrackleft}{\kern0pt}OF\ quot{\isacharbrackright}{\kern0pt}\ \isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}coprime\ a\ b{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}coprime{\isacharbrackleft}{\kern0pt}OF\ quot{\isacharbrackright}{\kern0pt}\ \isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ a\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ b{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ {\isacartoucheopen}x\ {\isacharequal}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat\ r{\isacartoucheclose}\isanewline
\ \ \ \ \ \ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}div{\isacharbrackleft}{\kern0pt}OF\ quot{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}divide{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ that\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ r\ {\isasymin}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Rats{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}int\ z\ {\isasymin}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rule\ Rats{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Ints{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Rats{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymint}\ {\isasymsubseteq}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ Ints{\isacharunderscore}{\kern0pt}cases\ Rats{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}nat\ n\ {\isasymin}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rule\ Rats{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Nats{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Rats{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnat}\ {\isasymsubseteq}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ Ints{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Rats\ Nats{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}Ints\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}number{\isacharunderscore}{\kern0pt}of\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}numeral\ w\ {\isasymin}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rule\ Rats{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymin}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ range{\isacharunderscore}{\kern0pt}eqI{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rule\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{1}}\ {\isasymin}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ range{\isacharunderscore}{\kern0pt}eqI{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rule\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}add\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ {\isasymrat}\ {\isasymLongrightarrow}\ b\ {\isasymin}\ {\isasymrat}\ {\isasymLongrightarrow}\ a\ {\isacharplus}{\kern0pt}\ b\ {\isasymin}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Rats{\isacharunderscore}{\kern0pt}cases\ Rats{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}add{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ a\ {\isasymin}\ {\isasymrat}\ {\isasymlongleftrightarrow}\ a\ {\isasymin}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Rats{\isacharunderscore}{\kern0pt}cases\ Rats{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ add{\isachardot}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}inverse\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}minus{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}diff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ {\isasymrat}\ {\isasymLongrightarrow}\ b\ {\isasymin}\ {\isasymrat}\ {\isasymLongrightarrow}\ a\ {\isacharminus}{\kern0pt}\ b\ {\isasymin}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Rats{\isacharunderscore}{\kern0pt}add\ Rats{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}iff\ diff{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}uminus{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}mult\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ {\isasymrat}\ {\isasymLongrightarrow}\ b\ {\isasymin}\ {\isasymrat}\ {\isasymLongrightarrow}\ a\ {\isacharasterisk}{\kern0pt}\ b\ {\isasymin}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Rats{\isacharunderscore}{\kern0pt}cases\ Rats{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}mult{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}inverse\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ {\isasymrat}\ {\isasymLongrightarrow}\ inverse\ a\ {\isasymin}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{for}\ a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}field{\isacharunderscore}{\kern0pt}char{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Rats{\isacharunderscore}{\kern0pt}cases\ Rats{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inverse{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}divide\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ {\isasymrat}\ {\isasymLongrightarrow}\ b\ {\isasymin}\ {\isasymrat}\ {\isasymLongrightarrow}\ a\ {\isacharslash}{\kern0pt}\ b\ {\isasymin}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{for}\ a\ b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}field{\isacharunderscore}{\kern0pt}char{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ divide{\isacharunderscore}{\kern0pt}inverse{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}power\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ {\isasymrat}\ {\isasymLongrightarrow}\ a\ {\isacharcircum}{\kern0pt}\ n\ {\isasymin}\ {\isasymrat}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{for}\ a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}field{\isacharunderscore}{\kern0pt}char{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Rats{\isacharunderscore}{\kern0pt}cases\ Rats{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}power{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}induct\ {\isacharbrackleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}names\ of{\isacharunderscore}{\kern0pt}rat{\isacharcomma}{\kern0pt}\ induct\ set{\isacharcolon}{\kern0pt}\ Rats{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}q\ {\isasymin}\ {\isasymrat}\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}r{\isachardot}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat\ r{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ P\ q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ Rats{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Rats{\isacharunderscore}{\kern0pt}infinite{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ finite\ {\isasymrat}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ dest{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ finite{\isacharunderscore}{\kern0pt}imageD\ simp{\isacharcolon}{\kern0pt}\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def\ infinite{\isacharunderscore}{\kern0pt}UNIV{\isacharunderscore}{\kern0pt}char{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ Rats{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Implementation of rational numbers as pairs of integers%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
Formal constructor%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ Frct\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}int\ {\isasymtimes}\ int\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Frct\ p\ {\isacharequal}{\kern0pt}\ Fract\ {\isacharparenleft}{\kern0pt}fst\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code\ abstype{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Frct\ {\isacharparenleft}{\kern0pt}quotient{\isacharunderscore}{\kern0pt}of\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ q{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Numerals%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{declare}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract\ {\isacharbrackleft}{\kern0pt}code\ abstract{\isacharbrackright}{\kern0pt}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ of{\isacharunderscore}{\kern0pt}int\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}int\ {\isasymRightarrow}\ rat{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isacharbrackleft}{\kern0pt}code{\isacharunderscore}{\kern0pt}abbrev{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}int\ {\isacharequal}{\kern0pt}\ Int{\isachardot}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{hide{\isacharunderscore}{\kern0pt}const}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}\isakeyword{open}{\isacharparenright}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharbrackleft}{\kern0pt}code\ abstract{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}Rat{\isachardot}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def\ of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}rat\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code{\isacharunderscore}{\kern0pt}unfold{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}numeral\ k\ {\isacharequal}{\kern0pt}\ Rat{\isachardot}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}numeral\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Rat{\isachardot}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code{\isacharunderscore}{\kern0pt}unfold{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ numeral\ k\ {\isacharequal}{\kern0pt}\ Rat{\isachardot}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ numeral\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Rat{\isachardot}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Frct{\isacharunderscore}{\kern0pt}code{\isacharunderscore}{\kern0pt}post\ {\isacharbrackleft}{\kern0pt}code{\isacharunderscore}{\kern0pt}post{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}Frct\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}Frct\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}Frct\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}Frct\ {\isacharparenleft}{\kern0pt}numeral\ k{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ numeral\ k{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}Frct\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ numeral\ k{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ numeral\ k{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}Frct\ {\isacharparenleft}{\kern0pt}numeral\ k{\isacharcomma}{\kern0pt}\ numeral\ l{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ numeral\ k\ {\isacharslash}{\kern0pt}\ numeral\ l{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}Frct\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ Frct\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}Frct\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharminus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}\ Frct\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ Frct\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Frct\ q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ Fract{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int{\isacharunderscore}{\kern0pt}quotient{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Operations%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}code\ {\isacharbrackleft}{\kern0pt}code\ abstract{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Zero{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract\ normalize{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}code\ {\isacharbrackleft}{\kern0pt}code\ abstract{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ One{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract\ normalize{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}plus{\isacharunderscore}{\kern0pt}code\ {\isacharbrackleft}{\kern0pt}code\ abstract{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}p\ {\isacharplus}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ p{\isacharsemicolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ q\isanewline
\ \ \ \ \ in\ normalize\ {\isacharparenleft}{\kern0pt}a\ {\isacharasterisk}{\kern0pt}\ d\ {\isacharplus}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ c{\isacharcomma}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharcomma}{\kern0pt}\ cases\ q{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}uminus{\isacharunderscore}{\kern0pt}code\ {\isacharbrackleft}{\kern0pt}code\ abstract{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ p{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ p\ in\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}\ a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}code\ {\isacharbrackleft}{\kern0pt}code\ abstract{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}p\ {\isacharminus}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ p{\isacharsemicolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ q\isanewline
\ \ \ \ \ in\ normalize\ {\isacharparenleft}{\kern0pt}a\ {\isacharasterisk}{\kern0pt}\ d\ {\isacharminus}{\kern0pt}\ b\ {\isacharasterisk}{\kern0pt}\ c{\isacharcomma}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharcomma}{\kern0pt}\ cases\ q{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}times{\isacharunderscore}{\kern0pt}code\ {\isacharbrackleft}{\kern0pt}code\ abstract{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}p\ {\isacharasterisk}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ p{\isacharsemicolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ q\isanewline
\ \ \ \ \ in\ normalize\ {\isacharparenleft}{\kern0pt}a\ {\isacharasterisk}{\kern0pt}\ b{\isacharcomma}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharcomma}{\kern0pt}\ cases\ q{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}code\ {\isacharbrackleft}{\kern0pt}code\ abstract{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}inverse\ p{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ p\isanewline
\ \ \ \ \ in\ if\ a\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}sgn\ a\ {\isacharasterisk}{\kern0pt}\ b{\isacharcomma}{\kern0pt}\ {\isasymbar}a{\isasymbar}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isachardoublequoteclose}\ a\ rule{\isacharcolon}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract\ ac{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}code\ {\isacharbrackleft}{\kern0pt}code\ abstract{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}p\ {\isacharslash}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ p{\isacharsemicolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ q\isanewline
\ \ \ \ \ in\ normalize\ {\isacharparenleft}{\kern0pt}a\ {\isacharasterisk}{\kern0pt}\ d{\isacharcomma}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharcomma}{\kern0pt}\ cases\ q{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}code\ {\isacharbrackleft}{\kern0pt}code\ abstract{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isasymbar}p{\isasymbar}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ p\ in\ {\isacharparenleft}{\kern0pt}{\isasymbar}a{\isasymbar}{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \isanewline
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}sgn{\isacharunderscore}{\kern0pt}code\ {\isacharbrackleft}{\kern0pt}code\ abstract{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}quotient{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}sgn\ p{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sgn\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}quotient{\isacharunderscore}{\kern0pt}of\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Fract\ a\ b{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}int{\isachardoublequoteclose}\ a\ rule{\isacharcolon}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}floor{\isacharunderscore}{\kern0pt}code\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlfloor}p{\isasymrfloor}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ p\ in\ a\ div\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract\ floor{\isacharunderscore}{\kern0pt}Fract{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{instantiation}\isamarkupfalse%
\ rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ equal\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}HOL{\isachardot}{\kern0pt}equal\ a\ b\ {\isasymlongleftrightarrow}\ quotient{\isacharunderscore}{\kern0pt}of\ a\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ b{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{instance}\isamarkupfalse%
\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ standard\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ equal{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}def\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}inject{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}refl\ {\isacharbrackleft}{\kern0pt}code\ nbe{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}HOL{\isachardot}{\kern0pt}equal\ {\isacharparenleft}{\kern0pt}r{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}rat{\isacharparenright}{\kern0pt}\ r\ {\isasymlongleftrightarrow}\ True{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ equal{\isacharunderscore}{\kern0pt}refl{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}code\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}p\ {\isasymle}\ q\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ p{\isacharsemicolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ q\ in\ a\ {\isacharasterisk}{\kern0pt}\ d\ {\isasymle}\ c\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharcomma}{\kern0pt}\ cases\ q{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract\ mult{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}code\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}p\ {\isacharless}{\kern0pt}\ q\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ p{\isacharsemicolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b{\isacharcomma}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ q\ in\ a\ {\isacharasterisk}{\kern0pt}\ d\ {\isacharless}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharcomma}{\kern0pt}\ cases\ q{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract\ mult{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}of{\isacharunderscore}{\kern0pt}rat\ p\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of\ p\ in\ of{\isacharunderscore}{\kern0pt}int\ a\ {\isacharslash}{\kern0pt}\ of{\isacharunderscore}{\kern0pt}int\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ quotient{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}Fract\ of{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}rat{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Quickcheck%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{context}\isamarkupfalse%
\isanewline
\ \ \isakeyword{includes}\ term{\isacharunderscore}{\kern0pt}syntax\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\isanewline
\ \ valterm{\isacharunderscore}{\kern0pt}fract\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}int\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}unit\ {\isasymRightarrow}\ Code{\isacharunderscore}{\kern0pt}Evaluation{\isachardot}{\kern0pt}term{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\isanewline
\ \ \ \ int\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}unit\ {\isasymRightarrow}\ Code{\isacharunderscore}{\kern0pt}Evaluation{\isachardot}{\kern0pt}term{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\isanewline
\ \ \ \ rat\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}unit\ {\isasymRightarrow}\ Code{\isacharunderscore}{\kern0pt}Evaluation{\isachardot}{\kern0pt}term{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isacharbrackleft}{\kern0pt}code{\isacharunderscore}{\kern0pt}unfold{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}valterm{\isacharunderscore}{\kern0pt}fract\ k\ l\ {\isacharequal}{\kern0pt}\ Code{\isacharunderscore}{\kern0pt}Evaluation{\isachardot}{\kern0pt}valtermify\ Fract\ {\isacharbraceleft}{\kern0pt}{\isasymcdot}{\isacharbraceright}{\kern0pt}\ k\ {\isacharbraceleft}{\kern0pt}{\isasymcdot}{\isacharbraceright}{\kern0pt}\ l{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{instantiation}\isamarkupfalse%
\ rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ random\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\isanewline
\ \ \isakeyword{includes}\ state{\isacharunderscore}{\kern0pt}combinator{\isacharunderscore}{\kern0pt}syntax\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\isanewline
\ \ {\isachardoublequoteopen}Quickcheck{\isacharunderscore}{\kern0pt}Random{\isachardot}{\kern0pt}random\ i\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ Quickcheck{\isacharunderscore}{\kern0pt}Random{\isachardot}{\kern0pt}random\ i\ {\isasymcirc}{\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}num{\isachardot}{\kern0pt}\ Random{\isachardot}{\kern0pt}range\ i\ {\isasymcirc}{\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}denom{\isachardot}{\kern0pt}\ Pair\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}let\ j\ {\isacharequal}{\kern0pt}\ int{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}integer\ {\isacharparenleft}{\kern0pt}integer{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}natural\ {\isacharparenleft}{\kern0pt}denom\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ in\ valterm{\isacharunderscore}{\kern0pt}fract\ num\ {\isacharparenleft}{\kern0pt}j{\isacharcomma}{\kern0pt}\ {\isasymlambda}u{\isachardot}{\kern0pt}\ Code{\isacharunderscore}{\kern0pt}Evaluation{\isachardot}{\kern0pt}term{\isacharunderscore}{\kern0pt}of\ j{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{instance}\isamarkupfalse%
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{instantiation}\isamarkupfalse%
\ rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ exhaustive\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\isanewline
\ \ {\isachardoublequoteopen}exhaustive{\isacharunderscore}{\kern0pt}rat\ f\ d\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ Quickcheck{\isacharunderscore}{\kern0pt}Exhaustive{\isachardot}{\kern0pt}exhaustive\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}l{\isachardot}{\kern0pt}\ Quickcheck{\isacharunderscore}{\kern0pt}Exhaustive{\isachardot}{\kern0pt}exhaustive\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}k{\isachardot}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}Fract\ k\ {\isacharparenleft}{\kern0pt}int{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}integer\ {\isacharparenleft}{\kern0pt}integer{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}natural\ l{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ d{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{instance}\isamarkupfalse%
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{instantiation}\isamarkupfalse%
\ rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ full{\isacharunderscore}{\kern0pt}exhaustive\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\isanewline
\ \ {\isachardoublequoteopen}full{\isacharunderscore}{\kern0pt}exhaustive{\isacharunderscore}{\kern0pt}rat\ f\ d\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ Quickcheck{\isacharunderscore}{\kern0pt}Exhaustive{\isachardot}{\kern0pt}full{\isacharunderscore}{\kern0pt}exhaustive\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}l{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ Quickcheck{\isacharunderscore}{\kern0pt}Exhaustive{\isachardot}{\kern0pt}full{\isacharunderscore}{\kern0pt}exhaustive\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}k{\isachardot}{\kern0pt}\ f\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}let\ j\ {\isacharequal}{\kern0pt}\ int{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}integer\ {\isacharparenleft}{\kern0pt}integer{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}natural\ l{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ in\ valterm{\isacharunderscore}{\kern0pt}fract\ k\ {\isacharparenleft}{\kern0pt}j{\isacharcomma}{\kern0pt}\ {\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ Code{\isacharunderscore}{\kern0pt}Evaluation{\isachardot}{\kern0pt}term{\isacharunderscore}{\kern0pt}of\ j{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ d{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{instance}\isamarkupfalse%
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{instance}\isamarkupfalse%
\ rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ partial{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}of%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}partial{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}ty\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\ itself{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Quickcheck{\isacharunderscore}{\kern0pt}Narrowing{\isachardot}{\kern0pt}Narrowing{\isacharunderscore}{\kern0pt}variable\ p\ tt{\isacharparenright}{\kern0pt}\ {\isasymequiv}\isanewline
\ \ \ \ Code{\isacharunderscore}{\kern0pt}Evaluation{\isachardot}{\kern0pt}Free\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Typerep{\isachardot}{\kern0pt}Typerep\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}Rat{\isachardot}{\kern0pt}rat{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}partial{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}ty\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ rat\ itself{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Quickcheck{\isacharunderscore}{\kern0pt}Narrowing{\isachardot}{\kern0pt}Narrowing{\isacharunderscore}{\kern0pt}constructor\ {\isadigit{0}}\ {\isacharbrackleft}{\kern0pt}l{\isacharcomma}{\kern0pt}\ k{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymequiv}\isanewline
\ \ \ \ Code{\isacharunderscore}{\kern0pt}Evaluation{\isachardot}{\kern0pt}App\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Code{\isacharunderscore}{\kern0pt}Evaluation{\isachardot}{\kern0pt}Const\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}Rat{\isachardot}{\kern0pt}Frct{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Typerep{\isachardot}{\kern0pt}Typerep\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}fun{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharbrackleft}{\kern0pt}Typerep{\isachardot}{\kern0pt}Typerep\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}Product{\isacharunderscore}{\kern0pt}Type{\isachardot}{\kern0pt}prod{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharbrackleft}{\kern0pt}Typerep{\isachardot}{\kern0pt}Typerep\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}Int{\isachardot}{\kern0pt}int{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ Typerep{\isachardot}{\kern0pt}Typerep\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}Int{\isachardot}{\kern0pt}int{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ Typerep{\isachardot}{\kern0pt}Typerep\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}Rat{\isachardot}{\kern0pt}rat{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Code{\isacharunderscore}{\kern0pt}Evaluation{\isachardot}{\kern0pt}App\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Code{\isacharunderscore}{\kern0pt}Evaluation{\isachardot}{\kern0pt}App\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Code{\isacharunderscore}{\kern0pt}Evaluation{\isachardot}{\kern0pt}Const\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}Product{\isacharunderscore}{\kern0pt}Type{\isachardot}{\kern0pt}Pair{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Typerep{\isachardot}{\kern0pt}Typerep\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}fun{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbrackleft}{\kern0pt}Typerep{\isachardot}{\kern0pt}Typerep\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}Int{\isachardot}{\kern0pt}int{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Typerep{\isachardot}{\kern0pt}Typerep\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}fun{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbrackleft}{\kern0pt}Typerep{\isachardot}{\kern0pt}Typerep\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}Int{\isachardot}{\kern0pt}int{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Typerep{\isachardot}{\kern0pt}Typerep\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}Product{\isacharunderscore}{\kern0pt}Type{\isachardot}{\kern0pt}prod{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbrackleft}{\kern0pt}Typerep{\isachardot}{\kern0pt}Typerep\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}Int{\isachardot}{\kern0pt}int{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ Typerep{\isachardot}{\kern0pt}Typerep\ {\isacharparenleft}{\kern0pt}STR\ {\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}Int{\isachardot}{\kern0pt}int{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}partial{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}TYPE{\isacharparenleft}{\kern0pt}int{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}partial{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}TYPE{\isacharparenleft}{\kern0pt}int{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ partial{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}anything{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{instantiation}\isamarkupfalse%
\ rat\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ narrowing\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\isanewline
\ \ {\isachardoublequoteopen}narrowing\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ Quickcheck{\isacharunderscore}{\kern0pt}Narrowing{\isachardot}{\kern0pt}apply\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Quickcheck{\isacharunderscore}{\kern0pt}Narrowing{\isachardot}{\kern0pt}apply\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Quickcheck{\isacharunderscore}{\kern0pt}Narrowing{\isachardot}{\kern0pt}cons\ {\isacharparenleft}{\kern0pt}{\isasymlambda}nom\ denom{\isachardot}{\kern0pt}\ Fract\ nom\ denom{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ narrowing{\isacharparenright}{\kern0pt}\ narrowing{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{instance}\isamarkupfalse%
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Setup for Nitpick%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{declaration}\isamarkupfalse%
\ {\isacartoucheopen}\isanewline
\ \ Nitpick{\isacharunderscore}{\kern0pt}HOL{\isachardot}{\kern0pt}register{\isacharunderscore}{\kern0pt}frac{\isacharunderscore}{\kern0pt}type\ \isactrltypeUNDERSCOREname {\isasymopen}rat{\isasymclose}\isanewline
\ \ \ \ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}Abs{\isacharunderscore}{\kern0pt}Rat{\isasymclose}{\isacharcomma}{\kern0pt}\ \isactrlconstUNDERSCOREname {\isasymopen}Nitpick{\isachardot}{\kern0pt}Abs{\isacharunderscore}{\kern0pt}Frac{\isasymclose}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}zero{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}zero{\isacharunderscore}{\kern0pt}rat{\isasymclose}{\isacharcomma}{\kern0pt}\ \isactrlconstUNDERSCOREname {\isasymopen}Nitpick{\isachardot}{\kern0pt}zero{\isacharunderscore}{\kern0pt}frac{\isasymclose}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}one{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}one{\isacharunderscore}{\kern0pt}rat{\isasymclose}{\isacharcomma}{\kern0pt}\ \isactrlconstUNDERSCOREname {\isasymopen}Nitpick{\isachardot}{\kern0pt}one{\isacharunderscore}{\kern0pt}frac{\isasymclose}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}plus{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}plus{\isacharunderscore}{\kern0pt}rat{\isasymclose}{\isacharcomma}{\kern0pt}\ \isactrlconstUNDERSCOREname {\isasymopen}Nitpick{\isachardot}{\kern0pt}plus{\isacharunderscore}{\kern0pt}frac{\isasymclose}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}times{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}times{\isacharunderscore}{\kern0pt}rat{\isasymclose}{\isacharcomma}{\kern0pt}\ \isactrlconstUNDERSCOREname {\isasymopen}Nitpick{\isachardot}{\kern0pt}times{\isacharunderscore}{\kern0pt}frac{\isasymclose}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}uminus{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}uminus{\isacharunderscore}{\kern0pt}rat{\isasymclose}{\isacharcomma}{\kern0pt}\ \isactrlconstUNDERSCOREname {\isasymopen}Nitpick{\isachardot}{\kern0pt}uminus{\isacharunderscore}{\kern0pt}frac{\isasymclose}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}inverse{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}rat{\isasymclose}{\isacharcomma}{\kern0pt}\ \isactrlconstUNDERSCOREname {\isasymopen}Nitpick{\isachardot}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}frac{\isasymclose}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}ord{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}less{\isacharunderscore}{\kern0pt}rat{\isasymclose}{\isacharcomma}{\kern0pt}\ \isactrlconstUNDERSCOREname {\isasymopen}Nitpick{\isachardot}{\kern0pt}less{\isacharunderscore}{\kern0pt}frac{\isasymclose}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}ord{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}rat{\isasymclose}{\isacharcomma}{\kern0pt}\ \isactrlconstUNDERSCOREname {\isasymopen}Nitpick{\isachardot}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}frac{\isasymclose}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}field{\isacharunderscore}{\kern0pt}char{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}class{\isachardot}{\kern0pt}of{\isacharunderscore}{\kern0pt}rat{\isasymclose}{\isacharcomma}{\kern0pt}\ \isactrlconstUNDERSCOREname {\isasymopen}Nitpick{\isachardot}{\kern0pt}of{\isacharunderscore}{\kern0pt}frac{\isasymclose}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
\isanewline
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}nitpick{\isacharunderscore}{\kern0pt}unfold{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ inverse{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}rat\isanewline
\ \ one{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}one{\isacharunderscore}{\kern0pt}rat\ ord{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}less{\isacharunderscore}{\kern0pt}rat\isanewline
\ \ ord{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}rat\ plus{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}plus{\isacharunderscore}{\kern0pt}rat\ times{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}times{\isacharunderscore}{\kern0pt}rat\isanewline
\ \ uminus{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}uminus{\isacharunderscore}{\kern0pt}rat\ zero{\isacharunderscore}{\kern0pt}rat{\isacharunderscore}{\kern0pt}inst{\isachardot}{\kern0pt}zero{\isacharunderscore}{\kern0pt}rat%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Float syntax%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{syntax}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}Float{\isachardoublequoteclose}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}float{\isacharunderscore}{\kern0pt}const\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\ \ \ \ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{parse{\isacharunderscore}{\kern0pt}translation}\isamarkupfalse%
\ {\isacartoucheopen}\isanewline
\ \ let\isanewline
\ \ \ \ fun\ mk{\isacharunderscore}{\kern0pt}frac\ str\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ let\isanewline
\ \ \ \ \ \ \ \ val\ {\isacharbraceleft}{\kern0pt}mant\ {\isacharequal}{\kern0pt}\ i{\isacharcomma}{\kern0pt}\ exp\ {\isacharequal}{\kern0pt}\ n{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Lexicon{\isachardot}{\kern0pt}read{\isacharunderscore}{\kern0pt}float\ str{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ val\ exp\ {\isacharequal}{\kern0pt}\ Syntax{\isachardot}{\kern0pt}const\ \isactrlconstUNDERSCOREsyntax {\isasymopen}Power{\isachardot}{\kern0pt}power{\isasymclose}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ val\ ten\ {\isacharequal}{\kern0pt}\ Numeral{\isachardot}{\kern0pt}mk{\isacharunderscore}{\kern0pt}number{\isacharunderscore}{\kern0pt}syntax\ {\isadigit{1}}{\isadigit{0}}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ val\ exp{\isadigit{1}}{\isadigit{0}}\ {\isacharequal}{\kern0pt}\ if\ n\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\ then\ ten\ else\ exp\ {\isachardollar}{\kern0pt}\ ten\ {\isachardollar}{\kern0pt}\ Numeral{\isachardot}{\kern0pt}mk{\isacharunderscore}{\kern0pt}number{\isacharunderscore}{\kern0pt}syntax\ n{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ in\ Syntax{\isachardot}{\kern0pt}const\ \isactrlconstUNDERSCOREsyntax {\isasymopen}Fields{\isachardot}{\kern0pt}inverse{\isacharunderscore}{\kern0pt}divide{\isasymclose}\ {\isachardollar}{\kern0pt}\ Numeral{\isachardot}{\kern0pt}mk{\isacharunderscore}{\kern0pt}number{\isacharunderscore}{\kern0pt}syntax\ i\ {\isachardollar}{\kern0pt}\ exp{\isadigit{1}}{\isadigit{0}}\ end{\isacharsemicolon}{\kern0pt}\isanewline
\isanewline
\ \ \ \ fun\ float{\isacharunderscore}{\kern0pt}tr\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}c\ as\ Const\ {\isacharparenleft}{\kern0pt}\isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}constrain{\isasymclose}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ t\ {\isachardollar}{\kern0pt}\ u{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ c\ {\isachardollar}{\kern0pt}\ float{\isacharunderscore}{\kern0pt}tr\ {\isacharbrackleft}{\kern0pt}t{\isacharbrackright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ u\isanewline
\ \ \ \ \ \ {\isacharbar}{\kern0pt}\ float{\isacharunderscore}{\kern0pt}tr\ {\isacharbrackleft}{\kern0pt}t\ as\ Const\ {\isacharparenleft}{\kern0pt}str{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ mk{\isacharunderscore}{\kern0pt}frac\ str\isanewline
\ \ \ \ \ \ {\isacharbar}{\kern0pt}\ float{\isacharunderscore}{\kern0pt}tr\ ts\ {\isacharequal}{\kern0pt}\ raise\ TERM\ {\isacharparenleft}{\kern0pt}{\isachardoublequote}{\kern0pt}float{\isacharunderscore}{\kern0pt}tr{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\ ts{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ in\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}\isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}Float{\isasymclose}{\isacharcomma}{\kern0pt}\ K\ float{\isacharunderscore}{\kern0pt}tr{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ end\isanewline
{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
%
\begin{isamarkuptext}%
Test:%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}{\isadigit{2}}{\isadigit{3}}{\isachardot}{\kern0pt}{\isadigit{4}}{\isadigit{5}}{\isadigit{6}}\ {\isacharequal}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isadigit{1}}{\isadigit{1}}{\isadigit{1}}{\isachardot}{\kern0pt}{\isadigit{1}}{\isadigit{1}}{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ {\isadigit{2}}{\isadigit{0}}{\isadigit{0}}\ {\isacharplus}{\kern0pt}\ {\isadigit{3}}{\isadigit{0}}\ {\isacharplus}{\kern0pt}\ {\isadigit{4}}\ {\isacharplus}{\kern0pt}\ {\isadigit{5}}{\isacharslash}{\kern0pt}{\isadigit{1}}{\isadigit{0}}\ {\isacharplus}{\kern0pt}\ {\isadigit{6}}{\isacharslash}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{7}}{\isacharslash}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isadigit{0}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}rat{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Hiding implementation details%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{hide{\isacharunderscore}{\kern0pt}const}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}\isakeyword{open}{\isacharparenright}{\kern0pt}\ normalize\ positive\isanewline
\isanewline
\isacommand{lifting{\isacharunderscore}{\kern0pt}update}\isamarkupfalse%
\ rat{\isachardot}{\kern0pt}lifting\isanewline
\isacommand{lifting{\isacharunderscore}{\kern0pt}forget}\isamarkupfalse%
\ rat{\isachardot}{\kern0pt}lifting\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=Rat.tex%:%
%:%11=5%:%
%:%27=7%:%
%:%28=7%:%
%:%29=8%:%
%:%30=9%:%
%:%44=11%:%
%:%48=13%:%
%:%58=15%:%
%:%59=15%:%
%:%60=16%:%
%:%61=17%:%
%:%62=18%:%
%:%63=18%:%
%:%66=19%:%
%:%70=19%:%
%:%71=19%:%
%:%76=19%:%
%:%79=20%:%
%:%80=21%:%
%:%81=21%:%
%:%84=22%:%
%:%88=22%:%
%:%89=22%:%
%:%94=22%:%
%:%97=23%:%
%:%98=24%:%
%:%99=24%:%
%:%102=25%:%
%:%106=25%:%
%:%107=25%:%
%:%112=25%:%
%:%115=26%:%
%:%116=27%:%
%:%117=27%:%
%:%124=28%:%
%:%125=28%:%
%:%126=29%:%
%:%127=29%:%
%:%128=30%:%
%:%129=30%:%
%:%130=31%:%
%:%131=31%:%
%:%132=32%:%
%:%133=32%:%
%:%134=32%:%
%:%135=33%:%
%:%136=33%:%
%:%137=33%:%
%:%138=33%:%
%:%139=33%:%
%:%140=34%:%
%:%141=34%:%
%:%142=34%:%
%:%143=34%:%
%:%144=35%:%
%:%145=35%:%
%:%146=35%:%
%:%147=35%:%
%:%148=35%:%
%:%149=36%:%
%:%150=36%:%
%:%151=36%:%
%:%152=36%:%
%:%153=37%:%
%:%154=37%:%
%:%155=37%:%
%:%156=37%:%
%:%157=38%:%
%:%158=38%:%
%:%159=38%:%
%:%160=38%:%
%:%161=38%:%
%:%162=39%:%
%:%163=39%:%
%:%164=39%:%
%:%165=39%:%
%:%166=40%:%
%:%167=40%:%
%:%168=40%:%
%:%169=40%:%
%:%170=41%:%
%:%176=41%:%
%:%179=42%:%
%:%180=43%:%
%:%181=43%:%
%:%184=44%:%
%:%188=44%:%
%:%189=44%:%
%:%194=44%:%
%:%197=45%:%
%:%198=46%:%
%:%199=46%:%
%:%200=47%:%
%:%203=48%:%
%:%207=48%:%
%:%208=48%:%
%:%213=48%:%
%:%216=49%:%
%:%217=50%:%
%:%218=50%:%
%:%221=51%:%
%:%225=51%:%
%:%226=51%:%
%:%240=54%:%
%:%250=56%:%
%:%251=56%:%
%:%252=57%:%
%:%255=58%:%
%:%259=58%:%
%:%260=58%:%
%:%265=58%:%
%:%268=59%:%
%:%269=60%:%
%:%270=60%:%
%:%271=61%:%
%:%272=62%:%
%:%273=63%:%
%:%276=64%:%
%:%280=64%:%
%:%281=64%:%
%:%286=64%:%
%:%289=65%:%
%:%290=66%:%
%:%291=66%:%
%:%292=67%:%
%:%293=68%:%
%:%300=69%:%
%:%301=69%:%
%:%302=70%:%
%:%303=70%:%
%:%304=71%:%
%:%305=71%:%
%:%306=72%:%
%:%307=72%:%
%:%308=73%:%
%:%309=73%:%
%:%310=74%:%
%:%311=74%:%
%:%312=74%:%
%:%313=75%:%
%:%314=75%:%
%:%315=76%:%
%:%316=76%:%
%:%317=76%:%
%:%318=77%:%
%:%319=77%:%
%:%320=78%:%
%:%321=78%:%
%:%322=78%:%
%:%323=79%:%
%:%324=79%:%
%:%325=80%:%
%:%326=80%:%
%:%327=80%:%
%:%328=81%:%
%:%329=81%:%
%:%330=82%:%
%:%331=82%:%
%:%332=83%:%
%:%333=83%:%
%:%334=84%:%
%:%335=84%:%
%:%336=85%:%
%:%337=85%:%
%:%338=85%:%
%:%339=86%:%
%:%340=86%:%
%:%341=87%:%
%:%342=87%:%
%:%343=87%:%
%:%344=87%:%
%:%345=88%:%
%:%346=88%:%
%:%347=89%:%
%:%348=89%:%
%:%349=90%:%
%:%350=90%:%
%:%351=91%:%
%:%352=91%:%
%:%353=91%:%
%:%354=92%:%
%:%355=92%:%
%:%356=92%:%
%:%357=92%:%
%:%358=93%:%
%:%359=93%:%
%:%360=94%:%
%:%361=94%:%
%:%362=94%:%
%:%363=94%:%
%:%364=95%:%
%:%365=95%:%
%:%366=96%:%
%:%367=96%:%
%:%368=96%:%
%:%369=97%:%
%:%370=97%:%
%:%371=98%:%
%:%372=98%:%
%:%373=99%:%
%:%379=99%:%
%:%382=100%:%
%:%383=101%:%
%:%384=101%:%
%:%385=102%:%
%:%386=103%:%
%:%389=104%:%
%:%393=104%:%
%:%394=104%:%
%:%395=104%:%
%:%400=104%:%
%:%403=105%:%
%:%404=106%:%
%:%405=106%:%
%:%406=107%:%
%:%407=108%:%
%:%408=109%:%
%:%409=109%:%
%:%412=110%:%
%:%416=110%:%
%:%417=110%:%
%:%422=110%:%
%:%425=111%:%
%:%426=112%:%
%:%427=112%:%
%:%430=113%:%
%:%434=113%:%
%:%435=113%:%
%:%440=113%:%
%:%443=114%:%
%:%444=115%:%
%:%445=115%:%
%:%448=116%:%
%:%452=116%:%
%:%453=116%:%
%:%458=116%:%
%:%461=117%:%
%:%462=118%:%
%:%463=118%:%
%:%466=119%:%
%:%470=119%:%
%:%471=119%:%
%:%476=119%:%
%:%479=120%:%
%:%480=121%:%
%:%481=121%:%
%:%482=122%:%
%:%485=123%:%
%:%489=123%:%
%:%490=123%:%
%:%495=123%:%
%:%498=124%:%
%:%499=125%:%
%:%500=125%:%
%:%501=126%:%
%:%502=127%:%
%:%505=128%:%
%:%509=128%:%
%:%510=128%:%
%:%511=128%:%
%:%516=128%:%
%:%519=129%:%
%:%520=130%:%
%:%521=130%:%
%:%524=131%:%
%:%528=131%:%
%:%529=131%:%
%:%534=131%:%
%:%537=132%:%
%:%538=133%:%
%:%539=133%:%
%:%542=134%:%
%:%546=134%:%
%:%547=134%:%
%:%552=134%:%
%:%555=135%:%
%:%556=136%:%
%:%557=136%:%
%:%560=137%:%
%:%564=137%:%
%:%565=137%:%
%:%570=137%:%
%:%573=138%:%
%:%574=139%:%
%:%575=139%:%
%:%576=140%:%
%:%577=141%:%
%:%578=141%:%
%:%579=142%:%
%:%582=143%:%
%:%586=143%:%
%:%587=143%:%
%:%592=143%:%
%:%595=144%:%
%:%596=145%:%
%:%597=145%:%
%:%598=146%:%
%:%601=147%:%
%:%605=147%:%
%:%606=147%:%
%:%611=147%:%
%:%614=148%:%
%:%615=149%:%
%:%616=149%:%
%:%619=150%:%
%:%623=150%:%
%:%624=150%:%
%:%629=150%:%
%:%632=151%:%
%:%633=152%:%
%:%634=152%:%
%:%637=153%:%
%:%641=153%:%
%:%642=153%:%
%:%647=153%:%
%:%650=154%:%
%:%651=155%:%
%:%652=155%:%
%:%653=156%:%
%:%656=157%:%
%:%660=157%:%
%:%661=157%:%
%:%666=157%:%
%:%669=158%:%
%:%670=159%:%
%:%671=159%:%
%:%674=160%:%
%:%678=160%:%
%:%679=160%:%
%:%684=160%:%
%:%687=161%:%
%:%688=162%:%
%:%689=162%:%
%:%690=163%:%
%:%691=164%:%
%:%692=164%:%
%:%695=165%:%
%:%699=165%:%
%:%700=165%:%
%:%705=165%:%
%:%708=166%:%
%:%709=167%:%
%:%710=167%:%
%:%717=168%:%
%:%718=168%:%
%:%719=169%:%
%:%720=169%:%
%:%721=170%:%
%:%722=170%:%
%:%723=171%:%
%:%724=171%:%
%:%725=172%:%
%:%726=172%:%
%:%727=173%:%
%:%728=173%:%
%:%729=174%:%
%:%730=174%:%
%:%731=175%:%
%:%732=175%:%
%:%733=176%:%
%:%734=176%:%
%:%735=177%:%
%:%736=177%:%
%:%737=178%:%
%:%738=178%:%
%:%739=179%:%
%:%740=179%:%
%:%741=180%:%
%:%742=180%:%
%:%743=181%:%
%:%744=181%:%
%:%745=182%:%
%:%746=182%:%
%:%747=183%:%
%:%748=183%:%
%:%749=184%:%
%:%750=184%:%
%:%751=185%:%
%:%752=185%:%
%:%753=186%:%
%:%754=186%:%
%:%755=187%:%
%:%756=187%:%
%:%757=188%:%
%:%758=188%:%
%:%759=189%:%
%:%760=189%:%
%:%761=190%:%
%:%762=190%:%
%:%763=191%:%
%:%764=191%:%
%:%765=191%:%
%:%766=192%:%
%:%767=192%:%
%:%768=193%:%
%:%769=193%:%
%:%770=194%:%
%:%771=194%:%
%:%772=195%:%
%:%773=195%:%
%:%774=196%:%
%:%780=196%:%
%:%783=197%:%
%:%784=198%:%
%:%785=198%:%
%:%786=199%:%
%:%787=200%:%
%:%788=201%:%
%:%789=201%:%
%:%790=202%:%
%:%791=203%:%
%:%794=204%:%
%:%798=204%:%
%:%799=204%:%
%:%800=204%:%
%:%805=204%:%
%:%808=205%:%
%:%809=206%:%
%:%810=206%:%
%:%811=207%:%
%:%812=208%:%
%:%815=209%:%
%:%819=209%:%
%:%820=209%:%
%:%821=209%:%
%:%826=209%:%
%:%829=210%:%
%:%830=211%:%
%:%831=211%:%
%:%834=212%:%
%:%838=212%:%
%:%839=212%:%
%:%844=212%:%
%:%847=213%:%
%:%848=214%:%
%:%849=214%:%
%:%852=215%:%
%:%856=215%:%
%:%857=215%:%
%:%862=215%:%
%:%865=216%:%
%:%866=217%:%
%:%867=217%:%
%:%870=218%:%
%:%874=218%:%
%:%875=218%:%
%:%880=218%:%
%:%883=219%:%
%:%884=220%:%
%:%885=220%:%
%:%888=221%:%
%:%892=221%:%
%:%893=221%:%
%:%898=221%:%
%:%901=222%:%
%:%902=223%:%
%:%903=223%:%
%:%904=224%:%
%:%905=225%:%
%:%906=226%:%
%:%907=227%:%
%:%908=228%:%
%:%909=229%:%
%:%912=230%:%
%:%916=230%:%
%:%917=230%:%
%:%918=231%:%
%:%919=232%:%
%:%920=232%:%
%:%925=232%:%
%:%928=233%:%
%:%929=234%:%
%:%930=234%:%
%:%931=235%:%
%:%932=236%:%
%:%933=237%:%
%:%934=238%:%
%:%935=239%:%
%:%938=240%:%
%:%942=240%:%
%:%943=240%:%
%:%948=240%:%
%:%951=241%:%
%:%952=242%:%
%:%953=242%:%
%:%954=243%:%
%:%955=244%:%
%:%956=245%:%
%:%963=246%:%
%:%964=246%:%
%:%965=247%:%
%:%966=247%:%
%:%967=248%:%
%:%968=248%:%
%:%969=248%:%
%:%970=248%:%
%:%971=248%:%
%:%972=249%:%
%:%973=249%:%
%:%974=250%:%
%:%975=250%:%
%:%976=251%:%
%:%977=251%:%
%:%978=251%:%
%:%979=252%:%
%:%980=252%:%
%:%981=253%:%
%:%982=253%:%
%:%983=253%:%
%:%984=254%:%
%:%985=254%:%
%:%986=255%:%
%:%987=255%:%
%:%988=255%:%
%:%989=256%:%
%:%990=256%:%
%:%991=257%:%
%:%992=257%:%
%:%993=257%:%
%:%994=257%:%
%:%995=258%:%
%:%1010=261%:%
%:%1020=263%:%
%:%1021=263%:%
%:%1028=264%:%
%:%1029=264%:%
%:%1030=265%:%
%:%1031=265%:%
%:%1032=266%:%
%:%1033=266%:%
%:%1034=266%:%
%:%1035=267%:%
%:%1036=267%:%
%:%1037=268%:%
%:%1038=268%:%
%:%1039=269%:%
%:%1040=269%:%
%:%1041=270%:%
%:%1042=270%:%
%:%1043=270%:%
%:%1044=271%:%
%:%1045=271%:%
%:%1046=272%:%
%:%1047=272%:%
%:%1048=272%:%
%:%1049=273%:%
%:%1050=273%:%
%:%1051=274%:%
%:%1052=274%:%
%:%1053=274%:%
%:%1054=275%:%
%:%1055=275%:%
%:%1056=276%:%
%:%1057=276%:%
%:%1058=276%:%
%:%1059=277%:%
%:%1060=277%:%
%:%1061=278%:%
%:%1067=278%:%
%:%1070=279%:%
%:%1071=280%:%
%:%1072=280%:%
%:%1073=281%:%
%:%1076=284%:%
%:%1077=285%:%
%:%1078=286%:%
%:%1079=286%:%
%:%1080=287%:%
%:%1081=288%:%
%:%1082=289%:%
%:%1089=290%:%
%:%1090=290%:%
%:%1091=291%:%
%:%1092=291%:%
%:%1093=292%:%
%:%1094=293%:%
%:%1095=293%:%
%:%1096=294%:%
%:%1097=294%:%
%:%1098=294%:%
%:%1099=295%:%
%:%1100=296%:%
%:%1101=296%:%
%:%1102=297%:%
%:%1103=297%:%
%:%1104=297%:%
%:%1105=298%:%
%:%1106=298%:%
%:%1107=299%:%
%:%1108=299%:%
%:%1109=300%:%
%:%1110=300%:%
%:%1111=300%:%
%:%1112=301%:%
%:%1113=301%:%
%:%1114=302%:%
%:%1115=303%:%
%:%1121=303%:%
%:%1124=304%:%
%:%1125=305%:%
%:%1126=305%:%
%:%1129=306%:%
%:%1133=306%:%
%:%1134=306%:%
%:%1135=307%:%
%:%1140=307%:%
%:%1143=308%:%
%:%1144=309%:%
%:%1145=309%:%
%:%1148=310%:%
%:%1152=310%:%
%:%1153=310%:%
%:%1154=311%:%
%:%1159=311%:%
%:%1162=312%:%
%:%1163=313%:%
%:%1164=313%:%
%:%1167=314%:%
%:%1171=314%:%
%:%1172=314%:%
%:%1177=314%:%
%:%1180=315%:%
%:%1181=316%:%
%:%1182=316%:%
%:%1185=317%:%
%:%1189=317%:%
%:%1190=317%:%
%:%1195=317%:%
%:%1198=318%:%
%:%1199=319%:%
%:%1200=319%:%
%:%1203=320%:%
%:%1207=320%:%
%:%1208=320%:%
%:%1213=320%:%
%:%1216=321%:%
%:%1217=322%:%
%:%1218=322%:%
%:%1221=323%:%
%:%1225=323%:%
%:%1226=323%:%
%:%1235=326%:%
%:%1237=329%:%
%:%1238=329%:%
%:%1239=330%:%
%:%1240=331%:%
%:%1241=332%:%
%:%1242=333%:%
%:%1243=333%:%
%:%1250=334%:%
%:%1251=334%:%
%:%1252=335%:%
%:%1253=335%:%
%:%1254=336%:%
%:%1255=336%:%
%:%1256=336%:%
%:%1257=337%:%
%:%1258=338%:%
%:%1259=338%:%
%:%1260=339%:%
%:%1261=339%:%
%:%1262=339%:%
%:%1263=340%:%
%:%1264=340%:%
%:%1265=341%:%
%:%1266=341%:%
%:%1267=342%:%
%:%1268=342%:%
%:%1269=343%:%
%:%1270=343%:%
%:%1271=343%:%
%:%1272=344%:%
%:%1273=344%:%
%:%1274=344%:%
%:%1275=345%:%
%:%1276=345%:%
%:%1277=346%:%
%:%1278=346%:%
%:%1279=347%:%
%:%1280=347%:%
%:%1281=348%:%
%:%1282=348%:%
%:%1283=349%:%
%:%1284=349%:%
%:%1285=349%:%
%:%1286=350%:%
%:%1287=350%:%
%:%1288=351%:%
%:%1289=351%:%
%:%1290=352%:%
%:%1291=352%:%
%:%1292=353%:%
%:%1293=353%:%
%:%1294=353%:%
%:%1295=354%:%
%:%1296=354%:%
%:%1297=355%:%
%:%1298=355%:%
%:%1299=355%:%
%:%1300=356%:%
%:%1301=356%:%
%:%1302=357%:%
%:%1303=357%:%
%:%1304=357%:%
%:%1305=358%:%
%:%1306=358%:%
%:%1307=359%:%
%:%1308=359%:%
%:%1309=359%:%
%:%1310=360%:%
%:%1311=360%:%
%:%1312=361%:%
%:%1313=361%:%
%:%1314=361%:%
%:%1315=362%:%
%:%1316=362%:%
%:%1317=363%:%
%:%1318=363%:%
%:%1319=363%:%
%:%1320=364%:%
%:%1321=364%:%
%:%1322=365%:%
%:%1323=365%:%
%:%1324=365%:%
%:%1325=366%:%
%:%1326=366%:%
%:%1327=367%:%
%:%1328=367%:%
%:%1329=367%:%
%:%1330=368%:%
%:%1331=368%:%
%:%1332=369%:%
%:%1333=369%:%
%:%1334=370%:%
%:%1335=370%:%
%:%1336=370%:%
%:%1337=371%:%
%:%1338=371%:%
%:%1339=372%:%
%:%1340=372%:%
%:%1341=373%:%
%:%1347=373%:%
%:%1350=374%:%
%:%1351=375%:%
%:%1352=375%:%
%:%1359=376%:%
%:%1360=376%:%
%:%1361=377%:%
%:%1362=377%:%
%:%1363=378%:%
%:%1364=378%:%
%:%1365=379%:%
%:%1366=379%:%
%:%1367=379%:%
%:%1368=380%:%
%:%1369=380%:%
%:%1370=381%:%
%:%1371=381%:%
%:%1372=381%:%
%:%1373=382%:%
%:%1374=382%:%
%:%1375=383%:%
%:%1376=383%:%
%:%1377=383%:%
%:%1378=383%:%
%:%1379=384%:%
%:%1380=384%:%
%:%1381=384%:%
%:%1382=385%:%
%:%1383=386%:%
%:%1384=386%:%
%:%1385=387%:%
%:%1386=387%:%
%:%1387=387%:%
%:%1388=387%:%
%:%1389=388%:%
%:%1395=388%:%
%:%1398=389%:%
%:%1399=390%:%
%:%1400=390%:%
%:%1401=391%:%
%:%1402=392%:%
%:%1403=393%:%
%:%1404=394%:%
%:%1405=395%:%
%:%1408=396%:%
%:%1412=396%:%
%:%1413=396%:%
%:%1418=396%:%
%:%1421=397%:%
%:%1422=398%:%
%:%1423=398%:%
%:%1426=399%:%
%:%1430=399%:%
%:%1431=399%:%
%:%1436=399%:%
%:%1439=400%:%
%:%1440=401%:%
%:%1441=401%:%
%:%1444=402%:%
%:%1448=402%:%
%:%1449=402%:%
%:%1454=402%:%
%:%1457=403%:%
%:%1458=404%:%
%:%1459=404%:%
%:%1462=405%:%
%:%1466=405%:%
%:%1467=405%:%
%:%1468=405%:%
%:%1473=405%:%
%:%1476=406%:%
%:%1477=407%:%
%:%1478=407%:%
%:%1481=408%:%
%:%1485=408%:%
%:%1486=408%:%
%:%1491=408%:%
%:%1494=409%:%
%:%1495=410%:%
%:%1496=410%:%
%:%1497=411%:%
%:%1498=412%:%
%:%1505=413%:%
%:%1506=413%:%
%:%1507=414%:%
%:%1508=414%:%
%:%1509=415%:%
%:%1510=415%:%
%:%1511=416%:%
%:%1512=416%:%
%:%1513=416%:%
%:%1514=417%:%
%:%1515=417%:%
%:%1516=418%:%
%:%1522=418%:%
%:%1525=419%:%
%:%1526=420%:%
%:%1527=420%:%
%:%1530=421%:%
%:%1534=421%:%
%:%1535=421%:%
%:%1549=424%:%
%:%1559=426%:%
%:%1560=426%:%
%:%1563=427%:%
%:%1567=427%:%
%:%1568=427%:%
%:%1573=427%:%
%:%1576=428%:%
%:%1577=429%:%
%:%1578=429%:%
%:%1581=430%:%
%:%1585=430%:%
%:%1586=430%:%
%:%1591=430%:%
%:%1594=431%:%
%:%1595=432%:%
%:%1596=432%:%
%:%1597=433%:%
%:%1598=434%:%
%:%1605=435%:%
%:%1606=435%:%
%:%1607=436%:%
%:%1608=436%:%
%:%1609=437%:%
%:%1610=437%:%
%:%1611=437%:%
%:%1612=438%:%
%:%1613=438%:%
%:%1614=438%:%
%:%1615=438%:%
%:%1616=439%:%
%:%1617=439%:%
%:%1618=440%:%
%:%1633=443%:%
%:%1643=445%:%
%:%1644=445%:%
%:%1645=446%:%
%:%1652=447%:%
%:%1653=447%:%
%:%1654=448%:%
%:%1655=448%:%
%:%1656=449%:%
%:%1657=449%:%
%:%1658=450%:%
%:%1659=450%:%
%:%1660=450%:%
%:%1661=451%:%
%:%1662=451%:%
%:%1663=452%:%
%:%1664=452%:%
%:%1665=452%:%
%:%1666=453%:%
%:%1667=453%:%
%:%1668=453%:%
%:%1669=454%:%
%:%1670=454%:%
%:%1671=454%:%
%:%1672=455%:%
%:%1673=455%:%
%:%1674=456%:%
%:%1675=456%:%
%:%1676=456%:%
%:%1677=457%:%
%:%1678=457%:%
%:%1679=458%:%
%:%1680=458%:%
%:%1681=459%:%
%:%1687=459%:%
%:%1690=460%:%
%:%1691=461%:%
%:%1692=461%:%
%:%1695=462%:%
%:%1699=462%:%
%:%1700=462%:%
%:%1705=462%:%
%:%1708=463%:%
%:%1709=464%:%
%:%1710=464%:%
%:%1713=465%:%
%:%1717=465%:%
%:%1718=465%:%
%:%1719=466%:%
%:%1720=466%:%
%:%1721=467%:%
%:%1727=467%:%
%:%1730=468%:%
%:%1731=469%:%
%:%1732=469%:%
%:%1735=470%:%
%:%1739=470%:%
%:%1740=470%:%
%:%1741=471%:%
%:%1742=471%:%
%:%1747=471%:%
%:%1750=472%:%
%:%1751=473%:%
%:%1752=473%:%
%:%1755=474%:%
%:%1759=474%:%
%:%1760=474%:%
%:%1765=474%:%
%:%1768=475%:%
%:%1769=476%:%
%:%1770=476%:%
%:%1771=477%:%
%:%1772=478%:%
%:%1773=479%:%
%:%1774=479%:%
%:%1775=480%:%
%:%1776=481%:%
%:%1777=481%:%
%:%1778=482%:%
%:%1779=483%:%
%:%1780=483%:%
%:%1781=484%:%
%:%1782=485%:%
%:%1783=485%:%
%:%1784=486%:%
%:%1785=487%:%
%:%1786=487%:%
%:%1793=488%:%
%:%1794=488%:%
%:%1795=489%:%
%:%1796=489%:%
%:%1797=490%:%
%:%1798=490%:%
%:%1799=491%:%
%:%1800=491%:%
%:%1801=492%:%
%:%1802=492%:%
%:%1803=493%:%
%:%1804=493%:%
%:%1805=494%:%
%:%1806=494%:%
%:%1807=494%:%
%:%1808=495%:%
%:%1809=495%:%
%:%1810=496%:%
%:%1811=496%:%
%:%1812=496%:%
%:%1813=497%:%
%:%1814=497%:%
%:%1815=498%:%
%:%1816=498%:%
%:%1817=499%:%
%:%1818=499%:%
%:%1819=499%:%
%:%1820=500%:%
%:%1821=500%:%
%:%1822=501%:%
%:%1823=501%:%
%:%1824=502%:%
%:%1825=502%:%
%:%1826=502%:%
%:%1827=503%:%
%:%1828=503%:%
%:%1829=504%:%
%:%1830=504%:%
%:%1831=504%:%
%:%1832=505%:%
%:%1833=505%:%
%:%1834=506%:%
%:%1835=506%:%
%:%1836=507%:%
%:%1837=507%:%
%:%1838=508%:%
%:%1839=508%:%
%:%1840=509%:%
%:%1841=509%:%
%:%1842=510%:%
%:%1843=510%:%
%:%1844=511%:%
%:%1845=511%:%
%:%1846=512%:%
%:%1847=512%:%
%:%1848=513%:%
%:%1854=513%:%
%:%1857=514%:%
%:%1858=515%:%
%:%1859=515%:%
%:%1860=516%:%
%:%1861=517%:%
%:%1862=517%:%
%:%1863=518%:%
%:%1864=519%:%
%:%1865=520%:%
%:%1866=520%:%
%:%1867=521%:%
%:%1868=522%:%
%:%1869=522%:%
%:%1870=523%:%
%:%1871=524%:%
%:%1872=524%:%
%:%1875=525%:%
%:%1879=525%:%
%:%1880=525%:%
%:%1885=525%:%
%:%1888=526%:%
%:%1889=527%:%
%:%1890=527%:%
%:%1891=528%:%
%:%1892=529%:%
%:%1893=529%:%
%:%1896=530%:%
%:%1900=530%:%
%:%1901=530%:%
%:%1906=530%:%
%:%1909=531%:%
%:%1910=532%:%
%:%1911=532%:%
%:%1912=533%:%
%:%1915=534%:%
%:%1919=534%:%
%:%1920=534%:%
%:%1925=534%:%
%:%1928=535%:%
%:%1929=536%:%
%:%1930=536%:%
%:%1931=537%:%
%:%1934=538%:%
%:%1938=538%:%
%:%1939=538%:%
%:%1944=538%:%
%:%1947=539%:%
%:%1948=540%:%
%:%1949=540%:%
%:%1952=541%:%
%:%1956=541%:%
%:%1957=541%:%
%:%1962=541%:%
%:%1965=542%:%
%:%1966=543%:%
%:%1967=543%:%
%:%1970=544%:%
%:%1974=544%:%
%:%1975=544%:%
%:%1976=545%:%
%:%1977=545%:%
%:%1978=546%:%
%:%1983=546%:%
%:%1986=547%:%
%:%1987=548%:%
%:%1988=548%:%
%:%1989=549%:%
%:%1990=550%:%
%:%1997=551%:%
%:%1998=551%:%
%:%1999=552%:%
%:%2000=552%:%
%:%2001=553%:%
%:%2002=553%:%
%:%2003=554%:%
%:%2004=554%:%
%:%2005=555%:%
%:%2006=555%:%
%:%2007=555%:%
%:%2008=556%:%
%:%2009=556%:%
%:%2010=557%:%
%:%2011=557%:%
%:%2012=557%:%
%:%2013=558%:%
%:%2014=558%:%
%:%2015=559%:%
%:%2016=559%:%
%:%2017=559%:%
%:%2018=560%:%
%:%2019=560%:%
%:%2020=561%:%
%:%2021=561%:%
%:%2022=562%:%
%:%2023=562%:%
%:%2024=562%:%
%:%2025=563%:%
%:%2026=563%:%
%:%2027=564%:%
%:%2033=564%:%
%:%2036=565%:%
%:%2037=566%:%
%:%2038=566%:%
%:%2041=567%:%
%:%2045=567%:%
%:%2046=567%:%
%:%2051=567%:%
%:%2054=568%:%
%:%2055=569%:%
%:%2056=569%:%
%:%2059=570%:%
%:%2063=570%:%
%:%2064=570%:%
%:%2069=570%:%
%:%2072=571%:%
%:%2073=572%:%
%:%2074=572%:%
%:%2077=573%:%
%:%2081=573%:%
%:%2082=573%:%
%:%2087=573%:%
%:%2090=574%:%
%:%2091=575%:%
%:%2092=575%:%
%:%2095=576%:%
%:%2099=576%:%
%:%2100=576%:%
%:%2105=576%:%
%:%2108=577%:%
%:%2109=578%:%
%:%2110=578%:%
%:%2113=579%:%
%:%2117=579%:%
%:%2118=579%:%
%:%2123=579%:%
%:%2126=580%:%
%:%2127=581%:%
%:%2128=581%:%
%:%2131=582%:%
%:%2135=582%:%
%:%2136=582%:%
%:%2141=582%:%
%:%2144=583%:%
%:%2145=584%:%
%:%2146=584%:%
%:%2149=585%:%
%:%2153=585%:%
%:%2154=585%:%
%:%2159=585%:%
%:%2162=586%:%
%:%2163=587%:%
%:%2164=587%:%
%:%2167=588%:%
%:%2171=588%:%
%:%2172=588%:%
%:%2186=591%:%
%:%2196=593%:%
%:%2197=593%:%
%:%2204=594%:%
%:%2205=594%:%
%:%2206=595%:%
%:%2207=595%:%
%:%2208=596%:%
%:%2209=596%:%
%:%2210=597%:%
%:%2211=597%:%
%:%2212=597%:%
%:%2213=598%:%
%:%2214=598%:%
%:%2215=599%:%
%:%2216=599%:%
%:%2217=600%:%
%:%2218=600%:%
%:%2219=600%:%
%:%2220=600%:%
%:%2221=601%:%
%:%2227=601%:%
%:%2230=602%:%
%:%2231=603%:%
%:%2232=603%:%
%:%2239=604%:%
%:%2240=604%:%
%:%2241=605%:%
%:%2242=605%:%
%:%2243=606%:%
%:%2244=606%:%
%:%2245=607%:%
%:%2246=607%:%
%:%2247=608%:%
%:%2248=608%:%
%:%2249=609%:%
%:%2250=609%:%
%:%2251=609%:%
%:%2252=610%:%
%:%2253=610%:%
%:%2254=610%:%
%:%2255=610%:%
%:%2256=611%:%
%:%2257=611%:%
%:%2258=612%:%
%:%2264=612%:%
%:%2267=613%:%
%:%2268=614%:%
%:%2269=614%:%
%:%2270=615%:%
%:%2271=616%:%
%:%2272=617%:%
%:%2273=617%:%
%:%2274=618%:%
%:%2275=619%:%
%:%2276=620%:%
%:%2277=620%:%
%:%2284=621%:%
%:%2285=621%:%
%:%2286=622%:%
%:%2287=622%:%
%:%2288=623%:%
%:%2289=623%:%
%:%2290=623%:%
%:%2291=623%:%
%:%2292=624%:%
%:%2298=624%:%
%:%2301=625%:%
%:%2302=626%:%
%:%2303=626%:%
%:%2304=627%:%
%:%2305=628%:%
%:%2306=628%:%
%:%2309=629%:%
%:%2313=629%:%
%:%2314=629%:%
%:%2328=632%:%
%:%2344=634%:%
%:%2345=634%:%
%:%2364=642%:%
%:%2374=644%:%
%:%2375=644%:%
%:%2376=645%:%
%:%2377=646%:%
%:%2378=647%:%
%:%2379=647%:%
%:%2380=648%:%
%:%2383=649%:%
%:%2387=649%:%
%:%2388=649%:%
%:%2393=649%:%
%:%2396=650%:%
%:%2397=651%:%
%:%2398=651%:%
%:%2399=652%:%
%:%2400=653%:%
%:%2401=653%:%
%:%2404=654%:%
%:%2408=654%:%
%:%2409=654%:%
%:%2414=654%:%
%:%2417=655%:%
%:%2418=656%:%
%:%2419=656%:%
%:%2422=657%:%
%:%2426=657%:%
%:%2427=657%:%
%:%2432=657%:%
%:%2435=658%:%
%:%2436=659%:%
%:%2437=659%:%
%:%2440=660%:%
%:%2444=660%:%
%:%2445=660%:%
%:%2450=660%:%
%:%2453=661%:%
%:%2454=662%:%
%:%2455=662%:%
%:%2458=663%:%
%:%2462=663%:%
%:%2463=663%:%
%:%2468=663%:%
%:%2471=664%:%
%:%2472=665%:%
%:%2473=665%:%
%:%2476=666%:%
%:%2480=666%:%
%:%2481=666%:%
%:%2486=666%:%
%:%2489=667%:%
%:%2490=668%:%
%:%2491=668%:%
%:%2494=669%:%
%:%2498=669%:%
%:%2499=669%:%
%:%2504=669%:%
%:%2507=670%:%
%:%2508=671%:%
%:%2509=671%:%
%:%2512=672%:%
%:%2516=672%:%
%:%2517=672%:%
%:%2518=672%:%
%:%2523=672%:%
%:%2526=673%:%
%:%2527=674%:%
%:%2528=674%:%
%:%2531=675%:%
%:%2535=675%:%
%:%2536=675%:%
%:%2541=675%:%
%:%2544=676%:%
%:%2545=677%:%
%:%2546=677%:%
%:%2549=678%:%
%:%2553=678%:%
%:%2554=678%:%
%:%2559=678%:%
%:%2562=679%:%
%:%2563=680%:%
%:%2564=680%:%
%:%2567=681%:%
%:%2571=681%:%
%:%2572=681%:%
%:%2577=681%:%
%:%2580=682%:%
%:%2581=683%:%
%:%2582=683%:%
%:%2585=684%:%
%:%2589=684%:%
%:%2590=684%:%
%:%2595=684%:%
%:%2598=685%:%
%:%2599=686%:%
%:%2600=686%:%
%:%2603=687%:%
%:%2607=687%:%
%:%2608=687%:%
%:%2613=687%:%
%:%2616=688%:%
%:%2617=689%:%
%:%2618=689%:%
%:%2621=690%:%
%:%2625=690%:%
%:%2626=690%:%
%:%2631=690%:%
%:%2634=691%:%
%:%2635=692%:%
%:%2636=692%:%
%:%2639=693%:%
%:%2643=693%:%
%:%2644=693%:%
%:%2649=693%:%
%:%2652=694%:%
%:%2653=695%:%
%:%2654=695%:%
%:%2657=696%:%
%:%2661=696%:%
%:%2662=696%:%
%:%2667=696%:%
%:%2670=697%:%
%:%2671=698%:%
%:%2672=698%:%
%:%2675=699%:%
%:%2679=699%:%
%:%2680=699%:%
%:%2681=700%:%
%:%2682=700%:%
%:%2683=701%:%
%:%2689=701%:%
%:%2692=702%:%
%:%2693=703%:%
%:%2694=703%:%
%:%2697=704%:%
%:%2701=704%:%
%:%2702=704%:%
%:%2703=704%:%
%:%2708=704%:%
%:%2711=705%:%
%:%2712=706%:%
%:%2713=706%:%
%:%2716=707%:%
%:%2720=707%:%
%:%2721=707%:%
%:%2726=707%:%
%:%2729=708%:%
%:%2730=709%:%
%:%2731=709%:%
%:%2734=710%:%
%:%2738=710%:%
%:%2739=710%:%
%:%2740=710%:%
%:%2745=710%:%
%:%2748=711%:%
%:%2749=712%:%
%:%2750=712%:%
%:%2753=713%:%
%:%2757=713%:%
%:%2758=713%:%
%:%2763=713%:%
%:%2766=714%:%
%:%2767=715%:%
%:%2768=715%:%
%:%2775=716%:%
%:%2776=716%:%
%:%2777=717%:%
%:%2778=717%:%
%:%2779=718%:%
%:%2780=718%:%
%:%2781=719%:%
%:%2782=719%:%
%:%2783=719%:%
%:%2784=719%:%
%:%2785=720%:%
%:%2786=720%:%
%:%2787=721%:%
%:%2788=722%:%
%:%2789=723%:%
%:%2790=723%:%
%:%2791=723%:%
%:%2792=724%:%
%:%2793=724%:%
%:%2794=725%:%
%:%2795=726%:%
%:%2796=726%:%
%:%2797=727%:%
%:%2798=727%:%
%:%2799=728%:%
%:%2805=728%:%
%:%2808=729%:%
%:%2809=730%:%
%:%2810=730%:%
%:%2813=731%:%
%:%2817=731%:%
%:%2818=731%:%
%:%2819=731%:%
%:%2824=731%:%
%:%2827=732%:%
%:%2828=733%:%
%:%2829=733%:%
%:%2832=734%:%
%:%2836=734%:%
%:%2837=734%:%
%:%2838=734%:%
%:%2843=734%:%
%:%2846=735%:%
%:%2847=736%:%
%:%2848=736%:%
%:%2851=737%:%
%:%2855=737%:%
%:%2856=737%:%
%:%2857=737%:%
%:%2862=737%:%
%:%2865=738%:%
%:%2866=739%:%
%:%2867=739%:%
%:%2870=740%:%
%:%2874=740%:%
%:%2875=740%:%
%:%2876=740%:%
%:%2881=740%:%
%:%2884=741%:%
%:%2885=742%:%
%:%2886=742%:%
%:%2889=743%:%
%:%2893=743%:%
%:%2894=743%:%
%:%2895=743%:%
%:%2900=743%:%
%:%2903=744%:%
%:%2904=745%:%
%:%2905=745%:%
%:%2908=746%:%
%:%2912=746%:%
%:%2913=746%:%
%:%2914=746%:%
%:%2919=746%:%
%:%2922=747%:%
%:%2923=748%:%
%:%2924=748%:%
%:%2927=749%:%
%:%2931=749%:%
%:%2932=749%:%
%:%2933=749%:%
%:%2938=749%:%
%:%2941=750%:%
%:%2942=751%:%
%:%2943=751%:%
%:%2946=752%:%
%:%2950=752%:%
%:%2951=752%:%
%:%2952=752%:%
%:%2957=752%:%
%:%2960=753%:%
%:%2961=754%:%
%:%2962=754%:%
%:%2965=755%:%
%:%2969=755%:%
%:%2970=755%:%
%:%2971=755%:%
%:%2976=755%:%
%:%2979=756%:%
%:%2980=757%:%
%:%2981=757%:%
%:%2988=758%:%
%:%2989=758%:%
%:%2990=759%:%
%:%2991=759%:%
%:%2992=760%:%
%:%2993=760%:%
%:%2994=761%:%
%:%3000=761%:%
%:%3003=762%:%
%:%3004=763%:%
%:%3005=763%:%
%:%3006=764%:%
%:%3009=765%:%
%:%3013=765%:%
%:%3014=765%:%
%:%3023=767%:%
%:%3025=768%:%
%:%3026=768%:%
%:%3029=769%:%
%:%3033=769%:%
%:%3034=769%:%
%:%3039=769%:%
%:%3042=770%:%
%:%3043=771%:%
%:%3044=771%:%
%:%3047=772%:%
%:%3051=772%:%
%:%3052=772%:%
%:%3057=772%:%
%:%3060=773%:%
%:%3061=774%:%
%:%3062=774%:%
%:%3065=775%:%
%:%3069=775%:%
%:%3070=775%:%
%:%3071=775%:%
%:%3076=775%:%
%:%3079=776%:%
%:%3080=777%:%
%:%3081=777%:%
%:%3084=778%:%
%:%3088=778%:%
%:%3089=778%:%
%:%3090=778%:%
%:%3095=778%:%
%:%3098=779%:%
%:%3099=780%:%
%:%3100=780%:%
%:%3101=781%:%
%:%3104=782%:%
%:%3108=782%:%
%:%3109=782%:%
%:%3114=782%:%
%:%3117=783%:%
%:%3118=784%:%
%:%3119=784%:%
%:%3120=785%:%
%:%3123=786%:%
%:%3127=786%:%
%:%3128=786%:%
%:%3129=786%:%
%:%3134=786%:%
%:%3137=787%:%
%:%3138=788%:%
%:%3139=788%:%
%:%3140=789%:%
%:%3141=789%:%
%:%3142=790%:%
%:%3143=791%:%
%:%3144=791%:%
%:%3145=792%:%
%:%3146=793%:%
%:%3147=794%:%
%:%3148=794%:%
%:%3149=795%:%
%:%3156=798%:%
%:%3166=800%:%
%:%3167=800%:%
%:%3168=801%:%
%:%3169=802%:%
%:%3170=803%:%
%:%3171=803%:%
%:%3172=804%:%
%:%3173=805%:%
%:%3174=806%:%
%:%3175=806%:%
%:%3176=807%:%
%:%3177=808%:%
%:%3178=808%:%
%:%3179=809%:%
%:%3180=810%:%
%:%3187=811%:%
%:%3188=811%:%
%:%3189=812%:%
%:%3190=812%:%
%:%3191=812%:%
%:%3192=813%:%
%:%3193=813%:%
%:%3194=814%:%
%:%3195=814%:%
%:%3196=814%:%
%:%3197=814%:%
%:%3198=815%:%
%:%3199=815%:%
%:%3200=815%:%
%:%3201=815%:%
%:%3202=816%:%
%:%3208=816%:%
%:%3211=817%:%
%:%3212=818%:%
%:%3213=818%:%
%:%3214=819%:%
%:%3215=820%:%
%:%3222=821%:%
%:%3223=821%:%
%:%3224=822%:%
%:%3225=822%:%
%:%3226=822%:%
%:%3227=823%:%
%:%3228=823%:%
%:%3229=824%:%
%:%3230=824%:%
%:%3231=824%:%
%:%3232=825%:%
%:%3233=825%:%
%:%3234=825%:%
%:%3235=825%:%
%:%3236=826%:%
%:%3237=826%:%
%:%3238=826%:%
%:%3239=826%:%
%:%3240=826%:%
%:%3241=827%:%
%:%3242=827%:%
%:%3243=827%:%
%:%3244=827%:%
%:%3245=828%:%
%:%3246=828%:%
%:%3247=829%:%
%:%3248=829%:%
%:%3249=829%:%
%:%3250=829%:%
%:%3251=829%:%
%:%3252=830%:%
%:%3258=830%:%
%:%3261=831%:%
%:%3262=832%:%
%:%3263=832%:%
%:%3266=833%:%
%:%3270=833%:%
%:%3271=833%:%
%:%3276=833%:%
%:%3279=834%:%
%:%3280=835%:%
%:%3281=835%:%
%:%3284=836%:%
%:%3288=836%:%
%:%3289=836%:%
%:%3294=836%:%
%:%3297=837%:%
%:%3298=838%:%
%:%3299=838%:%
%:%3302=839%:%
%:%3306=839%:%
%:%3307=839%:%
%:%3308=839%:%
%:%3313=839%:%
%:%3316=840%:%
%:%3317=841%:%
%:%3318=841%:%
%:%3321=842%:%
%:%3325=842%:%
%:%3326=842%:%
%:%3331=842%:%
%:%3334=843%:%
%:%3335=844%:%
%:%3336=844%:%
%:%3339=845%:%
%:%3343=845%:%
%:%3344=845%:%
%:%3345=845%:%
%:%3350=845%:%
%:%3353=846%:%
%:%3354=847%:%
%:%3355=847%:%
%:%3358=848%:%
%:%3362=848%:%
%:%3363=848%:%
%:%3368=848%:%
%:%3371=849%:%
%:%3372=850%:%
%:%3373=850%:%
%:%3376=851%:%
%:%3380=851%:%
%:%3381=851%:%
%:%3382=851%:%
%:%3387=851%:%
%:%3390=852%:%
%:%3391=853%:%
%:%3392=853%:%
%:%3395=854%:%
%:%3399=854%:%
%:%3400=854%:%
%:%3401=854%:%
%:%3406=854%:%
%:%3409=855%:%
%:%3410=856%:%
%:%3411=856%:%
%:%3414=857%:%
%:%3418=857%:%
%:%3419=857%:%
%:%3424=857%:%
%:%3427=858%:%
%:%3428=859%:%
%:%3429=859%:%
%:%3432=860%:%
%:%3436=860%:%
%:%3437=860%:%
%:%3442=860%:%
%:%3445=861%:%
%:%3446=862%:%
%:%3447=862%:%
%:%3450=863%:%
%:%3454=863%:%
%:%3455=863%:%
%:%3460=863%:%
%:%3463=864%:%
%:%3464=865%:%
%:%3465=865%:%
%:%3468=866%:%
%:%3472=866%:%
%:%3473=866%:%
%:%3478=866%:%
%:%3481=867%:%
%:%3482=868%:%
%:%3483=868%:%
%:%3484=869%:%
%:%3487=870%:%
%:%3491=870%:%
%:%3492=870%:%
%:%3497=870%:%
%:%3500=871%:%
%:%3501=872%:%
%:%3502=872%:%
%:%3503=873%:%
%:%3506=874%:%
%:%3510=874%:%
%:%3511=874%:%
%:%3516=874%:%
%:%3519=875%:%
%:%3520=876%:%
%:%3521=876%:%
%:%3522=877%:%
%:%3525=878%:%
%:%3529=878%:%
%:%3530=878%:%
%:%3535=878%:%
%:%3538=879%:%
%:%3539=880%:%
%:%3540=880%:%
%:%3543=881%:%
%:%3547=881%:%
%:%3548=881%:%
%:%3553=881%:%
%:%3556=882%:%
%:%3557=883%:%
%:%3558=883%:%
%:%3561=884%:%
%:%3565=884%:%
%:%3566=884%:%
%:%3580=887%:%
%:%3592=889%:%
%:%3594=891%:%
%:%3595=891%:%
%:%3596=892%:%
%:%3597=893%:%
%:%3598=894%:%
%:%3599=894%:%
%:%3602=895%:%
%:%3606=895%:%
%:%3607=895%:%
%:%3616=898%:%
%:%3618=900%:%
%:%3619=900%:%
%:%3620=901%:%
%:%3621=902%:%
%:%3622=902%:%
%:%3623=903%:%
%:%3624=904%:%
%:%3625=905%:%
%:%3626=905%:%
%:%3627=906%:%
%:%3628=907%:%
%:%3629=907%:%
%:%3632=908%:%
%:%3636=908%:%
%:%3637=908%:%
%:%3642=908%:%
%:%3645=909%:%
%:%3646=910%:%
%:%3647=910%:%
%:%3650=911%:%
%:%3654=911%:%
%:%3655=911%:%
%:%3660=911%:%
%:%3663=912%:%
%:%3664=913%:%
%:%3665=913%:%
%:%3668=914%:%
%:%3672=914%:%
%:%3673=914%:%
%:%3678=914%:%
%:%3681=915%:%
%:%3682=916%:%
%:%3683=916%:%
%:%3684=917%:%
%:%3685=918%:%
%:%3686=919%:%
%:%3687=920%:%
%:%3688=921%:%
%:%3689=922%:%
%:%3690=923%:%
%:%3691=924%:%
%:%3692=925%:%
%:%3695=926%:%
%:%3699=926%:%
%:%3700=926%:%
%:%3709=929%:%
%:%3711=931%:%
%:%3712=931%:%
%:%3715=932%:%
%:%3719=932%:%
%:%3720=932%:%
%:%3725=932%:%
%:%3728=933%:%
%:%3729=934%:%
%:%3730=934%:%
%:%3733=935%:%
%:%3737=935%:%
%:%3738=935%:%
%:%3743=935%:%
%:%3746=936%:%
%:%3747=937%:%
%:%3748=937%:%
%:%3749=938%:%
%:%3750=939%:%
%:%3753=940%:%
%:%3757=940%:%
%:%3758=940%:%
%:%3763=940%:%
%:%3766=941%:%
%:%3767=942%:%
%:%3768=942%:%
%:%3769=943%:%
%:%3772=944%:%
%:%3776=944%:%
%:%3777=944%:%
%:%3782=944%:%
%:%3785=945%:%
%:%3786=946%:%
%:%3787=946%:%
%:%3788=947%:%
%:%3790=949%:%
%:%3793=950%:%
%:%3797=950%:%
%:%3798=950%:%
%:%3803=950%:%
%:%3806=951%:%
%:%3807=952%:%
%:%3808=952%:%
%:%3809=953%:%
%:%3811=955%:%
%:%3814=956%:%
%:%3818=956%:%
%:%3819=956%:%
%:%3824=956%:%
%:%3827=957%:%
%:%3828=958%:%
%:%3829=958%:%
%:%3830=959%:%
%:%3832=961%:%
%:%3839=962%:%
%:%3840=962%:%
%:%3841=963%:%
%:%3842=963%:%
%:%3843=964%:%
%:%3844=964%:%
%:%3845=964%:%
%:%3846=965%:%
%:%3847=965%:%
%:%3848=966%:%
%:%3854=966%:%
%:%3857=967%:%
%:%3858=968%:%
%:%3859=968%:%
%:%3860=969%:%
%:%3862=971%:%
%:%3865=972%:%
%:%3869=972%:%
%:%3870=972%:%
%:%3875=972%:%
%:%3878=973%:%
%:%3879=974%:%
%:%3880=974%:%
%:%3881=975%:%
%:%3884=976%:%
%:%3888=976%:%
%:%3889=976%:%
%:%3894=976%:%
%:%3897=977%:%
%:%3898=978%:%
%:%3899=978%:%
%:%3906=979%:%
%:%3907=979%:%
%:%3908=980%:%
%:%3909=980%:%
%:%3910=981%:%
%:%3911=981%:%
%:%3912=981%:%
%:%3913=982%:%
%:%3914=982%:%
%:%3915=983%:%
%:%3921=983%:%
%:%3924=984%:%
%:%3925=985%:%
%:%3926=985%:%
%:%3929=986%:%
%:%3933=986%:%
%:%3934=986%:%
%:%3939=986%:%
%:%3942=987%:%
%:%3943=988%:%
%:%3944=988%:%
%:%3945=989%:%
%:%3946=990%:%
%:%3947=991%:%
%:%3948=991%:%
%:%3949=992%:%
%:%3950=993%:%
%:%3951=993%:%
%:%3954=994%:%
%:%3958=994%:%
%:%3959=994%:%
%:%3964=994%:%
%:%3967=995%:%
%:%3968=996%:%
%:%3969=996%:%
%:%3972=997%:%
%:%3976=997%:%
%:%3977=997%:%
%:%3982=997%:%
%:%3985=998%:%
%:%3986=999%:%
%:%3987=999%:%
%:%3988=1000%:%
%:%3989=1001%:%
%:%3990=1001%:%
%:%3991=1002%:%
%:%3994=1003%:%
%:%3998=1003%:%
%:%3999=1003%:%
%:%4004=1003%:%
%:%4007=1004%:%
%:%4008=1005%:%
%:%4009=1005%:%
%:%4010=1006%:%
%:%4013=1007%:%
%:%4017=1007%:%
%:%4018=1007%:%
%:%4023=1007%:%
%:%4026=1008%:%
%:%4027=1009%:%
%:%4028=1009%:%
%:%4031=1010%:%
%:%4035=1010%:%
%:%4036=1010%:%
%:%4045=1013%:%
%:%4047=1015%:%
%:%4048=1015%:%
%:%4049=1016%:%
%:%4050=1017%:%
%:%4051=1018%:%
%:%4052=1019%:%
%:%4053=1019%:%
%:%4054=1020%:%
%:%4056=1022%:%
%:%4057=1023%:%
%:%4058=1024%:%
%:%4059=1025%:%
%:%4060=1025%:%
%:%4061=1026%:%
%:%4062=1027%:%
%:%4063=1027%:%
%:%4064=1028%:%
%:%4065=1029%:%
%:%4066=1030%:%
%:%4067=1030%:%
%:%4068=1031%:%
%:%4069=1032%:%
%:%4070=1033%:%
%:%4071=1034%:%
%:%4072=1034%:%
%:%4073=1035%:%
%:%4076=1038%:%
%:%4077=1039%:%
%:%4078=1040%:%
%:%4081=1040%:%
%:%4085=1040%:%
%:%4093=1040%:%
%:%4094=1041%:%
%:%4095=1042%:%
%:%4096=1042%:%
%:%4097=1043%:%
%:%4098=1044%:%
%:%4099=1044%:%
%:%4100=1045%:%
%:%4101=1046%:%
%:%4102=1046%:%
%:%4103=1047%:%
%:%4104=1048%:%
%:%4105=1049%:%
%:%4106=1049%:%
%:%4107=1050%:%
%:%4110=1053%:%
%:%4111=1054%:%
%:%4112=1055%:%
%:%4115=1055%:%
%:%4119=1055%:%
%:%4127=1055%:%
%:%4128=1056%:%
%:%4129=1057%:%
%:%4130=1057%:%
%:%4131=1058%:%
%:%4132=1059%:%
%:%4133=1059%:%
%:%4134=1060%:%
%:%4135=1061%:%
%:%4136=1062%:%
%:%4137=1062%:%
%:%4138=1063%:%
%:%4143=1068%:%
%:%4144=1069%:%
%:%4145=1070%:%
%:%4148=1070%:%
%:%4152=1070%:%
%:%4160=1070%:%
%:%4161=1071%:%
%:%4162=1072%:%
%:%4163=1072%:%
%:%4164=1073%:%
%:%4165=1074%:%
%:%4166=1074%:%
%:%4168=1074%:%
%:%4172=1074%:%
%:%4180=1074%:%
%:%4181=1075%:%
%:%4182=1076%:%
%:%4183=1076%:%
%:%4184=1077%:%
%:%4185=1078%:%
%:%4186=1079%:%
%:%4202=1095%:%
%:%4205=1096%:%
%:%4209=1096%:%
%:%4210=1096%:%
%:%4215=1096%:%
%:%4218=1097%:%
%:%4219=1098%:%
%:%4220=1098%:%
%:%4221=1099%:%
%:%4222=1100%:%
%:%4223=1101%:%
%:%4224=1101%:%
%:%4225=1102%:%
%:%4228=1105%:%
%:%4229=1106%:%
%:%4230=1107%:%
%:%4233=1107%:%
%:%4237=1107%:%
%:%4245=1107%:%
%:%4246=1108%:%
%:%4247=1109%:%
%:%4255=1112%:%
%:%4271=1114%:%
%:%4272=1114%:%
%:%4291=1126%:%
%:%4292=1127%:%
%:%4293=1128%:%
%:%4294=1128%:%
%:%4295=1129%:%
%:%4296=1130%:%
%:%4297=1131%:%
%:%4298=1132%:%
%:%4305=1135%:%
%:%4315=1137%:%
%:%4316=1137%:%
%:%4319=1138%:%
%:%4324=1139%:%
%:%4325=1139%:%
%:%4348=1155%:%
%:%4350=1156%:%
%:%4351=1156%:%
%:%4354=1157%:%
%:%4358=1157%:%
%:%4359=1157%:%
%:%4373=1160%:%
%:%4383=1162%:%
%:%4384=1162%:%
%:%4385=1163%:%
%:%4386=1164%:%
%:%4387=1164%:%
%:%4388=1165%:%
%:%4389=1165%:%
%:%4392=1166%:%
%:%4397=1167%:%
