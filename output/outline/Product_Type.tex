%
\begin{isabellebody}%
\setisabellecontext{Product{\isacharunderscore}{\kern0pt}Type}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Cartesian products%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Product{\isacharunderscore}{\kern0pt}Type\isanewline
\ \ \isakeyword{imports}\ Typedef\ Inductive\ Fun\isanewline
\ \ \isakeyword{keywords}\ {\isachardoublequoteopen}inductive{\isacharunderscore}{\kern0pt}set{\isachardoublequoteclose}\ {\isachardoublequoteopen}coinductive{\isacharunderscore}{\kern0pt}set{\isachardoublequoteclose}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ thy{\isacharunderscore}{\kern0pt}defn\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{\isa{bool} is a datatype%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{free{\isacharunderscore}{\kern0pt}constructors}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}discs{\isacharunderscore}{\kern0pt}sels{\isacharparenright}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}bool\ \isakeyword{for}\ True\ {\isacharbar}{\kern0pt}\ False\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Avoid name clashes by prefixing the output of \isa{old{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}datatype} with \isa{old}.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}Sign{\isachardot}{\kern0pt}mandatory{\isacharunderscore}{\kern0pt}path\ {\isachardoublequote}{\kern0pt}old{\isachardoublequote}{\kern0pt}{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
\isanewline
\isanewline
\isacommand{old{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}datatype}\isamarkupfalse%
\ True\ False%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ bool{\isacharunderscore}{\kern0pt}induct{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}Sign{\isachardot}{\kern0pt}parent{\isacharunderscore}{\kern0pt}path{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
%
\begin{isamarkuptext}%
But erase the prefix for properties that are not generated by \isa{free{\isacharunderscore}{\kern0pt}constructors}.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}Sign{\isachardot}{\kern0pt}mandatory{\isacharunderscore}{\kern0pt}path\ {\isachardoublequote}{\kern0pt}bool{\isachardoublequote}{\kern0pt}{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
\isanewline
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ induct\ {\isacharequal}{\kern0pt}\ old{\isachardot}{\kern0pt}bool{\isachardot}{\kern0pt}induct\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ inducts\ {\isacharequal}{\kern0pt}\ old{\isachardot}{\kern0pt}bool{\isachardot}{\kern0pt}inducts\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ rec\ {\isacharequal}{\kern0pt}\ old{\isachardot}{\kern0pt}bool{\isachardot}{\kern0pt}rec\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ simps\ {\isacharequal}{\kern0pt}\ bool{\isachardot}{\kern0pt}distinct\ bool{\isachardot}{\kern0pt}case\ bool{\isachardot}{\kern0pt}rec\isanewline
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}Sign{\isachardot}{\kern0pt}parent{\isacharunderscore}{\kern0pt}path{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
\isanewline
%
\endisadelimML
\isanewline
\isacommand{declare}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}split\ {\isacharbrackleft}{\kern0pt}cases\ type{\isacharcolon}{\kern0pt}\ bool{\isacharbrackright}{\kern0pt}\isanewline
\ \ %
\isamarkupcmt{prefer plain propositional version%
}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}HOL{\isachardot}{\kern0pt}equal\ False\ P\ {\isasymlongleftrightarrow}\ {\isasymnot}\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}HOL{\isachardot}{\kern0pt}equal\ True\ P\ {\isasymlongleftrightarrow}\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}HOL{\isachardot}{\kern0pt}equal\ P\ False\ {\isasymlongleftrightarrow}\ {\isasymnot}\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}HOL{\isachardot}{\kern0pt}equal\ P\ True\ {\isasymlongleftrightarrow}\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ {\isacharbrackleft}{\kern0pt}code\ nbe{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}HOL{\isachardot}{\kern0pt}equal\ P\ P\ {\isasymlongleftrightarrow}\ True{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ equal{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ If{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}cert{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}CASE\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}b{\isachardot}{\kern0pt}\ If\ b\ f\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}CASE\ True\ {\isasymequiv}\ f{\isacharparenright}{\kern0pt}\ {\isacharampersand}{\kern0pt}{\isacharampersand}{\kern0pt}{\isacharampersand}{\kern0pt}\ {\isacharparenleft}{\kern0pt}CASE\ False\ {\isasymequiv}\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}{\kern0pt}all%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}Code{\isachardot}{\kern0pt}declare{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}global\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thm\ If{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}cert{\isacharbraceright}{\kern0pt}{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
\isanewline
%
\endisadelimML
\isanewline
\isacommand{code{\isacharunderscore}{\kern0pt}printing}\isamarkupfalse%
\isanewline
\ \ \isakeyword{constant}\ {\isachardoublequoteopen}HOL{\isachardot}{\kern0pt}equal\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ bool\ {\isasymRightarrow}\ bool\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ {\isasymrightharpoonup}\ {\isacharparenleft}{\kern0pt}Haskell{\isacharparenright}{\kern0pt}\ \isakeyword{infix}\ {\isadigit{4}}\ {\isachardoublequoteopen}{\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}{\isachardoublequoteclose}\isanewline
{\isacharbar}{\kern0pt}\ \isakeyword{class{\isacharunderscore}{\kern0pt}instance}\ {\isachardoublequoteopen}bool{\isachardoublequoteclose}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}equal{\isachardoublequoteclose}\ {\isasymrightharpoonup}\ {\isacharparenleft}{\kern0pt}Haskell{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{The \isa{unit} type%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{typedef}\isamarkupfalse%
\ unit\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}True{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ Unity\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unit\ \ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Abs{\isacharunderscore}{\kern0pt}unit\ True{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}atp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}u\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induct\ u{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Unity{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Simplification procedure for \isa{unit{\isacharunderscore}{\kern0pt}eq}.  Cannot use
  this rule directly --- it loops!%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{simproc{\isacharunderscore}{\kern0pt}setup}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}eq\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}x{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}unit{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacartoucheopen}\isanewline
\ \ fn\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ fn\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ fn\ ct\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\isanewline
\ \ \ \ if\ HOLogic{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}unit\ {\isacharparenleft}{\kern0pt}Thm{\isachardot}{\kern0pt}term{\isacharunderscore}{\kern0pt}of\ ct{\isacharparenright}{\kern0pt}\ then\ NONE\isanewline
\ \ \ \ else\ SOME\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}meta{\isacharunderscore}{\kern0pt}eq\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thm\ unit{\isacharunderscore}{\kern0pt}eq{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
\isanewline
\isanewline
\isacommand{free{\isacharunderscore}{\kern0pt}constructors}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}unit\ \isakeyword{for}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Avoid name clashes by prefixing the output of \isa{old{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}datatype} with \isa{old}.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}Sign{\isachardot}{\kern0pt}mandatory{\isacharunderscore}{\kern0pt}path\ {\isachardoublequote}{\kern0pt}old{\isachardoublequote}{\kern0pt}{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
\isanewline
\isanewline
\isacommand{old{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}datatype}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}Sign{\isachardot}{\kern0pt}parent{\isacharunderscore}{\kern0pt}path{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
%
\begin{isamarkuptext}%
But erase the prefix for properties that are not generated by \isa{free{\isacharunderscore}{\kern0pt}constructors}.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}Sign{\isachardot}{\kern0pt}mandatory{\isacharunderscore}{\kern0pt}path\ {\isachardoublequote}{\kern0pt}unit{\isachardoublequote}{\kern0pt}{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
\isanewline
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ induct\ {\isacharequal}{\kern0pt}\ old{\isachardot}{\kern0pt}unit{\isachardot}{\kern0pt}induct\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ inducts\ {\isacharequal}{\kern0pt}\ old{\isachardot}{\kern0pt}unit{\isachardot}{\kern0pt}inducts\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ rec\ {\isacharequal}{\kern0pt}\ old{\isachardot}{\kern0pt}unit{\isachardot}{\kern0pt}rec\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ simps\ {\isacharequal}{\kern0pt}\ unit{\isachardot}{\kern0pt}case\ unit{\isachardot}{\kern0pt}rec\isanewline
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}Sign{\isachardot}{\kern0pt}parent{\isacharunderscore}{\kern0pt}path{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
\isanewline
%
\endisadelimML
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}eq{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}x{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}unit{\isachardot}{\kern0pt}\ PROP\ P\ x{\isacharparenright}{\kern0pt}\ {\isasymequiv}\ PROP\ P\ {\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}eq{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}x{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}unit{\isachardot}{\kern0pt}\ PROP\ P{\isacharparenright}{\kern0pt}\ {\isasymequiv}\ PROP\ P{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ triv{\isacharunderscore}{\kern0pt}forall{\isacharunderscore}{\kern0pt}equality{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
This rewrite counters the effect of simproc \isa{unit{\isacharunderscore}{\kern0pt}eq} on \isa{{\isachardoublequote}{\kern0pt}{\isasymlambda}u{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}unit{\isachardot}{\kern0pt}\ f\ u{\isachardoublequote}{\kern0pt}}, replacing it by \isa{f} rather than by \isa{{\isachardoublequote}{\kern0pt}{\isasymlambda}u{\isachardot}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequote}{\kern0pt}}.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ unit{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}eta{\isacharunderscore}{\kern0pt}conv\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}u{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}unit{\isachardot}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ UNIV{\isacharunderscore}{\kern0pt}unit{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}UNIV\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{instantiation}\isamarkupfalse%
\ unit\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ default\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}default\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{instance}\isamarkupfalse%
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{instantiation}\isamarkupfalse%
\ unit\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}complete{\isacharunderscore}{\kern0pt}boolean{\isacharunderscore}{\kern0pt}algebra{\isacharcomma}{\kern0pt}complete{\isacharunderscore}{\kern0pt}linorder{\isacharcomma}{\kern0pt}wellorder{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}unit\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}unit\ {\isasymRightarrow}\ unit\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}unit{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharunderscore}{\kern0pt}\ {\isasymlongleftrightarrow}\ True{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}unit\ {\isacharbrackleft}{\kern0pt}iff{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}u\ {\isasymle}\ v{\isachardoublequoteclose}\ \isakeyword{for}\ u\ v\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unit\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}unit{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}unit\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}unit\ {\isasymRightarrow}\ unit\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}unit{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isasymlongleftrightarrow}\ False{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}unit\ {\isacharbrackleft}{\kern0pt}iff{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ u\ {\isacharless}{\kern0pt}\ v{\isachardoublequoteclose}\ \isakeyword{for}\ u\ v\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unit\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ add{\isacharcolon}{\kern0pt}\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}unit{\isacharunderscore}{\kern0pt}def\ less{\isacharunderscore}{\kern0pt}unit{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ bot{\isacharunderscore}{\kern0pt}unit\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unit\isanewline
\ \ \isakeyword{where}\ {\isacharbrackleft}{\kern0pt}code{\isacharunderscore}{\kern0pt}unfold{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymbottom}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ top{\isacharunderscore}{\kern0pt}unit\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unit\isanewline
\ \ \isakeyword{where}\ {\isacharbrackleft}{\kern0pt}code{\isacharunderscore}{\kern0pt}unfold{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymtop}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ inf{\isacharunderscore}{\kern0pt}unit\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}unit\ {\isasymRightarrow}\ unit\ {\isasymRightarrow}\ unit{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isasymsqinter}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ sup{\isacharunderscore}{\kern0pt}unit\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}unit\ {\isasymRightarrow}\ unit\ {\isasymRightarrow}\ unit{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isasymsqunion}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ Inf{\isacharunderscore}{\kern0pt}unit\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}unit\ set\ {\isasymRightarrow}\ unit{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymSqinter}{\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ Sup{\isacharunderscore}{\kern0pt}unit\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}unit\ set\ {\isasymRightarrow}\ unit{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymSqunion}{\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ uminus{\isacharunderscore}{\kern0pt}unit\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}unit\ {\isasymRightarrow}\ unit{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{declare}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}unit{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}abs{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ code{\isacharunderscore}{\kern0pt}unfold{\isacharbrackright}{\kern0pt}\isanewline
\ \ less{\isacharunderscore}{\kern0pt}unit{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}abs{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ code{\isacharunderscore}{\kern0pt}unfold{\isacharbrackright}{\kern0pt}\isanewline
\ \ inf{\isacharunderscore}{\kern0pt}unit{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}abs{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ code{\isacharunderscore}{\kern0pt}unfold{\isacharbrackright}{\kern0pt}\isanewline
\ \ sup{\isacharunderscore}{\kern0pt}unit{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}abs{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ code{\isacharunderscore}{\kern0pt}unfold{\isacharbrackright}{\kern0pt}\isanewline
\ \ Inf{\isacharunderscore}{\kern0pt}unit{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}abs{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ code{\isacharunderscore}{\kern0pt}unfold{\isacharbrackright}{\kern0pt}\isanewline
\ \ Sup{\isacharunderscore}{\kern0pt}unit{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}abs{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ code{\isacharunderscore}{\kern0pt}unfold{\isacharbrackright}{\kern0pt}\isanewline
\ \ uminus{\isacharunderscore}{\kern0pt}unit{\isacharunderscore}{\kern0pt}def\ {\isacharbrackleft}{\kern0pt}abs{\isacharunderscore}{\kern0pt}def{\isacharcomma}{\kern0pt}\ code{\isacharunderscore}{\kern0pt}unfold{\isacharbrackright}{\kern0pt}\isanewline
\isanewline
\isacommand{instance}\isamarkupfalse%
\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ intro{\isacharunderscore}{\kern0pt}classes\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}HOL{\isachardot}{\kern0pt}equal\ u\ v\ {\isasymlongleftrightarrow}\ True{\isachardoublequoteclose}\ \isakeyword{for}\ u\ v\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unit\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ equal\ unit{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}of\ u{\isacharbrackright}{\kern0pt}\ unit{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}of\ v{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ rule{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{code{\isacharunderscore}{\kern0pt}printing}\isamarkupfalse%
\isanewline
\ \ \isakeyword{type{\isacharunderscore}{\kern0pt}constructor}\ unit\ {\isasymrightharpoonup}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}SML{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}unit{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isacharparenleft}{\kern0pt}OCaml{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}unit{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isacharparenleft}{\kern0pt}Haskell{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isacharparenleft}{\kern0pt}Scala{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}Unit{\isachardoublequoteclose}\isanewline
{\isacharbar}{\kern0pt}\ \isakeyword{constant}\ Unity\ {\isasymrightharpoonup}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}SML{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isacharparenleft}{\kern0pt}OCaml{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isacharparenleft}{\kern0pt}Haskell{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isacharparenleft}{\kern0pt}Scala{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
{\isacharbar}{\kern0pt}\ \isakeyword{class{\isacharunderscore}{\kern0pt}instance}\ unit\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ equal\ {\isasymrightharpoonup}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}Haskell{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\isanewline
{\isacharbar}{\kern0pt}\ \isakeyword{constant}\ {\isachardoublequoteopen}HOL{\isachardot}{\kern0pt}equal\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unit\ {\isasymRightarrow}\ unit\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ {\isasymrightharpoonup}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}Haskell{\isacharparenright}{\kern0pt}\ \isakeyword{infix}\ {\isadigit{4}}\ {\isachardoublequoteopen}{\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{code{\isacharunderscore}{\kern0pt}reserved}\isamarkupfalse%
\ SML\isanewline
\ \ unit\isanewline
\isanewline
\isacommand{code{\isacharunderscore}{\kern0pt}reserved}\isamarkupfalse%
\ OCaml\isanewline
\ \ unit\isanewline
\isanewline
\isacommand{code{\isacharunderscore}{\kern0pt}reserved}\isamarkupfalse%
\ Scala\isanewline
\ \ Unit%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{The product type%
}
\isamarkuptrue%
%
\isamarkupsubsubsection{Type definition%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ Pair{\isacharunderscore}{\kern0pt}Rep\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}Pair{\isacharunderscore}{\kern0pt}Rep\ a\ b\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ y{\isachardot}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ a\ {\isasymand}\ y\ {\isacharequal}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}prod\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}f{\isachardot}{\kern0pt}\ {\isasymexists}a\ b{\isachardot}{\kern0pt}\ f\ {\isacharequal}{\kern0pt}\ Pair{\isacharunderscore}{\kern0pt}Rep\ {\isacharparenleft}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{typedef}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ prod\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}\ {\isasymtimes}{\isacharslash}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{2}}{\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isadigit{2}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}\ {\isadigit{2}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}prod\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ bool{\isacharparenright}{\kern0pt}\ set{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{type{\isacharunderscore}{\kern0pt}notation}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}ASCII{\isacharparenright}{\kern0pt}\isanewline
\ \ prod\ \ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isacharasterisk}{\kern0pt}{\isachardoublequoteclose}\ {\isadigit{2}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ Pair\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}Pair\ a\ b\ {\isacharequal}{\kern0pt}\ Abs{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}Pair{\isacharunderscore}{\kern0pt}Rep\ a\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}cases{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}a\ b{\isachardot}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}Pair\ a\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ P\ p{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ prod{\isacharunderscore}{\kern0pt}def\ Pair{\isacharunderscore}{\kern0pt}def\ Pair{\isacharunderscore}{\kern0pt}Rep{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{free{\isacharunderscore}{\kern0pt}constructors}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prod\ \isakeyword{for}\ Pair\ fst\ snd\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ P\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ bool\ \isakeyword{and}\ p\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b{\isachardoublequoteclose}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}x{\isadigit{1}}\ x{\isadigit{2}}{\isachardot}{\kern0pt}\ p\ {\isacharequal}{\kern0pt}\ Pair\ x{\isadigit{1}}\ x{\isadigit{2}}\ {\isasymLongrightarrow}\ P{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ prod{\isacharunderscore}{\kern0pt}def\ Pair{\isacharunderscore}{\kern0pt}def\ Pair{\isacharunderscore}{\kern0pt}Rep{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ a\ c\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ \isakeyword{and}\ b\ d\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}b\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Pair{\isacharunderscore}{\kern0pt}Rep\ a\ b\ {\isacharequal}{\kern0pt}\ Pair{\isacharunderscore}{\kern0pt}Rep\ c\ d\ {\isasymlongleftrightarrow}\ a\ {\isacharequal}{\kern0pt}\ c\ {\isasymand}\ b\ {\isacharequal}{\kern0pt}\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ Pair{\isacharunderscore}{\kern0pt}Rep{\isacharunderscore}{\kern0pt}def\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Pair{\isacharunderscore}{\kern0pt}Rep\ a\ b\ {\isasymin}\ prod{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}Pair{\isacharunderscore}{\kern0pt}Rep\ c\ d\ {\isasymin}\ prod{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ prod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}Pair\ a\ b\ {\isacharequal}{\kern0pt}\ Pair\ c\ d\ {\isasymlongleftrightarrow}\ a\ {\isacharequal}{\kern0pt}\ c\ {\isasymand}\ b\ {\isacharequal}{\kern0pt}\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Pair{\isacharunderscore}{\kern0pt}def\ Abs{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}inject{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Avoid name clashes by prefixing the output of \isa{old{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}datatype} with \isa{old}.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}Sign{\isachardot}{\kern0pt}mandatory{\isacharunderscore}{\kern0pt}path\ {\isachardoublequote}{\kern0pt}old{\isachardoublequote}{\kern0pt}{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
\isanewline
\isanewline
\isacommand{old{\isacharunderscore}{\kern0pt}rep{\isacharunderscore}{\kern0pt}datatype}\isamarkupfalse%
\ Pair\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}erule\ prod{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rule\ prod{\isachardot}{\kern0pt}inject{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}Sign{\isachardot}{\kern0pt}parent{\isacharunderscore}{\kern0pt}path{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
%
\begin{isamarkuptext}%
But erase the prefix for properties that are not generated by \isa{free{\isacharunderscore}{\kern0pt}constructors}.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}Sign{\isachardot}{\kern0pt}mandatory{\isacharunderscore}{\kern0pt}path\ {\isachardoublequote}{\kern0pt}prod{\isachardoublequote}{\kern0pt}{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
\isanewline
\isanewline
\isacommand{declare}\isamarkupfalse%
\ old{\isachardot}{\kern0pt}prod{\isachardot}{\kern0pt}inject\ {\isacharbrackleft}{\kern0pt}iff\ del{\isacharbrackright}{\kern0pt}\isanewline
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ induct\ {\isacharequal}{\kern0pt}\ old{\isachardot}{\kern0pt}prod{\isachardot}{\kern0pt}induct\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ inducts\ {\isacharequal}{\kern0pt}\ old{\isachardot}{\kern0pt}prod{\isachardot}{\kern0pt}inducts\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ rec\ {\isacharequal}{\kern0pt}\ old{\isachardot}{\kern0pt}prod{\isachardot}{\kern0pt}rec\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ simps\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}inject\ prod{\isachardot}{\kern0pt}case\ prod{\isachardot}{\kern0pt}rec\isanewline
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}Sign{\isachardot}{\kern0pt}parent{\isacharunderscore}{\kern0pt}path{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
\isanewline
%
\endisadelimML
\isanewline
\isacommand{declare}\isamarkupfalse%
\ prod{\isachardot}{\kern0pt}case\ {\isacharbrackleft}{\kern0pt}nitpick{\isacharunderscore}{\kern0pt}simp\ del{\isacharbrackright}{\kern0pt}\isanewline
\isacommand{declare}\isamarkupfalse%
\ old{\isachardot}{\kern0pt}prod{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}cong{\isacharunderscore}{\kern0pt}weak\ {\isacharbrackleft}{\kern0pt}cong\ del{\isacharbrackright}{\kern0pt}\isanewline
\isacommand{declare}\isamarkupfalse%
\ prod{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if\ {\isacharbrackleft}{\kern0pt}mono{\isacharbrackright}{\kern0pt}\isanewline
\isacommand{declare}\isamarkupfalse%
\ prod{\isachardot}{\kern0pt}split\ {\isacharbrackleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}atp{\isacharbrackright}{\kern0pt}\isanewline
\isacommand{declare}\isamarkupfalse%
\ prod{\isachardot}{\kern0pt}split{\isacharunderscore}{\kern0pt}asm\ {\isacharbrackleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}atp{\isacharbrackright}{\kern0pt}%
\begin{isamarkuptext}%
\isa{prod{\isachardot}{\kern0pt}split} could be declared as \isa{{\isacharbrackleft}{\kern0pt}split{\isacharbrackright}{\kern0pt}}
  done after the Splitter has been speeded up significantly;
  precompute the constants involved and don't do anything unless the
  current goal contains one of those constants.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Tuple syntax%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
Patterns -- extends pre-defined type \isa{pttrn} used in
  abstractions.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{nonterminal}\isamarkupfalse%
\ tuple{\isacharunderscore}{\kern0pt}args\ \isakeyword{and}\ patterns\isanewline
\isacommand{syntax}\isamarkupfalse%
\isanewline
\ \ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}tuple{\isachardoublequoteclose}\ \ \ \ \ \ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ tuple{\isacharunderscore}{\kern0pt}args\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b{\isachardoublequoteclose}\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}arg{\isachardoublequoteclose}\ \ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ tuple{\isacharunderscore}{\kern0pt}args{\isachardoublequoteclose}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}args{\isachardoublequoteclose}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ tuple{\isacharunderscore}{\kern0pt}args\ {\isasymRightarrow}\ tuple{\isacharunderscore}{\kern0pt}args{\isachardoublequoteclose}\ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}pattern{\isachardoublequoteclose}\ \ \ \ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}pttrn\ {\isasymRightarrow}\ patterns\ {\isasymRightarrow}\ pttrn{\isachardoublequoteclose}\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isachardoublequoteclose}\ \ \ \ \ \ \ \ \ \ \ \ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}pttrn\ {\isasymRightarrow}\ patterns{\isachardoublequoteclose}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}patterns{\isachardoublequoteclose}\ \ \ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}pttrn\ {\isasymRightarrow}\ patterns\ {\isasymRightarrow}\ patterns{\isachardoublequoteclose}\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}unit{\isachardoublequoteclose}\ \ \ \ \ \ \ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ pttrn\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{translations}\isamarkupfalse%
\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isasymrightleftharpoons}\ {\isachardoublequoteopen}CONST\ Pair\ x\ y{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}pattern\ x\ y{\isachardoublequoteclose}\ {\isasymrightleftharpoons}\ {\isachardoublequoteopen}CONST\ Pair\ x\ y{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}patterns\ x\ y{\isachardoublequoteclose}\ {\isasymrightleftharpoons}\ {\isachardoublequoteopen}CONST\ Pair\ x\ y{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}tuple\ x\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}args\ y\ z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isasymrightleftharpoons}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}tuple\ x\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}arg\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}tuple\ y\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}{\isasymlambda}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharcomma}{\kern0pt}\ zs{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ b{\isachardoublequoteclose}\ {\isasymrightleftharpoons}\ {\isachardoublequoteopen}CONST\ case{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ {\isacharparenleft}{\kern0pt}y{\isacharcomma}{\kern0pt}\ zs{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}{\isasymlambda}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ b{\isachardoublequoteclose}\ {\isasymrightleftharpoons}\ {\isachardoublequoteopen}CONST\ case{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ y{\isachardot}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}abs\ {\isacharparenleft}{\kern0pt}CONST\ Pair\ x\ y{\isacharparenright}{\kern0pt}\ t{\isachardoublequoteclose}\ {\isasymrightharpoonup}\ {\isachardoublequoteopen}{\isasymlambda}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\ \ %
\isamarkupcmt{This rule accommodates tuples in \isa{case\ C\ {\isasymdots}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isasymdots}\ {\isasymRightarrow}\ {\isasymdots}}:
     The \isa{{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}} is parsed as \isa{Pair\ x\ y} because it is \isa{logic},
     not \isa{pttrn}.%
}\isanewline
\ \ {\isachardoublequoteopen}{\isasymlambda}{\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ b{\isachardoublequoteclose}\ {\isasymrightleftharpoons}\ {\isachardoublequoteopen}CONST\ case{\isacharunderscore}{\kern0pt}unit\ b{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}abs\ {\isacharparenleft}{\kern0pt}CONST\ Unity{\isacharparenright}{\kern0pt}\ t{\isachardoublequoteclose}\ {\isasymrightharpoonup}\ {\isachardoublequoteopen}{\isasymlambda}{\isacharparenleft}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ t{\isachardoublequoteclose}%
\begin{isamarkuptext}%
print \isa{case{\isacharunderscore}{\kern0pt}prod\ f} as \isa{case{\isacharunderscore}{\kern0pt}prod\ f} and
  \isa{case{\isacharunderscore}{\kern0pt}prod\ f} as \isa{case{\isacharunderscore}{\kern0pt}prod\ f}%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{typed{\isacharunderscore}{\kern0pt}print{\isacharunderscore}{\kern0pt}translation}\isamarkupfalse%
\ {\isacartoucheopen}\isanewline
\ \ let\isanewline
\ \ \ \ fun\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}guess{\isacharunderscore}{\kern0pt}names{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ T\ {\isacharbrackleft}{\kern0pt}Abs\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ Abs\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ raise\ Match\isanewline
\ \ \ \ \ \ {\isacharbar}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}guess{\isacharunderscore}{\kern0pt}names{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ T\ {\isacharbrackleft}{\kern0pt}Abs\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ xT{\isacharcomma}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ {\isacharparenleft}{\kern0pt}head{\isacharunderscore}{\kern0pt}of\ t{\isacharparenright}{\kern0pt}\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ Const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREsyntax {\isasymopen}case{\isacharunderscore}{\kern0pt}prod{\isasymclose}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ raise\ Match\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ let\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ val\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ yT\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ binder{\isacharunderscore}{\kern0pt}types\ {\isacharparenleft}{\kern0pt}domain{\isacharunderscore}{\kern0pt}type\ T{\isacharparenright}{\kern0pt}\ handle\ Bind\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ raise\ Match{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ val\ {\isacharparenleft}{\kern0pt}y{\isacharcomma}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Syntax{\isacharunderscore}{\kern0pt}Trans{\isachardot}{\kern0pt}atomic{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isachardoublequote}{\kern0pt}y{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\ yT{\isacharcomma}{\kern0pt}\ incr{\isacharunderscore}{\kern0pt}boundvars\ {\isadigit{1}}\ t\ {\isachardollar}{\kern0pt}\ Bound\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ val\ {\isacharparenleft}{\kern0pt}x{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Syntax{\isacharunderscore}{\kern0pt}Trans{\isachardot}{\kern0pt}atomic{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ xT{\isacharcomma}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ in\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ Syntax{\isachardot}{\kern0pt}const\ \isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}abs{\isasymclose}\ {\isachardollar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Syntax{\isachardot}{\kern0pt}const\ \isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}pattern{\isasymclose}\ {\isachardollar}{\kern0pt}\ x{\isacharprime}{\kern0pt}\ {\isachardollar}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ end{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharbar}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}guess{\isacharunderscore}{\kern0pt}names{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ T\ {\isacharbrackleft}{\kern0pt}t{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ head{\isacharunderscore}{\kern0pt}of\ t\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ Const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREsyntax {\isasymopen}case{\isacharunderscore}{\kern0pt}prod{\isasymclose}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ raise\ Match\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ let\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ val\ {\isacharparenleft}{\kern0pt}xT\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ yT\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ binder{\isacharunderscore}{\kern0pt}types\ {\isacharparenleft}{\kern0pt}domain{\isacharunderscore}{\kern0pt}type\ T{\isacharparenright}{\kern0pt}\ handle\ Bind\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ raise\ Match{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ val\ {\isacharparenleft}{\kern0pt}y{\isacharcomma}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Syntax{\isacharunderscore}{\kern0pt}Trans{\isachardot}{\kern0pt}atomic{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isachardoublequote}{\kern0pt}y{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\ yT{\isacharcomma}{\kern0pt}\ incr{\isacharunderscore}{\kern0pt}boundvars\ {\isadigit{2}}\ t\ {\isachardollar}{\kern0pt}\ Bound\ {\isadigit{1}}\ {\isachardollar}{\kern0pt}\ Bound\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ val\ {\isacharparenleft}{\kern0pt}x{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Syntax{\isacharunderscore}{\kern0pt}Trans{\isachardot}{\kern0pt}atomic{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isachardoublequote}{\kern0pt}x{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\ xT{\isacharcomma}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ in\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ Syntax{\isachardot}{\kern0pt}const\ \isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}abs{\isasymclose}\ {\isachardollar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Syntax{\isachardot}{\kern0pt}const\ \isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}pattern{\isasymclose}\ {\isachardollar}{\kern0pt}\ x{\isacharprime}{\kern0pt}\ {\isachardollar}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ end{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharbar}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}guess{\isacharunderscore}{\kern0pt}names{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ raise\ Match{\isacharsemicolon}{\kern0pt}\isanewline
\ \ in\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREsyntax {\isasymopen}case{\isacharunderscore}{\kern0pt}prod{\isasymclose}{\isacharcomma}{\kern0pt}\ K\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}guess{\isacharunderscore}{\kern0pt}names{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ end\isanewline
{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
%
\begin{isamarkuptext}%
Reconstruct pattern from (nested) \isa{case{\isacharunderscore}{\kern0pt}prod}s,
  avoiding eta-contraction of body; required for enclosing "let",
  if "let" does not avoid eta-contraction, which has been observed to occur.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{print{\isacharunderscore}{\kern0pt}translation}\isamarkupfalse%
\ {\isacartoucheopen}\isanewline
\ \ let\isanewline
\ \ \ \ fun\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}Abs\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ T{\isacharcomma}{\kern0pt}\ t\ as\ {\isacharparenleft}{\kern0pt}Abs\ abs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ y{\isachardot}{\kern0pt}\ t{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isasymlambda}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ t\ {\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ let\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ val\ {\isacharparenleft}{\kern0pt}y{\isacharcomma}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Syntax{\isacharunderscore}{\kern0pt}Trans{\isachardot}{\kern0pt}atomic{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ abs{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ val\ {\isacharparenleft}{\kern0pt}x{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Syntax{\isacharunderscore}{\kern0pt}Trans{\isachardot}{\kern0pt}atomic{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ T{\isacharcomma}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ in\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ Syntax{\isachardot}{\kern0pt}const\ \isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}abs{\isasymclose}\ {\isachardollar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Syntax{\isachardot}{\kern0pt}const\ \isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}pattern{\isasymclose}\ {\isachardollar}{\kern0pt}\ x{\isacharprime}{\kern0pt}\ {\isachardollar}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ end\isanewline
\ \ \ \ \ \ {\isacharbar}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}Abs\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ T{\isacharcomma}{\kern0pt}\ {\isacharparenleft}{\kern0pt}s\ as\ Const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREsyntax {\isasymopen}case{\isacharunderscore}{\kern0pt}prod{\isasymclose}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}{\isasymlambda}y\ z{\isachardot}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isasymlambda}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharcomma}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ t\ {\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ let\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ val\ Const\ {\isacharparenleft}{\kern0pt}\isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}abs{\isasymclose}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Const\ {\isacharparenleft}{\kern0pt}\isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}pattern{\isasymclose}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ y\ {\isachardollar}{\kern0pt}\ z{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ t{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}t{\isacharbrackright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ val\ {\isacharparenleft}{\kern0pt}x{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Syntax{\isacharunderscore}{\kern0pt}Trans{\isachardot}{\kern0pt}atomic{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ T{\isacharcomma}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ in\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ Syntax{\isachardot}{\kern0pt}const\ \isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}abs{\isasymclose}\ {\isachardollar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Syntax{\isachardot}{\kern0pt}const\ \isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}pattern{\isasymclose}\ {\isachardollar}{\kern0pt}\ x{\isacharprime}{\kern0pt}\ {\isachardollar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Syntax{\isachardot}{\kern0pt}const\ \isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}patterns{\isasymclose}\ {\isachardollar}{\kern0pt}\ y\ {\isachardollar}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ t{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ end\isanewline
\ \ \ \ \ \ {\isacharbar}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}Const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREsyntax {\isasymopen}case{\isacharunderscore}{\kern0pt}prod{\isasymclose}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ t{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ y\ z{\isachardot}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isasymlambda}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ t\ {\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}t{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}\ inner\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ creates\ next\ pattern\ {\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharbar}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}Const\ {\isacharparenleft}{\kern0pt}\isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}abs{\isasymclose}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ x{\isacharunderscore}{\kern0pt}y\ {\isachardollar}{\kern0pt}\ Abs\ abs{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}{\isasymlambda}pttrn\ z{\isachardot}{\kern0pt}\ t{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isasymlambda}{\isacharparenleft}{\kern0pt}pttrn{\isacharcomma}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ t\ {\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ let\ val\ {\isacharparenleft}{\kern0pt}z{\isacharcomma}{\kern0pt}\ t{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Syntax{\isacharunderscore}{\kern0pt}Trans{\isachardot}{\kern0pt}atomic{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ abs\ in\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ Syntax{\isachardot}{\kern0pt}const\ \isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}abs{\isasymclose}\ {\isachardollar}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Syntax{\isachardot}{\kern0pt}const\ \isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}pattern{\isasymclose}\ {\isachardollar}{\kern0pt}\ x{\isacharunderscore}{\kern0pt}y\ {\isachardollar}{\kern0pt}\ z{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ t\isanewline
\ \ \ \ \ \ \ \ \ \ end\isanewline
\ \ \ \ \ \ {\isacharbar}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ raise\ Match{\isacharsemicolon}{\kern0pt}\isanewline
\ \ in\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREsyntax {\isasymopen}case{\isacharunderscore}{\kern0pt}prod{\isasymclose}{\isacharcomma}{\kern0pt}\ K\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ end\isanewline
{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Code generator setup%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{code{\isacharunderscore}{\kern0pt}printing}\isamarkupfalse%
\isanewline
\ \ \isakeyword{type{\isacharunderscore}{\kern0pt}constructor}\ prod\ {\isasymrightharpoonup}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}SML{\isacharparenright}{\kern0pt}\ \isakeyword{infix}\ {\isadigit{2}}\ {\isachardoublequoteopen}{\isacharasterisk}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isacharparenleft}{\kern0pt}OCaml{\isacharparenright}{\kern0pt}\ \isakeyword{infix}\ {\isadigit{2}}\ {\isachardoublequoteopen}{\isacharasterisk}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isacharparenleft}{\kern0pt}Haskell{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbang}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isacharparenleft}{\kern0pt}Scala{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
{\isacharbar}{\kern0pt}\ \isakeyword{constant}\ Pair\ {\isasymrightharpoonup}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}SML{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbang}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isacharparenleft}{\kern0pt}OCaml{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbang}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isacharparenleft}{\kern0pt}Haskell{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbang}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isacharparenleft}{\kern0pt}Scala{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbang}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
{\isacharbar}{\kern0pt}\ \isakeyword{class{\isacharunderscore}{\kern0pt}instance}\ \ prod\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ equal\ {\isasymrightharpoonup}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}Haskell{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\isanewline
{\isacharbar}{\kern0pt}\ \isakeyword{constant}\ {\isachardoublequoteopen}HOL{\isachardot}{\kern0pt}equal\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ {\isasymrightharpoonup}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}Haskell{\isacharparenright}{\kern0pt}\ \isakeyword{infix}\ {\isadigit{4}}\ {\isachardoublequoteopen}{\isacharequal}{\kern0pt}{\isacharequal}{\kern0pt}{\isachardoublequoteclose}\isanewline
{\isacharbar}{\kern0pt}\ \isakeyword{constant}\ fst\ {\isasymrightharpoonup}\ {\isacharparenleft}{\kern0pt}Haskell{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}fst{\isachardoublequoteclose}\isanewline
{\isacharbar}{\kern0pt}\ \isakeyword{constant}\ snd\ {\isasymrightharpoonup}\ {\isacharparenleft}{\kern0pt}Haskell{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}snd{\isachardoublequoteclose}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Fundamental operations and properties%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ Pair{\isacharunderscore}{\kern0pt}inject{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ b{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}a\ {\isacharequal}{\kern0pt}\ a{\isacharprime}{\kern0pt}\ {\isasymLongrightarrow}\ b\ {\isacharequal}{\kern0pt}\ b{\isacharprime}{\kern0pt}\ {\isasymLongrightarrow}\ R{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ R{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ surj{\isacharunderscore}{\kern0pt}pair\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymexists}x\ y{\isachardot}{\kern0pt}\ p\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fst{\isacharunderscore}{\kern0pt}eqD{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fst\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a\ {\isasymLongrightarrow}\ x\ {\isacharequal}{\kern0pt}\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}eqD{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a\ {\isasymLongrightarrow}\ y\ {\isacharequal}{\kern0pt}\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unfold\ {\isacharbrackleft}{\kern0pt}nitpick{\isacharunderscore}{\kern0pt}unfold{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}case{\isacharunderscore}{\kern0pt}prod\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}c\ p{\isachardot}{\kern0pt}\ c\ {\isacharparenleft}{\kern0pt}fst\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ split{\isacharcolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}split{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}conv\ {\isacharbrackleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}case\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ of\ {\isacharparenleft}{\kern0pt}c{\isacharcomma}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ f\ c\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ a\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fact\ prod{\isachardot}{\kern0pt}case{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ surjective{\isacharunderscore}{\kern0pt}pairing\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}collapse\ {\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\ {\isacharequal}{\kern0pt}\ t\ {\isasymlongleftrightarrow}\ fst\ s\ {\isacharequal}{\kern0pt}\ fst\ t\ {\isasymand}\ snd\ s\ {\isacharequal}{\kern0pt}\ snd\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ s{\isacharcomma}{\kern0pt}\ cases\ t{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}eqI\ {\isacharbrackleft}{\kern0pt}intro{\isacharquery}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fst\ p\ {\isacharequal}{\kern0pt}\ fst\ q\ {\isasymLongrightarrow}\ snd\ p\ {\isacharequal}{\kern0pt}\ snd\ q\ {\isasymLongrightarrow}\ p\ {\isacharequal}{\kern0pt}\ q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ prod{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prodI{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ a\ b\ {\isasymLongrightarrow}\ case\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ of\ {\isacharparenleft}{\kern0pt}c{\isacharcomma}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ f\ c\ d{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isachardot}{\kern0pt}case\ {\isacharbrackleft}{\kern0pt}THEN\ iffD{\isadigit{2}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prodD{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}case\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ of\ {\isacharparenleft}{\kern0pt}c{\isacharcomma}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ f\ c\ d{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ f\ a\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isachardot}{\kern0pt}case\ {\isacharbrackleft}{\kern0pt}THEN\ iffD{\isadigit{1}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}Pair\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}case{\isacharunderscore}{\kern0pt}prod\ Pair\ {\isacharequal}{\kern0pt}\ id{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ split{\isacharcolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}split{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eta{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
\ \ %
\isamarkupcmt{Subsumes the old \isa{split{\isacharunderscore}{\kern0pt}Pair} when \isa{f} is the identity function.%
}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ split{\isacharcolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}split{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}comp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}case\ x\ of\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\ g{\isacharparenright}{\kern0pt}\ a\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}g\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ The{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}The\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ P{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}THE\ xy{\isachardot}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}fst\ xy{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ xy{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unfold{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cond{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eta{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ f\ x\ y\ {\isacharequal}{\kern0pt}\ g\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ f\ x\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eta{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all\ {\isacharbrackleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}atp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}x{\isachardot}{\kern0pt}\ PROP\ P\ x{\isacharparenright}{\kern0pt}\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}a\ b{\isachardot}{\kern0pt}\ PROP\ P\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ a\ b\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ PROP\ P\ x{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}PROP\ P\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}a\ b{\isachardot}{\kern0pt}\ PROP\ P\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ {\isacartoucheopen}PROP\ P\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharcomma}{\kern0pt}\ snd\ x{\isacharparenright}{\kern0pt}{\isacartoucheclose}\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}PROP\ P\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The rule \isa{split{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all} does not work with the
  Simplifier because it also affects premises in congrence rules,
  where this can lead to premises of the form \isa{{\isasymAnd}a\ b{\isachardot}{\kern0pt}\ {\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isacharquery}{\kern0pt}P{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}}
  which cannot be solved by reflexivity.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemmas}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}tupled{\isacharunderscore}{\kern0pt}all\ {\isacharequal}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all\ unit{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}eq{\isadigit{2}}\isanewline
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{ML}\isamarkupfalse%
\ {\isacartoucheopen}\isanewline
\ \ {\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}\ replace\ parameters\ of\ product\ type\ by\ individual\ component\ parameters\ {\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ local\ {\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}\ filtering\ with\ exists{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all\ is\ an\ essential\ optimization\ {\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ fun\ exists{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all\ {\isacharparenleft}{\kern0pt}Const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}Pure{\isachardot}{\kern0pt}all{\isasymclose}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ Abs\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ T{\isacharcomma}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ can\ HOLogic{\isachardot}{\kern0pt}dest{\isacharunderscore}{\kern0pt}prodT\ T\ orelse\ exists{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all\ t\isanewline
\ \ \ \ \ \ {\isacharbar}{\kern0pt}\ exists{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all\ {\isacharparenleft}{\kern0pt}t\ {\isachardollar}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exists{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all\ t\ orelse\ exists{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all\ u\isanewline
\ \ \ \ \ \ {\isacharbar}{\kern0pt}\ exists{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all\ {\isacharparenleft}{\kern0pt}Abs\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exists{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all\ t\isanewline
\ \ \ \ \ \ {\isacharbar}{\kern0pt}\ exists{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ false{\isacharsemicolon}{\kern0pt}\isanewline
\ \ \ \ val\ ss\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ simpset{\isacharunderscore}{\kern0pt}of\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}put{\isacharunderscore}{\kern0pt}simpset\ HOL{\isacharunderscore}{\kern0pt}basic{\isacharunderscore}{\kern0pt}ss\ \isactrlcontext \isanewline
\ \ \ \ \ \ \ \ addsimps\ {\isacharbrackleft}{\kern0pt}{\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thm\ split{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thm\ unit{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}eq{\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thm\ unit{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}eta{\isacharunderscore}{\kern0pt}conv{\isacharbraceright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ addsimprocs\ {\isacharbrackleft}{\kern0pt}\isactrlsimproc {\isasymopen}unit{\isacharunderscore}{\kern0pt}eq{\isasymclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ in\isanewline
\ \ \ \ fun\ split{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}tac\ ctxt\ {\isacharequal}{\kern0pt}\ SUBGOAL\ {\isacharparenleft}{\kern0pt}fn\ {\isacharparenleft}{\kern0pt}t{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\isanewline
\ \ \ \ \ \ if\ exists{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all\ t\ then\ safe{\isacharunderscore}{\kern0pt}full{\isacharunderscore}{\kern0pt}simp{\isacharunderscore}{\kern0pt}tac\ {\isacharparenleft}{\kern0pt}put{\isacharunderscore}{\kern0pt}simpset\ ss\ ctxt{\isacharparenright}{\kern0pt}\ i\ else\ no{\isacharunderscore}{\kern0pt}tac{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\isanewline
\ \ \ \ fun\ unsafe{\isacharunderscore}{\kern0pt}split{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}tac\ ctxt\ {\isacharequal}{\kern0pt}\ SUBGOAL\ {\isacharparenleft}{\kern0pt}fn\ {\isacharparenleft}{\kern0pt}t{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\isanewline
\ \ \ \ \ \ if\ exists{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all\ t\ then\ full{\isacharunderscore}{\kern0pt}simp{\isacharunderscore}{\kern0pt}tac\ {\isacharparenleft}{\kern0pt}put{\isacharunderscore}{\kern0pt}simpset\ ss\ ctxt{\isacharparenright}{\kern0pt}\ i\ else\ no{\isacharunderscore}{\kern0pt}tac{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\isanewline
\ \ \ \ fun\ split{\isacharunderscore}{\kern0pt}all\ ctxt\ th\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ if\ exists{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all\ {\isacharparenleft}{\kern0pt}Thm{\isachardot}{\kern0pt}prop{\isacharunderscore}{\kern0pt}of\ th{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ then\ full{\isacharunderscore}{\kern0pt}simplify\ {\isacharparenleft}{\kern0pt}put{\isacharunderscore}{\kern0pt}simpset\ ss\ ctxt{\isacharparenright}{\kern0pt}\ th\ else\ th{\isacharsemicolon}{\kern0pt}\isanewline
\ \ end{\isacharsemicolon}{\kern0pt}\isanewline
{\isacartoucheclose}\isanewline
\isanewline
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}map{\isacharunderscore}{\kern0pt}theory{\isacharunderscore}{\kern0pt}claset\ {\isacharparenleft}{\kern0pt}fn\ ctxt\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ ctxt\ addSbefore\ {\isacharparenleft}{\kern0pt}{\isachardoublequote}{\kern0pt}split{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}tac{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}tac{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
\isanewline
%
\endisadelimML
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}All\ {\isacharbrackleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}atp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}x{\isachardot}{\kern0pt}\ P\ x{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}a\ b{\isachardot}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ %
\isamarkupcmt{\isa{{\isacharbrackleft}{\kern0pt}iff{\isacharbrackright}{\kern0pt}} is not a good idea because it makes \isa{blast} loop%
}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ fast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}Ex\ {\isacharbrackleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}atp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymexists}x{\isachardot}{\kern0pt}\ P\ x{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymexists}a\ b{\isachardot}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ fast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}The\ {\isacharbrackleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}atp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}THE\ x{\isachardot}{\kern0pt}\ P\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}THE\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ %
\isamarkupcmt{Can't be added to simpset: loops!%
}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eta{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Simplification procedure for \isa{cond{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eta}.  Using
  \isa{case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eta} as a rewrite rule is not general enough,
  and using \isa{cond{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eta} directly would render some
  existing proofs very inefficient; similarly for \isa{prod{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if}.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{ML}\isamarkupfalse%
\ {\isacartoucheopen}\isanewline
local\isanewline
\ \ val\ cond{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eta{\isacharunderscore}{\kern0pt}ss\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ simpset{\isacharunderscore}{\kern0pt}of\ {\isacharparenleft}{\kern0pt}put{\isacharunderscore}{\kern0pt}simpset\ HOL{\isacharunderscore}{\kern0pt}basic{\isacharunderscore}{\kern0pt}ss\ \isactrlcontext \ addsimps\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ cond{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eta{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\ \ fun\ Pair{\isacharunderscore}{\kern0pt}pat\ k\ {\isadigit{0}}\ {\isacharparenleft}{\kern0pt}Bound\ m{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}m\ {\isacharequal}{\kern0pt}\ k{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ Pair{\isacharunderscore}{\kern0pt}pat\ k\ i\ {\isacharparenleft}{\kern0pt}Const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}Pair{\isasymclose}{\isacharcomma}{\kern0pt}\ \ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ Bound\ m\ {\isachardollar}{\kern0pt}\ t{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ i\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}\ andalso\ m\ {\isacharequal}{\kern0pt}\ k\ {\isacharplus}{\kern0pt}\ i\ andalso\ Pair{\isacharunderscore}{\kern0pt}pat\ k\ {\isacharparenleft}{\kern0pt}i\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ t\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ Pair{\isacharunderscore}{\kern0pt}pat\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ false{\isacharsemicolon}{\kern0pt}\isanewline
\ \ fun\ no{\isacharunderscore}{\kern0pt}args\ k\ i\ {\isacharparenleft}{\kern0pt}Abs\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}args\ {\isacharparenleft}{\kern0pt}k\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ i\ t\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}args\ k\ i\ {\isacharparenleft}{\kern0pt}t\ {\isachardollar}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}args\ k\ i\ t\ andalso\ no{\isacharunderscore}{\kern0pt}args\ k\ i\ u\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}args\ k\ i\ {\isacharparenleft}{\kern0pt}Bound\ m{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ m\ {\isacharless}{\kern0pt}\ k\ orelse\ m\ {\isachargreater}{\kern0pt}\ k\ {\isacharplus}{\kern0pt}\ i\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}args\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ true{\isacharsemicolon}{\kern0pt}\isanewline
\ \ fun\ split{\isacharunderscore}{\kern0pt}pat\ tp\ i\ {\isacharparenleft}{\kern0pt}Abs\ \ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ if\ tp\ {\isadigit{0}}\ i\ t\ then\ SOME\ {\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ t{\isacharparenright}{\kern0pt}\ else\ NONE\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}pat\ tp\ i\ {\isacharparenleft}{\kern0pt}Const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}case{\isacharunderscore}{\kern0pt}prod{\isasymclose}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ Abs\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}pat\ tp\ {\isacharparenleft}{\kern0pt}i\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ t\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}pat\ tp\ i\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ NONE{\isacharsemicolon}{\kern0pt}\isanewline
\ \ fun\ metaeq\ ctxt\ lhs\ rhs\ {\isacharequal}{\kern0pt}\ mk{\isacharunderscore}{\kern0pt}meta{\isacharunderscore}{\kern0pt}eq\ {\isacharparenleft}{\kern0pt}Goal{\isachardot}{\kern0pt}prove\ ctxt\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}HOLogic{\isachardot}{\kern0pt}mk{\isacharunderscore}{\kern0pt}Trueprop\ {\isacharparenleft}{\kern0pt}HOLogic{\isachardot}{\kern0pt}mk{\isacharunderscore}{\kern0pt}eq\ {\isacharparenleft}{\kern0pt}lhs{\isacharcomma}{\kern0pt}\ rhs{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}K\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}tac\ {\isacharparenleft}{\kern0pt}put{\isacharunderscore}{\kern0pt}simpset\ cond{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eta{\isacharunderscore}{\kern0pt}ss\ ctxt{\isacharparenright}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
\isanewline
\ \ fun\ beta{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}pat\ k\ i\ {\isacharparenleft}{\kern0pt}Abs\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ beta{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}pat\ {\isacharparenleft}{\kern0pt}k\ {\isacharplus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ i\ t\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ beta{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}pat\ k\ i\ {\isacharparenleft}{\kern0pt}t\ {\isachardollar}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ Pair{\isacharunderscore}{\kern0pt}pat\ k\ i\ {\isacharparenleft}{\kern0pt}t\ {\isachardollar}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ orelse\ {\isacharparenleft}{\kern0pt}beta{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}pat\ k\ i\ t\ andalso\ beta{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}pat\ k\ i\ u{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ beta{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}pat\ k\ i\ t\ {\isacharequal}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}args\ k\ i\ t{\isacharsemicolon}{\kern0pt}\isanewline
\ \ fun\ eta{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}pat\ k\ i\ {\isacharparenleft}{\kern0pt}f\ {\isachardollar}{\kern0pt}\ arg{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}args\ k\ i\ f\ andalso\ Pair{\isacharunderscore}{\kern0pt}pat\ k\ i\ arg\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ eta{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}pat\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ false{\isacharsemicolon}{\kern0pt}\isanewline
\ \ fun\ subst\ arg\ k\ i\ {\isacharparenleft}{\kern0pt}Abs\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ T{\isacharcomma}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Abs\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ T{\isacharcomma}{\kern0pt}\ subst\ arg\ {\isacharparenleft}{\kern0pt}k{\isacharplus}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ i\ t{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ subst\ arg\ k\ i\ {\isacharparenleft}{\kern0pt}t\ {\isachardollar}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ if\ Pair{\isacharunderscore}{\kern0pt}pat\ k\ i\ {\isacharparenleft}{\kern0pt}t\ {\isachardollar}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ then\ incr{\isacharunderscore}{\kern0pt}boundvars\ k\ arg\isanewline
\ \ \ \ \ \ \ \ else\ {\isacharparenleft}{\kern0pt}subst\ arg\ k\ i\ t\ {\isachardollar}{\kern0pt}\ subst\ arg\ k\ i\ u{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ subst\ arg\ k\ i\ t\ {\isacharequal}{\kern0pt}\ t{\isacharsemicolon}{\kern0pt}\isanewline
in\isanewline
\ \ fun\ beta{\isacharunderscore}{\kern0pt}proc\ ctxt\ {\isacharparenleft}{\kern0pt}s\ as\ Const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}case{\isacharunderscore}{\kern0pt}prod{\isasymclose}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ Abs\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ t{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ arg{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ split{\isacharunderscore}{\kern0pt}pat\ beta{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}pat\ {\isadigit{1}}\ t\ of\isanewline
\ \ \ \ \ \ \ \ \ \ SOME\ {\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ SOME\ {\isacharparenleft}{\kern0pt}metaeq\ ctxt\ s\ {\isacharparenleft}{\kern0pt}subst\ arg\ {\isadigit{0}}\ i\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ NONE\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ NONE{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ beta{\isacharunderscore}{\kern0pt}proc\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ NONE{\isacharsemicolon}{\kern0pt}\isanewline
\ \ fun\ eta{\isacharunderscore}{\kern0pt}proc\ ctxt\ {\isacharparenleft}{\kern0pt}s\ as\ Const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}case{\isacharunderscore}{\kern0pt}prod{\isasymclose}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ Abs\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ split{\isacharunderscore}{\kern0pt}pat\ eta{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}pat\ {\isadigit{1}}\ t\ of\isanewline
\ \ \ \ \ \ \ \ \ \ SOME\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ ft{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ SOME\ {\isacharparenleft}{\kern0pt}metaeq\ ctxt\ s\ {\isacharparenleft}{\kern0pt}let\ val\ f\ {\isachardollar}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ ft\ in\ f\ end{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ NONE\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ NONE{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ eta{\isacharunderscore}{\kern0pt}proc\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ NONE{\isacharsemicolon}{\kern0pt}\isanewline
end{\isacharsemicolon}{\kern0pt}\isanewline
{\isacartoucheclose}\isanewline
\isacommand{simproc{\isacharunderscore}{\kern0pt}setup}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}case{\isacharunderscore}{\kern0pt}prod\ f\ z{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ {\isacartoucheopen}fn\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ fn\ ctxt\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ fn\ ct\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ beta{\isacharunderscore}{\kern0pt}proc\ ctxt\ {\isacharparenleft}{\kern0pt}Thm{\isachardot}{\kern0pt}term{\isacharunderscore}{\kern0pt}of\ ct{\isacharparenright}{\kern0pt}{\isacartoucheclose}\isanewline
\isacommand{simproc{\isacharunderscore}{\kern0pt}setup}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}eta\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}case{\isacharunderscore}{\kern0pt}prod\ f{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ {\isacartoucheopen}fn\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ fn\ ctxt\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ fn\ ct\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ eta{\isacharunderscore}{\kern0pt}proc\ ctxt\ {\isacharparenleft}{\kern0pt}Thm{\isachardot}{\kern0pt}term{\isacharunderscore}{\kern0pt}of\ ct{\isacharparenright}{\kern0pt}{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}y{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ f\ x\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
\medskip \isa{case{\isacharunderscore}{\kern0pt}prod} used as a logical connective or set former.

  \medskip These rules are for use with \isa{blast}; could instead
  call \isa{simp} using \isa{prod{\isachardot}{\kern0pt}split} as rewrite.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prodI{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymAnd}p{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}a\ b{\isachardot}{\kern0pt}\ p\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ c\ a\ b{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ case\ p\ of\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ c\ a\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}tupled{\isacharunderscore}{\kern0pt}all{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prodI{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymAnd}p{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}a\ b{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ p\ {\isasymLongrightarrow}\ c\ a\ b\ x{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}case\ p\ of\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ c\ a\ b{\isacharparenright}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}tupled{\isacharunderscore}{\kern0pt}all{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prodE\ {\isacharbrackleft}{\kern0pt}elim{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}case\ p\ of\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ c\ a\ b{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ p\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ c\ x\ y\ {\isasymLongrightarrow}\ Q{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ Q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induct\ p{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prodE{\isacharprime}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}elim{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}case\ p\ of\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ c\ a\ b{\isacharparenright}{\kern0pt}\ z\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ p\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ c\ x\ y\ z\ {\isasymLongrightarrow}\ Q{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ Q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induct\ p{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prodE{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ q{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Q\ {\isacharparenleft}{\kern0pt}case\ z\ of\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ P\ a\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ r{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ z\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ Q\ {\isacharparenleft}{\kern0pt}P\ x\ y{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ R{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ R\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ r{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}z\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ z{\isacharcomma}{\kern0pt}\ snd\ z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}Q\ {\isacharparenleft}{\kern0pt}P\ {\isacharparenleft}{\kern0pt}fst\ z{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ q\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unfold{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prodD{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}case\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ of\ {\isacharparenleft}{\kern0pt}c{\isacharcomma}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ R\ c\ d{\isacharparenright}{\kern0pt}\ c\ {\isasymLongrightarrow}\ R\ a\ b\ c{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mem{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prodI{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}z\ {\isasymin}\ c\ a\ b\ {\isasymLongrightarrow}\ z\ {\isasymin}\ {\isacharparenleft}{\kern0pt}case\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ of\ {\isacharparenleft}{\kern0pt}d{\isacharcomma}{\kern0pt}\ e{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ c\ d\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mem{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prodI{\isadigit{2}}\ {\isacharbrackleft}{\kern0pt}intro{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymAnd}p{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}a\ b{\isachardot}{\kern0pt}\ p\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ z\ {\isasymin}\ c\ a\ b{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ z\ {\isasymin}\ {\isacharparenleft}{\kern0pt}case\ p\ of\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ c\ a\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}tupled{\isacharunderscore}{\kern0pt}all{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{declare}\isamarkupfalse%
\ mem{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prodI\ {\isacharbrackleft}{\kern0pt}intro{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}\ %
\isamarkupcmt{postponed to maintain traditional declaration order!%
}\isanewline
\isacommand{declare}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prodI{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}intro{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}\ %
\isamarkupcmt{postponed to maintain traditional declaration order!%
}\isanewline
\isacommand{declare}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prodI{\isadigit{2}}\ {\isacharbrackleft}{\kern0pt}intro{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}\ %
\isamarkupcmt{postponed to maintain traditional declaration order!%
}\isanewline
\isacommand{declare}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prodI\ {\isacharbrackleft}{\kern0pt}intro{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}\ %
\isamarkupcmt{postponed to maintain traditional declaration order!%
}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mem{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prodE\ {\isacharbrackleft}{\kern0pt}elim{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}z\ {\isasymin}\ case{\isacharunderscore}{\kern0pt}prod\ c\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{obtains}\ x\ y\ \isakeyword{where}\ {\isachardoublequoteopen}p\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}z\ {\isasymin}\ c\ x\ y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ case{\isacharunderscore}{\kern0pt}prodE{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{ML}\isamarkupfalse%
\ {\isacartoucheopen}\isanewline
local\ {\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}\ filtering\ with\ exists{\isacharunderscore}{\kern0pt}p{\isacharunderscore}{\kern0pt}split\ is\ an\ essential\ optimization\ {\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ fun\ exists{\isacharunderscore}{\kern0pt}p{\isacharunderscore}{\kern0pt}split\ {\isacharparenleft}{\kern0pt}Const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}case{\isacharunderscore}{\kern0pt}prod{\isasymclose}{\isacharcomma}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardollar}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}Pair{\isasymclose}{\isacharcomma}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardollar}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isachardollar}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ true\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ exists{\isacharunderscore}{\kern0pt}p{\isacharunderscore}{\kern0pt}split\ {\isacharparenleft}{\kern0pt}t\ {\isachardollar}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exists{\isacharunderscore}{\kern0pt}p{\isacharunderscore}{\kern0pt}split\ t\ orelse\ exists{\isacharunderscore}{\kern0pt}p{\isacharunderscore}{\kern0pt}split\ u\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ exists{\isacharunderscore}{\kern0pt}p{\isacharunderscore}{\kern0pt}split\ {\isacharparenleft}{\kern0pt}Abs\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ t{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ exists{\isacharunderscore}{\kern0pt}p{\isacharunderscore}{\kern0pt}split\ t\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ exists{\isacharunderscore}{\kern0pt}p{\isacharunderscore}{\kern0pt}split\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ false{\isacharsemicolon}{\kern0pt}\isanewline
in\isanewline
\ \ fun\ split{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}tac\ ctxt\ {\isacharequal}{\kern0pt}\ SUBGOAL\ {\isacharparenleft}{\kern0pt}fn\ {\isacharparenleft}{\kern0pt}t{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\isanewline
\ \ \ \ if\ exists{\isacharunderscore}{\kern0pt}p{\isacharunderscore}{\kern0pt}split\ t\isanewline
\ \ \ \ then\ safe{\isacharunderscore}{\kern0pt}full{\isacharunderscore}{\kern0pt}simp{\isacharunderscore}{\kern0pt}tac\ {\isacharparenleft}{\kern0pt}put{\isacharunderscore}{\kern0pt}simpset\ HOL{\isacharunderscore}{\kern0pt}basic{\isacharunderscore}{\kern0pt}ss\ ctxt\ addsimps\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}conv{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ i\isanewline
\ \ \ \ else\ no{\isacharunderscore}{\kern0pt}tac{\isacharparenright}{\kern0pt}{\isacharsemicolon}{\kern0pt}\isanewline
end{\isacharsemicolon}{\kern0pt}\isanewline
{\isacartoucheclose}\isanewline
\isanewline
\isanewline
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}map{\isacharunderscore}{\kern0pt}theory{\isacharunderscore}{\kern0pt}claset\ {\isacharparenleft}{\kern0pt}fn\ ctxt\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ ctxt\ addSbefore\ {\isacharparenleft}{\kern0pt}{\isachardoublequote}{\kern0pt}split{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}tac{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}tac{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
\isanewline
%
\endisadelimML
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}eta{\isacharunderscore}{\kern0pt}SetCompr\ {\isacharbrackleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}atp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}u{\isachardot}{\kern0pt}\ {\isasymexists}x\ y{\isachardot}{\kern0pt}\ u\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isasymand}\ P\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ P{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\ fast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}eta{\isacharunderscore}{\kern0pt}SetCompr{\isadigit{2}}\ {\isacharbrackleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}atp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}u{\isachardot}{\kern0pt}\ {\isasymexists}x\ y{\isachardot}{\kern0pt}\ u\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isasymand}\ P\ x\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod\ P{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\ fast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}part\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}b{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ P\ {\isasymand}\ Q\ a\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}ab{\isachardot}{\kern0pt}\ P\ {\isasymand}\ case{\isacharunderscore}{\kern0pt}prod\ Q\ ab{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ %
\isamarkupcmt{Allows simplifications of nested splits in case of independent predicates.%
}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ f\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}c{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ g\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}d\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}u{\isachardot}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}g\ {\isacharparenleft}{\kern0pt}fst\ u{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ u{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}g\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ pair{\isacharunderscore}{\kern0pt}imageI\ {\isacharbrackleft}{\kern0pt}intro{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ A\ {\isasymLongrightarrow}\ f\ a\ b\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ f\ a\ b{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ image{\isacharunderscore}{\kern0pt}eqI\ {\isacharbrackleft}{\kern0pt}\isakeyword{where}\ x\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Collect{\isacharunderscore}{\kern0pt}const{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}b{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ P{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ P\ then\ UNIV\ else\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ The{\isacharunderscore}{\kern0pt}split{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}THE\ {\isacharparenleft}{\kern0pt}x{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}y{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ x{\isacharprime}{\kern0pt}\ {\isasymand}\ y\ {\isacharequal}{\kern0pt}\ y{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}case{\isacharunderscore}{\kern0pt}prod\ f\ p\ {\isacharequal}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}fst\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fact\ prod{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}cases{\isadigit{3}}\ {\isacharbrackleft}{\kern0pt}cases\ type{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{obtains}\ {\isacharparenleft}{\kern0pt}fields{\isacharparenright}{\kern0pt}\ a\ b\ c\ \isakeyword{where}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ y{\isacharcomma}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}tac\ b{\isacharparenright}{\kern0pt}\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}induct{\isadigit{3}}\ {\isacharbrackleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}names\ fields{\isacharcomma}{\kern0pt}\ induct\ type{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}a\ b\ c{\isachardot}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharcomma}{\kern0pt}\ c{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ P\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}cases{\isadigit{4}}\ {\isacharbrackleft}{\kern0pt}cases\ type{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{obtains}\ {\isacharparenleft}{\kern0pt}fields{\isacharparenright}{\kern0pt}\ a\ b\ c\ d\ \isakeyword{where}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharcomma}{\kern0pt}\ c{\isacharcomma}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ y{\isacharcomma}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}tac\ c{\isacharparenright}{\kern0pt}\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}induct{\isadigit{4}}\ {\isacharbrackleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}names\ fields{\isacharcomma}{\kern0pt}\ induct\ type{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}a\ b\ c\ d{\isachardot}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharcomma}{\kern0pt}\ c{\isacharcomma}{\kern0pt}\ d{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ P\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}cases{\isadigit{5}}\ {\isacharbrackleft}{\kern0pt}cases\ type{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{obtains}\ {\isacharparenleft}{\kern0pt}fields{\isacharparenright}{\kern0pt}\ a\ b\ c\ d\ e\ \isakeyword{where}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharcomma}{\kern0pt}\ c{\isacharcomma}{\kern0pt}\ d{\isacharcomma}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ y{\isacharcomma}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}tac\ d{\isacharparenright}{\kern0pt}\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}induct{\isadigit{5}}\ {\isacharbrackleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}names\ fields{\isacharcomma}{\kern0pt}\ induct\ type{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}a\ b\ c\ d\ e{\isachardot}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharcomma}{\kern0pt}\ c{\isacharcomma}{\kern0pt}\ d{\isacharcomma}{\kern0pt}\ e{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ P\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}cases{\isadigit{6}}\ {\isacharbrackleft}{\kern0pt}cases\ type{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{obtains}\ {\isacharparenleft}{\kern0pt}fields{\isacharparenright}{\kern0pt}\ a\ b\ c\ d\ e\ f\ \isakeyword{where}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharcomma}{\kern0pt}\ c{\isacharcomma}{\kern0pt}\ d{\isacharcomma}{\kern0pt}\ e{\isacharcomma}{\kern0pt}\ f{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ y{\isacharcomma}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}tac\ e{\isacharparenright}{\kern0pt}\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}induct{\isadigit{6}}\ {\isacharbrackleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}names\ fields{\isacharcomma}{\kern0pt}\ induct\ type{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}a\ b\ c\ d\ e\ f{\isachardot}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharcomma}{\kern0pt}\ c{\isacharcomma}{\kern0pt}\ d{\isacharcomma}{\kern0pt}\ e{\isacharcomma}{\kern0pt}\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ P\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}cases{\isadigit{7}}\ {\isacharbrackleft}{\kern0pt}cases\ type{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{obtains}\ {\isacharparenleft}{\kern0pt}fields{\isacharparenright}{\kern0pt}\ a\ b\ c\ d\ e\ f\ g\ \isakeyword{where}\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharcomma}{\kern0pt}\ c{\isacharcomma}{\kern0pt}\ d{\isacharcomma}{\kern0pt}\ e{\isacharcomma}{\kern0pt}\ f{\isacharcomma}{\kern0pt}\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ y{\isacharcomma}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}tac\ f{\isacharparenright}{\kern0pt}\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}induct{\isadigit{7}}\ {\isacharbrackleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}names\ fields{\isacharcomma}{\kern0pt}\ induct\ type{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymAnd}a\ b\ c\ d\ e\ f\ g{\isachardot}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharcomma}{\kern0pt}\ c{\isacharcomma}{\kern0pt}\ d{\isacharcomma}{\kern0pt}\ e{\isacharcomma}{\kern0pt}\ f{\isacharcomma}{\kern0pt}\ g{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ P\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ internal{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}c{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}c{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}internal{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ {\isasymequiv}\ case{\isacharunderscore}{\kern0pt}prod{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ internal{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}conv{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}internal{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ c\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ c\ a\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ internal{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{ML{\isacharunderscore}{\kern0pt}file}\isamarkupfalse%
\ {\isacartoucheopen}Tools{\isacharslash}{\kern0pt}split{\isacharunderscore}{\kern0pt}rule{\isachardot}{\kern0pt}ML{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
\isanewline
%
\endisadelimML
\isanewline
\isacommand{hide{\isacharunderscore}{\kern0pt}const}\isamarkupfalse%
\ internal{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Derived operations%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ curry\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}c{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}c{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}curry\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}c\ x\ y{\isachardot}{\kern0pt}\ c\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ curry{\isacharunderscore}{\kern0pt}conv\ {\isacharbrackleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}curry\ f\ a\ b\ {\isacharequal}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ curry{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ curryI\ {\isacharbrackleft}{\kern0pt}intro{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ curry\ f\ a\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ curry{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ curryD\ {\isacharbrackleft}{\kern0pt}dest{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}curry\ f\ a\ b\ {\isasymLongrightarrow}\ f\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ curry{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ curryE{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}curry\ f\ a\ b\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}f\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ Q{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ Q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ curry{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ curry{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}curry\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ curry{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unfold{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}curry\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}case{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}curry\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ curry{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unfold{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ curry{\isacharunderscore}{\kern0pt}K{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}curry\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ c{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x\ y{\isachardot}{\kern0pt}\ c{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The composition-uncurry combinator.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ scomp\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ {\isasymtimes}\ {\isacharprime}{\kern0pt}c{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}c\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}d{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}d{\isachardoublequoteclose}\ \ {\isacharparenleft}{\kern0pt}\isakeyword{infixl}\ {\isachardoublequoteopen}{\isasymcirc}{\isasymrightarrow}{\isachardoublequoteclose}\ {\isadigit{6}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}f\ {\isasymcirc}{\isasymrightarrow}\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod\ g\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{no{\isacharunderscore}{\kern0pt}notation}\isamarkupfalse%
\ scomp\ {\isacharparenleft}{\kern0pt}\isakeyword{infixl}\ {\isachardoublequoteopen}{\isasymcirc}{\isasymrightarrow}{\isachardoublequoteclose}\ {\isadigit{6}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\isacommand{bundle}\isamarkupfalse%
\ state{\isacharunderscore}{\kern0pt}combinator{\isacharunderscore}{\kern0pt}syntax\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{notation}\isamarkupfalse%
\ fcomp\ {\isacharparenleft}{\kern0pt}\isakeyword{infixl}\ {\isachardoublequoteopen}{\isasymcirc}{\isachargreater}{\kern0pt}{\isachardoublequoteclose}\ {\isadigit{6}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{notation}\isamarkupfalse%
\ scomp\ {\isacharparenleft}{\kern0pt}\isakeyword{infixl}\ {\isachardoublequoteopen}{\isasymcirc}{\isasymrightarrow}{\isachardoublequoteclose}\ {\isadigit{6}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\isanewline
\ \ \isakeyword{includes}\ state{\isacharunderscore}{\kern0pt}combinator{\isacharunderscore}{\kern0pt}syntax\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ scomp{\isacharunderscore}{\kern0pt}unfold{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymcirc}{\isasymrightarrow}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}f\ g\ x{\isachardot}{\kern0pt}\ g\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ scomp{\isacharunderscore}{\kern0pt}def\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unfold{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ scomp{\isacharunderscore}{\kern0pt}apply\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymcirc}{\isasymrightarrow}\ g{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod\ g\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ scomp{\isacharunderscore}{\kern0pt}unfold\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unfold{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Pair{\isacharunderscore}{\kern0pt}scomp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Pair\ x\ {\isasymcirc}{\isasymrightarrow}\ f\ {\isacharequal}{\kern0pt}\ f\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ scomp{\isacharunderscore}{\kern0pt}Pair{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymcirc}{\isasymrightarrow}\ Pair\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ scomp{\isacharunderscore}{\kern0pt}scomp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymcirc}{\isasymrightarrow}\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}{\isasymrightarrow}\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}{\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ g\ x\ {\isasymcirc}{\isasymrightarrow}\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ scomp{\isacharunderscore}{\kern0pt}unfold{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ scomp{\isacharunderscore}{\kern0pt}fcomp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymcirc}{\isasymrightarrow}\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}{\isachargreater}{\kern0pt}\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}{\isasymrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ g\ x\ {\isasymcirc}{\isachargreater}{\kern0pt}\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ scomp{\isacharunderscore}{\kern0pt}unfold\ fcomp{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fcomp{\isacharunderscore}{\kern0pt}scomp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isasymcirc}{\isachargreater}{\kern0pt}\ g{\isacharparenright}{\kern0pt}\ {\isasymcirc}{\isasymrightarrow}\ h\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}{\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isasymcirc}{\isasymrightarrow}\ h{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ scomp{\isacharunderscore}{\kern0pt}unfold{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{code{\isacharunderscore}{\kern0pt}printing}\isamarkupfalse%
\isanewline
\ \ \isakeyword{constant}\ scomp\ {\isasymrightharpoonup}\ {\isacharparenleft}{\kern0pt}Eval{\isacharparenright}{\kern0pt}\ \isakeyword{infixl}\ {\isadigit{3}}\ {\isachardoublequoteopen}{\isacharhash}{\kern0pt}{\isacharminus}{\kern0pt}{\isachargreater}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
\isa{map{\isacharunderscore}{\kern0pt}prod} --- action of the product functor upon functions.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ map{\isacharunderscore}{\kern0pt}prod\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}c{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}d{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}c\ {\isasymtimes}\ {\isacharprime}{\kern0pt}d{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}map{\isacharunderscore}{\kern0pt}prod\ f\ g\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ x{\isacharcomma}{\kern0pt}\ g\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ map{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}simp\ {\isacharbrackleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}map{\isacharunderscore}{\kern0pt}prod\ f\ g\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ a{\isacharcomma}{\kern0pt}\ g\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{functor}\isamarkupfalse%
\ map{\isacharunderscore}{\kern0pt}prod{\isacharcolon}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ split{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fst{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fst\ {\isacharparenleft}{\kern0pt}map{\isacharunderscore}{\kern0pt}prod\ f\ g\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ simp{\isacharunderscore}{\kern0pt}all%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}map{\isacharunderscore}{\kern0pt}prod\ f\ g\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ simp{\isacharunderscore}{\kern0pt}all%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fst{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fst\ {\isasymcirc}\ map{\isacharunderscore}{\kern0pt}prod\ f\ g\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\ fst{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\ simp{\isacharunderscore}{\kern0pt}all%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isasymcirc}\ map{\isacharunderscore}{\kern0pt}prod\ f\ g\ {\isacharequal}{\kern0pt}\ g\ {\isasymcirc}\ snd{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\ simp{\isacharunderscore}{\kern0pt}all%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ map{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}compose{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}map{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}f{\isadigit{1}}\ {\isasymcirc}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g{\isadigit{1}}\ {\isasymcirc}\ g{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map{\isacharunderscore}{\kern0pt}prod\ f{\isadigit{1}}\ g{\isadigit{1}}\ {\isasymcirc}\ map{\isacharunderscore}{\kern0pt}prod\ f{\isadigit{2}}\ g{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod{\isachardot}{\kern0pt}compositionality\ comp{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ map{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}ident\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}map{\isacharunderscore}{\kern0pt}prod\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}y{\isachardot}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}z{\isachardot}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ext{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod{\isachardot}{\kern0pt}identity{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ map{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}imageI\ {\isacharbrackleft}{\kern0pt}intro{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ R\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}f\ a{\isacharcomma}{\kern0pt}\ g\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ map{\isacharunderscore}{\kern0pt}prod\ f\ g\ {\isacharbackquote}{\kern0pt}\ R{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ image{\isacharunderscore}{\kern0pt}eqI{\isacharparenright}{\kern0pt}\ simp{\isacharunderscore}{\kern0pt}all%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prod{\isacharunderscore}{\kern0pt}fun{\isacharunderscore}{\kern0pt}imageE\ {\isacharbrackleft}{\kern0pt}elim{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ major{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}c\ {\isasymin}\ map{\isacharunderscore}{\kern0pt}prod\ f\ g\ {\isacharbackquote}{\kern0pt}\ R{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ cases{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ c\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ x{\isacharcomma}{\kern0pt}\ g\ y{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isasymin}\ R\ {\isasymLongrightarrow}\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ P\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ major\ {\isacharbrackleft}{\kern0pt}THEN\ imageE{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}tac\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ simp{\isacharunderscore}{\kern0pt}all\isanewline
\ \ \isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ apfst\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}c{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}c\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}apfst\ f\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod\ f\ id{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ apsnd\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}c{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}c{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}apsnd\ f\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod\ id\ f{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apfst{\isacharunderscore}{\kern0pt}conv\ {\isacharbrackleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}apfst\ f\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ apfst{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apsnd{\isacharunderscore}{\kern0pt}conv\ {\isacharbrackleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}apsnd\ f\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ f\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ apsnd{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fst{\isacharunderscore}{\kern0pt}apfst\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fst\ {\isacharparenleft}{\kern0pt}apfst\ f\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fst{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}apfst\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fst\ {\isasymcirc}\ apfst\ f\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\ fst{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fst{\isacharunderscore}{\kern0pt}apsnd\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fst\ {\isacharparenleft}{\kern0pt}apsnd\ f\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ fst\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fst{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}apsnd\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fst\ {\isasymcirc}\ apsnd\ f\ {\isacharequal}{\kern0pt}\ fst{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}apfst\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}apfst\ f\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ snd\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}apfst\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isasymcirc}\ apfst\ f\ {\isacharequal}{\kern0pt}\ snd{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}apsnd\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}apsnd\ f\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}apsnd\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isasymcirc}\ apsnd\ f\ {\isacharequal}{\kern0pt}\ f\ {\isasymcirc}\ snd{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apfst{\isacharunderscore}{\kern0pt}compose{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}apfst\ f\ {\isacharparenleft}{\kern0pt}apfst\ g\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ apfst\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\ g{\isacharparenright}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apsnd{\isacharunderscore}{\kern0pt}compose{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}apsnd\ f\ {\isacharparenleft}{\kern0pt}apsnd\ g\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ apsnd\ {\isacharparenleft}{\kern0pt}f\ {\isasymcirc}\ g{\isacharparenright}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apfst{\isacharunderscore}{\kern0pt}apsnd\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}apfst\ f\ {\isacharparenleft}{\kern0pt}apsnd\ g\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ g\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apsnd{\isacharunderscore}{\kern0pt}apfst\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}apsnd\ f\ {\isacharparenleft}{\kern0pt}apfst\ g\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}g\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apfst{\isacharunderscore}{\kern0pt}id\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}apfst\ id\ {\isacharequal}{\kern0pt}\ id{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apsnd{\isacharunderscore}{\kern0pt}id\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}apsnd\ id\ {\isacharequal}{\kern0pt}\ id{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apfst{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}conv\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}apfst\ f\ x\ {\isacharequal}{\kern0pt}\ apfst\ g\ x\ {\isasymlongleftrightarrow}\ f\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apsnd{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}conv\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}apsnd\ f\ x\ {\isacharequal}{\kern0pt}\ apsnd\ g\ x\ {\isasymlongleftrightarrow}\ f\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apsnd{\isacharunderscore}{\kern0pt}apfst{\isacharunderscore}{\kern0pt}commute{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}apsnd\ f\ {\isacharparenleft}{\kern0pt}apfst\ g\ p{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ apfst\ g\ {\isacharparenleft}{\kern0pt}apsnd\ f\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{context}\isamarkupfalse%
\isanewline
\isakeyword{begin}\isanewline
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{local{\isacharunderscore}{\kern0pt}setup}\isamarkupfalse%
\ {\isacartoucheopen}Local{\isacharunderscore}{\kern0pt}Theory{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}background{\isacharunderscore}{\kern0pt}naming\ {\isacharparenleft}{\kern0pt}Name{\isacharunderscore}{\kern0pt}Space{\isachardot}{\kern0pt}mandatory{\isacharunderscore}{\kern0pt}path\ {\isachardoublequote}{\kern0pt}prod{\isachardoublequote}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
\isanewline
%
\endisadelimML
\isanewline
\isacommand{definition}\isamarkupfalse%
\ swap\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}swap\ p\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ p{\isacharcomma}{\kern0pt}\ fst\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ swap{\isacharunderscore}{\kern0pt}simp\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}y{\isacharcomma}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}swap{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ swap{\isacharunderscore}{\kern0pt}swap\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}swap\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}swap\ p{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ p{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ swap{\isacharunderscore}{\kern0pt}comp{\isacharunderscore}{\kern0pt}swap\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}swap\ {\isasymcirc}\ prod{\isachardot}{\kern0pt}swap\ {\isacharequal}{\kern0pt}\ id{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ pair{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}swap{\isacharunderscore}{\kern0pt}image\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}y{\isacharcomma}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymin}\ prod{\isachardot}{\kern0pt}swap\ {\isacharbackquote}{\kern0pt}\ A\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isasymin}\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ image{\isacharunderscore}{\kern0pt}eqI{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inj{\isacharunderscore}{\kern0pt}swap\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ prod{\isachardot}{\kern0pt}swap\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inj{\isacharunderscore}{\kern0pt}onI{\isacharparenright}{\kern0pt}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ swap{\isacharunderscore}{\kern0pt}inj{\isacharunderscore}{\kern0pt}on{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ j{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}j{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inj{\isacharunderscore}{\kern0pt}onI{\isacharparenright}{\kern0pt}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ surj{\isacharunderscore}{\kern0pt}swap\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}surj\ prod{\isachardot}{\kern0pt}swap{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ surjI\ {\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ prod{\isachardot}{\kern0pt}swap{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}swap\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bij\ prod{\isachardot}{\kern0pt}swap{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ bij{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ case{\isacharunderscore}{\kern0pt}swap\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}case\ prod{\isachardot}{\kern0pt}swap\ p\ of\ {\isacharparenleft}{\kern0pt}y{\isacharcomma}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ f\ x\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case\ p\ of\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ f\ x\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ p{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fst{\isacharunderscore}{\kern0pt}swap\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fst\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}swap\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ snd\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}swap\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}prod{\isachardot}{\kern0pt}swap\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ fst\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Disjoint union of a family of sets -- Sigma.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ Sigma\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ set{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ set{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}Sigma\ A\ B\ {\isasymequiv}\ {\isasymUnion}x{\isasymin}A{\isachardot}{\kern0pt}\ {\isasymUnion}y{\isasymin}B\ x{\isachardot}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}Pair\ x\ y{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ Times\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ set\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ set{\isachardoublequoteclose}\ \ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isasymtimes}{\isachardoublequoteclose}\ {\isadigit{8}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}A\ {\isasymtimes}\ B\ {\isasymequiv}\ Sigma\ A\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{hide{\isacharunderscore}{\kern0pt}const}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}\isakeyword{open}{\isacharparenright}{\kern0pt}\ Times\isanewline
\isanewline
\isacommand{bundle}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}Set{\isacharunderscore}{\kern0pt}Product{\isacharunderscore}{\kern0pt}syntax\ \isakeyword{begin}\isanewline
\isacommand{no{\isacharunderscore}{\kern0pt}notation}\isamarkupfalse%
\ Product{\isacharunderscore}{\kern0pt}Type{\isachardot}{\kern0pt}Times\ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isasymtimes}{\isachardoublequoteclose}\ {\isadigit{8}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isacommand{bundle}\isamarkupfalse%
\ Set{\isacharunderscore}{\kern0pt}Product{\isacharunderscore}{\kern0pt}syntax\ \isakeyword{begin}\isanewline
\isacommand{notation}\isamarkupfalse%
\ Product{\isacharunderscore}{\kern0pt}Type{\isachardot}{\kern0pt}Times\ {\isacharparenleft}{\kern0pt}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isasymtimes}{\isachardoublequoteclose}\ {\isadigit{8}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{syntax}\isamarkupfalse%
\isanewline
\ \ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}Sigma{\isachardoublequoteclose}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}pttrn\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ set\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ set{\isachardoublequoteclose}\ \ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{3}}SIGMA\ {\isacharunderscore}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}{\isacharslash}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbrackleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{0}}{\isacharcomma}{\kern0pt}\ {\isadigit{1}}{\isadigit{0}}{\isacharbrackright}{\kern0pt}\ {\isadigit{1}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{translations}\isamarkupfalse%
\isanewline
\ \ {\isachardoublequoteopen}SIGMA\ x{\isacharcolon}{\kern0pt}A{\isachardot}{\kern0pt}\ B{\isachardoublequoteclose}\ {\isasymrightleftharpoons}\ {\isachardoublequoteopen}CONST\ Sigma\ A\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ SigmaI\ {\isacharbrackleft}{\kern0pt}intro{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ A\ {\isasymLongrightarrow}\ b\ {\isasymin}\ B\ a\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ Sigma\ A\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Sigma{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ SigmaE\ {\isacharbrackleft}{\kern0pt}elim{\isacharbang}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}c\ {\isasymin}\ Sigma\ A\ B\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ x\ {\isasymin}\ A\ {\isasymLongrightarrow}\ y\ {\isasymin}\ B\ x\ {\isasymLongrightarrow}\ c\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ P{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ P{\isachardoublequoteclose}\isanewline
\ \ %
\isamarkupcmt{The general elimination rule.%
}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Sigma{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Elimination of \isa{{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ A\ {\isasymtimes}\ B} -- introduces no
  eigenvariables.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ SigmaD{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ Sigma\ A\ B\ {\isasymLongrightarrow}\ a\ {\isasymin}\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ SigmaD{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ Sigma\ A\ B\ {\isasymLongrightarrow}\ b\ {\isasymin}\ B\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ SigmaE{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ Sigma\ A\ B\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}a\ {\isasymin}\ A\ {\isasymLongrightarrow}\ b\ {\isasymin}\ B\ a\ {\isasymLongrightarrow}\ P{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ P{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Sigma{\isacharunderscore}{\kern0pt}cong{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isacharequal}{\kern0pt}\ B\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ B\ {\isasymLongrightarrow}\ C\ x\ {\isacharequal}{\kern0pt}\ D\ x{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}SIGMA\ x{\isacharcolon}{\kern0pt}A{\isachardot}{\kern0pt}\ C\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}SIGMA\ x{\isacharcolon}{\kern0pt}B{\isachardot}{\kern0pt}\ D\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Sigma{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ C\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ A\ {\isasymLongrightarrow}\ B\ x\ {\isasymsubseteq}\ D\ x{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ Sigma\ A\ B\ {\isasymsubseteq}\ Sigma\ C\ D{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Sigma{\isacharunderscore}{\kern0pt}empty{\isadigit{1}}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Sigma\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ B\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Sigma{\isacharunderscore}{\kern0pt}empty{\isadigit{2}}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymtimes}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ UNIV{\isacharunderscore}{\kern0pt}Times{\isacharunderscore}{\kern0pt}UNIV\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}UNIV\ {\isasymtimes}\ UNIV\ {\isacharequal}{\kern0pt}\ UNIV{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Compl{\isacharunderscore}{\kern0pt}Times{\isacharunderscore}{\kern0pt}UNIV{\isadigit{1}}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}UNIV\ {\isasymtimes}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ UNIV\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Compl{\isacharunderscore}{\kern0pt}Times{\isacharunderscore}{\kern0pt}UNIV{\isadigit{2}}\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ UNIV{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ UNIV{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mem{\isacharunderscore}{\kern0pt}Sigma{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}iff{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ Sigma\ A\ B\ {\isasymlongleftrightarrow}\ a\ {\isasymin}\ A\ {\isasymand}\ b\ {\isasymin}\ B\ a{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mem{\isacharunderscore}{\kern0pt}Times{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ A\ {\isasymtimes}\ B\ {\isasymlongleftrightarrow}\ fst\ x\ {\isasymin}\ A\ {\isasymand}\ snd\ x\ {\isasymin}\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induct\ x{\isacharparenright}{\kern0pt}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Sigma{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}SIGMA\ i{\isacharcolon}{\kern0pt}I{\isachardot}{\kern0pt}\ X\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i{\isasymin}I{\isachardot}{\kern0pt}\ X\ i\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Times{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}cancel{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ C\ {\isasymLongrightarrow}\ A\ {\isasymtimes}\ C\ {\isasymsubseteq}\ B\ {\isasymtimes}\ C\ {\isasymlongleftrightarrow}\ A\ {\isasymsubseteq}\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Times{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}cancel{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ C\ {\isasymLongrightarrow}\ A\ {\isasymtimes}\ C\ {\isacharequal}{\kern0pt}\ B\ {\isasymtimes}\ C\ {\isasymlongleftrightarrow}\ A\ {\isacharequal}{\kern0pt}\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}blast\ elim{\isacharcolon}{\kern0pt}\ equalityE{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Collect{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}Sigma{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ P\ x\ {\isasymand}\ Q\ x\ y{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}SIGMA\ x{\isacharcolon}{\kern0pt}Collect\ P{\isachardot}{\kern0pt}\ Collect\ {\isacharparenleft}{\kern0pt}Q\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Collect{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ P\ a\ {\isasymand}\ Q\ b{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Collect\ P\ {\isasymtimes}\ Collect\ Q\ {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fact\ Collect{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}Sigma{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Collect{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prodD{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ Collect\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ A{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ A\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Collect{\isacharunderscore}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymle}\ B\ {\isasymLongrightarrow}\ Collect\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ A{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ Collect\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto\ {\isacharparenleft}{\kern0pt}auto\ elim{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ le{\isacharunderscore}{\kern0pt}funE{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Collect{\isacharunderscore}{\kern0pt}split{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}strong{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}X\ {\isacharequal}{\kern0pt}\ fst\ {\isacharbackquote}{\kern0pt}\ A\ {\isasymLongrightarrow}\ Y\ {\isacharequal}{\kern0pt}\ snd\ {\isacharbackquote}{\kern0pt}\ A\ {\isasymLongrightarrow}\ {\isasymforall}a{\isasymin}X{\isachardot}{\kern0pt}\ {\isasymforall}b\ {\isasymin}\ Y{\isachardot}{\kern0pt}\ P\ a\ b\ {\isasymlongrightarrow}\ Q\ a\ b\isanewline
\ \ \ \ {\isasymLongrightarrow}\ A\ {\isasymsubseteq}\ Collect\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ P{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ A\ {\isasymsubseteq}\ Collect\ {\isacharparenleft}{\kern0pt}case{\isacharunderscore}{\kern0pt}prod\ Q{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ UN{\isacharunderscore}{\kern0pt}Times{\isacharunderscore}{\kern0pt}distrib{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymUnion}{\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isasymin}A\ {\isasymtimes}\ B{\isachardot}{\kern0pt}\ E\ a\ {\isasymtimes}\ F\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymUnion}{\isacharparenleft}{\kern0pt}E\ {\isacharbackquote}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ {\isasymUnion}{\isacharparenleft}{\kern0pt}F\ {\isacharbackquote}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ %
\isamarkupcmt{Suggested by Pierre Chartier%
}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}Ball{\isacharunderscore}{\kern0pt}Sigma\ {\isacharbrackleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}atp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}z{\isasymin}Sigma\ A\ B{\isachardot}{\kern0pt}\ P\ z{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}x{\isasymin}A{\isachardot}{\kern0pt}\ {\isasymforall}y{\isasymin}B\ x{\isachardot}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}Bex{\isacharunderscore}{\kern0pt}Sigma\ {\isacharbrackleft}{\kern0pt}simp{\isacharcomma}{\kern0pt}\ no{\isacharunderscore}{\kern0pt}atp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymexists}z{\isasymin}Sigma\ A\ B{\isachardot}{\kern0pt}\ P\ z{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymexists}x{\isasymin}A{\isachardot}{\kern0pt}\ {\isasymexists}y{\isasymin}B\ x{\isachardot}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Sigma{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Sigma\ {\isacharparenleft}{\kern0pt}I\ {\isasymunion}\ J{\isacharparenright}{\kern0pt}\ C\ {\isacharequal}{\kern0pt}\ Sigma\ I\ C\ {\isasymunion}\ Sigma\ J\ C{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Sigma{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}SIGMA\ i{\isacharcolon}{\kern0pt}I{\isachardot}{\kern0pt}\ A\ i\ {\isasymunion}\ B\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Sigma\ I\ A\ {\isasymunion}\ Sigma\ I\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Sigma{\isacharunderscore}{\kern0pt}Int{\isacharunderscore}{\kern0pt}distrib{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Sigma\ {\isacharparenleft}{\kern0pt}I\ {\isasyminter}\ J{\isacharparenright}{\kern0pt}\ C\ {\isacharequal}{\kern0pt}\ Sigma\ I\ C\ {\isasyminter}\ Sigma\ J\ C{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Sigma{\isacharunderscore}{\kern0pt}Int{\isacharunderscore}{\kern0pt}distrib{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}SIGMA\ i{\isacharcolon}{\kern0pt}I{\isachardot}{\kern0pt}\ A\ i\ {\isasyminter}\ B\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Sigma\ I\ A\ {\isasyminter}\ Sigma\ I\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Sigma{\isacharunderscore}{\kern0pt}Diff{\isacharunderscore}{\kern0pt}distrib{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Sigma\ {\isacharparenleft}{\kern0pt}I\ {\isacharminus}{\kern0pt}\ J{\isacharparenright}{\kern0pt}\ C\ {\isacharequal}{\kern0pt}\ Sigma\ I\ C\ {\isacharminus}{\kern0pt}\ Sigma\ J\ C{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Sigma{\isacharunderscore}{\kern0pt}Diff{\isacharunderscore}{\kern0pt}distrib{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}SIGMA\ i{\isacharcolon}{\kern0pt}I{\isachardot}{\kern0pt}\ A\ i\ {\isacharminus}{\kern0pt}\ B\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Sigma\ I\ A\ {\isacharminus}{\kern0pt}\ Sigma\ I\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Sigma{\isacharunderscore}{\kern0pt}Union{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Sigma\ {\isacharparenleft}{\kern0pt}{\isasymUnion}X{\isacharparenright}{\kern0pt}\ B\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}A{\isasymin}X{\isachardot}{\kern0pt}\ Sigma\ A\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Pair{\isacharunderscore}{\kern0pt}vimage{\isacharunderscore}{\kern0pt}Sigma{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Pair\ x\ {\isacharminus}{\kern0pt}{\isacharbackquote}{\kern0pt}\ Sigma\ A\ f\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ x\ {\isasymin}\ A\ then\ f\ x\ else\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Non-dependent versions are needed to avoid the need for higher-order
  matching, especially when the rules are re-oriented.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ Times{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ C\ {\isacharequal}{\kern0pt}\ A\ {\isasymtimes}\ C\ {\isasymunion}\ B\ {\isasymtimes}\ C\ {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fact\ Sigma{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isadigit{1}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Times{\isacharunderscore}{\kern0pt}Int{\isacharunderscore}{\kern0pt}distrib{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ C\ {\isacharequal}{\kern0pt}\ A\ {\isasymtimes}\ C\ {\isasyminter}\ B\ {\isasymtimes}\ C\ {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fact\ Sigma{\isacharunderscore}{\kern0pt}Int{\isacharunderscore}{\kern0pt}distrib{\isadigit{1}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Times{\isacharunderscore}{\kern0pt}Diff{\isacharunderscore}{\kern0pt}distrib{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}A\ {\isacharminus}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ C\ {\isacharequal}{\kern0pt}\ A\ {\isasymtimes}\ C\ {\isacharminus}{\kern0pt}\ B\ {\isasymtimes}\ C\ {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fact\ Sigma{\isacharunderscore}{\kern0pt}Diff{\isacharunderscore}{\kern0pt}distrib{\isadigit{1}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Times{\isacharunderscore}{\kern0pt}empty\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymtimes}\ B\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymlongleftrightarrow}\ A\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymor}\ B\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ times{\isacharunderscore}{\kern0pt}subset{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymtimes}\ C\ {\isasymsubseteq}\ B\ {\isasymtimes}\ D\ {\isasymlongleftrightarrow}\ A{\isacharequal}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymor}\ C{\isacharequal}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymor}\ A\ {\isasymsubseteq}\ B\ {\isasymand}\ C\ {\isasymsubseteq}\ D{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ times{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymtimes}\ B\ {\isacharequal}{\kern0pt}\ C\ {\isasymtimes}\ D\ {\isasymlongleftrightarrow}\ A\ {\isacharequal}{\kern0pt}\ C\ {\isasymand}\ B\ {\isacharequal}{\kern0pt}\ D\ {\isasymor}\ {\isacharparenleft}{\kern0pt}A\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymor}\ B\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}C\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymor}\ D\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fst{\isacharunderscore}{\kern0pt}image{\isacharunderscore}{\kern0pt}times\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fst\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ B\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ then\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ else\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}image{\isacharunderscore}{\kern0pt}times\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ A\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ then\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ else\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fst{\isacharunderscore}{\kern0pt}image{\isacharunderscore}{\kern0pt}Sigma{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fst\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Sigma\ A\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x\ {\isasymin}\ A{\isachardot}{\kern0pt}\ B{\isacharparenleft}{\kern0pt}x{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}image{\isacharunderscore}{\kern0pt}Sigma{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Sigma\ A\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}\ x\ {\isasymin}\ A{\isachardot}{\kern0pt}\ B\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ vimage{\isacharunderscore}{\kern0pt}fst{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fst\ {\isacharminus}{\kern0pt}{\isacharbackquote}{\kern0pt}\ A\ {\isacharequal}{\kern0pt}\ A\ {\isasymtimes}\ UNIV{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ vimage{\isacharunderscore}{\kern0pt}snd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isacharminus}{\kern0pt}{\isacharbackquote}{\kern0pt}\ A\ {\isacharequal}{\kern0pt}\ UNIV\ {\isasymtimes}\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ insert{\isacharunderscore}{\kern0pt}Times{\isacharunderscore}{\kern0pt}insert\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}insert\ a\ A\ {\isasymtimes}\ insert\ b\ B\ {\isacharequal}{\kern0pt}\ insert\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}b{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ insert\ b\ B\ {\isasymunion}\ insert\ a\ A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ vimage{\isacharunderscore}{\kern0pt}Times{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isacharminus}{\kern0pt}{\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ {\isasymcirc}\ f{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharbackquote}{\kern0pt}\ A\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}snd\ {\isasymcirc}\ f{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharbackquote}{\kern0pt}\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ set{\isacharunderscore}{\kern0pt}eqI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ f\ {\isacharminus}{\kern0pt}{\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ x\ {\isasymin}\ {\isacharparenleft}{\kern0pt}fst\ {\isasymcirc}\ f{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharbackquote}{\kern0pt}\ A\ {\isasyminter}\ {\isacharparenleft}{\kern0pt}snd\ {\isasymcirc}\ f{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}{\isacharbackquote}{\kern0pt}\ B{\isachardoublequoteclose}\ \isakeyword{for}\ x\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}f\ x{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ split{\isacharcolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}split{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Times{\isacharunderscore}{\kern0pt}Int{\isacharunderscore}{\kern0pt}Times{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymtimes}\ B\ {\isasyminter}\ C\ {\isasymtimes}\ D\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasyminter}\ C{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}B\ {\isasyminter}\ D{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ image{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}Times{\isacharcolon}{\kern0pt}\isanewline
\ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}y{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ x{\isacharcomma}{\kern0pt}\ g\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}g\ {\isacharbackquote}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ product{\isacharunderscore}{\kern0pt}swap{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}prod{\isachardot}{\kern0pt}swap\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ B\ {\isasymtimes}\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ swap{\isacharunderscore}{\kern0pt}product{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}i{\isacharcomma}{\kern0pt}\ j{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}j{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ B\ {\isasymtimes}\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ image{\isacharunderscore}{\kern0pt}split{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Sigma{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ x{\isacharcomma}{\kern0pt}\ g\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ A\ {\isacharequal}{\kern0pt}\ Sigma\ {\isacharparenleft}{\kern0pt}f\ {\isacharbackquote}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ g\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isacharminus}{\kern0pt}{\isacharbackquote}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasyminter}\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}safe\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ imageI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ a\ b\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}b\ {\isasymin}\ A{\isachardoublequoteclose}\ \isakeyword{and}\ eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ a\ {\isacharequal}{\kern0pt}\ f\ b{\isachardoublequoteclose}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ b{\isacharcomma}{\kern0pt}\ g\ a{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ x{\isacharcomma}{\kern0pt}\ g\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\ eq{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
\ simp{\isacharunderscore}{\kern0pt}all%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ subset{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}snd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}fst\ {\isacharbackquote}{\kern0pt}\ A\ {\isasymtimes}\ snd\ {\isacharbackquote}{\kern0pt}\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}apfst\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ {\isacharparenleft}{\kern0pt}apfst\ f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ UNIV{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ inj{\isacharunderscore}{\kern0pt}on\ f\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inj{\isacharunderscore}{\kern0pt}apfst\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}inj\ {\isacharparenleft}{\kern0pt}apfst\ f{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ inj\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}apfst{\isacharbrackleft}{\kern0pt}of\ f\ UNIV{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}apsnd\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ {\isacharparenleft}{\kern0pt}apsnd\ f{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}UNIV\ {\isasymtimes}\ A{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ inj{\isacharunderscore}{\kern0pt}on\ f\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inj{\isacharunderscore}{\kern0pt}apsnd\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}inj\ {\isacharparenleft}{\kern0pt}apsnd\ f{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ inj\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}apsnd{\isacharbrackleft}{\kern0pt}of\ f\ UNIV{\isacharbrackright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{context}\isamarkupfalse%
\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isakeyword{qualified}\ \isacommand{definition}\isamarkupfalse%
\ product\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ set\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b\ set\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ set{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isacharbrackleft}{\kern0pt}code{\isacharunderscore}{\kern0pt}abbrev{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}product\ A\ B\ {\isacharequal}{\kern0pt}\ A\ {\isasymtimes}\ B{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ member{\isacharunderscore}{\kern0pt}product{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ Product{\isacharunderscore}{\kern0pt}Type{\isachardot}{\kern0pt}product\ A\ B\ {\isasymlongleftrightarrow}\ x\ {\isasymin}\ A\ {\isasymtimes}\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ product{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
%
\begin{isamarkuptext}%
The following \isa{map{\isacharunderscore}{\kern0pt}prod} lemmas are due to Joachim Breitner:%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ map{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}inj{\isacharunderscore}{\kern0pt}on{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ f\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ g\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ {\isacharparenleft}{\kern0pt}map{\isacharunderscore}{\kern0pt}prod\ f\ g{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ inj{\isacharunderscore}{\kern0pt}onI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}c{\isachardoublequoteclose}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ y\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}c{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ A\ {\isasymtimes}\ B{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}fst\ x\ {\isasymin}\ A{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}snd\ x\ {\isasymin}\ B{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\ A\ {\isasymtimes}\ B{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}fst\ y\ {\isasymin}\ A{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}snd\ y\ {\isasymin}\ B{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}map{\isacharunderscore}{\kern0pt}prod\ f\ g\ x\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod\ f\ g\ y{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}fst\ {\isacharparenleft}{\kern0pt}map{\isacharunderscore}{\kern0pt}prod\ f\ g\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}map{\isacharunderscore}{\kern0pt}prod\ f\ g\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isacharparenleft}{\kern0pt}fst\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}fst\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharcomma}{\kern0pt}\ cases\ y{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}inj{\isacharunderscore}{\kern0pt}on\ f\ A{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}fst\ x\ {\isasymin}\ A{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}fst\ y\ {\isasymin}\ A{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}fst\ x\ {\isacharequal}{\kern0pt}\ fst\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ dest{\isacharcolon}{\kern0pt}\ inj{\isacharunderscore}{\kern0pt}onD{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ {\isacartoucheopen}map{\isacharunderscore}{\kern0pt}prod\ f\ g\ x\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod\ f\ g\ y{\isacartoucheclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}map{\isacharunderscore}{\kern0pt}prod\ f\ g\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}map{\isacharunderscore}{\kern0pt}prod\ f\ g\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ g\ {\isacharparenleft}{\kern0pt}snd\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ x{\isacharcomma}{\kern0pt}\ cases\ y{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}inj{\isacharunderscore}{\kern0pt}on\ g\ B{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}snd\ x\ {\isasymin}\ B{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}snd\ y\ {\isasymin}\ B{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}snd\ x\ {\isacharequal}{\kern0pt}\ snd\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ dest{\isacharcolon}{\kern0pt}\ inj{\isacharunderscore}{\kern0pt}onD{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ prod{\isacharunderscore}{\kern0pt}eqI{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ map{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}surj{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ f\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ g\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}c\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}d{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}surj\ f{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}surj\ g{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}surj\ {\isacharparenleft}{\kern0pt}map{\isacharunderscore}{\kern0pt}prod\ f\ g{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ surj{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ y\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}b\ {\isasymtimes}\ {\isacharprime}{\kern0pt}d{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ {\isacartoucheopen}surj\ f{\isacartoucheclose}\ \isacommand{obtain}\isamarkupfalse%
\ a\ \isakeyword{where}\ {\isachardoublequoteopen}fst\ y\ {\isacharequal}{\kern0pt}\ f\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ elim{\isacharcolon}{\kern0pt}\ surjE{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ {\isacartoucheopen}surj\ g{\isacartoucheclose}\ \isacommand{obtain}\isamarkupfalse%
\ b\ \isakeyword{where}\ {\isachardoublequoteopen}snd\ y\ {\isacharequal}{\kern0pt}\ g\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ elim{\isacharcolon}{\kern0pt}\ surjE{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fst\ y{\isacharcomma}{\kern0pt}\ snd\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod\ f\ g\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}{\kern0pt}\ y\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod\ f\ g\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ map{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}surj{\isacharunderscore}{\kern0pt}on{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}f\ {\isacharbackquote}{\kern0pt}\ A\ {\isacharequal}{\kern0pt}\ A{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}g\ {\isacharbackquote}{\kern0pt}\ B\ {\isacharequal}{\kern0pt}\ B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}map{\isacharunderscore}{\kern0pt}prod\ f\ g\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ A{\isacharprime}{\kern0pt}\ {\isasymtimes}\ B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ image{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ set{\isacharunderscore}{\kern0pt}eqI{\isacharcomma}{\kern0pt}\ rule\ iffI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}c{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}y{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}c{\isachardot}{\kern0pt}\ {\isasymexists}x{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}b\ {\isasymtimes}\ {\isacharprime}{\kern0pt}d{\isasymin}A\ {\isasymtimes}\ B{\isachardot}{\kern0pt}\ y\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod\ f\ g\ x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ y\ \isakeyword{where}\ {\isachardoublequoteopen}y\ {\isasymin}\ A\ {\isasymtimes}\ B{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod\ f\ g\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ {\isacartoucheopen}image\ f\ A\ {\isacharequal}{\kern0pt}\ A{\isacharprime}{\kern0pt}{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}y\ {\isasymin}\ A\ {\isasymtimes}\ B{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isacharparenleft}{\kern0pt}fst\ y{\isacharparenright}{\kern0pt}\ {\isasymin}\ A{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ {\isacartoucheopen}image\ g\ B\ {\isacharequal}{\kern0pt}\ B{\isacharprime}{\kern0pt}{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}y\ {\isasymin}\ A\ {\isasymtimes}\ B{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}g\ {\isacharparenleft}{\kern0pt}snd\ y{\isacharparenright}{\kern0pt}\ {\isasymin}\ B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}f\ {\isacharparenleft}{\kern0pt}fst\ y{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ g\ {\isacharparenleft}{\kern0pt}snd\ y{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A{\isacharprime}{\kern0pt}\ {\isasymtimes}\ B{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}x\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod\ f\ g\ y{\isacartoucheclose}\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ A{\isacharprime}{\kern0pt}\ {\isasymtimes}\ B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ y{\isacharparenright}{\kern0pt}\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ {\isasymtimes}\ {\isacharprime}{\kern0pt}c{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ A{\isacharprime}{\kern0pt}\ {\isasymtimes}\ B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}fst\ x\ {\isasymin}\ A{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}snd\ x\ {\isasymin}\ B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ {\isacartoucheopen}image\ f\ A\ {\isacharequal}{\kern0pt}\ A{\isacharprime}{\kern0pt}{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}fst\ x\ {\isasymin}\ A{\isacharprime}{\kern0pt}{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}fst\ x\ {\isasymin}\ image\ f\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ a\ \isakeyword{where}\ {\isachardoublequoteopen}a\ {\isasymin}\ A{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}fst\ x\ {\isacharequal}{\kern0pt}\ f\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ imageE{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ {\isacartoucheopen}image\ g\ B\ {\isacharequal}{\kern0pt}\ B{\isacharprime}{\kern0pt}{\isacartoucheclose}\ \isakeyword{and}\ {\isacartoucheopen}snd\ x\ {\isasymin}\ B{\isacharprime}{\kern0pt}{\isacartoucheclose}\ \isacommand{obtain}\isamarkupfalse%
\ b\ \isakeyword{where}\ {\isachardoublequoteopen}b\ {\isasymin}\ B{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}snd\ x\ {\isacharequal}{\kern0pt}\ g\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fst\ x{\isacharcomma}{\kern0pt}\ snd\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod\ f\ g\ {\isacharparenleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ {\isacartoucheopen}a\ {\isasymin}\ A{\isacartoucheclose}\ \isakeyword{and}\ \ {\isacartoucheopen}b\ {\isasymin}\ B{\isacartoucheclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}a\ {\isacharcomma}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isasymin}\ A\ {\isasymtimes}\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}y\ {\isasymin}\ A\ {\isasymtimes}\ B{\isachardot}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod\ f\ g\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}x{\isachardot}{\kern0pt}\ {\isasymexists}y\ {\isasymin}\ A\ {\isasymtimes}\ B{\isachardot}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}prod\ f\ g\ y{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Simproc for rewriting a set comprehension into a pointfree expression%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{ML{\isacharunderscore}{\kern0pt}file}\isamarkupfalse%
\ {\isacartoucheopen}Tools{\isacharslash}{\kern0pt}set{\isacharunderscore}{\kern0pt}comprehension{\isacharunderscore}{\kern0pt}pointfree{\isachardot}{\kern0pt}ML{\isacartoucheclose}\isanewline
\isanewline
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}\isanewline
\ \ Code{\isacharunderscore}{\kern0pt}Preproc{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}pre\ {\isacharparenleft}{\kern0pt}fn\ ctxt\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ ctxt\ addsimprocs\isanewline
\ \ \ \ {\isacharbrackleft}{\kern0pt}Simplifier{\isachardot}{\kern0pt}make{\isacharunderscore}{\kern0pt}simproc\ \isactrlcontext \ {\isachardoublequote}{\kern0pt}set\ comprehension{\isachardoublequote}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}lhss\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}\isactrlterm {\isasymopen}Collect\ P{\isasymclose}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ proc\ {\isacharequal}{\kern0pt}\ K\ Set{\isacharunderscore}{\kern0pt}Comprehension{\isacharunderscore}{\kern0pt}Pointfree{\isachardot}{\kern0pt}code{\isacharunderscore}{\kern0pt}simproc{\isacharbraceright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Lemmas about disjointness%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ disjnt{\isacharunderscore}{\kern0pt}Times{\isadigit{1}}{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}disjnt\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\ A{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}C\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ C\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymor}\ disjnt\ A\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ disjnt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ disjnt{\isacharunderscore}{\kern0pt}Times{\isadigit{2}}{\isacharunderscore}{\kern0pt}iff\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}disjnt\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ C{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}B\ {\isasymtimes}\ C{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ C\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymor}\ disjnt\ A\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ disjnt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ disjnt{\isacharunderscore}{\kern0pt}Sigma{\isacharunderscore}{\kern0pt}iff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}disjnt\ {\isacharparenleft}{\kern0pt}Sigma\ A\ C{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Sigma\ B\ C{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i\ {\isasymin}\ A{\isasyminter}B{\isachardot}{\kern0pt}\ C\ i\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymor}\ disjnt\ A\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ disjnt{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Inductively defined sets%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{simproc{\isacharunderscore}{\kern0pt}setup}\isamarkupfalse%
\ Collect{\isacharunderscore}{\kern0pt}mem\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}Collect\ t{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacartoucheopen}\isanewline
\ \ fn\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ fn\ ctxt\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ fn\ ct\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}case\ Thm{\isachardot}{\kern0pt}term{\isacharunderscore}{\kern0pt}of\ ct\ of\isanewline
\ \ \ \ \ \ S\ as\ Const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}Collect{\isasymclose}{\isacharcomma}{\kern0pt}\ Type\ {\isacharparenleft}{\kern0pt}\isactrltypeUNDERSCOREname {\isasymopen}fun{\isasymclose}{\isacharcomma}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ T{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ t\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ let\ val\ {\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ ps{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ HOLogic{\isachardot}{\kern0pt}strip{\isacharunderscore}{\kern0pt}ptupleabs\ t\ in\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ u\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}c\ as\ Const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}Set{\isachardot}{\kern0pt}member{\isasymclose}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ q\ {\isachardollar}{\kern0pt}\ S{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ try\ {\isacharparenleft}{\kern0pt}HOLogic{\isachardot}{\kern0pt}strip{\isacharunderscore}{\kern0pt}ptuple\ ps{\isacharparenright}{\kern0pt}\ q\ of\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NONE\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ NONE\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ SOME\ ts\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ not\ {\isacharparenleft}{\kern0pt}Term{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}open\ S{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ andalso\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ts\ {\isacharequal}{\kern0pt}\ map\ Bound\ {\isacharparenleft}{\kern0pt}length\ ps\ downto\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ then\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ let\ val\ simp\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ full{\isacharunderscore}{\kern0pt}simp{\isacharunderscore}{\kern0pt}tac\ {\isacharparenleft}{\kern0pt}put{\isacharunderscore}{\kern0pt}simpset\ HOL{\isacharunderscore}{\kern0pt}basic{\isacharunderscore}{\kern0pt}ss\ ctxt\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ addsimps\ {\isacharbrackleft}{\kern0pt}{\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thm\ split{\isacharunderscore}{\kern0pt}paired{\isacharunderscore}{\kern0pt}all{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thm\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}conv{\isacharbraceright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SOME\ {\isacharparenleft}{\kern0pt}Goal{\isachardot}{\kern0pt}prove\ ctxt\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Const\ {\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREname {\isasymopen}Pure{\isachardot}{\kern0pt}eq{\isasymclose}{\isacharcomma}{\kern0pt}\ T\ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}{\isachargreater}{\kern0pt}\ T\ {\isacharminus}{\kern0pt}{\isacharminus}{\kern0pt}{\isachargreater}{\kern0pt}\ propT{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ S\ {\isachardollar}{\kern0pt}\ S{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}K\ {\isacharparenleft}{\kern0pt}EVERY\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbrackleft}{\kern0pt}resolve{\isacharunderscore}{\kern0pt}tac\ ctxt\ {\isacharbrackleft}{\kern0pt}eq{\isacharunderscore}{\kern0pt}reflection{\isacharbrackright}{\kern0pt}\ {\isadigit{1}}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ resolve{\isacharunderscore}{\kern0pt}tac\ ctxt\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ subset{\isacharunderscore}{\kern0pt}antisym{\isacharbraceright}{\kern0pt}\ {\isadigit{1}}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ resolve{\isacharunderscore}{\kern0pt}tac\ ctxt\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ subsetI{\isacharbraceright}{\kern0pt}\ {\isadigit{1}}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dresolve{\isacharunderscore}{\kern0pt}tac\ ctxt\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ CollectD{\isacharbraceright}{\kern0pt}\ {\isadigit{1}}{\isacharcomma}{\kern0pt}\ simp{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ resolve{\isacharunderscore}{\kern0pt}tac\ ctxt\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ subsetI{\isacharbraceright}{\kern0pt}\ {\isadigit{1}}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ resolve{\isacharunderscore}{\kern0pt}tac\ ctxt\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ CollectI{\isacharbraceright}{\kern0pt}\ {\isadigit{1}}{\isacharcomma}{\kern0pt}\ simp{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ end\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ NONE{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ NONE{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ end\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ NONE{\isacharparenright}{\kern0pt}\isanewline
{\isacartoucheclose}\isanewline
\isanewline
\isacommand{ML{\isacharunderscore}{\kern0pt}file}\isamarkupfalse%
\ {\isacartoucheopen}Tools{\isacharslash}{\kern0pt}inductive{\isacharunderscore}{\kern0pt}set{\isachardot}{\kern0pt}ML{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Legacy theorem bindings and duplicates%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemmas}\isamarkupfalse%
\ fst{\isacharunderscore}{\kern0pt}conv\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}sel{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ snd{\isacharunderscore}{\kern0pt}conv\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}sel{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}def\ {\isacharequal}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}unfold\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}beta\ {\isacharequal}{\kern0pt}\ prod{\isachardot}{\kern0pt}case{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}if\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ split{\isacharunderscore}{\kern0pt}conv\ {\isacharequal}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}conv\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ split\ {\isacharequal}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}conv\isanewline
\isanewline
\isacommand{hide{\isacharunderscore}{\kern0pt}const}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}\isakeyword{open}{\isacharparenright}{\kern0pt}\ prod\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=Product_Type.tex%:%
%:%11=6%:%
%:%27=8%:%
%:%28=8%:%
%:%29=9%:%
%:%30=10%:%
%:%31=11%:%
%:%45=13%:%
%:%55=15%:%
%:%56=15%:%
%:%59=16%:%
%:%63=16%:%
%:%64=16%:%
%:%73=18%:%
%:%81=20%:%
%:%82=20%:%
%:%89=20%:%
%:%90=21%:%
%:%91=22%:%
%:%92=22%:%
%:%94=22%:%
%:%98=22%:%
%:%99=22%:%
%:%106=22%:%
%:%109=23%:%
%:%114=24%:%
%:%115=24%:%
%:%124=26%:%
%:%132=28%:%
%:%133=28%:%
%:%140=28%:%
%:%141=29%:%
%:%142=30%:%
%:%143=30%:%
%:%144=31%:%
%:%145=31%:%
%:%146=32%:%
%:%147=32%:%
%:%148=33%:%
%:%149=33%:%
%:%152=34%:%
%:%157=35%:%
%:%158=35%:%
%:%163=35%:%
%:%166=36%:%
%:%167=37%:%
%:%168=37%:%
%:%169=38%:%
%:%170=38%:%
%:%171=38%:%
%:%172=39%:%
%:%173=40%:%
%:%174=40%:%
%:%175=41%:%
%:%176=42%:%
%:%177=43%:%
%:%178=44%:%
%:%181=45%:%
%:%185=45%:%
%:%186=45%:%
%:%191=45%:%
%:%194=46%:%
%:%195=47%:%
%:%196=47%:%
%:%197=48%:%
%:%198=49%:%
%:%201=50%:%
%:%205=50%:%
%:%206=50%:%
%:%207=50%:%
%:%212=50%:%
%:%217=51%:%
%:%222=52%:%
%:%223=52%:%
%:%228=52%:%
%:%231=53%:%
%:%232=54%:%
%:%233=54%:%
%:%234=55%:%
%:%235=56%:%
%:%242=59%:%
%:%252=61%:%
%:%253=61%:%
%:%256=62%:%
%:%260=62%:%
%:%261=62%:%
%:%266=62%:%
%:%269=63%:%
%:%270=64%:%
%:%271=64%:%
%:%272=65%:%
%:%273=66%:%
%:%274=67%:%
%:%275=67%:%
%:%278=68%:%
%:%282=68%:%
%:%283=68%:%
%:%292=71%:%
%:%293=72%:%
%:%301=75%:%
%:%302=75%:%
%:%313=79%:%
%:%314=80%:%
%:%315=81%:%
%:%316=81%:%
%:%319=82%:%
%:%323=82%:%
%:%324=82%:%
%:%333=84%:%
%:%341=86%:%
%:%342=86%:%
%:%349=86%:%
%:%350=87%:%
%:%351=88%:%
%:%352=88%:%
%:%354=88%:%
%:%358=88%:%
%:%359=88%:%
%:%366=88%:%
%:%369=89%:%
%:%374=90%:%
%:%375=90%:%
%:%384=92%:%
%:%392=94%:%
%:%393=94%:%
%:%400=94%:%
%:%401=95%:%
%:%402=96%:%
%:%403=96%:%
%:%404=97%:%
%:%405=97%:%
%:%406=98%:%
%:%407=98%:%
%:%408=99%:%
%:%409=99%:%
%:%412=100%:%
%:%417=101%:%
%:%418=101%:%
%:%423=101%:%
%:%426=102%:%
%:%427=103%:%
%:%428=103%:%
%:%431=104%:%
%:%435=104%:%
%:%436=104%:%
%:%441=104%:%
%:%444=105%:%
%:%445=106%:%
%:%446=106%:%
%:%449=107%:%
%:%453=107%:%
%:%454=107%:%
%:%463=110%:%
%:%463=111%:%
%:%463=112%:%
%:%465=115%:%
%:%466=115%:%
%:%469=116%:%
%:%473=116%:%
%:%474=116%:%
%:%479=116%:%
%:%482=117%:%
%:%483=118%:%
%:%484=118%:%
%:%487=119%:%
%:%491=119%:%
%:%492=119%:%
%:%497=119%:%
%:%500=120%:%
%:%501=121%:%
%:%502=121%:%
%:%503=122%:%
%:%504=123%:%
%:%505=124%:%
%:%506=124%:%
%:%507=125%:%
%:%508=126%:%
%:%511=126%:%
%:%515=126%:%
%:%523=126%:%
%:%524=127%:%
%:%525=128%:%
%:%526=128%:%
%:%527=129%:%
%:%528=130%:%
%:%529=130%:%
%:%530=131%:%
%:%531=132%:%
%:%532=133%:%
%:%533=133%:%
%:%534=134%:%
%:%535=135%:%
%:%536=136%:%
%:%537=136%:%
%:%540=137%:%
%:%544=137%:%
%:%545=137%:%
%:%550=137%:%
%:%553=138%:%
%:%554=139%:%
%:%555=139%:%
%:%556=140%:%
%:%557=141%:%
%:%558=142%:%
%:%559=142%:%
%:%562=143%:%
%:%566=143%:%
%:%567=143%:%
%:%572=143%:%
%:%575=144%:%
%:%576=145%:%
%:%577=145%:%
%:%578=146%:%
%:%579=147%:%
%:%580=148%:%
%:%581=148%:%
%:%582=149%:%
%:%583=150%:%
%:%584=151%:%
%:%585=151%:%
%:%586=152%:%
%:%587=153%:%
%:%588=154%:%
%:%589=154%:%
%:%590=155%:%
%:%591=156%:%
%:%592=157%:%
%:%593=157%:%
%:%594=158%:%
%:%595=159%:%
%:%596=160%:%
%:%597=160%:%
%:%598=161%:%
%:%599=162%:%
%:%600=163%:%
%:%601=163%:%
%:%602=164%:%
%:%603=165%:%
%:%604=166%:%
%:%605=166%:%
%:%606=167%:%
%:%607=168%:%
%:%608=169%:%
%:%609=170%:%
%:%610=171%:%
%:%611=172%:%
%:%612=173%:%
%:%613=174%:%
%:%614=174%:%
%:%617=175%:%
%:%621=175%:%
%:%622=175%:%
%:%627=175%:%
%:%630=176%:%
%:%631=177%:%
%:%632=177%:%
%:%633=178%:%
%:%634=179%:%
%:%635=179%:%
%:%638=180%:%
%:%642=180%:%
%:%643=180%:%
%:%644=180%:%
%:%649=180%:%
%:%652=181%:%
%:%653=182%:%
%:%654=182%:%
%:%655=183%:%
%:%656=184%:%
%:%657=185%:%
%:%658=186%:%
%:%659=187%:%
%:%660=188%:%
%:%661=189%:%
%:%662=190%:%
%:%663=191%:%
%:%664=192%:%
%:%665=193%:%
%:%666=194%:%
%:%667=195%:%
%:%668=196%:%
%:%669=197%:%
%:%670=198%:%
%:%671=198%:%
%:%672=199%:%
%:%673=200%:%
%:%674=201%:%
%:%675=201%:%
%:%676=202%:%
%:%677=203%:%
%:%678=204%:%
%:%679=204%:%
%:%680=205%:%
%:%687=208%:%
%:%691=210%:%
%:%701=212%:%
%:%702=212%:%
%:%703=213%:%
%:%704=214%:%
%:%705=215%:%
%:%706=215%:%
%:%707=216%:%
%:%708=217%:%
%:%709=217%:%
%:%712=218%:%
%:%716=218%:%
%:%717=218%:%
%:%718=218%:%
%:%723=218%:%
%:%726=219%:%
%:%727=220%:%
%:%728=220%:%
%:%729=221%:%
%:%730=222%:%
%:%731=223%:%
%:%732=223%:%
%:%733=224%:%
%:%734=225%:%
%:%735=226%:%
%:%736=226%:%
%:%739=227%:%
%:%743=227%:%
%:%744=227%:%
%:%749=227%:%
%:%752=228%:%
%:%753=229%:%
%:%754=229%:%
%:%761=230%:%
%:%762=230%:%
%:%763=231%:%
%:%764=231%:%
%:%765=232%:%
%:%766=232%:%
%:%767=233%:%
%:%768=233%:%
%:%769=234%:%
%:%770=234%:%
%:%771=235%:%
%:%772=235%:%
%:%773=236%:%
%:%774=236%:%
%:%775=237%:%
%:%776=237%:%
%:%777=238%:%
%:%778=238%:%
%:%779=238%:%
%:%780=239%:%
%:%781=239%:%
%:%782=240%:%
%:%783=240%:%
%:%784=240%:%
%:%785=241%:%
%:%786=241%:%
%:%787=242%:%
%:%797=244%:%
%:%805=246%:%
%:%806=246%:%
%:%813=246%:%
%:%814=247%:%
%:%815=248%:%
%:%816=248%:%
%:%819=249%:%
%:%823=249%:%
%:%824=249%:%
%:%829=249%:%
%:%834=250%:%
%:%839=251%:%
%:%840=251%:%
%:%849=253%:%
%:%857=255%:%
%:%858=255%:%
%:%865=255%:%
%:%866=256%:%
%:%867=257%:%
%:%868=257%:%
%:%869=258%:%
%:%870=259%:%
%:%871=259%:%
%:%872=260%:%
%:%873=260%:%
%:%874=261%:%
%:%875=261%:%
%:%876=262%:%
%:%877=262%:%
%:%880=263%:%
%:%885=264%:%
%:%886=264%:%
%:%891=264%:%
%:%894=265%:%
%:%895=266%:%
%:%896=266%:%
%:%897=267%:%
%:%898=267%:%
%:%899=268%:%
%:%900=268%:%
%:%901=269%:%
%:%902=269%:%
%:%903=270%:%
%:%904=270%:%
%:%906=273%:%
%:%907=274%:%
%:%908=275%:%
%:%909=276%:%
%:%918=280%:%
%:%930=283%:%
%:%931=284%:%
%:%933=287%:%
%:%934=287%:%
%:%935=288%:%
%:%936=288%:%
%:%937=289%:%
%:%938=290%:%
%:%939=291%:%
%:%940=292%:%
%:%941=293%:%
%:%942=294%:%
%:%943=295%:%
%:%944=296%:%
%:%945=296%:%
%:%946=297%:%
%:%947=298%:%
%:%948=299%:%
%:%949=300%:%
%:%950=301%:%
%:%951=302%:%
%:%952=303%:%
%:%953=304%:%
%:%954=304%:%
%:%955=305%:%
%:%956=306%:%
%:%957=306%:%
%:%958=307%:%
%:%959=308%:%
%:%961=310%:%
%:%962=311%:%
%:%970=313%:%
%:%971=313%:%
%:%1010=345%:%
%:%1011=346%:%
%:%1012=347%:%
%:%1020=349%:%
%:%1021=349%:%
%:%1070=387%:%
%:%1080=389%:%
%:%1081=389%:%
%:%1082=390%:%
%:%1083=391%:%
%:%1084=392%:%
%:%1085=393%:%
%:%1086=394%:%
%:%1087=395%:%
%:%1088=396%:%
%:%1089=397%:%
%:%1090=398%:%
%:%1091=399%:%
%:%1092=400%:%
%:%1093=401%:%
%:%1094=402%:%
%:%1095=403%:%
%:%1096=404%:%
%:%1097=405%:%
%:%1104=408%:%
%:%1114=410%:%
%:%1115=410%:%
%:%1118=411%:%
%:%1122=411%:%
%:%1123=411%:%
%:%1128=411%:%
%:%1131=412%:%
%:%1132=413%:%
%:%1133=413%:%
%:%1136=414%:%
%:%1140=414%:%
%:%1141=414%:%
%:%1146=414%:%
%:%1149=415%:%
%:%1150=416%:%
%:%1151=416%:%
%:%1154=417%:%
%:%1158=417%:%
%:%1159=417%:%
%:%1164=417%:%
%:%1167=418%:%
%:%1168=419%:%
%:%1169=419%:%
%:%1172=420%:%
%:%1176=420%:%
%:%1177=420%:%
%:%1182=420%:%
%:%1185=421%:%
%:%1186=422%:%
%:%1187=422%:%
%:%1190=423%:%
%:%1194=423%:%
%:%1195=423%:%
%:%1200=423%:%
%:%1203=424%:%
%:%1204=425%:%
%:%1205=425%:%
%:%1208=426%:%
%:%1212=426%:%
%:%1213=426%:%
%:%1218=426%:%
%:%1221=427%:%
%:%1222=428%:%
%:%1223=428%:%
%:%1224=429%:%
%:%1225=430%:%
%:%1226=430%:%
%:%1229=431%:%
%:%1233=431%:%
%:%1234=431%:%
%:%1239=431%:%
%:%1242=432%:%
%:%1243=433%:%
%:%1244=433%:%
%:%1247=434%:%
%:%1251=434%:%
%:%1252=434%:%
%:%1257=434%:%
%:%1260=435%:%
%:%1261=436%:%
%:%1262=436%:%
%:%1265=437%:%
%:%1269=437%:%
%:%1270=437%:%
%:%1275=437%:%
%:%1278=438%:%
%:%1279=439%:%
%:%1280=439%:%
%:%1283=440%:%
%:%1287=440%:%
%:%1288=440%:%
%:%1293=440%:%
%:%1296=441%:%
%:%1297=442%:%
%:%1298=442%:%
%:%1301=443%:%
%:%1305=443%:%
%:%1306=443%:%
%:%1311=443%:%
%:%1314=444%:%
%:%1315=445%:%
%:%1316=445%:%
%:%1317=446%:%
%:%1318=446%:%
%:%1319=446%:%
%:%1322=447%:%
%:%1326=447%:%
%:%1327=447%:%
%:%1332=447%:%
%:%1335=448%:%
%:%1336=452%:%
%:%1337=453%:%
%:%1338=454%:%
%:%1339=454%:%
%:%1342=455%:%
%:%1346=455%:%
%:%1347=455%:%
%:%1352=455%:%
%:%1355=456%:%
%:%1356=457%:%
%:%1357=457%:%
%:%1360=458%:%
%:%1364=458%:%
%:%1365=458%:%
%:%1370=458%:%
%:%1373=459%:%
%:%1374=460%:%
%:%1375=460%:%
%:%1378=461%:%
%:%1382=461%:%
%:%1383=461%:%
%:%1388=461%:%
%:%1391=462%:%
%:%1392=463%:%
%:%1393=463%:%
%:%1400=464%:%
%:%1401=464%:%
%:%1402=465%:%
%:%1403=465%:%
%:%1404=466%:%
%:%1405=466%:%
%:%1406=467%:%
%:%1407=467%:%
%:%1408=467%:%
%:%1409=467%:%
%:%1410=468%:%
%:%1411=468%:%
%:%1412=469%:%
%:%1413=469%:%
%:%1414=470%:%
%:%1415=470%:%
%:%1416=471%:%
%:%1417=471%:%
%:%1418=471%:%
%:%1419=471%:%
%:%1420=472%:%
%:%1430=475%:%
%:%1431=476%:%
%:%1432=477%:%
%:%1433=478%:%
%:%1435=481%:%
%:%1436=481%:%
%:%1439=482%:%
%:%1444=483%:%
%:%1445=483%:%
%:%1469=507%:%
%:%1470=508%:%
%:%1471=509%:%
%:%1472=509%:%
%:%1477=509%:%
%:%1480=510%:%
%:%1481=511%:%
%:%1482=511%:%
%:%1483=512%:%
%:%1484=512%:%
%:%1485=512%:%
%:%1488=513%:%
%:%1492=513%:%
%:%1493=513%:%
%:%1498=513%:%
%:%1501=514%:%
%:%1502=515%:%
%:%1503=515%:%
%:%1506=516%:%
%:%1510=516%:%
%:%1511=516%:%
%:%1516=516%:%
%:%1519=517%:%
%:%1520=518%:%
%:%1521=518%:%
%:%1522=519%:%
%:%1523=519%:%
%:%1524=519%:%
%:%1527=520%:%
%:%1531=520%:%
%:%1532=520%:%
%:%1541=523%:%
%:%1542=524%:%
%:%1543=525%:%
%:%1544=526%:%
%:%1552=529%:%
%:%1553=529%:%
%:%1595=571%:%
%:%1596=572%:%
%:%1597=572%:%
%:%1598=573%:%
%:%1599=574%:%
%:%1600=574%:%
%:%1601=575%:%
%:%1608=575%:%
%:%1609=576%:%
%:%1610=577%:%
%:%1611=577%:%
%:%1614=578%:%
%:%1618=578%:%
%:%1619=578%:%
%:%1628=581%:%
%:%1629=582%:%
%:%1630=583%:%
%:%1631=584%:%
%:%1633=586%:%
%:%1634=586%:%
%:%1635=587%:%
%:%1638=588%:%
%:%1642=588%:%
%:%1643=588%:%
%:%1648=588%:%
%:%1651=589%:%
%:%1652=590%:%
%:%1653=590%:%
%:%1654=591%:%
%:%1657=592%:%
%:%1661=592%:%
%:%1662=592%:%
%:%1667=592%:%
%:%1670=593%:%
%:%1671=594%:%
%:%1672=594%:%
%:%1673=595%:%
%:%1676=596%:%
%:%1680=596%:%
%:%1681=596%:%
%:%1686=596%:%
%:%1689=597%:%
%:%1690=598%:%
%:%1691=598%:%
%:%1692=599%:%
%:%1695=600%:%
%:%1699=600%:%
%:%1700=600%:%
%:%1705=600%:%
%:%1708=601%:%
%:%1709=602%:%
%:%1710=602%:%
%:%1711=603%:%
%:%1712=604%:%
%:%1713=605%:%
%:%1720=606%:%
%:%1721=606%:%
%:%1722=607%:%
%:%1723=607%:%
%:%1724=607%:%
%:%1725=608%:%
%:%1726=608%:%
%:%1727=608%:%
%:%1728=609%:%
%:%1729=609%:%
%:%1730=609%:%
%:%1731=610%:%
%:%1737=610%:%
%:%1740=611%:%
%:%1741=612%:%
%:%1742=612%:%
%:%1745=613%:%
%:%1749=613%:%
%:%1750=613%:%
%:%1755=613%:%
%:%1758=614%:%
%:%1759=615%:%
%:%1760=615%:%
%:%1763=616%:%
%:%1767=616%:%
%:%1768=616%:%
%:%1773=616%:%
%:%1776=617%:%
%:%1777=618%:%
%:%1778=618%:%
%:%1779=619%:%
%:%1782=620%:%
%:%1786=620%:%
%:%1787=620%:%
%:%1792=620%:%
%:%1795=621%:%
%:%1796=622%:%
%:%1797=622%:%
%:%1798=622%:%
%:%1799=622%:%
%:%1800=623%:%
%:%1801=623%:%
%:%1802=623%:%
%:%1803=623%:%
%:%1804=624%:%
%:%1805=624%:%
%:%1806=624%:%
%:%1807=624%:%
%:%1808=625%:%
%:%1809=625%:%
%:%1810=625%:%
%:%1811=625%:%
%:%1812=626%:%
%:%1813=627%:%
%:%1814=627%:%
%:%1815=628%:%
%:%1816=629%:%
%:%1819=630%:%
%:%1823=630%:%
%:%1824=630%:%
%:%1825=630%:%
%:%1830=630%:%
%:%1835=631%:%
%:%1840=632%:%
%:%1841=632%:%
%:%1853=644%:%
%:%1854=645%:%
%:%1855=647%:%
%:%1856=648%:%
%:%1857=648%:%
%:%1862=648%:%
%:%1865=649%:%
%:%1866=650%:%
%:%1867=650%:%
%:%1870=651%:%
%:%1874=651%:%
%:%1875=651%:%
%:%1880=651%:%
%:%1883=652%:%
%:%1884=653%:%
%:%1885=653%:%
%:%1888=654%:%
%:%1892=654%:%
%:%1893=654%:%
%:%1898=654%:%
%:%1901=655%:%
%:%1902=656%:%
%:%1903=656%:%
%:%1904=657%:%
%:%1905=657%:%
%:%1906=657%:%
%:%1909=658%:%
%:%1913=658%:%
%:%1914=658%:%
%:%1919=658%:%
%:%1922=659%:%
%:%1923=663%:%
%:%1924=664%:%
%:%1925=664%:%
%:%1926=665%:%
%:%1927=666%:%
%:%1928=667%:%
%:%1931=668%:%
%:%1935=668%:%
%:%1936=668%:%
%:%1941=668%:%
%:%1944=669%:%
%:%1945=670%:%
%:%1946=670%:%
%:%1949=671%:%
%:%1953=671%:%
%:%1954=671%:%
%:%1959=671%:%
%:%1962=672%:%
%:%1963=673%:%
%:%1964=673%:%
%:%1971=674%:%
%:%1972=674%:%
%:%1977=674%:%
%:%1980=675%:%
%:%1981=676%:%
%:%1982=676%:%
%:%1985=677%:%
%:%1989=677%:%
%:%1990=677%:%
%:%1995=677%:%
%:%1998=678%:%
%:%1999=690%:%
%:%2000=691%:%
%:%2001=692%:%
%:%2002=692%:%
%:%2005=693%:%
%:%2009=693%:%
%:%2010=693%:%
%:%2015=693%:%
%:%2018=694%:%
%:%2019=695%:%
%:%2020=695%:%
%:%2021=696%:%
%:%2024=697%:%
%:%2028=697%:%
%:%2029=697%:%
%:%2034=697%:%
%:%2037=698%:%
%:%2038=699%:%
%:%2039=699%:%
%:%2040=700%:%
%:%2043=701%:%
%:%2047=701%:%
%:%2048=701%:%
%:%2053=701%:%
%:%2056=702%:%
%:%2057=703%:%
%:%2058=703%:%
%:%2059=704%:%
%:%2062=705%:%
%:%2066=705%:%
%:%2067=705%:%
%:%2072=705%:%
%:%2075=706%:%
%:%2076=707%:%
%:%2077=707%:%
%:%2078=708%:%
%:%2081=709%:%
%:%2085=709%:%
%:%2086=709%:%
%:%2091=709%:%
%:%2094=710%:%
%:%2095=711%:%
%:%2096=711%:%
%:%2097=712%:%
%:%2100=713%:%
%:%2104=713%:%
%:%2105=713%:%
%:%2110=713%:%
%:%2113=714%:%
%:%2114=715%:%
%:%2115=715%:%
%:%2116=716%:%
%:%2119=717%:%
%:%2123=717%:%
%:%2124=717%:%
%:%2129=717%:%
%:%2132=718%:%
%:%2133=719%:%
%:%2134=719%:%
%:%2135=720%:%
%:%2138=721%:%
%:%2142=721%:%
%:%2143=721%:%
%:%2148=721%:%
%:%2151=722%:%
%:%2152=723%:%
%:%2153=723%:%
%:%2154=724%:%
%:%2157=725%:%
%:%2161=725%:%
%:%2162=725%:%
%:%2167=725%:%
%:%2170=726%:%
%:%2171=727%:%
%:%2172=727%:%
%:%2173=728%:%
%:%2176=729%:%
%:%2180=729%:%
%:%2181=729%:%
%:%2186=729%:%
%:%2189=730%:%
%:%2190=731%:%
%:%2191=731%:%
%:%2192=732%:%
%:%2195=733%:%
%:%2199=733%:%
%:%2200=733%:%
%:%2205=733%:%
%:%2208=734%:%
%:%2209=735%:%
%:%2210=735%:%
%:%2211=736%:%
%:%2212=737%:%
%:%2213=738%:%
%:%2214=738%:%
%:%2217=739%:%
%:%2221=739%:%
%:%2222=739%:%
%:%2227=739%:%
%:%2232=740%:%
%:%2237=741%:%
%:%2238=741%:%
%:%2243=741%:%
%:%2246=742%:%
%:%2247=743%:%
%:%2248=743%:%
%:%2255=746%:%
%:%2265=748%:%
%:%2266=748%:%
%:%2267=749%:%
%:%2268=750%:%
%:%2269=751%:%
%:%2270=751%:%
%:%2273=752%:%
%:%2277=752%:%
%:%2278=752%:%
%:%2283=752%:%
%:%2286=753%:%
%:%2287=754%:%
%:%2288=754%:%
%:%2291=755%:%
%:%2295=755%:%
%:%2296=755%:%
%:%2301=755%:%
%:%2304=756%:%
%:%2305=757%:%
%:%2306=757%:%
%:%2309=758%:%
%:%2313=758%:%
%:%2314=758%:%
%:%2319=758%:%
%:%2322=759%:%
%:%2323=760%:%
%:%2324=760%:%
%:%2327=761%:%
%:%2331=761%:%
%:%2332=761%:%
%:%2337=761%:%
%:%2340=762%:%
%:%2341=763%:%
%:%2342=763%:%
%:%2345=764%:%
%:%2349=764%:%
%:%2350=764%:%
%:%2355=764%:%
%:%2358=765%:%
%:%2359=766%:%
%:%2360=766%:%
%:%2363=767%:%
%:%2367=767%:%
%:%2368=767%:%
%:%2373=767%:%
%:%2376=768%:%
%:%2377=769%:%
%:%2378=769%:%
%:%2381=770%:%
%:%2385=770%:%
%:%2386=770%:%
%:%2395=772%:%
%:%2397=774%:%
%:%2398=774%:%
%:%2399=775%:%
%:%2400=776%:%
%:%2401=777%:%
%:%2402=777%:%
%:%2403=778%:%
%:%2404=779%:%
%:%2405=779%:%
%:%2406=780%:%
%:%2407=781%:%
%:%2408=782%:%
%:%2409=782%:%
%:%2410=783%:%
%:%2411=783%:%
%:%2412=784%:%
%:%2413=785%:%
%:%2414=785%:%
%:%2415=786%:%
%:%2416=787%:%
%:%2417=787%:%
%:%2418=788%:%
%:%2419=789%:%
%:%2420=790%:%
%:%2421=791%:%
%:%2422=791%:%
%:%2425=792%:%
%:%2429=792%:%
%:%2430=792%:%
%:%2435=792%:%
%:%2438=793%:%
%:%2439=794%:%
%:%2440=794%:%
%:%2443=795%:%
%:%2447=795%:%
%:%2448=795%:%
%:%2453=795%:%
%:%2456=796%:%
%:%2457=797%:%
%:%2458=797%:%
%:%2461=798%:%
%:%2465=798%:%
%:%2466=798%:%
%:%2471=798%:%
%:%2474=799%:%
%:%2475=800%:%
%:%2476=800%:%
%:%2479=801%:%
%:%2483=801%:%
%:%2484=801%:%
%:%2489=801%:%
%:%2492=802%:%
%:%2493=803%:%
%:%2494=803%:%
%:%2497=804%:%
%:%2501=804%:%
%:%2502=804%:%
%:%2507=804%:%
%:%2510=805%:%
%:%2511=806%:%
%:%2512=806%:%
%:%2515=807%:%
%:%2519=807%:%
%:%2520=807%:%
%:%2525=807%:%
%:%2528=808%:%
%:%2529=809%:%
%:%2530=809%:%
%:%2533=810%:%
%:%2537=810%:%
%:%2538=810%:%
%:%2543=810%:%
%:%2546=811%:%
%:%2547=812%:%
%:%2548=812%:%
%:%2549=813%:%
%:%2550=814%:%
%:%2551=814%:%
%:%2552=815%:%
%:%2554=818%:%
%:%2556=821%:%
%:%2557=821%:%
%:%2558=822%:%
%:%2559=823%:%
%:%2560=824%:%
%:%2561=824%:%
%:%2564=825%:%
%:%2568=825%:%
%:%2569=825%:%
%:%2574=825%:%
%:%2577=826%:%
%:%2578=827%:%
%:%2579=827%:%
%:%2582=828%:%
%:%2586=828%:%
%:%2587=828%:%
%:%2592=828%:%
%:%2595=829%:%
%:%2596=830%:%
%:%2597=830%:%
%:%2600=831%:%
%:%2604=831%:%
%:%2605=831%:%
%:%2610=831%:%
%:%2613=832%:%
%:%2614=833%:%
%:%2615=833%:%
%:%2618=834%:%
%:%2622=834%:%
%:%2623=834%:%
%:%2628=834%:%
%:%2631=835%:%
%:%2632=836%:%
%:%2633=836%:%
%:%2636=837%:%
%:%2640=837%:%
%:%2641=837%:%
%:%2646=837%:%
%:%2649=838%:%
%:%2650=839%:%
%:%2651=839%:%
%:%2654=840%:%
%:%2658=840%:%
%:%2659=840%:%
%:%2664=840%:%
%:%2667=841%:%
%:%2668=842%:%
%:%2669=842%:%
%:%2672=843%:%
%:%2676=843%:%
%:%2677=843%:%
%:%2682=843%:%
%:%2685=844%:%
%:%2686=845%:%
%:%2687=845%:%
%:%2690=846%:%
%:%2694=846%:%
%:%2695=846%:%
%:%2700=846%:%
%:%2703=847%:%
%:%2704=848%:%
%:%2705=848%:%
%:%2708=849%:%
%:%2712=849%:%
%:%2713=849%:%
%:%2718=849%:%
%:%2721=850%:%
%:%2722=851%:%
%:%2723=851%:%
%:%2724=852%:%
%:%2725=853%:%
%:%2726=854%:%
%:%2729=855%:%
%:%2733=855%:%
%:%2734=855%:%
%:%2735=856%:%
%:%2736=856%:%
%:%2737=857%:%
%:%2738=857%:%
%:%2739=858%:%
%:%2740=858%:%
%:%2741=859%:%
%:%2747=859%:%
%:%2750=860%:%
%:%2751=861%:%
%:%2752=861%:%
%:%2753=862%:%
%:%2754=863%:%
%:%2755=864%:%
%:%2756=864%:%
%:%2757=865%:%
%:%2758=866%:%
%:%2759=867%:%
%:%2760=867%:%
%:%2763=868%:%
%:%2767=868%:%
%:%2768=868%:%
%:%2773=868%:%
%:%2776=869%:%
%:%2777=870%:%
%:%2778=870%:%
%:%2781=871%:%
%:%2785=871%:%
%:%2786=871%:%
%:%2791=871%:%
%:%2794=872%:%
%:%2795=873%:%
%:%2796=873%:%
%:%2799=874%:%
%:%2803=874%:%
%:%2804=874%:%
%:%2809=874%:%
%:%2812=875%:%
%:%2813=876%:%
%:%2814=876%:%
%:%2817=877%:%
%:%2821=877%:%
%:%2822=877%:%
%:%2827=877%:%
%:%2830=878%:%
%:%2831=879%:%
%:%2832=879%:%
%:%2835=880%:%
%:%2839=880%:%
%:%2840=880%:%
%:%2845=880%:%
%:%2848=881%:%
%:%2849=882%:%
%:%2850=882%:%
%:%2853=883%:%
%:%2857=883%:%
%:%2858=883%:%
%:%2863=883%:%
%:%2866=884%:%
%:%2867=885%:%
%:%2868=885%:%
%:%2871=886%:%
%:%2875=886%:%
%:%2876=886%:%
%:%2881=886%:%
%:%2884=887%:%
%:%2885=888%:%
%:%2886=888%:%
%:%2889=889%:%
%:%2893=889%:%
%:%2894=889%:%
%:%2899=889%:%
%:%2902=890%:%
%:%2903=891%:%
%:%2904=891%:%
%:%2907=892%:%
%:%2911=892%:%
%:%2912=892%:%
%:%2917=892%:%
%:%2920=893%:%
%:%2921=894%:%
%:%2922=894%:%
%:%2925=895%:%
%:%2929=895%:%
%:%2930=895%:%
%:%2935=895%:%
%:%2938=896%:%
%:%2939=897%:%
%:%2940=897%:%
%:%2943=898%:%
%:%2947=898%:%
%:%2948=898%:%
%:%2953=898%:%
%:%2956=899%:%
%:%2957=900%:%
%:%2958=900%:%
%:%2961=901%:%
%:%2965=901%:%
%:%2966=901%:%
%:%2971=901%:%
%:%2974=902%:%
%:%2975=903%:%
%:%2976=903%:%
%:%2979=904%:%
%:%2983=904%:%
%:%2984=904%:%
%:%2989=904%:%
%:%2992=905%:%
%:%2993=906%:%
%:%2994=906%:%
%:%2997=907%:%
%:%3001=907%:%
%:%3002=907%:%
%:%3007=907%:%
%:%3010=908%:%
%:%3011=909%:%
%:%3012=909%:%
%:%3015=910%:%
%:%3019=910%:%
%:%3020=910%:%
%:%3025=910%:%
%:%3028=911%:%
%:%3029=912%:%
%:%3030=912%:%
%:%3033=913%:%
%:%3037=913%:%
%:%3038=913%:%
%:%3043=913%:%
%:%3046=914%:%
%:%3047=915%:%
%:%3048=915%:%
%:%3051=916%:%
%:%3055=916%:%
%:%3056=916%:%
%:%3061=916%:%
%:%3064=917%:%
%:%3065=918%:%
%:%3066=918%:%
%:%3069=919%:%
%:%3073=919%:%
%:%3074=919%:%
%:%3079=919%:%
%:%3082=920%:%
%:%3083=921%:%
%:%3084=921%:%
%:%3087=922%:%
%:%3091=922%:%
%:%3092=922%:%
%:%3097=922%:%
%:%3100=923%:%
%:%3101=924%:%
%:%3102=924%:%
%:%3103=925%:%
%:%3106=926%:%
%:%3111=927%:%
%:%3112=927%:%
%:%3117=927%:%
%:%3120=928%:%
%:%3121=929%:%
%:%3122=929%:%
%:%3123=930%:%
%:%3124=931%:%
%:%3125=932%:%
%:%3126=932%:%
%:%3127=933%:%
%:%3128=934%:%
%:%3129=934%:%
%:%3132=935%:%
%:%3136=935%:%
%:%3137=935%:%
%:%3142=935%:%
%:%3145=936%:%
%:%3146=937%:%
%:%3147=937%:%
%:%3150=938%:%
%:%3154=938%:%
%:%3155=938%:%
%:%3160=938%:%
%:%3163=939%:%
%:%3164=940%:%
%:%3165=940%:%
%:%3168=941%:%
%:%3172=941%:%
%:%3173=941%:%
%:%3178=941%:%
%:%3181=942%:%
%:%3182=943%:%
%:%3183=943%:%
%:%3186=944%:%
%:%3190=944%:%
%:%3191=944%:%
%:%3196=944%:%
%:%3199=945%:%
%:%3200=946%:%
%:%3201=946%:%
%:%3204=947%:%
%:%3208=947%:%
%:%3209=947%:%
%:%3214=947%:%
%:%3217=948%:%
%:%3218=949%:%
%:%3219=949%:%
%:%3222=950%:%
%:%3226=950%:%
%:%3227=950%:%
%:%3232=950%:%
%:%3235=951%:%
%:%3236=952%:%
%:%3237=952%:%
%:%3240=953%:%
%:%3244=953%:%
%:%3245=953%:%
%:%3250=953%:%
%:%3253=954%:%
%:%3254=955%:%
%:%3255=955%:%
%:%3258=956%:%
%:%3262=956%:%
%:%3263=956%:%
%:%3268=956%:%
%:%3271=957%:%
%:%3272=958%:%
%:%3273=958%:%
%:%3276=959%:%
%:%3280=959%:%
%:%3281=959%:%
%:%3286=959%:%
%:%3289=960%:%
%:%3290=961%:%
%:%3291=961%:%
%:%3294=962%:%
%:%3298=962%:%
%:%3299=962%:%
%:%3304=962%:%
%:%3307=963%:%
%:%3308=964%:%
%:%3309=964%:%
%:%3312=965%:%
%:%3316=965%:%
%:%3317=965%:%
%:%3326=967%:%
%:%3328=969%:%
%:%3329=969%:%
%:%3330=970%:%
%:%3331=971%:%
%:%3332=972%:%
%:%3333=972%:%
%:%3334=973%:%
%:%3335=974%:%
%:%3336=975%:%
%:%3337=975%:%
%:%3338=976%:%
%:%3339=977%:%
%:%3340=977%:%
%:%3341=978%:%
%:%3342=978%:%
%:%3343=979%:%
%:%3344=979%:%
%:%3345=980%:%
%:%3346=980%:%
%:%3347=981%:%
%:%3348=981%:%
%:%3349=982%:%
%:%3350=982%:%
%:%3351=983%:%
%:%3352=984%:%
%:%3353=984%:%
%:%3354=985%:%
%:%3355=986%:%
%:%3356=986%:%
%:%3357=987%:%
%:%3358=988%:%
%:%3359=989%:%
%:%3360=989%:%
%:%3363=990%:%
%:%3367=990%:%
%:%3368=990%:%
%:%3369=990%:%
%:%3374=990%:%
%:%3377=991%:%
%:%3378=992%:%
%:%3379=992%:%
%:%3380=993%:%
%:%3381=993%:%
%:%3382=993%:%
%:%3385=994%:%
%:%3389=994%:%
%:%3390=994%:%
%:%3391=994%:%
%:%3400=997%:%
%:%3401=998%:%
%:%3403=1001%:%
%:%3404=1001%:%
%:%3407=1002%:%
%:%3411=1002%:%
%:%3412=1002%:%
%:%3417=1002%:%
%:%3420=1003%:%
%:%3421=1004%:%
%:%3422=1004%:%
%:%3425=1005%:%
%:%3429=1005%:%
%:%3430=1005%:%
%:%3435=1005%:%
%:%3438=1006%:%
%:%3439=1007%:%
%:%3440=1007%:%
%:%3443=1008%:%
%:%3447=1008%:%
%:%3448=1008%:%
%:%3453=1008%:%
%:%3456=1009%:%
%:%3457=1010%:%
%:%3458=1010%:%
%:%3461=1011%:%
%:%3465=1011%:%
%:%3466=1011%:%
%:%3471=1011%:%
%:%3474=1012%:%
%:%3475=1013%:%
%:%3476=1013%:%
%:%3479=1014%:%
%:%3483=1014%:%
%:%3484=1014%:%
%:%3489=1014%:%
%:%3492=1015%:%
%:%3493=1016%:%
%:%3494=1016%:%
%:%3497=1017%:%
%:%3501=1017%:%
%:%3502=1017%:%
%:%3507=1017%:%
%:%3510=1018%:%
%:%3511=1019%:%
%:%3512=1019%:%
%:%3515=1020%:%
%:%3519=1020%:%
%:%3520=1020%:%
%:%3525=1020%:%
%:%3528=1021%:%
%:%3529=1022%:%
%:%3530=1022%:%
%:%3533=1023%:%
%:%3537=1023%:%
%:%3538=1023%:%
%:%3543=1023%:%
%:%3546=1024%:%
%:%3547=1025%:%
%:%3548=1025%:%
%:%3551=1026%:%
%:%3555=1026%:%
%:%3556=1026%:%
%:%3561=1026%:%
%:%3564=1027%:%
%:%3565=1028%:%
%:%3566=1028%:%
%:%3569=1029%:%
%:%3573=1029%:%
%:%3574=1029%:%
%:%3579=1029%:%
%:%3582=1030%:%
%:%3583=1031%:%
%:%3584=1031%:%
%:%3587=1032%:%
%:%3591=1032%:%
%:%3592=1032%:%
%:%3597=1032%:%
%:%3600=1033%:%
%:%3601=1034%:%
%:%3602=1034%:%
%:%3605=1035%:%
%:%3609=1035%:%
%:%3610=1035%:%
%:%3615=1035%:%
%:%3618=1036%:%
%:%3619=1037%:%
%:%3620=1037%:%
%:%3623=1038%:%
%:%3627=1038%:%
%:%3628=1038%:%
%:%3633=1038%:%
%:%3636=1039%:%
%:%3637=1040%:%
%:%3638=1040%:%
%:%3641=1041%:%
%:%3645=1041%:%
%:%3646=1041%:%
%:%3651=1041%:%
%:%3654=1042%:%
%:%3655=1043%:%
%:%3656=1043%:%
%:%3659=1044%:%
%:%3663=1044%:%
%:%3664=1044%:%
%:%3669=1044%:%
%:%3672=1045%:%
%:%3673=1046%:%
%:%3674=1046%:%
%:%3677=1047%:%
%:%3681=1047%:%
%:%3682=1047%:%
%:%3687=1047%:%
%:%3690=1048%:%
%:%3691=1049%:%
%:%3692=1049%:%
%:%3695=1050%:%
%:%3699=1050%:%
%:%3700=1050%:%
%:%3705=1050%:%
%:%3708=1051%:%
%:%3709=1052%:%
%:%3710=1052%:%
%:%3713=1053%:%
%:%3717=1053%:%
%:%3718=1053%:%
%:%3723=1053%:%
%:%3726=1054%:%
%:%3727=1055%:%
%:%3728=1055%:%
%:%3731=1056%:%
%:%3735=1056%:%
%:%3736=1056%:%
%:%3741=1056%:%
%:%3744=1057%:%
%:%3745=1058%:%
%:%3746=1058%:%
%:%3747=1059%:%
%:%3748=1060%:%
%:%3751=1061%:%
%:%3755=1061%:%
%:%3756=1061%:%
%:%3761=1061%:%
%:%3764=1062%:%
%:%3765=1063%:%
%:%3766=1063%:%
%:%3767=1064%:%
%:%3768=1064%:%
%:%3769=1064%:%
%:%3772=1065%:%
%:%3776=1065%:%
%:%3777=1065%:%
%:%3782=1065%:%
%:%3785=1066%:%
%:%3786=1067%:%
%:%3787=1067%:%
%:%3790=1068%:%
%:%3794=1068%:%
%:%3795=1068%:%
%:%3800=1068%:%
%:%3803=1069%:%
%:%3804=1070%:%
%:%3805=1070%:%
%:%3808=1071%:%
%:%3812=1071%:%
%:%3813=1071%:%
%:%3818=1071%:%
%:%3821=1072%:%
%:%3822=1073%:%
%:%3823=1073%:%
%:%3826=1074%:%
%:%3830=1074%:%
%:%3831=1074%:%
%:%3836=1074%:%
%:%3839=1075%:%
%:%3840=1076%:%
%:%3841=1076%:%
%:%3844=1077%:%
%:%3848=1077%:%
%:%3849=1077%:%
%:%3854=1077%:%
%:%3857=1078%:%
%:%3858=1079%:%
%:%3859=1079%:%
%:%3862=1080%:%
%:%3866=1080%:%
%:%3867=1080%:%
%:%3872=1080%:%
%:%3875=1081%:%
%:%3876=1082%:%
%:%3877=1082%:%
%:%3880=1083%:%
%:%3884=1083%:%
%:%3885=1083%:%
%:%3890=1083%:%
%:%3893=1084%:%
%:%3894=1085%:%
%:%3895=1085%:%
%:%3898=1086%:%
%:%3902=1086%:%
%:%3903=1086%:%
%:%3908=1086%:%
%:%3911=1087%:%
%:%3912=1088%:%
%:%3913=1088%:%
%:%3916=1089%:%
%:%3920=1089%:%
%:%3921=1089%:%
%:%3926=1089%:%
%:%3929=1090%:%
%:%3930=1091%:%
%:%3931=1091%:%
%:%3934=1092%:%
%:%3938=1092%:%
%:%3939=1092%:%
%:%3944=1092%:%
%:%3947=1093%:%
%:%3948=1094%:%
%:%3949=1094%:%
%:%3952=1095%:%
%:%3956=1095%:%
%:%3957=1095%:%
%:%3966=1098%:%
%:%3967=1099%:%
%:%3969=1102%:%
%:%3970=1102%:%
%:%3973=1103%:%
%:%3977=1103%:%
%:%3978=1103%:%
%:%3983=1103%:%
%:%3986=1104%:%
%:%3987=1105%:%
%:%3988=1105%:%
%:%3991=1106%:%
%:%3995=1106%:%
%:%3996=1106%:%
%:%4001=1106%:%
%:%4004=1107%:%
%:%4005=1108%:%
%:%4006=1108%:%
%:%4009=1109%:%
%:%4013=1109%:%
%:%4014=1109%:%
%:%4019=1109%:%
%:%4022=1110%:%
%:%4023=1111%:%
%:%4024=1111%:%
%:%4027=1112%:%
%:%4031=1112%:%
%:%4032=1112%:%
%:%4037=1112%:%
%:%4040=1113%:%
%:%4041=1114%:%
%:%4042=1114%:%
%:%4045=1115%:%
%:%4049=1115%:%
%:%4050=1115%:%
%:%4055=1115%:%
%:%4058=1116%:%
%:%4059=1117%:%
%:%4060=1117%:%
%:%4063=1118%:%
%:%4067=1118%:%
%:%4068=1118%:%
%:%4073=1118%:%
%:%4076=1119%:%
%:%4077=1120%:%
%:%4078=1120%:%
%:%4081=1121%:%
%:%4085=1121%:%
%:%4086=1121%:%
%:%4091=1121%:%
%:%4094=1122%:%
%:%4095=1123%:%
%:%4096=1123%:%
%:%4099=1124%:%
%:%4103=1124%:%
%:%4104=1124%:%
%:%4109=1124%:%
%:%4112=1125%:%
%:%4113=1126%:%
%:%4114=1126%:%
%:%4117=1127%:%
%:%4121=1127%:%
%:%4122=1127%:%
%:%4127=1127%:%
%:%4130=1128%:%
%:%4131=1129%:%
%:%4132=1129%:%
%:%4135=1130%:%
%:%4139=1130%:%
%:%4140=1130%:%
%:%4145=1130%:%
%:%4148=1131%:%
%:%4149=1132%:%
%:%4150=1132%:%
%:%4153=1133%:%
%:%4157=1133%:%
%:%4158=1133%:%
%:%4163=1133%:%
%:%4166=1134%:%
%:%4167=1135%:%
%:%4168=1135%:%
%:%4171=1136%:%
%:%4175=1136%:%
%:%4176=1136%:%
%:%4181=1136%:%
%:%4184=1137%:%
%:%4185=1138%:%
%:%4186=1138%:%
%:%4187=1139%:%
%:%4190=1140%:%
%:%4194=1140%:%
%:%4195=1140%:%
%:%4200=1140%:%
%:%4203=1141%:%
%:%4204=1142%:%
%:%4205=1142%:%
%:%4212=1143%:%
%:%4213=1143%:%
%:%4214=1144%:%
%:%4215=1144%:%
%:%4216=1145%:%
%:%4217=1145%:%
%:%4218=1146%:%
%:%4224=1146%:%
%:%4227=1147%:%
%:%4228=1148%:%
%:%4229=1148%:%
%:%4232=1149%:%
%:%4236=1149%:%
%:%4237=1149%:%
%:%4242=1149%:%
%:%4245=1150%:%
%:%4246=1151%:%
%:%4247=1151%:%
%:%4248=1152%:%
%:%4251=1153%:%
%:%4255=1153%:%
%:%4256=1153%:%
%:%4261=1153%:%
%:%4264=1154%:%
%:%4265=1155%:%
%:%4266=1155%:%
%:%4269=1156%:%
%:%4273=1156%:%
%:%4274=1156%:%
%:%4279=1156%:%
%:%4282=1157%:%
%:%4283=1158%:%
%:%4284=1158%:%
%:%4287=1159%:%
%:%4291=1159%:%
%:%4292=1159%:%
%:%4297=1159%:%
%:%4300=1160%:%
%:%4301=1161%:%
%:%4302=1161%:%
%:%4309=1162%:%
%:%4310=1162%:%
%:%4311=1163%:%
%:%4312=1163%:%
%:%4313=1164%:%
%:%4314=1164%:%
%:%4315=1165%:%
%:%4316=1165%:%
%:%4317=1166%:%
%:%4318=1166%:%
%:%4319=1166%:%
%:%4320=1167%:%
%:%4321=1167%:%
%:%4326=1167%:%
%:%4329=1168%:%
%:%4330=1169%:%
%:%4331=1169%:%
%:%4334=1170%:%
%:%4338=1170%:%
%:%4339=1170%:%
%:%4344=1170%:%
%:%4347=1171%:%
%:%4348=1172%:%
%:%4349=1172%:%
%:%4352=1173%:%
%:%4356=1173%:%
%:%4357=1173%:%
%:%4362=1173%:%
%:%4365=1174%:%
%:%4366=1175%:%
%:%4367=1175%:%
%:%4370=1176%:%
%:%4374=1176%:%
%:%4375=1176%:%
%:%4376=1176%:%
%:%4381=1176%:%
%:%4384=1177%:%
%:%4385=1178%:%
%:%4386=1178%:%
%:%4389=1179%:%
%:%4393=1179%:%
%:%4394=1179%:%
%:%4399=1179%:%
%:%4402=1180%:%
%:%4403=1181%:%
%:%4404=1181%:%
%:%4407=1182%:%
%:%4411=1182%:%
%:%4412=1182%:%
%:%4413=1182%:%
%:%4418=1182%:%
%:%4421=1183%:%
%:%4422=1184%:%
%:%4423=1184%:%
%:%4424=1185%:%
%:%4425=1186%:%
%:%4426=1187%:%
%:%4427=1187%:%
%:%4428=1188%:%
%:%4429=1189%:%
%:%4430=1190%:%
%:%4431=1190%:%
%:%4434=1191%:%
%:%4438=1191%:%
%:%4439=1191%:%
%:%4444=1191%:%
%:%4447=1192%:%
%:%4448=1193%:%
%:%4451=1195%:%
%:%4453=1197%:%
%:%4454=1197%:%
%:%4455=1198%:%
%:%4456=1199%:%
%:%4457=1200%:%
%:%4464=1201%:%
%:%4465=1201%:%
%:%4466=1202%:%
%:%4467=1202%:%
%:%4468=1203%:%
%:%4469=1203%:%
%:%4470=1204%:%
%:%4471=1204%:%
%:%4472=1205%:%
%:%4473=1205%:%
%:%4474=1205%:%
%:%4475=1205%:%
%:%4476=1206%:%
%:%4477=1206%:%
%:%4478=1207%:%
%:%4479=1207%:%
%:%4480=1207%:%
%:%4481=1207%:%
%:%4482=1208%:%
%:%4483=1208%:%
%:%4484=1209%:%
%:%4485=1209%:%
%:%4486=1209%:%
%:%4487=1209%:%
%:%4488=1210%:%
%:%4489=1210%:%
%:%4490=1210%:%
%:%4491=1210%:%
%:%4492=1211%:%
%:%4493=1211%:%
%:%4494=1211%:%
%:%4495=1212%:%
%:%4496=1212%:%
%:%4497=1213%:%
%:%4498=1213%:%
%:%4499=1213%:%
%:%4500=1214%:%
%:%4501=1214%:%
%:%4502=1214%:%
%:%4503=1215%:%
%:%4504=1215%:%
%:%4505=1215%:%
%:%4506=1215%:%
%:%4507=1216%:%
%:%4508=1216%:%
%:%4509=1216%:%
%:%4510=1217%:%
%:%4511=1217%:%
%:%4512=1218%:%
%:%4513=1218%:%
%:%4514=1218%:%
%:%4515=1218%:%
%:%4516=1219%:%
%:%4522=1219%:%
%:%4525=1220%:%
%:%4526=1221%:%
%:%4527=1221%:%
%:%4528=1222%:%
%:%4529=1223%:%
%:%4530=1224%:%
%:%4531=1225%:%
%:%4534=1226%:%
%:%4538=1226%:%
%:%4539=1226%:%
%:%4540=1227%:%
%:%4541=1227%:%
%:%4542=1228%:%
%:%4543=1228%:%
%:%4544=1229%:%
%:%4545=1229%:%
%:%4546=1229%:%
%:%4547=1230%:%
%:%4548=1230%:%
%:%4549=1231%:%
%:%4550=1231%:%
%:%4551=1232%:%
%:%4552=1232%:%
%:%4553=1232%:%
%:%4554=1233%:%
%:%4555=1233%:%
%:%4556=1234%:%
%:%4557=1234%:%
%:%4558=1234%:%
%:%4559=1235%:%
%:%4560=1235%:%
%:%4561=1236%:%
%:%4562=1236%:%
%:%4563=1236%:%
%:%4564=1237%:%
%:%4565=1237%:%
%:%4566=1238%:%
%:%4572=1238%:%
%:%4575=1239%:%
%:%4576=1240%:%
%:%4577=1240%:%
%:%4578=1241%:%
%:%4579=1242%:%
%:%4582=1243%:%
%:%4586=1243%:%
%:%4587=1243%:%
%:%4588=1244%:%
%:%4589=1244%:%
%:%4590=1245%:%
%:%4591=1245%:%
%:%4592=1246%:%
%:%4593=1246%:%
%:%4594=1247%:%
%:%4595=1247%:%
%:%4596=1247%:%
%:%4597=1248%:%
%:%4598=1248%:%
%:%4599=1249%:%
%:%4600=1249%:%
%:%4601=1249%:%
%:%4602=1250%:%
%:%4603=1250%:%
%:%4604=1251%:%
%:%4605=1251%:%
%:%4606=1251%:%
%:%4607=1251%:%
%:%4608=1252%:%
%:%4609=1252%:%
%:%4610=1253%:%
%:%4611=1253%:%
%:%4612=1253%:%
%:%4613=1254%:%
%:%4614=1254%:%
%:%4615=1255%:%
%:%4616=1255%:%
%:%4617=1255%:%
%:%4618=1256%:%
%:%4619=1256%:%
%:%4620=1257%:%
%:%4621=1257%:%
%:%4622=1258%:%
%:%4623=1258%:%
%:%4624=1259%:%
%:%4625=1259%:%
%:%4626=1260%:%
%:%4627=1260%:%
%:%4628=1260%:%
%:%4629=1261%:%
%:%4630=1261%:%
%:%4631=1262%:%
%:%4632=1262%:%
%:%4633=1262%:%
%:%4634=1263%:%
%:%4635=1263%:%
%:%4636=1264%:%
%:%4637=1264%:%
%:%4638=1264%:%
%:%4639=1265%:%
%:%4640=1265%:%
%:%4641=1266%:%
%:%4642=1266%:%
%:%4643=1266%:%
%:%4644=1266%:%
%:%4645=1267%:%
%:%4646=1267%:%
%:%4647=1268%:%
%:%4648=1268%:%
%:%4649=1268%:%
%:%4650=1269%:%
%:%4651=1269%:%
%:%4652=1270%:%
%:%4653=1270%:%
%:%4654=1270%:%
%:%4655=1270%:%
%:%4656=1271%:%
%:%4657=1271%:%
%:%4658=1272%:%
%:%4659=1272%:%
%:%4660=1272%:%
%:%4661=1273%:%
%:%4662=1273%:%
%:%4663=1274%:%
%:%4664=1274%:%
%:%4665=1274%:%
%:%4666=1275%:%
%:%4667=1275%:%
%:%4668=1276%:%
%:%4683=1279%:%
%:%4699=1281%:%
%:%4700=1281%:%
%:%4701=1282%:%
%:%4702=1283%:%
%:%4703=1283%:%
%:%4722=1290%:%
%:%4732=1292%:%
%:%4733=1292%:%
%:%4736=1293%:%
%:%4740=1293%:%
%:%4741=1293%:%
%:%4746=1293%:%
%:%4749=1294%:%
%:%4750=1295%:%
%:%4751=1295%:%
%:%4754=1296%:%
%:%4758=1296%:%
%:%4759=1296%:%
%:%4764=1296%:%
%:%4767=1297%:%
%:%4768=1298%:%
%:%4769=1298%:%
%:%4772=1299%:%
%:%4776=1299%:%
%:%4777=1299%:%
%:%4791=1302%:%
%:%4807=1305%:%
%:%4808=1305%:%
%:%4839=1336%:%
%:%4840=1337%:%
%:%4841=1338%:%
%:%4842=1338%:%
%:%4856=1341%:%
%:%4866=1343%:%
%:%4867=1343%:%
%:%4868=1344%:%
%:%4869=1344%:%
%:%4870=1345%:%
%:%4871=1345%:%
%:%4872=1346%:%
%:%4873=1346%:%
%:%4874=1347%:%
%:%4875=1347%:%
%:%4876=1348%:%
%:%4877=1348%:%
%:%4878=1349%:%
%:%4879=1349%:%
%:%4880=1350%:%
%:%4881=1351%:%
%:%4882=1351%:%
%:%4885=1352%:%
%:%4890=1353%:%
